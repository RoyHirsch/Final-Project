bplist00“_WebMainResource_WebSubresources’	
_WebResourceData_WebResourceMIMEType_WebResourceTextEncodingName^WebResourceURL_WebResourceFrameNameOõ|<!DOCTYPE html><html><head>
	<title>Test Repository</title>

    <!-- Generated using sbt-concat -->
    <link rel="stylesheet" media="screen" href="/assets/stylesheets/generated_default_styles.css">

    <!-- Avoid favicon request -->
    <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgo=">

    <!-- Generated using sbt-concat -->
    <script src="/assets/javascripts/generated_default_scripts.js" type="text/javascript"></script>

</head>


    <body>

    	
    		






<div class="menu" id="cssmenu">

	<ul style="text-align: left;">

		<li class="has-sub" style="height: 32px; min-width: 180px;">
			<a href="/" style="padding-left: 3px; padding-bottom: 0px;">
				<span class="home-icon"></span>
				<table style="display: inline-block; line-height: 0.9; padding-top: 3px; padding-right: 5px; width: calc(100% - 46px);">
					<tbody><tr><td>DSI</td></tr>
					<tr><td style="font-size: 11px;">Test Repository</td></tr>
				</tbody></table>
			</a>

			<table>
				<tbody>
					<tr>
						<td> 
							<ul>
								
							</ul>
						</td>
					</tr>
				</tbody>
			</table>
		</li>

		<li class="has-sub mega-menu"><a href="/reports">Reports</a><table><tbody><tr><td><p class="mega-menu-header">Coverage</p><ul><li><a href="/reports/LMTestCoverageReport?hdnTestCoverageStage=Execution">Execution</a></li><li><a href="/reports/LMTestCoverageReport?hdnTestCoverageStage=Planning">Planning</a></li><li><a href="/ui/TPSimulationGeneration">TP Simulation</a></li><li><a href="/reports/displayAutoReportsPage">Automatic</a></li></ul></td><td><p class="mega-menu-header">Activity</p><ul><li><a href="/reports/LMLabActivityReport">Test History</a></li><li><a href="/reports/LabStatusReport">Lab Status</a></li><li><a href="/reports/ActivityLogReport">Activity Log</a></li><li><a href="/reports/displayChangeLogReport">Change Log</a></li><li><a href="/lab/usageReport">Usage Analytics</a></li></ul></td><td><p class="mega-menu-header">Other</p><ul><li><a href="/tasks/DisplayOpenQueriesPage">Open Queries</a></li><li><a href="/tasks/genericReports_displayExecutionPage">Generic Reports Execution</a></li><li><a href="/tasks/genericReports_displayConfigurationPage">Generic Reports Configuration</a></li></ul></td></tr></tbody></table></li><li class="has-sub mega-menu"><a href="/ui/displayHostManagement">Operation</a><table><tbody><tr><td><p class="mega-menu-header">Execution</p><ul><li><a href="/ui/displayHostManagement">Host Management</a></li><li><a href="/ui/displayBatchManagement/false">Test Plan Executions</a></li><li><a href="/ui/displayBatchManagement/true">Fast Run Executions</a></li><li><a href="/tasks/DisplayWorkflowRuns">Workflows Monitoring</a></li></ul></td><td><p class="mega-menu-header">Tasks</p><ul><li><a href="/tasks/tasksViewer">Task Management</a></li></ul></td><td><p class="mega-menu-header">Documents</p><ul><li><a href="/documents/searchReport">Search</a></li><li><a href="/documents/edit">Upload</a></li></ul></td><td><p class="mega-menu-header">User Packages</p><ul><li><a href="/packages/display">View Released</a></li><li><a href="/packages/requests/displayAll">View Requests</a></li><li><a href="/packages/requests/displayNew">New Request</a></li></ul></td></tr></tbody></table></li><li class="has-sub mega-menu"><a href="/config/true">Configuration</a><table><tbody><tr><td><p class="mega-menu-header">Tests</p><ul><li><a href="/ui/displayTestPlansManagement">Test Plans</a></li><li><a href="/ui/displayTestSuitesManagement">Test Suites</a></li><li><a href="/ui/displayScenariosSetupsManagement">Test Repository</a></li><li><a href="/ui/displayProjectsManagement">Projects</a></li><li><a href="/ui/fastRunManagement">Fast Runs</a></li></ul></td><td><p class="mega-menu-header">Workflows</p><ul><li><a href="/tasks/DisplayWorkflowStepsConfiguration">Step Repository</a></li><li><a href="/tasks/DisplayWorkflowsConfigurationManagement">Workflows Configuration</a></li><li><a href="/tasks/DisplayWorkflowPlansConfig">Workflow Plans</a></li></ul></td><td><p class="mega-menu-header">Lab</p><ul><li><a href="/ui/displayVirtualLabsManagement">Virtual Labs</a></li><li><a href="/ui/resourceGroupsEditor">Resource Groups</a></li><li><a href="/tasks/DisplayCustomizedAttributesManagement">Attributes</a></li><li><a href="/ui/displaySetupParametersManagement">Setup Parameters</a></li><li><a href="/ui/displayVirtualCombinationManagement">Virtual Combinations</a></li><li><a href="/ui/displayAllowedPermutationsManagement">Allowed Permutations</a></li><li><a href="/ui/displayLabArrangements">Lab Arrangements</a></li></ul></td><td><p class="mega-menu-header">Documents</p><ul><li><a href="/documents/repositories/config">Repositories</a></li></ul></td><td><p class="mega-menu-header">System</p><ul><li><a href="/config/true">Default Settings</a></li><li><a href="/config/false">Server Settings</a></li><li><a href="/tasks/displayUsers">Users</a></li></ul></td></tr></tbody></table></li>

		<table style="float: right;" cellspacing="0" class="MenuBarRightTable">
			<tbody><tr>
				<td id="terminalsMenu" class="inactive-force" style="border-right: 1px solid #555; display: inline-block;">
					<li class="has-sub">
						<a class="login">Terminals &amp; Logs</a>
						<table style="margin-left: -10px;"><tbody><tr><td></td></tr></tbody></table>
					</li>
				</td>

				

				<td>
					<li class="has-sub">
						<a href='javascript:location.href = "/tasks/displayUserInfo/" + getLoggedInUsername()' class="login">
							 Roy Hirsch 
						</a>
						<table id="loggedInMenu" style="margin-left: -10px;">
							<tbody><tr>
								<td>
									<ul id="logsMenu">
										<li><a href='javascript:location.href = "/tasks/displayUserInfo/" + getLoggedInUsername()'>Profile</a></li>
										<li><a href="javascript:generateAccessKey()">Access Key</a></li>
										<li><a href="javascript:generateEncryptedCredentials()">Encrypt Credentials</a></li>
										<li><a href="javascript:logout()">Logout</a></li>
									</ul>
								</td>
							</tr>
						</tbody></table>
					</li>
				</td>

				<td style="display: inline-block; padding-left: 10px; border-left: 1px solid #555;">
					<span id="lmStatusSpan">
						<label id="lmVersion" class="inactive">4.7.2.1</label>
						<label id="connectionStatus" style="margin-right: 5px">
							<span id="green" class="inactive"><span class="status-green-icon" title="Version: 4.7.2.1. Connected to lab manager"></span></span>
							<span id="red" class="inactive"><span class="status-red-icon" title="Version: 4.7.2.1. Disconnected from lab manager.<br/>Trying to reconnect every 10 seconds"></span></span>
							<span id="gray"><span class="status-gray-icon" title="Version: 4.7.2.1. Lab manager state is unknown"></span></span>
						</label>
					</span>
				</td>

				<td>
					<li class="has-sub" style="margin-right: -8px;">
						<a style="top: 0px; display: inline-block; height: 32px;">
							<span class="info-icon"></span>
						</a>

						<table style="margin-left: -150px;">
							<tbody>
								<tr><td> 
									<ul>
										
											
										

										<li><a href="/documentation/0">Documentation</a></li>
										<li><a href="/documentation/downloadExternalAPIDoc">API Documentation</a></li>
										<li><a href="/documentation/downloadExternalAPI">Python API</a></li>
										<li><a href="/mobile/introduction">iLM</a></li>
										<li><a href="/about">About</a></li>
									</ul>
								</td>
							</tr></tbody>
						</table>
					</li>
				</td>

				<td>
					<li>
						<span style="margin-top: 5px; cursor: pointer; float: right" class="radar-icon" onclick="openNewRadar()" title="Open new radar">
						
					</span></li>
				</td>
			</tr>
		</tbody></table>

	</ul>

	<div id="pageLoading" style="left: 0px; width: 100%; z-index: 201; position: absolute; opacity: 0.9; display: none; top: 0px; height: 0px;">
		<div style="width: 100%; height: 32px;" role="progressbar" aria-valuemin="0" class="ui-progressbar ui-corner-all ui-widget ui-widget-content ui-progressbar-indeterminate">
			<div style="position: absolute; left: 45.5%; top: 4px; font-weight: bold; text-shadow: 1px 1px 0 #fff; z-index: 201; font-size: 18px;">
				Please wait ...
			</div>
		<div class="ui-progressbar-value ui-corner-left ui-widget-header" style="width: 100%; background-color: transparent; background-position: initial initial; background-repeat: initial initial;"><div class="ui-progressbar-overlay"></div></div></div>
	</div>

</div>		

<script type="text/javascript">
	$(function () {
		// Set tasks menu maximum size, this is needed because it's floating and it doesn't know to resize itself
		// according to the viewport size
		var cssMenu = $("#cssmenu");
		var tasksBadge = cssMenu.find("#tasksBadge");
		if (tasksBadge.length > 0) {
			var tasksBadgeLeft = tasksBadge.position().left;
			var maxTaskMenuWidth = $(window).width() - tasksBadgeLeft;
			cssMenu.find("#tasksBadgeTable").width(maxTaskMenuWidth + 5);
		}
	});
</script>





    	

    	<div class="content">
			<div id="divContent" style="padding: 10px;  height: calc(100vh - 58px); ">
	        	

	<script src="/assets/javascripts/testrepositoryjs/TestRepositoryManagement.js" type="text/javascript"></script>
	<script src="/assets/javascripts/ui-controls/autosize.js" type="text/javascript"></script>
	<script src="/assets/javascripts/utilities/papaparse.min.js" type="text/javascript"></script>

	<script type="text/javascript">
		function isEnableTestRadarsFeature() {
			return false;
		}

		$(function() {
	
		    // Make the sections collapsible
			$("#divSections").accordion({
			      collapsible: true,
			      active: 1
			});	

			// Initialize the buttons
			testRepository_initializeButtons();

			// Initialize the dialogs
			testRepository_initializeDeleteTestsConfirmDialog();

			$(document).tooltip({
				content: function() {
					return renderScenarioVirtualCombinationTooltip(this);
				}
			});

			// Send a request to the server to load the configuration scenarios 
			testRepository_sendRequestToLoadTestRepository();
		});

	</script>

	<div class="LMBottomInsetSection">
		<table>
			<tbody><tr>
				<td style="width: 100%;">
					<button id="btnSaveTestRepository" onclick="testRepository_save();" class="LMMainButton ui-button ui-corner-all ui-widget"><span class="ui-button-icon ui-icon ui-icon-disk"></span><span class="ui-button-icon-space"> </span>Save</button>
					
					
				</td>

				<td style="white-space: nowrap;">
					<button id="btnImportTests" onclick="testRepository_onImport()" title="Import tests from CSV" class="ui-button ui-corner-all ui-widget"><span class="ui-button-icon ui-icon ui-icon-folder-open"></span><span class="ui-button-icon-space"> </span>Import</button>
					<button id="btnExportTests" onclick="testRepository_onExport()" title="Export tests to CSV" class="ui-button ui-corner-all ui-widget"><span class="ui-button-icon ui-icon ui-icon-disk"></span><span class="ui-button-icon-space"> </span>Export</button>

					<span style="display: inline-block;">
						 

<form action="/reports/displayChangeLogReport" method="GET" id="frmShowChangeLog">
    
							<input type="hidden" id="hdnReportWasGenerated" name="reportWasGenerated" value="true">
							<input type="hidden" id="hdnEntityType" name="entityType" value="TestRepository">
							<input type="hidden" id="hdnEntityId" name="entityId" value="">
							<input type="hidden" id="hdnSinceDays" name="sinceDays" value="">
							<button type="button" id="btnShowChangeLog" onclick="testRepository_showChangeLog();" class="ui-button ui-corner-all ui-widget"><span class="ui-button-icon ui-icon ui-icon-script"></span><span class="ui-button-icon-space"> </span>Change Log</button>
						
</form>

					</span>
				</td>
			</tr>
		</tbody></table>
	</div>

	<div class="LMBorderedSection LMContentSection LMOverflowContainer LMContainerStretch" style="height: calc(100vh - 102px);">
		<table id="tblOperations" class="LMInsetSection">
			<tbody>
				<tr>
					<td id="tdNewTest">
						<button id="btnNewTest" type="button" onclick="testRepository_editTest();" class="ui-button ui-corner-all ui-widget"><span class="ui-button-icon ui-icon ui-icon-document"></span><span class="ui-button-icon-space"> </span>New</button>
					</td>

					<td id="tdDeleteTest">
						<button id="btnDeleteTest" type="button" onclick="testRepository_onDeleteTests()" class="ui-button ui-corner-all ui-widget"><span class="ui-button-icon ui-icon ui-icon-trash"></span><span class="ui-button-icon-space"> </span>Delete</button>
					</td>

					<td>
						<input type="checkbox" id="btnShowAdvanced" class="ui-checkboxradio ui-helper-hidden-accessible">
							<label for="btnShowAdvanced" class="ui-checkboxradio-label ui-corner-all ui-button ui-widget ui-checkboxradio-checked ui-state-active"><span class="ui-icon ui-button-icon ui-icon-gear white-icons"></span> Show Advanced</label>
						
					</td>
				</tr>
			</tbody>
		</table>

		<div id="divScenarios" class="LMInsetSection">
		
			<input type="hidden" id="hdnConfigurationScenariosData">
			<input type="hidden" id="hdnVirtualCombinationsData"><table class="hor-minimalist-c" id="tblScenarios" data-filter-display-num-shown-rows="" data-filter-display-num-shown-rows-in-id="thSelectionStats" data-filter-checkbox-id="chkSelect" data-filter-checkbox-all-id="chkSelectAll" data-filter-post-function="testRepository_GroupTestsOfSameCategory" data-sort-post-function="testRepository_GroupTestsOfSameCategory">

				<thead class="StickyHeader">
				
					<tr id="trActionOnSelected" data-csv-exclude="">

						<th colspan="3" id="thSelectionStats">0/2 (2)</th>						

						<th id="thPriority" data-advanced="" class="">
						
							<select id="slctPriority" name="slctPriority" onchange="testRepository_onSetScenariosProperty(this,'Priority', true)">
								<option value="">Set Priority...</option>
								
									
										<option value="0">0</option>
									
										<option value="1">1</option>
									
										<option value="2">2</option>
									
										<option value="3">3</option>
									
										<option value="4">4</option>
									
										<option value="5">5</option>
									
										<option value="6">6</option>
									
										<option value="7">7</option>
									
										<option value="8">8</option>
									
										<option value="9">9</option>
									
								
							</select>
							
						</th>
						
						<th id="thRepeat" data-advanced="" class="">

							<select id="slctRepeat" name="slctRepeat" onchange="testRepository_onSetScenariosProperty(this,'Repeat', true)">
							
								<option>Set Repeat...</option>
								
									<option value="1">1</option>
								
									<option value="2">2</option>
								
									<option value="3">3</option>
								
									<option value="4">4</option>
								
									<option value="5">5</option>
								
									<option value="6">6</option>
								
									<option value="7">7</option>
								
									<option value="8">8</option>
								
									<option value="9">9</option>
								
									<option value="10">10</option>
								
								
							</select>
							
						</th>

						

						<th id="thVirtualCombination" class="RightBorderCell">
						
							<select id="slctVirtualCombination" name="slctVirtualCombination" onchange="testRepository_onSetScenariosProperty(this, 'VirtualCombination', true)"><option value="">Set Virtual Combination...</option><option value="1">Any</option></select>
					
						</th>

						<th id="thScriptPath" name="thScriptPath" data-entity-type="Scenario" data-customized-attribute-id="1" data-customized-attribute-name="ScriptPath" data-multiple-choice="false"><input type="button" value="Set ScriptPath" onclick="testRepository_setTestCustomizedAttributeText(this)"></th><th id="thRightMostCell"></th>
					</tr>
					
					<tr id="trColumnNames">

						<th id="thCategory" data-filter-enabled="" style="min-width: 250px;" data-filter-function="FilterTable" data-column-index="0"><span class="text-wrapper"><span class="text">Category</span></span><select multiple="multiple" id="slctCategory" name="slctCategory" onchange="FilterTable('tblScenarios', 'Category')" style="width: 19px; display: none;"><option value="Regression Tests">Regression Tests</option></select><div class="ms-parent " style="width: 19px;"><button type="button" class="ms-choice"><span class="placeholder"></span><div></div></button><div class="ms-drop bottom"><ul style="max-height: 250px;"><li class="ms-select-all"><label><input type="checkbox" data-name="selectAllslctCategory"> [Select all]</label></li><li class="" style="false"><label class=""><input type="checkbox" data-name="selectItemslctCategory" value="Regression Tests"><span>Regression Tests</span></label></li><li class="ms-no-results">No matches found</li></ul></div></div></th>

						<th id="thSelect" data-csv-exclude="" style="padding-left: 4px;" data-filter-function="FilterTable" data-column-index="1">
							<input type="checkbox" id="chkSelectAll" name="chkSelectAll" onclick="CheckAll(this.id, 'tblScenarios');">
						</th>

						<th id="thScenarioName" data-filter-enabled="" data-filter-search="" data-filter-function="FilterTable" data-column-index="2"><span class="text-wrapper"><span class="text">Test Name</span></span><select multiple="multiple" id="slctScenarioName" name="slctScenarioName" onchange="FilterTable('tblScenarios', 'ScenarioName')" style="width: 19px; display: none;"><option value="BioKitTester">BioKitTester</option><option value="PCEcalibCopy">PCEcalibCopy</option></select><div class="ms-parent " style="width: 19px;"><button type="button" class="ms-choice"><span class="placeholder"></span><div></div></button><div class="ms-drop bottom"><div class="ms-search"><input type="text" autocomplete="off" autocorrect="off" autocapitilize="off" spellcheck="false"></div><ul style="max-height: 250px;"><li class="ms-select-all"><label><input type="checkbox" data-name="selectAllslctScenarioName"> [Select all]</label></li><li class="" style="false"><label class=""><input type="checkbox" data-name="selectItemslctScenarioName" value="BioKitTester"><span>BioKitTester</span></label></li><li class="" style="false"><label class=""><input type="checkbox" data-name="selectItemslctScenarioName" value="PCEcalibCopy"><span>PCEcalibCopy</span></label></li><li class="ms-no-results">No matches found</li></ul></div></div></th>

						<th id="thPriority" data-view="basic-view" data-filter-enabled="" data-advanced="" class="" data-filter-function="FilterTable" data-column-index="3"><span class="text-wrapper"><span class="text">Priority</span></span><select multiple="multiple" id="slctPriority" name="slctPriority" onchange="FilterTable('tblScenarios', 'Priority')" style="width: 19px; display: none;"><option value="0">0</option></select><div class="ms-parent " style="width: 19px;"><button type="button" class="ms-choice"><span class="placeholder"></span><div></div></button><div class="ms-drop bottom"><ul style="max-height: 250px;"><li class="ms-select-all"><label><input type="checkbox" data-name="selectAllslctPriority"> [Select all]</label></li><li class="" style="false"><label class=""><input type="checkbox" data-name="selectItemslctPriority" value="0"><span>0</span></label></li><li class="ms-no-results">No matches found</li></ul></div></div></th>

						<th id="thRepeat" data-filter-enabled="" data-advanced="" class="" data-filter-function="FilterTable" data-column-index="4"><span class="text-wrapper"><span class="text">Repeat</span></span><select multiple="multiple" id="slctRepeat" name="slctRepeat" onchange="FilterTable('tblScenarios', 'Repeat')" style="width: 19px; display: none;"><option value="1">1</option></select><div class="ms-parent " style="width: 19px;"><button type="button" class="ms-choice"><span class="placeholder"></span><div></div></button><div class="ms-drop bottom"><ul style="max-height: 250px;"><li class="ms-select-all"><label><input type="checkbox" data-name="selectAllslctRepeat"> [Select all]</label></li><li class="" style="false"><label class=""><input type="checkbox" data-name="selectItemslctRepeat" value="1"><span>1</span></label></li><li class="ms-no-results">No matches found</li></ul></div></div></th>

						
						
						<th id="thVirtualCombination" class="RightBorderCell" data-filter-enabled="" data-filter-function="FilterTable" data-column-index="5"><span class="text-wrapper"><span class="text">Virtual Combination</span></span><select multiple="multiple" id="slctVirtualCombination" name="slctVirtualCombination" onchange="FilterTable('tblScenarios', 'VirtualCombination')" style="width: 19px; display: none;"><option value="Any">Any</option></select><div class="ms-parent " style="width: 19px;"><button type="button" class="ms-choice"><span class="placeholder"></span><div></div></button><div class="ms-drop bottom"><ul style="max-height: 250px;"><li class="ms-select-all"><label><input type="checkbox" data-name="selectAllslctVirtualCombination"> [Select all]</label></li><li class="" style="false"><label class=""><input type="checkbox" data-name="selectItemslctVirtualCombination" value="Any"><span>Any</span></label></li><li class="ms-no-results">No matches found</li></ul></div></div></th>

						<th id="thScriptPath" name="thScriptPath" data-entity-type="Scenario" data-customized-attribute-id="1" data-customized-attribute-name="ScriptPath" data-multiple-choice="false" data-view="test-attributes-view" data-filter-enabled="" data-filter-refresh-on-open="" data-filter-search="" data-filter-function="FilterTable" data-column-index="6"><span class="text-wrapper"><span class="text">ScriptPath</span></span><select multiple="multiple" id="slctScriptPath" name="slctScriptPath" onchange="FilterTable('tblScenarios', 'ScriptPath')" style="width: 19px; display: none;"></select><div class="ms-parent " style="width: 19px;"><button type="button" class="ms-choice"><span class="placeholder"></span><div></div></button><div class="ms-drop bottom"><div class="ms-search"><input type="text" autocomplete="off" autocorrect="off" autocapitilize="off" spellcheck="false"></div><ul style="max-height: 250px;"><li class="ms-select-all"><label><input type="checkbox" data-name="selectAllslctScriptPath"> [Select all]</label></li><li class="ms-no-results">No matches found</li></ul></div></div></th><th id="thRightMostCell" data-csv-exclude="" data-filter-function="FilterTable" data-column-index="7"></th>
					</tr>
				
				</thead>
				
				<tbody>

				<tr id="0" data-scenario-virtual-combination-id="0" data-scenario-id="0" data-scenario-name="Test" data-virtual-combination-id="1" onclick="if (!($(event.target).is('#tdCategory'))) { $(this).find('#chkSelect').click(); }" style="cursor: pointer; border-top-width: 1px; border-top-style: solid; border-top-color: rgb(0, 0, 0);" data-dirty="true" class="TestManagementDifferentFromDefault"><td id="tdCategory" class="cell-white-no-hover cell-light-right-border" style="word-break: break-all; vertical-align: top; cursor: default;" onmouseover="testRepository_HoverCategory($(this));" onmouseout="testRepository_UnhoverCategory($(this));" rowspan="3">Regression Tests</td><td id="tdSelect" name="tdSelect" data-csv-exclude="" style="white-space: nowrap;"><input type="checkbox" id="chkSelect" name="chkSelect" onclick="event.stopPropagation();"><input type="hidden" id="hdnID" value="0">&nbsp;<button id="editButton" onclick="testRepository_editTest($(this).closest('tr')); event.stopPropagation();" class="ui-button ui-corner-all ui-widget" style="padding: 2px 7px 2px 11px;"><span class="ui-button-icon ui-icon ui-icon-pencil"></span><span class="ui-button-icon-space"> </span></button></td><td id="tdScenarioName" style="white-space: nowrap;">Test</td><td id="tdPriority" data-advanced="">0</td><td id="tdRepeat" data-advanced="">1</td><td id="tdVirtualCombination">Any</td><td id="tdScriptPath" data-customized-attribute-name="ScriptPath" data-multiple-choice="false">/Auto/TestRunner/test_automation3.py</td><input type="hidden" id="hdnFilterBitArray" name="hdnFilterBitArray"></tr><tr id="1" data-scenario-virtual-combination-id="1" data-scenario-id="1" data-scenario-name="BioKitTester" data-virtual-combination-id="1" onclick="if (!($(event.target).is('#tdCategory'))) { $(this).find('#chkSelect').click(); }" style="cursor: pointer;"><td id="tdCategory" class="cell-light-right-border cell-white-no-hover inactive-force" style="word-break: break-all; vertical-align: top; cursor: default;" onmouseover="testRepository_HoverCategory($(this));" onmouseout="testRepository_UnhoverCategory($(this));" rowspan="1">Regression Tests</td><td id="tdSelect" name="tdSelect" data-csv-exclude="" style="white-space: nowrap;"><input type="checkbox" id="chkSelect" name="chkSelect" onclick="event.stopPropagation();"><input type="hidden" id="hdnID" value="1">&nbsp;<button id="editButton" onclick="testRepository_editTest($(this).closest('tr')); event.stopPropagation();" class="ui-button ui-corner-all ui-widget" style="padding: 2px 7px 2px 11px;"><span class="ui-button-icon ui-icon ui-icon-pencil"></span><span class="ui-button-icon-space"> </span></button></td><td id="tdScenarioName" style="white-space: nowrap;">BioKitTester</td><td id="tdPriority" data-advanced="" class="">0</td><td id="tdRepeat" data-advanced="" class="">1</td><td id="tdVirtualCombination">Any</td><td id="tdScriptPath" data-customized-attribute-name="ScriptPath" data-multiple-choice="false">/Auto/TestRunner/test_automation.py</td><input type="hidden" id="hdnFilterBitArray" name="hdnFilterBitArray"></tr><tr id="2" data-scenario-virtual-combination-id="2" data-scenario-id="2" data-scenario-name="PCEcalibCopy" data-virtual-combination-id="1" onclick="if (!($(event.target).is('#tdCategory'))) { $(this).find('#chkSelect').click(); }" style="cursor: pointer;"><td id="tdCategory" class="cell-light-right-border inactive-force cell-white-no-hover" style="word-break: break-all; vertical-align: top; cursor: default;" onmouseover="testRepository_HoverCategory($(this));" onmouseout="testRepository_UnhoverCategory($(this));" rowspan="1">Regression Tests</td><td id="tdSelect" name="tdSelect" data-csv-exclude="" style="white-space: nowrap;"><input type="checkbox" id="chkSelect" name="chkSelect" onclick="event.stopPropagation();"><input type="hidden" id="hdnID" value="2">&nbsp;<button id="editButton" onclick="testRepository_editTest($(this).closest('tr')); event.stopPropagation();" class="ui-button ui-corner-all ui-widget" style="padding: 2px 7px 2px 11px;"><span class="ui-button-icon ui-icon ui-icon-pencil"></span><span class="ui-button-icon-space"> </span></button></td><td id="tdScenarioName" style="white-space: nowrap;">PCEcalibCopy</td><td id="tdPriority" data-advanced="" class="">0</td><td id="tdRepeat" data-advanced="" class="">1</td><td id="tdVirtualCombination">Any</td><td id="tdScriptPath" data-customized-attribute-name="ScriptPath" data-multiple-choice="false">/Auto/TestRunner/test_automation2.py</td><input type="hidden" id="hdnFilterBitArray" name="hdnFilterBitArray"></tr></tbody>
			
			</table>

			
		
		</div>
	</div>

	

	        </div>
	    </div>

    
   
    <script type="text/javascript">
    	function InsertParserReplacers(p_str) {
    		return p_str.replace(/\//g, "SLASH_REPLACER").replace(/ /g, "SPACE_REPLACER").replace(/=/g, "ASSIGNMENT_REPLACER").replace(/:/g, "COLON_REPLACER").replace(/\./g, "DOT_REPLACER").replace(/@/g, "AT_REPLACER");
    	}
    	
    	function ParseParserReplacers(p_str) {
    		return p_str.replace(/ASSIGNMENT_REPLACER/g, "=").replace(/COLON_REPLACER/g, ":").replace(/DOT_REPLACER/g, ".").replace(/AT_REPLACER/g, "@");
    	}

		function isClosedLoop() {
			return false;
		}

		function getLMIP() {
			return "17.78.178.24";
		}

		$(function() {
			// If we have a stretch container with overflow, limit its height so it won't exceed the viewport's height
			// Make sure it stays that way after a resize
			relayoutStretchContainers();

			var loggedInData = getLoggedInData();
			if (loggedInData != undefined && loggedInData.isAdmin) {
				// Show web log links
				var username = 'labmadmin';
				var password = 'test';
				$("#logsMenu").append('<hr><li><a href="javascript:followLMLog(\'last_LM_output\');">Basic Log</a></li>' +
						'<li><a href="javascript:followLMLog(\'LabManager_Debug\');">Debug Log</a></li>');
			}

			// Set dynamic message with the last message receival time in the green icon
			var connectionStatus = $("#connectionStatus");
			connectionStatus.find(".status-gray-icon").tooltip();
			connectionStatus.find(".status-green-icon").tooltip({
				content: function() {
					var message = "Version: 4.7.2.1. Connected to lab manager";
					var date = connectionStatus.data('lastMessageReceivedAt');
					if (date != undefined) {
						message += ". Last message received at: " + formatDate(date);
					}
					return message;
				}	 
			});
		});

		function pageLoading(optTimeBeforeAnimation) {
			// Initialize loading progress bar if wasn't initialized
			var loadingElem = $("#pageLoading");
			if (loadingElem.data('inited') != true) {
				// Initialize progress bar
				loadingElem.find("> div:eq(0)").progressbar({ value: false });
				loadingElem.data('inited', true);

				// Set transparent background
				loadingElem.find(".ui-progressbar-value").css("background", "transparent");

				// Set height to 0 for animation
				loadingElem.css('height', '0px');
			}

			if (optTimeBeforeAnimation == undefined) {
				optTimeBeforeAnimation = 200;
			}

			var callCount = loadingElem.data('loadingCalledCount');
			if (callCount == undefined) {
				callCount = 0;
			}
			loadingElem.data('loadingCalledCount', callCount + 1);

			setTimeout(function () {
				if (loadingElem.data('loadingCalledCount') > 0) {
					loadingElem.css('display', 'inline').animate({ height: '45px' }, 100);
				}
			}, optTimeBeforeAnimation);
		}

		function pageFinishedLoading() {
			var loadingElem = $("#pageLoading");
			var callCount = loadingElem.data('loadingCalledCount');
			callCount--;
			loadingElem.data('loadingCalledCount', callCount);
			if (callCount == 0) {
				loadingElem.removeData('loadingCalled');
				if (loadingElem.css('display') != 'none') {
					loadingElem.animate({ height: '0px' }, 100, function () { $(this).css('display', 'none') });
				}
			}
		}

		function isPageLoading() {
			var loadingElem = $("#pageLoading");
			var loadingCalledCount = loadingElem.data('loadingCalledCount');
			if (loadingCalledCount == undefined || loadingCalledCount == 0) {
				return false;
			} else {
				return true;
			}
		}

		function followLMLog(prefix) {
			// We're in LM_logs when we download a log, so no inner directory needed
			var ui = "<a download style='font-size: 12px' href='https://" + window.location.hostname + ":9000/getLog/" + window.location.hostname
					+ "/" + encodeURIComponent("ls -1tr " + prefix + "*.log* | tail -n 1\n") + "'>Download Log</a>";

			// The * at the end of the pattern Prefix*.log* is for .1, .2, ... when the log file is too big
			// Assume we're in the home directory of the user (can't use ~ because of windows)
			var command = "tail -n1000 -f `ls -1tr LM_logs/" + prefix + "*.log* | tail -n 1`\n";

			// Show terminal dialog
			showTerminalDialog(window.location.hostname, prefix + " Log", command, ui);
		}

		function isMobile() {
			return false;
		}

		function getLMComponentInfo() {
			return {
				"component": "Flashmob",
				"version": "LM Common"
			};
		}
	</script>




<div tabindex="-1" role="dialog" class="ui-dialog ui-corner-all ui-widget ui-widget-content ui-front ui-dialog-buttons ui-draggable ui-resizable" aria-describedby="deleteTestsConfirmDialog" aria-labelledby="ui-id-1" style="display: none; position: absolute;"><div class="ui-dialog-titlebar ui-corner-all ui-widget-header ui-helper-clearfix ui-draggable-handle"><span id="ui-id-1" class="ui-dialog-title">Delete Tests</span><button type="button" class="ui-button ui-corner-all ui-widget ui-button-icon-only ui-dialog-titlebar-close" title="Close"><span class="ui-button-icon ui-icon ui-icon-closethick"></span><span class="ui-button-icon-space"> </span>Close</button></div><div id="deleteTestsConfirmDialog" class="ui-dialog-content ui-widget-content">

		<input type="hidden" id="hdnSelectedTestIdsAsJson">
	
		<table>
			<tbody>
				<tr>
					<td>
						<label id="lblMessage"></label>
					</td>
				</tr>

				<tr>
					<td align="center">
						<img id="deleteTestsLoader" src="/assets/images/loader-spinner.gif" class="inactive">
					</td>
				</tr>
				
				<tr>
					<td>
						<font color="red"><label id="lblErrorMessage"></label></font>
					</td>
				</tr>
			
			</tbody>
		</table>

	</div><div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"><div class="ui-dialog-buttonset"><button type="button" id="btnConfirmDeleteTests" class="ui-button ui-corner-all ui-widget">Confirm</button><button type="button" class="ui-button ui-corner-all ui-widget">Cancel</button></div></div><div class="ui-resizable-handle ui-resizable-n" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-e" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-s" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-w" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-sw" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-ne" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-nw" style="z-index: 90;"></div></div><div role="log" aria-live="assertive" aria-relevant="additions" class="ui-helper-hidden-accessible"></div><div role="log" aria-live="assertive" aria-relevant="additions" class="ui-helper-hidden-accessible"></div><div role="log" aria-live="assertive" aria-relevant="additions" class="ui-helper-hidden-accessible"></div><div tabindex="-1" role="dialog" class="ui-dialog ui-corner-all ui-widget ui-widget-content ui-front ui-dialog-buttons ui-draggable ui-resizable" aria-describedby="confirmDialogDiv" aria-labelledby="ui-id-2" style="position: absolute; height: auto; width: 800px; top: 160.5px; left: 173.5px; z-index: 101; display: none;"><div class="ui-dialog-titlebar ui-corner-all ui-widget-header ui-helper-clearfix ui-draggable-handle"><span id="ui-id-2" class="ui-dialog-title">Edit Test</span><button type="button" class="ui-button ui-corner-all ui-widget ui-button-icon-only ui-dialog-titlebar-close" title="Close"><span class="ui-button-icon ui-icon ui-icon-closethick"></span><span class="ui-button-icon-space"> </span>undefined</button></div><div id="confirmDialogDiv" class="ui-dialog-content ui-widget-content" style="width: auto; min-height: 0px; max-height: none; height: 594.03125px;"><table style="overflow: scroll;"><tr><td><table id="editTestTable" style="width: 775px;"><tbody><tr style="width: 100%;"><td style="white-space: nowrap; vertical-align: top; padding-bottom: 10px;">Category:</td><td style="width: 100%; padding-bottom: 10px;"><input id="txtCategory" value="Regression Tests" style="width: 99%;" class="ui-autocomplete-input" autocomplete="off"></td></tr><tr style="width: 100%;"><td style="white-space: nowrap; vertical-align: top; padding-bottom: 10px;">Test Name:</td><td style="width: 100%; padding-bottom: 10px;"><input type="text" id="txtTestName" value="Test" style="width: 99%;"></td></tr><tr style="width: 100%;"><td style="white-space: nowrap; vertical-align: top; padding-bottom: 10px;">Priority:</td><td style="width: 100%; padding-bottom: 10px;"><span class="ui-spinner ui-corner-all ui-widget ui-widget-content"><input type="text" id="txtPriority" value="0" style="width: 50px;" aria-valuemin="0" aria-valuemax="9" aria-valuenow="0" autocomplete="off" class="ui-spinner-input" role="spinbutton"><a tabindex="-1" aria-hidden="true" class="ui-button ui-widget ui-spinner-button ui-spinner-up ui-corner-tr ui-button-icon-only" role="button"><span class="ui-button-icon ui-icon ui-icon-triangle-1-n"></span><span class="ui-button-icon-space"> </span></a><a tabindex="-1" aria-hidden="true" class="ui-button ui-widget ui-spinner-button ui-spinner-down ui-corner-br ui-button-icon-only" role="button"><span class="ui-button-icon ui-icon ui-icon-triangle-1-s"></span><span class="ui-button-icon-space"> </span></a></span></td></tr><tr style="width: 100%;"><td style="white-space: nowrap; vertical-align: top; padding-bottom: 10px;">Repeat:</td><td style="width: 100%; padding-bottom: 10px;"><span class="ui-spinner ui-corner-all ui-widget ui-widget-content"><input type="text" id="txtRepeat" value="1" style="width: 50px;" aria-valuemin="1" aria-valuemax="10" aria-valuenow="1" autocomplete="off" class="ui-spinner-input" role="spinbutton"><a tabindex="-1" aria-hidden="true" class="ui-button ui-widget ui-spinner-button ui-spinner-up ui-corner-tr ui-button-icon-only" role="button"><span class="ui-button-icon ui-icon ui-icon-triangle-1-n"></span><span class="ui-button-icon-space"> </span></a><a tabindex="-1" aria-hidden="true" class="ui-button ui-widget ui-spinner-button ui-spinner-down ui-corner-br ui-button-icon-only" role="button"><span class="ui-button-icon ui-icon ui-icon-triangle-1-s"></span><span class="ui-button-icon-space"> </span></a></span></td></tr><tr style="width: 100%;"><td style="white-space: nowrap; vertical-align: top; padding-bottom: 10px;">Virtual Combination:</td><td class="small-selectize" style="width: 100%; padding-bottom: 10px;"><select id="slctVirtualCombination" style="width: 100%; display: none;" tabindex="-1" class="selectized"><option value="1" selected="selected">Any</option></select><div class="selectize-control single" style="width: 100%;"><div class="selectize-input items full has-options has-items"><div data-value="1" class="item">Any</div><input type="text" autocomplete="off" tabindex="" style="width: 4px;"></div><div class="selectize-dropdown single" style="display: none;"><div class="selectize-dropdown-content"></div></div></div></td></tr><tr style="width: 100%;"><td style="white-space: nowrap; vertical-align: top; padding-bottom: 10px;">ScriptPath:</td><td style="width: 100%; padding-bottom: 10px;"><textarea data-attribute="ScriptPath" style="width: 99%; overflow: hidden; resize: horizontal; word-wrap: break-word; height: auto;" data-autosize-on="true">/Auto/TestRunner/test_automation3.py</textarea></td></tr></tbody></table></td></tr></table></div><div class="ui-resizable-handle ui-resizable-n" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-e" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-s" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-w" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-sw" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-ne" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-nw" style="z-index: 90;"></div><div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"><div class="ui-dialog-buttonset"><button type="button" id="confirm_OK" tabindex="-1" class="ui-button ui-corner-all ui-widget">OK</button><button type="button" id="confirm_Cancel" tabindex="1" class="ui-button ui-corner-all ui-widget">Cancel</button></div></div><ul id="ui-id-6" tabindex="0" class="ui-menu ui-widget ui-widget-content ui-autocomplete ui-front" style="display: none;"></ul></div><div role="status" aria-live="assertive" aria-relevant="additions" class="ui-helper-hidden-accessible"></div></body></html>Ytext/htmlUUTF-8_Jhttps://hdc-lm-dsi.euro.apple.com:9000/ui/displayScenariosSetupsManagementROKØ#'+/48<@DHLPUZ_d’_WebResourceResponseOÀbplist00‘klX$versionX$objectsY$archiverT$top Ü†Ø #)*0123MNOPQRSTUVWXYZ[\]^_`aefU$null›	
 !"R$6S$10R$2R$7R$3S$11R$8V$classR$4R$9R$0R$5R$1Ä	ÄÄÄ ÄÄÄÄ”$%'(WNS.base[NS.relativeÄ ÄÄ_Vhttps://hdc-lm-dsi.euro.apple.com:9000/assets/stylesheets/generated_default_styles.css“+,-.Z$classnameX$classesUNSURL¢-/XNSObject#Aø±Æbãñ) »”456ALWNS.keysZNS.objects™789:;<=>?@Ä	Ä
ÄÄÄÄÄÄÄÄ™BCDEFGHIJKÄÄÄÄÄÄÄÄÄÄÄTVary\Content-TypeTEtag]Last-Modified_Strict-Transport-Security]Accept-RangesTDate_Content-Encoding]Cache-Control_Transfer-Encoding_Accept-Encoding_text/css; charset=UTF-8_*"61ad785031e9978a6d6a6ce1b96d94e401be889b"_Mon, 06 Nov 2017 07:24:04 GMT_max-age=2592000Ubytes_Tue, 07 Nov 2017 08:44:38 GMTTgzip_public, max-age=3600XIdentity“+,bc_NSMutableDictionary£bd/\NSDictionaryXtext/css“+,gh_NSHTTPURLResponse£ij/_NSHTTPURLResponse]NSURLResponse_NSKeyedArchiver—mn_WebResourceResponseÄ    # - 2 7 Z ` { ~ Ç Ö à ã è í ô ú ü ¢ • ® ™ ¨ Æ ∞ ≤ ≥ µ ∑ π ª Ω ø ¡ » – ‹ ﬁ ‡ ‚;@KTZ]foqszÇçòöúû†¢§¶®™¨∑πªΩø¡√≈«…ÀÕ“ﬂ‰Ú!4BVhÇØœ·Á#,1GKXafz~í†≤µÀ             o              ÕO ¿¬
/** stylesheets/main.css **/
body
{
	background: #f5f5f5;
	font-family: Lucida Sans Unicode, Lucida Grande, Sans-Serif;
	margin: 0px;
	overflow: visible;
	width: 100%;
	-webkit-font-smoothing: subpixel-antialiased;
}

div.header h1.header
{
	font-size: 200%;
	vertical-align: middle;
	color: #404040;
	margin: 0px;
}

div.menu
{
	width: 100%;
	text-align: center;
	position: fixed;
	top: 0px;
	left: 0px;
}
div.menu,
div.menu li,
div.menu ul {
	z-index: 200;
}

h2, h3, h4, h5
{
	color: #2966B8;
}

div.content
{
	font-size: 12px;
	width: 100%;
	overflow: visible;
	color: #404040;
	margin-top: 32px;
}

div.DocumentationLinks
{
	height: 100%;
	width: 15%;
	float: left;
	padding: 1%;
	overflow-x: hidden;
	overflow-y: auto;
	border-right: 1px solid #C0C0C0;
}

div.DocumentationLinks ul
{ 
	margin-left: 0px; 
}

div.DocumentationLinks a
{
	color: #000000;
	font-size: 75%;
	font-weight: bold;
	text-decoration: none;
}

div.DocumentationLinksCollapsed
{
	width: 3% !important;
}

div.DocumentationContent
{
	height: 100%;
	width: 80%;
	float: left;
	padding: 1%;
	overflow: auto;
}

div.DocumentationContentExpanded
{
	width: 92% !important;
}

div.LabStatusReport
{
	width: 15%;
	display: inline-block;
	margin-bottom: 20px;
}

.inactive
{
	display: none;
}

a.InnerLink
{
	color: #FFFFFF;
	background: #808080;
	padding: 5px;
	text-decoration: none;
}

table.InnerLinks
{
	border-collapse: separate;
	border-spacing: 3px;	
}

table.InnerLinks td
{
	background: #808080;
	padding: 5px;
	text-align: center;
}

table.InnerLinks td a
{
	color: #FFFFFF;
	text-decoration: none;
}

a.InnerLink:hover, table.InnerLinks td:hover
{
	background: #404040;
}

div.TestCoverageReport td.active
{
	background: #808080;
}

div.TestCoverageReport td.active a
{
	color: #FFFFFF;
}

.TextAlignLeft
{
	text-align:left;
}

.FontWeightBold
{
	font-weight: bold;
}

th.TableCornerCell
{
	font-weight: normal;
	color: #FFFFFF !important;
	background-color: #A0A0A0;	
}

.IncludeInExecution
{
	background-color: #CEDEF4;
}

.RunStatusRunningWorkflow
{
	color: #FFFFFF !important;
	background-color: #964B00;
}

.RunStatusUnknown
{
	color: #000000 !important;
	background-color: lightgray;
}

.HostStatusAvailable, .HostStatusAssigned, .TestStatusInQueue, .TestStatusIncluded, .TestStatusMatched, .DriveStatusIdle, .WorkflowStatusIDLE, .HostStatusIdle
{
	color: #FFFFFF !important;
	background-color: #00B7EB;
}

.HostStatusRunning, .HostStatusActive, .TestStatusPass, .TestStatusPassed, .FWUpdateStatusFinished, .DriveStatusRun, .NVMeAgentStatusActive, .NVMeAgentStatusHostInBoot, .WorkflowStatusSUCCESS, .checkTPPassed, .HostStatusFree, .RunStatusRunningTest
{
	color: #FFFFFF !important;
	background-color: #228B22;
}

.HostStatusStuck, .TestStatusStuck, .TestStatusWarning, .DriveStatusStuck, .DriveStatusRunTooLong, .NVMeAgentStatusLockedByLabManager, .NVMeAgentStatusLockedByUser, .WorkflowStatusWARNING, .checkTPWarning, .RunStatusStuck, .WorkflowStatusABORTING, .TestStatusRadaredFail
{
	color: #FFFFFF !important;
	background-color: #FF7F00;
}

.HostStatusInactiveHost {
	color: #FFFFFF !important;
	background-color: #CC020A;
}

.HostStatusInactiveHostLongTime {
	color: #FFFFFF !important;
	background: repeating-linear-gradient(-45deg, #CC020A 2px, #CC020A 10px, #990208 0px, #990208 18px);
}

.HostStatusInactiveAgent, .TestStatusFailed, .TestStatusAssert, .FWUpdateStatusFailed, .DriveStatusAssert, .DriveStatusPanic, .DriveStatusError, .NVMeAgentStatusInactiveAgent, .NVMeAgentStatusInactiveHost, .WorkflowStatusFAILED, .checkTPError
{
	color: #FFFFFF !important;
	background-color: #ED1C24;
}

.HostStatusLockedByLabManager, .HostStatusLockedByLM, .HostStatusLockedByUser, .HostStatusLockedByWorkflow, .TestStatusAbort, .TestStatusAborted, .WorkflowStatusABORTED, .TestStatusNotTested
{
	color: #FFFFFF !important;
	background-color: #FFD300;
}

.TestStatusInProgress, .WorkflowStatusINPROGRESS, .HostStatusInUse
{
	color: #FFFFFF !important;
	background-color: #7851A9;
}

.TestStatusCompleted
{
	color: #FFFFFF !important;
	background-color: #2D5DA1; 
}

.DriveStatusNotInLab, .WorkflowStatusSKIPPED, .TestStatusDiscarded, .WorkflowStatusDISCARDED
{
	color: #FFFFFF !important;
	background-color: #A0A0A0;	
}

.SSHCommandPassed, .statusSuccess
{
	color: #04B404 !important;
}

.SSHCommandFailed, .LMSMismatch, .NoMatchingAgents, .statusFail
{
	color: #FE2E2E !important;
}

.SSHCommandInProgress
{
	color: #7851A9 !important;
}

.AlternateRow
{
	background-color: #F0F0F0;
}

.custom-combobox {
    position: relative;
    display: inline-block;
    margin-right: 30px;
}
.custom-combobox-toggle {
    position: absolute;
    top: 0;
    bottom: 0;
    margin-left: -1px;
    padding: 0;
}
  
.actionbtn {
    min-height: 60px;
}
.actionbtn .ui-button-text {
	padding-top: 18px !important;
	padding-bottom: 18px !important;
}

.separatedata {
    height: 2px;
    color: #000000;
    background: #000000;
    font-size: 0;
    border: 0;
}

.divider {
    padding-left:10px;
    display:inline-block;
}

.DifferentFromDefault
{
	background: #00B7EB;
	color: #FFFFFF !important;
}

.StepRepositoryDifferentFromDefault, .TestManagementDifferentFromDefault, .DocumentContentsDifferentFromDefault {
	background: #DCF3FA;
	color: #000000 !important;
}

.VirtualLabNotBelongToServer, .StopBatch, .IllegalVirtualCombination
{
	background: #ED1C24;
}

div.ui-tooltip {
    max-width: 500px;
    font-size:8pt;
}

.selectable .ui-selecting { background: #b3d4fc; }
.selectable .ui-selected { background: #0070a3; color: white; }
.selectable { list-style-type: none; margin: 0; padding: 0;}
.selectable li { margin: 3px; padding: 0.4em; font-size: 1.0em; height: 15px; width:450px;}

.DialogSmallFont { font-size :12px }

.checkbox, .radio {
    width: 19px;
    height: 20px;
    padding: 0px;
    background: url("http://i48.tinypic.com/raz13m.jpg");
    display: block;
    clear: left;
    float: left;
 }
 
.text-centered {
	text-align: center;	
	vertical-align: middle;
}

a.urlLogLink:link {
    color: #FFFFFF;
}
a.urlLogLink:visited {
    color: #FFFFFF;
}

.inactive-force {
	display: none !important;
}

.no-close .ui-dialog-titlebar-close {
  display: none;
}

/* Useful when we already have inactive used from one source, and another one decides on different reason to set inactive, like multiple filters */
.inactive-secondary {
	display: none;
}

.StickyHeader {
	/*
		The top value is after the menu and header
	*/
	/* StickyHeaderTopMarker*/ top: 32px;

	position: sticky;
	position: -webkit-sticky;
	background-color: #ffffff;
	z-index: 40;
}

.LMVerticalPaddedSection {
	padding-top: 10px;
	padding-bottom: 10px;
}

.LMBottomPaddedSection {
	padding-bottom: 10px;
}

.LMPaddedSection {
	padding: 10px;
}

.LMInsetSection {
	margin: 10px;
}

.LMVerticalInsetSection {
	margin-top: 10px;
	margin-bottom: 10px;
}

.LMTopInsetSection {
	margin-top: 10px;
}

.LMBottomInsetSection {
	margin-bottom: 10px;
}

.LMBigTopInsetSection {
	margin-top: 20px;
}

.LMBigBottomInsetSection {
	margin-bottom: 20px;
}

.LMInnerInsetSection {
	margin-top: 10px;
	margin-bottom: 10px;
}
.LMInnerInsetSection:first-of-type {
	margin-top: 0px;
}
.LMInnerInsetSection:last-of-type {
	margin-bottom: 0px;
}

.LMInnerBigInsetSection {
	margin-top: 20px;
	margin-bottom: 20px;
}
.LMInnerBigInsetSection:first-of-type {
	margin-top: 10px;
}
.LMInnerBigInsetSection:last-of-type {
	margin-bottom: 10px;
}

.LMContentSection {
	background-color: white;
}

.LMBorderedSection {
	border: 1px solid #ccc;
}

/*
	Enable overflow scrolling
*/
.LMOverflowContainer {
	overflow: scroll;
}
.LMHorizontalOverflowContainer {
	overflow-x: scroll;
	overflow-y: visible;
}

/*
	This will stretch your container to fill 100% of width/height.
	If this is used together with LMOverflowContainer, the overflow will be inside the container,
	and the container will be limited to the viewport's height (using javascript).
*/
.LMContainerStretch {
	width: calc(100% - 1px);
	height: 100%;
}

/*
	A sticky header in a container should have a top relative to the container's start, and not the page start.
*/
.LMOverflowContainer .StickyHeader {
	top: 0px;
}

.LMSectionHeader {
	background-color: #9fb8c1;
	color: #ffffff;
	padding-left: 10px;
	padding-right: 10px;
}

.LMSectionSubHeader {
	background-color: #ddd;
	color: #000000;
	padding-left: 10px;
	padding-right: 10px;
}

.LMSectionHeaderClickable {
	cursor: pointer;
	-webkit-user-select: none;
	user-select: none;
}

.LMSectionHeaderClickable:hover {
	cursor: pointer;
}

.LMSectionHeader.LMSectionHeaderClickable:hover {
	background-color: #aec2c9;
}

.LMSectionSubHeader.LMSectionHeaderClickable:hover {
	background-color: #e0e0e0;
}

/*
	Disable jQuery UI focus glow.
*/
*:focus {
    outline: none;
    -moz-box-shadow: none;
    -webkit-box-shadow: none;
    box-shadow: none;
}

/*
	Main button will be with a special style.
*/
.LMMainButton {
	color: #fff !important;
	background-color: #007aff !important;
	border-color: #006ee6 !important;
}
.LMMainButton:hover,
.LMMainButton:hover .ui-button-text {
	background-color: #0062cc !important;
	border-color: #0051a8 !important;
}
.LMMainButton .ui-icon {
	background-image: url("/assets/stylesheets/images/ui-icons_ffffff_256x240.png") !important;
}

.LMDarkButton {
	border: 1px solid #ffffff;
	background-image: linear-gradient(to bottom, #888888, #888888) !important;
	text-shadow: 0 1px 0 rgba(0, 0, 0, 0.3) !important;
	color: white !important;
}
.LMDarkButton:hover,
.LMDarkButton:hover .ui-button-text {
	background-image: linear-gradient(to bottom, #4796e6, #3873af) !important;
}
.LMDarkButton .ui-icon {
	background-image: url("/assets/stylesheets/images/ui-icons_ffffff_256x240.png") !important;
}
.LMDarkButton.ui-checkboxradio-checked {
	background-image: linear-gradient(to bottom, #555555, #555555) !important;
}

.LMTableNoHoverEffect tr:hover {
	background-color: inherit !important;
}

.LMTableNoBorders,
.LMTableNoBorders tr,
.LMTableNoBorders th,
.LMTableNoBorders td {
	border: 0px !important;
}

.LMTableRowHighlighted,
.LMTableRowHighlighted td {
	background-color: rgb(192, 218, 228);
	color: #555555 !important;
}

.problematic-row {
	background-color: red;
	color: white !important;
}

/** Host Management related cell styles **/

.cell-light-right-border {
	border-right: 1px solid #CCCCCC;
}

.cell-white-no-hover {
	background: #ffffff !important;
}

.cell-gray-hover {
	background: #f5f5f5 !important;
}

/*
	Minimize button for dialogs.
*/
.ui-dialog .ui-dialog-titlebar-minimize {
	position: absolute;
	right: .3em;
	top: 50%;
	width: 20px;
	margin: -10px 24px 0 0;
	padding: 1px;
	height: 20px;
	background: #eee !important;
	border: 0px !important;
}

.ui-dialog .ui-dialog-titlebar-minimize:hover {
	opacity: 0.5;
}

/** Smaller and more professional dialogs **/

.ui-dialog-buttonpane {
	padding: 0em 0em 0em .4em !important;
	background-color: white !important;
	border: 0px !important;
}

.ui-dialog-buttonpane button {
	margin: .4em .4em .4em .2em !important;
}

.ui-dialog-buttonpane {
	border: 0px !important;
	border-top: 1px #e5e5e5 solid !important;
	border-radius: 0px !important;
}

.ui-dialog-buttonset .ui-button-text {
	padding: .2em 1em;
}

.ui-dialog-titlebar {
	padding: .15em .5em !important;
	line-height: 1.5em;
	font-size: 16px !important;
	border: 0px !important;
	border-bottom: 1px #e5e5e5 solid !important;
	border-radius: 0px !important;
}

.ui-dialog {
	padding: 0px !important;
	background-color: white !important;
	box-shadow: 0 5px 15px rgba(0, 0, 0, .5);
	border: 1px solid rgba(0, 0, 0, .2);
	border-radius: 6px !important;
	background-clip: padding-box;
	outline: 0;
}

.ui-dialog-titlebar,
.ui-dialog-buttonpane {
	background: transparent !important;
}

.ui-dialog * {
	font-size: 16px !important;
}

.ui-dialog-content {
	padding: .5em .5em !important;
}

.ui-dialog .ui-dialog-titlebar-close {
	background: #eee !important;
	border: 0px !important;
}

.ui-dialog .ui-dialog-titlebar-close:hover {
	opacity: 0.5;
}


.radar-icon {
	width: 24px;
	height: 24px;
	background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KTMInWQAABqNJREFUGBnVwXlYDggCx/FvvYbQ43ixlnKmi6TU5hjnGPGMxv3GOPIUWufkmlEKRRemKUm5p7eJNWrQmsd0uHO182jyhJ4Y5nEtmTHYZ9fK0W/fZ3nWM48Z1c7jj/l8+D1rN2HCxAKgA68a4+Lis4E3bLAsYmPX3gXsealVack9xceaHwCugBVvyChZPKmsUvD0+eeAelhMmbK4sPJRlZyd+5cDvoCBN8RdL3xXfl/GJi0TgfdPFlZqR2aFgDygF7XQGLChFmJiVv9NFpWPqjRl4ryrHl1Hns7IeKCAgL0CUgEHasiqZ8+enwPOgIGa67pz+5c3b1y7r+Sk3c/69v3on1Onfatmzcc9BkKBptRQr6iolaWAO9CQ2onPzyvSp5/8Rd7ei+XuuV3AWWAyUJ+amDv3wwyTyXQI8ALqUXMG6n1wLywsW6kpORo/PkE2DfweAmmADzVkuH377jNgPeBG7Qx3cE7QyugCnS2+rpi4w3L3CKkEIqmFobIAlgNteFU7A/XHGo2d5huNDguh3ry2bb3NzZp5fNbEOOyKvUOCAqdm6eqVOzp/7q4mBx4W1n63AUdqwjTCFCULYCHQmP9p5DjBtLTg88/OKi25TAlrzigiLF+hodu1b9/3mjMnV55/+kR2HVZpyLAtOnLksr7KKVDXrlPk0nWrwHYHYE11Ylas2S0LIBR4i+daBAdu+9e+Pf9Wbs5PysmukHnTZSWsOaOCA9eUnX1RAQG71d0rVZ2cE+XVK0WZGWe1JytXnV17a8CgrYKBPwDeVGfTpswTsgBW84JNXZflKck3lJZcJvPmSzJvvqy1n57TxrRzOl30dyUmfiPfoely67ZO3Tw2qmWrWM2as0eVj6r03cWf9GHIQRlb/FmAP9VZu3bLMVn07zM4nxd691p0ITrqgmJXnlFSQqmSEkoVtaxIGeYynTpxU7Pn7Fe37uvk7bNFzq4xcvdYKXC4GRQUcVcWhw7dku/QdAFrqM6KyIQDsigvuyPAD4tRI8wKmXNUixYcU3hooZYsLtTM4FylrDuprF3l6ts/Ra5d4uTllaSxY9MUEnJM0OMKsNg0JrhUFl9k/aC6NsNuAe14Hd93Rybrhb1ZByugQZrv4G1PJ036StOC9it4ep5mTC/QuLHpio/bqw0bLsjNPVrtOi5VZ7f5WrLkuOaGHFUT47QnwHuAo2nU9POyWBx6WkAC1Rh+9cpTXb70RD9WPNPmTSfUr99mDRu2U6NHZ8vff48WLTqs9PTzCl+6S/Gr8hQeXqDW9kGC1ho5eoPCws6ok+NCAcE85zR7RsSdJ5VV8vRaIMCb1/lg/EelJcWPlZ97S2tWFciz+zq9/Xa6BgxIl2lsttLSzup44W1t3HhWkwPMmj8/U/u/vqoRIxLVuKmfIiOPa8jQzQIieKnfli05Kil5LOhwhGqMS0os0pfZ9xQXVyhn55Vy99gob59NCpiSo127Lio//6YyM8sUFXlK77yTpKCpqfqm6IHGjIlXcPB6hYWeErAPeA/owHMRhw6WK+TjQwKiqcaK4OCdiosrUzfPVWrbMVGd3VJk8s9WRuYF5eXd0PYd5YqOPqHx47+Qo1OEFixKV0ZmsdzcZyk1tUS+vvHy8Vml1vaLBZj4L4M5Yc1+Bc85IWhhBurwKwzAjMaN+5S16zBTf7SLVyenZI0cnaX160uUm39DZvN5xcScVmBgjly7xAnsK5r9wf0q8H1ISNqTlJQS2TYaIWj/I7AAqINFD6u3Ctq38LgBza8D/QEDv8Ia8ATCoPdtB0ezevZOUWTkMRUVPdCOHeVKTv5Wc+ceVb0Gox4CW4FZwMQ+fQKv37nzTMOHL7kPfA0E8NJAO9gJjAK8gbpUwwAMAKdiG9tZcnIJ1bx55qqCgmvavfuqZs7OqgJygUmALc/5+fj4X7py5amSkkpl32aGgB684A6RNhBELTkB4UB6q1aDruXmPtCpU/9QbGyegI1AI36ub5cu/td9fUMFNpeBQKARzxnbQCzQF7CihqyAloCLtXV7c9SKYmVnV+jkyUoNHDj7EuDOq/oD0cByYCjQkJfaAiZeqkMt2ALLWtsNuRkWXqy/7nuoj0P3CIOHGRjAS/UBR8ABsOXnXN6Fy01hdUdYBXhRSw0BX2Cns+u0J/kHHmnd+otycl4mYBiv1wToAvQEFgLbADv+T7ZAuLH5+5V2bUwCVwFLASO/zApoB9gDnsAgwBcw8hv5AUuAUMAPaMQvswKsAQNgAxiB+oCB38gGaAG0BBrye/Qfn69lSjkErBgAAAAASUVORK5CYII=');
	background-size: 24px 24px;
}

.vnc-icon {
	width: 16px;
	height: 16px;
	display: inline-block;
	background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAACXBIWXMAABYlAAAWJQFJUiTwAAABy2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgICAgICAgICAgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIj4KICAgICAgICAgPHRpZmY6T3JpZW50YXRpb24+MTwvdGlmZjpPcmllbnRhdGlvbj4KICAgICAgICAgPHhtcDpDcmVhdG9yVG9vbD5BZG9iZSBJbWFnZVJlYWR5PC94bXA6Q3JlYXRvclRvb2w+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgqyI37xAAADM0lEQVQ4EV2TTWwTRxTH38x++SN2YhyTqAEao6AgrKpS4cAFya04Va16CoceGqVFcKt64oBUKZwqceECAokD91x66KktalMJqbRFkAOJCgHiyHYc29vd7NfszuzsTmctFbl50hvt7PvPb57+M6OADCEE2mo0lEsy5RS3Wi2c/c5qh2NpaUm5tLmJ1m/cGNXRYcH4/Nmv9tTj33481mm16zYfnp1cnO5/9+21u+OaEeDh4zczz396NN/baZ9yuHOaqP4iybMFOhEfVypqtTxXhliPwfg9cT69+PFHXcsSXy8vP8tAaPXmrctPXz65789RqNSrgIsaYF2AjhHgOIECNwSOcOKbXDjPY/DTMpSRx5evflH/7Pz5vupu2Wi/4cJ7F88y5UmE3Ve+YEER+dEUSnMVzEsVSCfKqjo7JZhOkT6xsNn75d7JP9d/OCUb6KtlNLk5QQxQ9qi6dXsXF775CpRyDYxCTqYGCCFIkwRYkoII/wHEE43mp7HZ+WtRAh6ptXcq7Xg/Cn0R5isf5IU6VZQ764ARA/+AZkcEjKeAVAViRUDshzlaqDKr0zuTeYCbn6/0xR7bDxiTYldQywFFAwijBCKagEc4UCp3l4tD6QsJw3xsVIjrkqwDwI0GYqqZ7g5MF7hGUnpgS2sFuG4MjkzX56BIU0PGwYsAgiAq+GqNeIE+PwJkgx7CttVzIRIhRI4JthPDwEnADgRoBoZY3rQDLwU31oXjUaNnYubGlZnr1y/PqBlASdCLcOADNyAhvYE6nOXigAAqKLL9gIMzTJAfYAhtBrhtqgVtjpJ02mhtf//uCKAWtVfm6z04Ui0ZpPMG3Nw+4hEGiiA2OWZporEoZIzYsi0hTyTt5h2PlWx39v0RoH5uYevc06CdWAF1SPsYaTmWm+aQQj0tF3tGPhoWS2F3sgZDYSArMKBLS0dn/jgx33zx9i2sra3pGxsb1Z8fru9YvqGVdGLpuDvQtc6uYcB2Lnf873xh9mX5yImdCxc+2VtZWZGWSr+zYTyuXPnyQ6v/mh+dq2/fufNgIC9SOl4f+8arq6v/A/wHO/yMlWazOarVajXRaDSEXJhpRrp/ARoNpS+DtZxPAAAAAElFTkSuQmCC');
	background-size: 16px 16px;
}

.terminal-icon {
	width: 16px;
	height: 14px;
	display: inline-block;
	background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAOCAYAAAAmL5yKAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KTMInWQAAATxJREFUKBVjYKAQMCPpZwKyGZH4RDPRNYEMBRlGFAC7oKGhgenPnz9G5ubmP69du/YNqPO/g4MDy4MHD/4RZQpIEVBzo66u7nFTU9MgojUBFYJcAPaClZXV+S9fvvz78eNHtpiYmJWWltZFoAs+wOSJNjQpKYnXxMSkV1NT876dnZ0TVCPOAIYFFjwgnz17Jvz7929pZmbm1ywsLCAX4AUgjSD838/PT/zRo0dFwMD0AGpcpaqqOnH16tVfgHIgS/4DMTJA5zMwmJmZderp6W10dnY2RVaJhw13NcP///8ZgdGmEBoayomkgUlFRYUdyJcBYnkgloPSIDYvEIMBwhSYCMTJIGf/AWJJJiamOCDNDcS/gJgViBmA4bMdGE4ngExGZANgIQ1KPDA/gqIZ5CpkdUAuw08gBhlIOQAAsXJQfxd1L1sAAAAASUVORK5CYII=');
	background-size: 16px 14px;
}

.status-green-icon {
	width: 10px;
	height: 10px;
	display: inline-block;
	background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAAB50RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNS4xqx9I6wAAABZ0RVh0Q3JlYXRpb24gVGltZQAxMS8yOC8xMaVolhIAAACGSURBVBiVjdDBCcJAFEXRE5lJGynBwKxjLXFjGyZluJGAnbiegJYwnbgwulLjhbf5XB6fV1lIpzSgR7OcCqZ8yANUkM7phq3P3PM+t1W6pAHHL9KLMYj6FQn6IL5/+kUTxD80BFFhtbVs1CY1K5me81xX5ulyu4F5N7eiUVRElhTRmLvcwgNEiB33B43RyQAAAABJRU5ErkJggg==');
	background-size: 10px 10px;
}

.status-red-icon {
	width: 10px;
	height: 10px;
	display: inline-block;
	background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAAB50RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNS4xqx9I6wAAABZ0RVh0Q3JlYXRpb24gVGltZQAxMS8yOC8xMaVolhIAAACDSURBVBiVjdCxDcIwEIXhz1GcNRgBLxBmgYY1SMagQZFomIMJYAM8iSkSJAoi80uvOf26p7tg4cyAPTbLKGM6ljJAgAsPbP3meSglheu86bQifRjDjddX3Rq5jXUJNm38w4I2ztdVq5uOqUMlU4B75T19KamBHSkyRnLEkhwZ+1ISvAFJaR4dshqbegAAAABJRU5ErkJggg==');
	background-size: 10px 10px;
}

.status-gray-icon {
	width: 10px;
	height: 10px;
	display: inline-block;
	background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsSAAALEgHS3X78AAAAB3RJTUUH4AYbDBAOdqhSLgAAAINJREFUGNON0LERgzAUg+FfOu/hEeJRTAmVN4nZhAaOjlWSEbxJGhcpEuC7U/NOjZ7o1nWtQAFiPzVgmaapAghg27YX8OC39ziOSfu+V+DJuTlIKlwrQVK8UYxBEncE2+1r6T/NkhZJXGQRwHEcp+/JOScDDMOQbM+2m216mu0555wAPo+VHP+uBpBNAAAAAElFTkSuQmCC');
	background-size: 10px 10px;
}

.sort-icon {
	vertical-align: middle;
	margin-bottom: 4px;
	margin-left: -5px;
	padding-right: 2px;
	width: 14px;
	height: 18px;
	display: inline-block;
	background-image: url('data:image/gif;base64,R0lGODlhDgASAKUAAP///25ra3Rxcfz8/NDPz3Jvb8C/v4yJifr6+u3s7HBtbfHx8f39/eXk5Kmnp8vKyqempvPz83t4eK2rq+Hg4HVzc4SCgpORkdXV1XFubnNwcO7u7piVlbi2tsLAwPv7+5WSkqKgoNva2o6MjH17e728vLe2tv///////////////////////////////////////////////////////////////////////////////////////////////////yH5BAEKAD8ALAAAAAAOABIAAAY+wJ9wSCwaj8jkcDRR/iABwSNpUAQCJMoRU7leL0dOQUDWCErOtDrt8Ho7R5A7hGxYrodEkpCRiJwmHmuDRUEAOw==');
	background-size: 14px 18px;
}

.unlock-icon {
	vertical-align: middle;
	width: 14px;
	height: 16px;
	display: inline-block;
	background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACLklEQVR4nKWRT2gTURDGv7e7QYWWYiQlpS1C6iEIIlSInnqKl6oYEQmeFRGhUi/aUz21WPEionjQcyLNRQlCNRfFIF3bUtvGYtRtaeq/bFPNH7PS3XnjIW0aY4qIc3lvPt785nszwH+GaCSGQqGdvb1HTnvbvN227SCztDSdSDyNxuPxlb8Sh4aGe4yFha9LmWU2Fhb53fsPPP82zeP6RLa//9Lh+vdqbRIOh71XBgaeM2PX1NTkxJOxsZuzM68fA9jR3t6x19fVdaxULI6mUqlvDbuPxmKDmeWPHIk+eBYMBps39EAg4IpEog/n3szztZGRG7U1Sm3S2dl5sGxZeKWP308kEsUNXdd1O5lM3tVUFR5P6yG/31+dnVYL0HV9sqmpmUzTnKt3Z5rZnGSGUJQmTdMUAPQH4GJf32DDvwEQQoEkAjmO0LTNsuoteu/yWU8L9oEtQFqontIC+Cc0Let1W7dwoHWx7dwJ1/kL07j9G8C/WxzfvwdHQQ5AFiDzsKwiBBWwXfsOUAFMSXg90lPq6Djl8/nuGIbBm16cHGCvAVQAZAGgPK7HusFUxNWTjwByACnApAKkAJB1Q6RVwC4BMl+BUB4trgyglgGbwFIFSIBJAW8JcHIA5QFZAJMFM1eGkGtgp9KVSQBSWXdQv0ZnFbA/g+UPgAggBWd6ZsBSgO11gBTroAaAyfS2l19Mt2DpBrjSiVkAUiD9SQAsKgAWMFaaZw3jBW+18n+KX71+Fh8akfd/AAAAAElFTkSuQmCC');
	background-size: 16px 16px;
	margin-bottom: 4px;
}

.home-icon {
	vertical-align: middle;
	width: 24px;
	max-width: 24px;
	height: 18px;
	max-height: 18px;
	display: inline-block;
	background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAD8ElEQVRIia2U3W8UVRiHnzOzs7uz293ultLWwiJFQBAkixENES+amhDBj14oFzQY0ESjiYn9I4g3RrgxamLSGkm4aBRuxIiS+pUoKIqaIIrQltRua+m2uzs7Ozsf53ixQO220gK+VzNn3t/7nPd33jNwC9F9cry7++R46lY02lITnx+c6Humo+HYlrQx+OSJsexSdWKxhF3HR1IrEuG+B1c2dJ/O+2xIhAgF/sypEevAx09ljt8RYOfA5dWbWmPHVqTN7JmrLp6srXckQrQa8P2Y1TuwO3P4tgCPHb2Y3ZZJDkbNcOrs3w4CqJYqhMwwuqHTGNHJNoX5JWf1jxWrvSf33DOzZMDTA3/uX9/a0FcMYLTkoaTEvWrxRBJOFyT5VBwjGsbQ4IHWGENT5XMjU5XOU3vXz4PMA+w8cuHQ1tVNr40Uq0xXfAIvwMhbvLLOZPPaKMWCzztnLC6EDSLJGACbWuNYtjvze67YOfjcxnMLAna8+3OqOWUeWtPeuH9o0saq+nhVj5W2wwv3J1izKnxD5FUkR38o8XlBYjTF0TSN1mSExqjO5VzxwIm99/bPAWx/68dUpi052JyOZ/8YKxJIhVuqcB+SVx9J05jW59kYuIqvzpd575KNno6hGyGSMYP2tMnQWOHwJz0begGEUorHPzhfbGlOJoZzBZRSuAWbXcsi9DzUiBH/76uiJFwaqXLw9BRO0sQww0QMjVVtSa78NfPNp/s2PqoBlMtu4tKVKTzHxR6f4cVMnH07UjctDiA0WNsR4c2uFjJWBTtfomK7XBzO4/vBDrh2k+1yFafsEJos8frDLXRtS6Abi97BG5FeHuLg7rvoNHVKEwWcskNxqjZQIQAZBO/bM+XhNzpX7+1YG1kn/rVxZxKcqQVgChpWKULx2qsRF7zU2Uziu+kvPpqwv9RDRgrqxlQpxYWzwyq2fJaQ/xV++2wCiU+pVCQWj4PUiJlxNj+bItY2W8LJK9Zn7xZCzK4t+rMLPInjVIg26njSwUzpaJGActFGycXtCy0OULhVn4rl4lU9KiUX1/HBFUip5pqwgJPzAKIuSQYKz/NwygrP9XFsF8/10T0dbquDOoAKoFDIM5qbRinJ9HQegPZla1Dq5puDBc5A1GUppdCEjq4bKKUQQkPXjZp0HmEJHVx0BVFL3Ei2qxBIn0B6BMoHKVBIZBAwWtUIVzRAIARIV7FuMUD/kMQK1wRCCLZchWjg4wceUgYASKUhZcCHOZ1JGap1LQQpV9FV78j1h+1v/3TE0LQeKeZ+NqsKYZWRKkChENckhh7GSZr4xtyZV4Ec96Tc8+3LW7+eA1D1ft5hXD9L8X8Xro9/AG95vVGiPYb2AAAAAElFTkSuQmCC');
	background-size: 24px 24px;
	padding: 0px !important;
	margin-top: -18px !important;
	margin-bottom: 0px !important;
	margin-right: 5px !important;
	margin-left: 5px !important;
}

.info-icon {
	vertical-align: middle;
	width: 16px;
	max-width: 16px;
	height: 16px;
	max-height: 16px;
	display: inline-block;
	background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAABIAAAASABGyWs+AAAACXZwQWcAAAAQAAAAEABcxq3DAAACwklEQVQ4y22TT2hcVRTGf+e+N5mapEkmJs2kqSWpZGyJQjRWUUEKuirdibRYFy1aN0WXBcWNutKFK3VTkaKLKugiigUFpYKC1JaWWtSkpKaRTmaS4CTpe2/en/vucTEjSf/c3eV853fOd7mfcJdz4e8bT/QNbNt/qR7vulqPZKnRnFusLX93+uW9P9+ulc2X46d/G39ysnKyWCg8vZo6QTdqmc2prgS/zi/Ujn12dOrKHYAjn158dM/4ju+LWwolEbmlqM6BMahCs5kG1/5ZOXDy4J6fAAzAgXe+6B+5rzydIqUgyQkSS5hYgsRSLuQcrnSyo+gIEosV6S4Plb46+OHZ7QA+wNjk46+nynYbW0TAbDJWGuyka0sBqxDGGU7Bqd47NDr2FnBM9r54wps6dLwmxgyYdrOItECqlDuF1AnLsaKqbQDgXDTz4/SA37dz9+6bcTZgRDBGWgCEsR6P/ZU+Joa3cm5hjVOXGxsApzjVzt6dDzzi5+KVgyjDMyBGMCJs6/Twjc/izZSJYagFGUEzRZUWxCnOQY5X9tMsT8MoaU03gogQNmFxLeGVx4ZQVX6YbRBEtwMUEpv660vV2bw8ocYYkbYNBJ6qlOgqFpipB/xVC1BVaK/fhmhevzFjLp96s55E8fkwjImimDCMicKEZyslAM5cWeLhwQ6iMGGzJo6aV8+9/9KsD9Bcb7zr/O4vpW2hq+jx4EgPAKO9HcxW1wnDBLQ1XZ3iYd8D8ABWfvn8z61Tz1eyzD2UZTnW5uwa7OLCfIOPz85z6foqNrVkaY5NLblNv127+M2J8Nr5ja/c/8yrHR3j+z5RzGERAbklJqBK6xHsdL74+wvLX78d3REmgO59rz3n9Y684fWPToKY/9vzxvW5+I8zH+Qrcx/Zfxeyu6ZxI6Piyz39w6anfD+o79aqVW2uVoEQyDZL/wN0KnGLRYYg1QAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxMC0wMi0xMFQxMjowMTo1OC0wNjowMBPHUbwAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMDktMDEtMDRUMTQ6Mjc6MDAtMDY6MDAp2xYhAAAAAElFTkSuQmCC');
	background-size: 16px 16px;
	padding: 0px !important;
	margin: 0px !important;
	margin-top: -2px !important;
}

input[type=button]:active,button:active 
{ 
	background-color: #00B7EB;
}

input[type=button].confirm 
{
	color: #FFFFFF;
	background: -moz-linear-gradient(
		top,
		#606060 0%,
		#202020);
	background: -webkit-gradient(
		linear, left top, left bottom, 
		from(#606060),
		to(#202020));
	-moz-border-radius: 3px;
	-webkit-border-radius: 3px;
	border-radius: 3px;
	border: 1px solid #000000;
}

input[type=button].close 
{
	color: #FFFFFF;
	background: -moz-linear-gradient(
		top,
		#606060 0%,
		#202020);
	background: -webkit-gradient(
		linear, left top, left bottom, 
		from(#606060),
		to(#202020));
	-moz-border-radius: 6px;
	-webkit-border-radius: 6px;
	border-radius: 6px;
	border: 1px solid #000000;
}

fieldset.notify
{
	/*font-size: 80%;*/
	padding: 5px;
}

p.NotificationSummary
{
	font-weight: bold;
}

span.UserMessageSuccess
{
	color: green;
}

span.UserMessageError
{
	color: red;
}

span.UserMessageInfo
{
	color: blue;
}

.custom-combobox  {
	position: relative;
	display: inline-block;
}

a.custom-combobox-toggle {
	position: absolute;
	top: 0;
	bottom: 0;
	margin-left: -1px;
	padding: 0;
}

.custom-combobox-input {
	margin: 0;
	padding: 0.3em;
}

button.ui-margin-combo-toggle {
	margin-left: +50px;
	margin-bottom: +5px;	
}

.highlight-button,
.highlight-button * {
	background-color: #FF6363 !important;
	color: white !important;
}

.highlight-toggled-button.ui-state-active,
.highlight-toggled-button.ui-state-active * {
	background-color: #4FB066 !important;
	color: white !important;
}

.highlight-toggled-button.ui-state-active,
.highlight-toggled-button.ui-state-active:hover {
	border: 1px solid #ccc !important;
}

.highlight-button-green,
.highlight-button-green * {
	background-color: #AAE3B8 !important;
	color: white !important;
}

.tableWithLargerPaddingBetweenColumns td:not(:first-child),
.tableWithLargerPaddingBetweenColumns th:not(:first-child) {
	padding-left: 10px !important;
}

.tableWithLargerPaddingBetweenColumns td:not(:last-child),
.tableWithLargerPaddingBetweenColumns th:not(:last-child) {
	padding-right: 10px !important;
}

/** Make multiple.select a bit wider **/

.ms-drop ul {
	padding-right: 14px !important;
}

.task-badge {
	background-color: #7DABBA;
	color: white;
	display: inline-block;
	padding-left: 8px;
	padding-right: 8px;
	text-align: center;
	border-radius: 50%;
	font-size: 13px;
	width: 22px;
	height: 22px;
	line-height: 1.8;
}

.highlight-section-green {
	background-color: #AAE3B8 !important;
	color: #000000 !important;
}

/** Properly support white icons when button is toggled in JQueryUI 1.12 **/

.white-icons {
	background-image: url("/assets/stylesheets/images/ui-icons_ffffff_256x240.png") !important;
}

/** JQueryUI 1.12 made button icons too far from left **/

.ui-button-icon {
	margin-left: -5px;
}

/** Make autocomplete rows shorter **/

.ui-autocomplete {
	line-height: 20px;
}

/** Default theme has an ugly accordion **/

.ui-accordion-header.ui-state-active {
	background: #dadada !important;
	color: #212121 !important;
	border: 1px solid #ccc !important;
}

.ui-accordion-header.ui-state-active .ui-accordion-header-icon {
	background-image: url("/assets/stylesheets/images/ui-icons_555555_256x240.png") !important;
}






/** ANSI codes **/

.ansi1 { font-weight: bold; }
.ansi2 { font-weight: lighter; }
.ansi3 { font-style: italic; }
.ansi4 { text-decoration: underline; }
.ansi5 { text-decoration: blink; }
.ansi6 { text-decoration: blink; }
.ansi8 { visibility: hidden; }
.ansi9 { text-decoration: line-through; }
.ansi30 { color: #000000; }
.inv30 { background-color: #000000; }
.ansi31 { color: #c23621; }
.inv31 { background-color: #c23621; }
.ansi32 { color: #25bc24; }
.inv32 { background-color: #25bc24; }
.ansi33 { color: #adad27; }
.inv33 { background-color: #adad27; }
.ansi34 { color: #492ee1; }
.inv34 { background-color: #492ee1; }
.ansi35 { color: #d338d3; }
.inv35 { background-color: #d338d3; }
.ansi36 { color: #33bbc8; }
.inv36 { background-color: #33bbc8; }
.ansi37 { color: #cbcccd; }
.inv37 { background-color: #cbcccd; }
.ansi40 { background-color: #000000; }
.inv40 { color: #000000; }
.ansi41 { background-color: #c23621; }
.inv41 { color: #c23621; }
.ansi42 { background-color: #25bc24; }
.inv42 { color: #25bc24; }
.ansi43 { background-color: #adad27; }
.inv43 { color: #adad27; }
.ansi44 { background-color: #492ee1; }
.inv44 { color: #492ee1; }
.ansi45 { background-color: #d338d3; }
.inv45 { color: #d338d3; }
.ansi46 { background-color: #33bbc8; }
.inv46 { color: #33bbc8; }
.ansi47 { background-color: #cbcccd; }
.inv47 { color: #cbcccd; }
.ansi38-0 { color: #000000; }
.inv38-0 { background-color: #000000; }
.ansi38-1 { color: #c23621; }
.inv38-1 { background-color: #c23621; }
.ansi38-2 { color: #25bc24; }
.inv38-2 { background-color: #25bc24; }
.ansi38-3 { color: #adad27; }
.inv38-3 { background-color: #adad27; }
.ansi38-4 { color: #492ee1; }
.inv38-4 { background-color: #492ee1; }
.ansi38-5 { color: #d338d3; }
.inv38-5 { background-color: #d338d3; }
.ansi38-6 { color: #33bbc8; }
.inv38-6 { background-color: #33bbc8; }
.ansi38-7 { color: #cbcccd; }
.inv38-7 { background-color: #cbcccd; }
.ansi38-8 { color: #000000; }
.inv38-8 { background-color: #000000; }
.ansi38-9 { color: #c23621; }
.inv38-9 { background-color: #c23621; }
.ansi38-10 { color: #25bc24; }
.inv38-10 { background-color: #25bc24; }
.ansi38-11 { color: #adad27; }
.inv38-11 { background-color: #adad27; }
.ansi38-12 { color: #492ee1; }
.inv38-12 { background-color: #492ee1; }
.ansi38-13 { color: #d338d3; }
.inv38-13 { background-color: #d338d3; }
.ansi38-14 { color: #33bbc8; }
.inv38-14 { background-color: #33bbc8; }
.ansi38-15 { color: #cbcccd; }
.inv38-15 { background-color: #cbcccd; }
.ansi48-0 { background-color: #000000; }
.inv48-0 { color: #000000; }
.ansi48-1 { background-color: #c23621; }
.inv48-1 { color: #c23621; }
.ansi48-2 { background-color: #25bc24; }
.inv48-2 { color: #25bc24; }
.ansi48-3 { background-color: #adad27; }
.inv48-3 { color: #adad27; }
.ansi48-4 { background-color: #492ee1; }
.inv48-4 { color: #492ee1; }
.ansi48-5 { background-color: #d338d3; }
.inv48-5 { color: #d338d3; }
.ansi48-6 { background-color: #33bbc8; }
.inv48-6 { color: #33bbc8; }
.ansi48-7 { background-color: #cbcccd; }
.inv48-7 { color: #cbcccd; }
.ansi48-8 { background-color: #000000; }
.inv48-8 { color: #000000; }
.ansi48-9 { background-color: #c23621; }
.inv48-9 { color: #c23621; }
.ansi48-10 { background-color: #25bc24; }
.inv48-10 { color: #25bc24; }
.ansi48-11 { background-color: #adad27; }
.inv48-11 { color: #adad27; }
.ansi48-12 { background-color: #492ee1; }
.inv48-12 { color: #492ee1; }
.ansi48-13 { background-color: #d338d3; }
.inv48-13 { color: #d338d3; }
.ansi48-14 { background-color: #33bbc8; }
.inv48-14 { color: #33bbc8; }
.ansi48-15 { background-color: #cbcccd; }
.inv48-15 { color: #cbcccd; }
.ansi38-16 { color: #000000; }
.inv38-16 { background: #000000; }
.ansi48-16 { background: #000000; }
.inv48-16 { color: #000000; }
.ansi38-17 { color: #00002a; }
.inv38-17 { background: #00002a; }
.ansi48-17 { background: #00002a; }
.inv48-17 { color: #00002a; }
.ansi38-18 { color: #000054; }
.inv38-18 { background: #000054; }
.ansi48-18 { background: #000054; }
.inv48-18 { color: #000054; }
.ansi38-19 { color: #00007e; }
.inv38-19 { background: #00007e; }
.ansi48-19 { background: #00007e; }
.inv48-19 { color: #00007e; }
.ansi38-20 { color: #0000a8; }
.inv38-20 { background: #0000a8; }
.ansi48-20 { background: #0000a8; }
.inv48-20 { color: #0000a8; }
.ansi38-21 { color: #0000d2; }
.inv38-21 { background: #0000d2; }
.ansi48-21 { background: #0000d2; }
.inv48-21 { color: #0000d2; }
.ansi38-52 { color: #2a0000; }
.inv38-52 { background: #2a0000; }
.ansi48-52 { background: #2a0000; }
.inv48-52 { color: #2a0000; }
.ansi38-53 { color: #2a002a; }
.inv38-53 { background: #2a002a; }
.ansi48-53 { background: #2a002a; }
.inv48-53 { color: #2a002a; }
.ansi38-54 { color: #2a0054; }
.inv38-54 { background: #2a0054; }
.ansi48-54 { background: #2a0054; }
.inv48-54 { color: #2a0054; }
.ansi38-55 { color: #2a007e; }
.inv38-55 { background: #2a007e; }
.ansi48-55 { background: #2a007e; }
.inv48-55 { color: #2a007e; }
.ansi38-56 { color: #2a00a8; }
.inv38-56 { background: #2a00a8; }
.ansi48-56 { background: #2a00a8; }
.inv48-56 { color: #2a00a8; }
.ansi38-57 { color: #2a00d2; }
.inv38-57 { background: #2a00d2; }
.ansi48-57 { background: #2a00d2; }
.inv48-57 { color: #2a00d2; }
.ansi38-88 { color: #540000; }
.inv38-88 { background: #540000; }
.ansi48-88 { background: #540000; }
.inv48-88 { color: #540000; }
.ansi38-89 { color: #54002a; }
.inv38-89 { background: #54002a; }
.ansi48-89 { background: #54002a; }
.inv48-89 { color: #54002a; }
.ansi38-90 { color: #540054; }
.inv38-90 { background: #540054; }
.ansi48-90 { background: #540054; }
.inv48-90 { color: #540054; }
.ansi38-91 { color: #54007e; }
.inv38-91 { background: #54007e; }
.ansi48-91 { background: #54007e; }
.inv48-91 { color: #54007e; }
.ansi38-92 { color: #5400a8; }
.inv38-92 { background: #5400a8; }
.ansi48-92 { background: #5400a8; }
.inv48-92 { color: #5400a8; }
.ansi38-93 { color: #5400d2; }
.inv38-93 { background: #5400d2; }
.ansi48-93 { background: #5400d2; }
.inv48-93 { color: #5400d2; }
.ansi38-124 { color: #7e0000; }
.inv38-124 { background: #7e0000; }
.ansi48-124 { background: #7e0000; }
.inv48-124 { color: #7e0000; }
.ansi38-125 { color: #7e002a; }
.inv38-125 { background: #7e002a; }
.ansi48-125 { background: #7e002a; }
.inv48-125 { color: #7e002a; }
.ansi38-126 { color: #7e0054; }
.inv38-126 { background: #7e0054; }
.ansi48-126 { background: #7e0054; }
.inv48-126 { color: #7e0054; }
.ansi38-127 { color: #7e007e; }
.inv38-127 { background: #7e007e; }
.ansi48-127 { background: #7e007e; }
.inv48-127 { color: #7e007e; }
.ansi38-128 { color: #7e00a8; }
.inv38-128 { background: #7e00a8; }
.ansi48-128 { background: #7e00a8; }
.inv48-128 { color: #7e00a8; }
.ansi38-129 { color: #7e00d2; }
.inv38-129 { background: #7e00d2; }
.ansi48-129 { background: #7e00d2; }
.inv48-129 { color: #7e00d2; }
.ansi38-160 { color: #a80000; }
.inv38-160 { background: #a80000; }
.ansi48-160 { background: #a80000; }
.inv48-160 { color: #a80000; }
.ansi38-161 { color: #a8002a; }
.inv38-161 { background: #a8002a; }
.ansi48-161 { background: #a8002a; }
.inv48-161 { color: #a8002a; }
.ansi38-162 { color: #a80054; }
.inv38-162 { background: #a80054; }
.ansi48-162 { background: #a80054; }
.inv48-162 { color: #a80054; }
.ansi38-163 { color: #a8007e; }
.inv38-163 { background: #a8007e; }
.ansi48-163 { background: #a8007e; }
.inv48-163 { color: #a8007e; }
.ansi38-164 { color: #a800a8; }
.inv38-164 { background: #a800a8; }
.ansi48-164 { background: #a800a8; }
.inv48-164 { color: #a800a8; }
.ansi38-165 { color: #a800d2; }
.inv38-165 { background: #a800d2; }
.ansi48-165 { background: #a800d2; }
.inv48-165 { color: #a800d2; }
.ansi38-196 { color: #d20000; }
.inv38-196 { background: #d20000; }
.ansi48-196 { background: #d20000; }
.inv48-196 { color: #d20000; }
.ansi38-197 { color: #d2002a; }
.inv38-197 { background: #d2002a; }
.ansi48-197 { background: #d2002a; }
.inv48-197 { color: #d2002a; }
.ansi38-198 { color: #d20054; }
.inv38-198 { background: #d20054; }
.ansi48-198 { background: #d20054; }
.inv48-198 { color: #d20054; }
.ansi38-199 { color: #d2007e; }
.inv38-199 { background: #d2007e; }
.ansi48-199 { background: #d2007e; }
.inv48-199 { color: #d2007e; }
.ansi38-200 { color: #d200a8; }
.inv38-200 { background: #d200a8; }
.ansi48-200 { background: #d200a8; }
.inv48-200 { color: #d200a8; }
.ansi38-201 { color: #d200d2; }
.inv38-201 { background: #d200d2; }
.ansi48-201 { background: #d200d2; }
.inv48-201 { color: #d200d2; }
.ansi38-22 { color: #002a00; }
.inv38-22 { background: #002a00; }
.ansi48-22 { background: #002a00; }
.inv48-22 { color: #002a00; }
.ansi38-23 { color: #002a2a; }
.inv38-23 { background: #002a2a; }
.ansi48-23 { background: #002a2a; }
.inv48-23 { color: #002a2a; }
.ansi38-24 { color: #002a54; }
.inv38-24 { background: #002a54; }
.ansi48-24 { background: #002a54; }
.inv48-24 { color: #002a54; }
.ansi38-25 { color: #002a7e; }
.inv38-25 { background: #002a7e; }
.ansi48-25 { background: #002a7e; }
.inv48-25 { color: #002a7e; }
.ansi38-26 { color: #002aa8; }
.inv38-26 { background: #002aa8; }
.ansi48-26 { background: #002aa8; }
.inv48-26 { color: #002aa8; }
.ansi38-27 { color: #002ad2; }
.inv38-27 { background: #002ad2; }
.ansi48-27 { background: #002ad2; }
.inv48-27 { color: #002ad2; }
.ansi38-58 { color: #2a2a00; }
.inv38-58 { background: #2a2a00; }
.ansi48-58 { background: #2a2a00; }
.inv48-58 { color: #2a2a00; }
.ansi38-59 { color: #2a2a2a; }
.inv38-59 { background: #2a2a2a; }
.ansi48-59 { background: #2a2a2a; }
.inv48-59 { color: #2a2a2a; }
.ansi38-60 { color: #2a2a54; }
.inv38-60 { background: #2a2a54; }
.ansi48-60 { background: #2a2a54; }
.inv48-60 { color: #2a2a54; }
.ansi38-61 { color: #2a2a7e; }
.inv38-61 { background: #2a2a7e; }
.ansi48-61 { background: #2a2a7e; }
.inv48-61 { color: #2a2a7e; }
.ansi38-62 { color: #2a2aa8; }
.inv38-62 { background: #2a2aa8; }
.ansi48-62 { background: #2a2aa8; }
.inv48-62 { color: #2a2aa8; }
.ansi38-63 { color: #2a2ad2; }
.inv38-63 { background: #2a2ad2; }
.ansi48-63 { background: #2a2ad2; }
.inv48-63 { color: #2a2ad2; }
.ansi38-94 { color: #542a00; }
.inv38-94 { background: #542a00; }
.ansi48-94 { background: #542a00; }
.inv48-94 { color: #542a00; }
.ansi38-95 { color: #542a2a; }
.inv38-95 { background: #542a2a; }
.ansi48-95 { background: #542a2a; }
.inv48-95 { color: #542a2a; }
.ansi38-96 { color: #542a54; }
.inv38-96 { background: #542a54; }
.ansi48-96 { background: #542a54; }
.inv48-96 { color: #542a54; }
.ansi38-97 { color: #542a7e; }
.inv38-97 { background: #542a7e; }
.ansi48-97 { background: #542a7e; }
.inv48-97 { color: #542a7e; }
.ansi38-98 { color: #542aa8; }
.inv38-98 { background: #542aa8; }
.ansi48-98 { background: #542aa8; }
.inv48-98 { color: #542aa8; }
.ansi38-99 { color: #542ad2; }
.inv38-99 { background: #542ad2; }
.ansi48-99 { background: #542ad2; }
.inv48-99 { color: #542ad2; }
.ansi38-130 { color: #7e2a00; }
.inv38-130 { background: #7e2a00; }
.ansi48-130 { background: #7e2a00; }
.inv48-130 { color: #7e2a00; }
.ansi38-131 { color: #7e2a2a; }
.inv38-131 { background: #7e2a2a; }
.ansi48-131 { background: #7e2a2a; }
.inv48-131 { color: #7e2a2a; }
.ansi38-132 { color: #7e2a54; }
.inv38-132 { background: #7e2a54; }
.ansi48-132 { background: #7e2a54; }
.inv48-132 { color: #7e2a54; }
.ansi38-133 { color: #7e2a7e; }
.inv38-133 { background: #7e2a7e; }
.ansi48-133 { background: #7e2a7e; }
.inv48-133 { color: #7e2a7e; }
.ansi38-134 { color: #7e2aa8; }
.inv38-134 { background: #7e2aa8; }
.ansi48-134 { background: #7e2aa8; }
.inv48-134 { color: #7e2aa8; }
.ansi38-135 { color: #7e2ad2; }
.inv38-135 { background: #7e2ad2; }
.ansi48-135 { background: #7e2ad2; }
.inv48-135 { color: #7e2ad2; }
.ansi38-166 { color: #a82a00; }
.inv38-166 { background: #a82a00; }
.ansi48-166 { background: #a82a00; }
.inv48-166 { color: #a82a00; }
.ansi38-167 { color: #a82a2a; }
.inv38-167 { background: #a82a2a; }
.ansi48-167 { background: #a82a2a; }
.inv48-167 { color: #a82a2a; }
.ansi38-168 { color: #a82a54; }
.inv38-168 { background: #a82a54; }
.ansi48-168 { background: #a82a54; }
.inv48-168 { color: #a82a54; }
.ansi38-169 { color: #a82a7e; }
.inv38-169 { background: #a82a7e; }
.ansi48-169 { background: #a82a7e; }
.inv48-169 { color: #a82a7e; }
.ansi38-170 { color: #a82aa8; }
.inv38-170 { background: #a82aa8; }
.ansi48-170 { background: #a82aa8; }
.inv48-170 { color: #a82aa8; }
.ansi38-171 { color: #a82ad2; }
.inv38-171 { background: #a82ad2; }
.ansi48-171 { background: #a82ad2; }
.inv48-171 { color: #a82ad2; }
.ansi38-202 { color: #d22a00; }
.inv38-202 { background: #d22a00; }
.ansi48-202 { background: #d22a00; }
.inv48-202 { color: #d22a00; }
.ansi38-203 { color: #d22a2a; }
.inv38-203 { background: #d22a2a; }
.ansi48-203 { background: #d22a2a; }
.inv48-203 { color: #d22a2a; }
.ansi38-204 { color: #d22a54; }
.inv38-204 { background: #d22a54; }
.ansi48-204 { background: #d22a54; }
.inv48-204 { color: #d22a54; }
.ansi38-205 { color: #d22a7e; }
.inv38-205 { background: #d22a7e; }
.ansi48-205 { background: #d22a7e; }
.inv48-205 { color: #d22a7e; }
.ansi38-206 { color: #d22aa8; }
.inv38-206 { background: #d22aa8; }
.ansi48-206 { background: #d22aa8; }
.inv48-206 { color: #d22aa8; }
.ansi38-207 { color: #d22ad2; }
.inv38-207 { background: #d22ad2; }
.ansi48-207 { background: #d22ad2; }
.inv48-207 { color: #d22ad2; }
.ansi38-28 { color: #005400; }
.inv38-28 { background: #005400; }
.ansi48-28 { background: #005400; }
.inv48-28 { color: #005400; }
.ansi38-29 { color: #00542a; }
.inv38-29 { background: #00542a; }
.ansi48-29 { background: #00542a; }
.inv48-29 { color: #00542a; }
.ansi38-30 { color: #005454; }
.inv38-30 { background: #005454; }
.ansi48-30 { background: #005454; }
.inv48-30 { color: #005454; }
.ansi38-31 { color: #00547e; }
.inv38-31 { background: #00547e; }
.ansi48-31 { background: #00547e; }
.inv48-31 { color: #00547e; }
.ansi38-32 { color: #0054a8; }
.inv38-32 { background: #0054a8; }
.ansi48-32 { background: #0054a8; }
.inv48-32 { color: #0054a8; }
.ansi38-33 { color: #0054d2; }
.inv38-33 { background: #0054d2; }
.ansi48-33 { background: #0054d2; }
.inv48-33 { color: #0054d2; }
.ansi38-64 { color: #2a5400; }
.inv38-64 { background: #2a5400; }
.ansi48-64 { background: #2a5400; }
.inv48-64 { color: #2a5400; }
.ansi38-65 { color: #2a542a; }
.inv38-65 { background: #2a542a; }
.ansi48-65 { background: #2a542a; }
.inv48-65 { color: #2a542a; }
.ansi38-66 { color: #2a5454; }
.inv38-66 { background: #2a5454; }
.ansi48-66 { background: #2a5454; }
.inv48-66 { color: #2a5454; }
.ansi38-67 { color: #2a547e; }
.inv38-67 { background: #2a547e; }
.ansi48-67 { background: #2a547e; }
.inv48-67 { color: #2a547e; }
.ansi38-68 { color: #2a54a8; }
.inv38-68 { background: #2a54a8; }
.ansi48-68 { background: #2a54a8; }
.inv48-68 { color: #2a54a8; }
.ansi38-69 { color: #2a54d2; }
.inv38-69 { background: #2a54d2; }
.ansi48-69 { background: #2a54d2; }
.inv48-69 { color: #2a54d2; }
.ansi38-100 { color: #545400; }
.inv38-100 { background: #545400; }
.ansi48-100 { background: #545400; }
.inv48-100 { color: #545400; }
.ansi38-101 { color: #54542a; }
.inv38-101 { background: #54542a; }
.ansi48-101 { background: #54542a; }
.inv48-101 { color: #54542a; }
.ansi38-102 { color: #545454; }
.inv38-102 { background: #545454; }
.ansi48-102 { background: #545454; }
.inv48-102 { color: #545454; }
.ansi38-103 { color: #54547e; }
.inv38-103 { background: #54547e; }
.ansi48-103 { background: #54547e; }
.inv48-103 { color: #54547e; }
.ansi38-104 { color: #5454a8; }
.inv38-104 { background: #5454a8; }
.ansi48-104 { background: #5454a8; }
.inv48-104 { color: #5454a8; }
.ansi38-105 { color: #5454d2; }
.inv38-105 { background: #5454d2; }
.ansi48-105 { background: #5454d2; }
.inv48-105 { color: #5454d2; }
.ansi38-136 { color: #7e5400; }
.inv38-136 { background: #7e5400; }
.ansi48-136 { background: #7e5400; }
.inv48-136 { color: #7e5400; }
.ansi38-137 { color: #7e542a; }
.inv38-137 { background: #7e542a; }
.ansi48-137 { background: #7e542a; }
.inv48-137 { color: #7e542a; }
.ansi38-138 { color: #7e5454; }
.inv38-138 { background: #7e5454; }
.ansi48-138 { background: #7e5454; }
.inv48-138 { color: #7e5454; }
.ansi38-139 { color: #7e547e; }
.inv38-139 { background: #7e547e; }
.ansi48-139 { background: #7e547e; }
.inv48-139 { color: #7e547e; }
.ansi38-140 { color: #7e54a8; }
.inv38-140 { background: #7e54a8; }
.ansi48-140 { background: #7e54a8; }
.inv48-140 { color: #7e54a8; }
.ansi38-141 { color: #7e54d2; }
.inv38-141 { background: #7e54d2; }
.ansi48-141 { background: #7e54d2; }
.inv48-141 { color: #7e54d2; }
.ansi38-172 { color: #a85400; }
.inv38-172 { background: #a85400; }
.ansi48-172 { background: #a85400; }
.inv48-172 { color: #a85400; }
.ansi38-173 { color: #a8542a; }
.inv38-173 { background: #a8542a; }
.ansi48-173 { background: #a8542a; }
.inv48-173 { color: #a8542a; }
.ansi38-174 { color: #a85454; }
.inv38-174 { background: #a85454; }
.ansi48-174 { background: #a85454; }
.inv48-174 { color: #a85454; }
.ansi38-175 { color: #a8547e; }
.inv38-175 { background: #a8547e; }
.ansi48-175 { background: #a8547e; }
.inv48-175 { color: #a8547e; }
.ansi38-176 { color: #a854a8; }
.inv38-176 { background: #a854a8; }
.ansi48-176 { background: #a854a8; }
.inv48-176 { color: #a854a8; }
.ansi38-177 { color: #a854d2; }
.inv38-177 { background: #a854d2; }
.ansi48-177 { background: #a854d2; }
.inv48-177 { color: #a854d2; }
.ansi38-208 { color: #d25400; }
.inv38-208 { background: #d25400; }
.ansi48-208 { background: #d25400; }
.inv48-208 { color: #d25400; }
.ansi38-209 { color: #d2542a; }
.inv38-209 { background: #d2542a; }
.ansi48-209 { background: #d2542a; }
.inv48-209 { color: #d2542a; }
.ansi38-210 { color: #d25454; }
.inv38-210 { background: #d25454; }
.ansi48-210 { background: #d25454; }
.inv48-210 { color: #d25454; }
.ansi38-211 { color: #d2547e; }
.inv38-211 { background: #d2547e; }
.ansi48-211 { background: #d2547e; }
.inv48-211 { color: #d2547e; }
.ansi38-212 { color: #d254a8; }
.inv38-212 { background: #d254a8; }
.ansi48-212 { background: #d254a8; }
.inv48-212 { color: #d254a8; }
.ansi38-213 { color: #d254d2; }
.inv38-213 { background: #d254d2; }
.ansi48-213 { background: #d254d2; }
.inv48-213 { color: #d254d2; }
.ansi38-34 { color: #007e00; }
.inv38-34 { background: #007e00; }
.ansi48-34 { background: #007e00; }
.inv48-34 { color: #007e00; }
.ansi38-35 { color: #007e2a; }
.inv38-35 { background: #007e2a; }
.ansi48-35 { background: #007e2a; }
.inv48-35 { color: #007e2a; }
.ansi38-36 { color: #007e54; }
.inv38-36 { background: #007e54; }
.ansi48-36 { background: #007e54; }
.inv48-36 { color: #007e54; }
.ansi38-37 { color: #007e7e; }
.inv38-37 { background: #007e7e; }
.ansi48-37 { background: #007e7e; }
.inv48-37 { color: #007e7e; }
.ansi38-38 { color: #007ea8; }
.inv38-38 { background: #007ea8; }
.ansi48-38 { background: #007ea8; }
.inv48-38 { color: #007ea8; }
.ansi38-39 { color: #007ed2; }
.inv38-39 { background: #007ed2; }
.ansi48-39 { background: #007ed2; }
.inv48-39 { color: #007ed2; }
.ansi38-70 { color: #2a7e00; }
.inv38-70 { background: #2a7e00; }
.ansi48-70 { background: #2a7e00; }
.inv48-70 { color: #2a7e00; }
.ansi38-71 { color: #2a7e2a; }
.inv38-71 { background: #2a7e2a; }
.ansi48-71 { background: #2a7e2a; }
.inv48-71 { color: #2a7e2a; }
.ansi38-72 { color: #2a7e54; }
.inv38-72 { background: #2a7e54; }
.ansi48-72 { background: #2a7e54; }
.inv48-72 { color: #2a7e54; }
.ansi38-73 { color: #2a7e7e; }
.inv38-73 { background: #2a7e7e; }
.ansi48-73 { background: #2a7e7e; }
.inv48-73 { color: #2a7e7e; }
.ansi38-74 { color: #2a7ea8; }
.inv38-74 { background: #2a7ea8; }
.ansi48-74 { background: #2a7ea8; }
.inv48-74 { color: #2a7ea8; }
.ansi38-75 { color: #2a7ed2; }
.inv38-75 { background: #2a7ed2; }
.ansi48-75 { background: #2a7ed2; }
.inv48-75 { color: #2a7ed2; }
.ansi38-106 { color: #547e00; }
.inv38-106 { background: #547e00; }
.ansi48-106 { background: #547e00; }
.inv48-106 { color: #547e00; }
.ansi38-107 { color: #547e2a; }
.inv38-107 { background: #547e2a; }
.ansi48-107 { background: #547e2a; }
.inv48-107 { color: #547e2a; }
.ansi38-108 { color: #547e54; }
.inv38-108 { background: #547e54; }
.ansi48-108 { background: #547e54; }
.inv48-108 { color: #547e54; }
.ansi38-109 { color: #547e7e; }
.inv38-109 { background: #547e7e; }
.ansi48-109 { background: #547e7e; }
.inv48-109 { color: #547e7e; }
.ansi38-110 { color: #547ea8; }
.inv38-110 { background: #547ea8; }
.ansi48-110 { background: #547ea8; }
.inv48-110 { color: #547ea8; }
.ansi38-111 { color: #547ed2; }
.inv38-111 { background: #547ed2; }
.ansi48-111 { background: #547ed2; }
.inv48-111 { color: #547ed2; }
.ansi38-142 { color: #7e7e00; }
.inv38-142 { background: #7e7e00; }
.ansi48-142 { background: #7e7e00; }
.inv48-142 { color: #7e7e00; }
.ansi38-143 { color: #7e7e2a; }
.inv38-143 { background: #7e7e2a; }
.ansi48-143 { background: #7e7e2a; }
.inv48-143 { color: #7e7e2a; }
.ansi38-144 { color: #7e7e54; }
.inv38-144 { background: #7e7e54; }
.ansi48-144 { background: #7e7e54; }
.inv48-144 { color: #7e7e54; }
.ansi38-145 { color: #7e7e7e; }
.inv38-145 { background: #7e7e7e; }
.ansi48-145 { background: #7e7e7e; }
.inv48-145 { color: #7e7e7e; }
.ansi38-146 { color: #7e7ea8; }
.inv38-146 { background: #7e7ea8; }
.ansi48-146 { background: #7e7ea8; }
.inv48-146 { color: #7e7ea8; }
.ansi38-147 { color: #7e7ed2; }
.inv38-147 { background: #7e7ed2; }
.ansi48-147 { background: #7e7ed2; }
.inv48-147 { color: #7e7ed2; }
.ansi38-178 { color: #a87e00; }
.inv38-178 { background: #a87e00; }
.ansi48-178 { background: #a87e00; }
.inv48-178 { color: #a87e00; }
.ansi38-179 { color: #a87e2a; }
.inv38-179 { background: #a87e2a; }
.ansi48-179 { background: #a87e2a; }
.inv48-179 { color: #a87e2a; }
.ansi38-180 { color: #a87e54; }
.inv38-180 { background: #a87e54; }
.ansi48-180 { background: #a87e54; }
.inv48-180 { color: #a87e54; }
.ansi38-181 { color: #a87e7e; }
.inv38-181 { background: #a87e7e; }
.ansi48-181 { background: #a87e7e; }
.inv48-181 { color: #a87e7e; }
.ansi38-182 { color: #a87ea8; }
.inv38-182 { background: #a87ea8; }
.ansi48-182 { background: #a87ea8; }
.inv48-182 { color: #a87ea8; }
.ansi38-183 { color: #a87ed2; }
.inv38-183 { background: #a87ed2; }
.ansi48-183 { background: #a87ed2; }
.inv48-183 { color: #a87ed2; }
.ansi38-214 { color: #d27e00; }
.inv38-214 { background: #d27e00; }
.ansi48-214 { background: #d27e00; }
.inv48-214 { color: #d27e00; }
.ansi38-215 { color: #d27e2a; }
.inv38-215 { background: #d27e2a; }
.ansi48-215 { background: #d27e2a; }
.inv48-215 { color: #d27e2a; }
.ansi38-216 { color: #d27e54; }
.inv38-216 { background: #d27e54; }
.ansi48-216 { background: #d27e54; }
.inv48-216 { color: #d27e54; }
.ansi38-217 { color: #d27e7e; }
.inv38-217 { background: #d27e7e; }
.ansi48-217 { background: #d27e7e; }
.inv48-217 { color: #d27e7e; }
.ansi38-218 { color: #d27ea8; }
.inv38-218 { background: #d27ea8; }
.ansi48-218 { background: #d27ea8; }
.inv48-218 { color: #d27ea8; }
.ansi38-219 { color: #d27ed2; }
.inv38-219 { background: #d27ed2; }
.ansi48-219 { background: #d27ed2; }
.inv48-219 { color: #d27ed2; }
.ansi38-40 { color: #00a800; }
.inv38-40 { background: #00a800; }
.ansi48-40 { background: #00a800; }
.inv48-40 { color: #00a800; }
.ansi38-41 { color: #00a82a; }
.inv38-41 { background: #00a82a; }
.ansi48-41 { background: #00a82a; }
.inv48-41 { color: #00a82a; }
.ansi38-42 { color: #00a854; }
.inv38-42 { background: #00a854; }
.ansi48-42 { background: #00a854; }
.inv48-42 { color: #00a854; }
.ansi38-43 { color: #00a87e; }
.inv38-43 { background: #00a87e; }
.ansi48-43 { background: #00a87e; }
.inv48-43 { color: #00a87e; }
.ansi38-44 { color: #00a8a8; }
.inv38-44 { background: #00a8a8; }
.ansi48-44 { background: #00a8a8; }
.inv48-44 { color: #00a8a8; }
.ansi38-45 { color: #00a8d2; }
.inv38-45 { background: #00a8d2; }
.ansi48-45 { background: #00a8d2; }
.inv48-45 { color: #00a8d2; }
.ansi38-76 { color: #2aa800; }
.inv38-76 { background: #2aa800; }
.ansi48-76 { background: #2aa800; }
.inv48-76 { color: #2aa800; }
.ansi38-77 { color: #2aa82a; }
.inv38-77 { background: #2aa82a; }
.ansi48-77 { background: #2aa82a; }
.inv48-77 { color: #2aa82a; }
.ansi38-78 { color: #2aa854; }
.inv38-78 { background: #2aa854; }
.ansi48-78 { background: #2aa854; }
.inv48-78 { color: #2aa854; }
.ansi38-79 { color: #2aa87e; }
.inv38-79 { background: #2aa87e; }
.ansi48-79 { background: #2aa87e; }
.inv48-79 { color: #2aa87e; }
.ansi38-80 { color: #2aa8a8; }
.inv38-80 { background: #2aa8a8; }
.ansi48-80 { background: #2aa8a8; }
.inv48-80 { color: #2aa8a8; }
.ansi38-81 { color: #2aa8d2; }
.inv38-81 { background: #2aa8d2; }
.ansi48-81 { background: #2aa8d2; }
.inv48-81 { color: #2aa8d2; }
.ansi38-112 { color: #54a800; }
.inv38-112 { background: #54a800; }
.ansi48-112 { background: #54a800; }
.inv48-112 { color: #54a800; }
.ansi38-113 { color: #54a82a; }
.inv38-113 { background: #54a82a; }
.ansi48-113 { background: #54a82a; }
.inv48-113 { color: #54a82a; }
.ansi38-114 { color: #54a854; }
.inv38-114 { background: #54a854; }
.ansi48-114 { background: #54a854; }
.inv48-114 { color: #54a854; }
.ansi38-115 { color: #54a87e; }
.inv38-115 { background: #54a87e; }
.ansi48-115 { background: #54a87e; }
.inv48-115 { color: #54a87e; }
.ansi38-116 { color: #54a8a8; }
.inv38-116 { background: #54a8a8; }
.ansi48-116 { background: #54a8a8; }
.inv48-116 { color: #54a8a8; }
.ansi38-117 { color: #54a8d2; }
.inv38-117 { background: #54a8d2; }
.ansi48-117 { background: #54a8d2; }
.inv48-117 { color: #54a8d2; }
.ansi38-148 { color: #7ea800; }
.inv38-148 { background: #7ea800; }
.ansi48-148 { background: #7ea800; }
.inv48-148 { color: #7ea800; }
.ansi38-149 { color: #7ea82a; }
.inv38-149 { background: #7ea82a; }
.ansi48-149 { background: #7ea82a; }
.inv48-149 { color: #7ea82a; }
.ansi38-150 { color: #7ea854; }
.inv38-150 { background: #7ea854; }
.ansi48-150 { background: #7ea854; }
.inv48-150 { color: #7ea854; }
.ansi38-151 { color: #7ea87e; }
.inv38-151 { background: #7ea87e; }
.ansi48-151 { background: #7ea87e; }
.inv48-151 { color: #7ea87e; }
.ansi38-152 { color: #7ea8a8; }
.inv38-152 { background: #7ea8a8; }
.ansi48-152 { background: #7ea8a8; }
.inv48-152 { color: #7ea8a8; }
.ansi38-153 { color: #7ea8d2; }
.inv38-153 { background: #7ea8d2; }
.ansi48-153 { background: #7ea8d2; }
.inv48-153 { color: #7ea8d2; }
.ansi38-184 { color: #a8a800; }
.inv38-184 { background: #a8a800; }
.ansi48-184 { background: #a8a800; }
.inv48-184 { color: #a8a800; }
.ansi38-185 { color: #a8a82a; }
.inv38-185 { background: #a8a82a; }
.ansi48-185 { background: #a8a82a; }
.inv48-185 { color: #a8a82a; }
.ansi38-186 { color: #a8a854; }
.inv38-186 { background: #a8a854; }
.ansi48-186 { background: #a8a854; }
.inv48-186 { color: #a8a854; }
.ansi38-187 { color: #a8a87e; }
.inv38-187 { background: #a8a87e; }
.ansi48-187 { background: #a8a87e; }
.inv48-187 { color: #a8a87e; }
.ansi38-188 { color: #a8a8a8; }
.inv38-188 { background: #a8a8a8; }
.ansi48-188 { background: #a8a8a8; }
.inv48-188 { color: #a8a8a8; }
.ansi38-189 { color: #a8a8d2; }
.inv38-189 { background: #a8a8d2; }
.ansi48-189 { background: #a8a8d2; }
.inv48-189 { color: #a8a8d2; }
.ansi38-220 { color: #d2a800; }
.inv38-220 { background: #d2a800; }
.ansi48-220 { background: #d2a800; }
.inv48-220 { color: #d2a800; }
.ansi38-221 { color: #d2a82a; }
.inv38-221 { background: #d2a82a; }
.ansi48-221 { background: #d2a82a; }
.inv48-221 { color: #d2a82a; }
.ansi38-222 { color: #d2a854; }
.inv38-222 { background: #d2a854; }
.ansi48-222 { background: #d2a854; }
.inv48-222 { color: #d2a854; }
.ansi38-223 { color: #d2a87e; }
.inv38-223 { background: #d2a87e; }
.ansi48-223 { background: #d2a87e; }
.inv48-223 { color: #d2a87e; }
.ansi38-224 { color: #d2a8a8; }
.inv38-224 { background: #d2a8a8; }
.ansi48-224 { background: #d2a8a8; }
.inv48-224 { color: #d2a8a8; }
.ansi38-225 { color: #d2a8d2; }
.inv38-225 { background: #d2a8d2; }
.ansi48-225 { background: #d2a8d2; }
.inv48-225 { color: #d2a8d2; }
.ansi38-46 { color: #00d200; }
.inv38-46 { background: #00d200; }
.ansi48-46 { background: #00d200; }
.inv48-46 { color: #00d200; }
.ansi38-47 { color: #00d22a; }
.inv38-47 { background: #00d22a; }
.ansi48-47 { background: #00d22a; }
.inv48-47 { color: #00d22a; }
.ansi38-48 { color: #00d254; }
.inv38-48 { background: #00d254; }
.ansi48-48 { background: #00d254; }
.inv48-48 { color: #00d254; }
.ansi38-49 { color: #00d27e; }
.inv38-49 { background: #00d27e; }
.ansi48-49 { background: #00d27e; }
.inv48-49 { color: #00d27e; }
.ansi38-50 { color: #00d2a8; }
.inv38-50 { background: #00d2a8; }
.ansi48-50 { background: #00d2a8; }
.inv48-50 { color: #00d2a8; }
.ansi38-51 { color: #00d2d2; }
.inv38-51 { background: #00d2d2; }
.ansi48-51 { background: #00d2d2; }
.inv48-51 { color: #00d2d2; }
.ansi38-82 { color: #2ad200; }
.inv38-82 { background: #2ad200; }
.ansi48-82 { background: #2ad200; }
.inv48-82 { color: #2ad200; }
.ansi38-83 { color: #2ad22a; }
.inv38-83 { background: #2ad22a; }
.ansi48-83 { background: #2ad22a; }
.inv48-83 { color: #2ad22a; }
.ansi38-84 { color: #2ad254; }
.inv38-84 { background: #2ad254; }
.ansi48-84 { background: #2ad254; }
.inv48-84 { color: #2ad254; }
.ansi38-85 { color: #2ad27e; }
.inv38-85 { background: #2ad27e; }
.ansi48-85 { background: #2ad27e; }
.inv48-85 { color: #2ad27e; }
.ansi38-86 { color: #2ad2a8; }
.inv38-86 { background: #2ad2a8; }
.ansi48-86 { background: #2ad2a8; }
.inv48-86 { color: #2ad2a8; }
.ansi38-87 { color: #2ad2d2; }
.inv38-87 { background: #2ad2d2; }
.ansi48-87 { background: #2ad2d2; }
.inv48-87 { color: #2ad2d2; }
.ansi38-118 { color: #54d200; }
.inv38-118 { background: #54d200; }
.ansi48-118 { background: #54d200; }
.inv48-118 { color: #54d200; }
.ansi38-119 { color: #54d22a; }
.inv38-119 { background: #54d22a; }
.ansi48-119 { background: #54d22a; }
.inv48-119 { color: #54d22a; }
.ansi38-120 { color: #54d254; }
.inv38-120 { background: #54d254; }
.ansi48-120 { background: #54d254; }
.inv48-120 { color: #54d254; }
.ansi38-121 { color: #54d27e; }
.inv38-121 { background: #54d27e; }
.ansi48-121 { background: #54d27e; }
.inv48-121 { color: #54d27e; }
.ansi38-122 { color: #54d2a8; }
.inv38-122 { background: #54d2a8; }
.ansi48-122 { background: #54d2a8; }
.inv48-122 { color: #54d2a8; }
.ansi38-123 { color: #54d2d2; }
.inv38-123 { background: #54d2d2; }
.ansi48-123 { background: #54d2d2; }
.inv48-123 { color: #54d2d2; }
.ansi38-154 { color: #7ed200; }
.inv38-154 { background: #7ed200; }
.ansi48-154 { background: #7ed200; }
.inv48-154 { color: #7ed200; }
.ansi38-155 { color: #7ed22a; }
.inv38-155 { background: #7ed22a; }
.ansi48-155 { background: #7ed22a; }
.inv48-155 { color: #7ed22a; }
.ansi38-156 { color: #7ed254; }
.inv38-156 { background: #7ed254; }
.ansi48-156 { background: #7ed254; }
.inv48-156 { color: #7ed254; }
.ansi38-157 { color: #7ed27e; }
.inv38-157 { background: #7ed27e; }
.ansi48-157 { background: #7ed27e; }
.inv48-157 { color: #7ed27e; }
.ansi38-158 { color: #7ed2a8; }
.inv38-158 { background: #7ed2a8; }
.ansi48-158 { background: #7ed2a8; }
.inv48-158 { color: #7ed2a8; }
.ansi38-159 { color: #7ed2d2; }
.inv38-159 { background: #7ed2d2; }
.ansi48-159 { background: #7ed2d2; }
.inv48-159 { color: #7ed2d2; }
.ansi38-190 { color: #a8d200; }
.inv38-190 { background: #a8d200; }
.ansi48-190 { background: #a8d200; }
.inv48-190 { color: #a8d200; }
.ansi38-191 { color: #a8d22a; }
.inv38-191 { background: #a8d22a; }
.ansi48-191 { background: #a8d22a; }
.inv48-191 { color: #a8d22a; }
.ansi38-192 { color: #a8d254; }
.inv38-192 { background: #a8d254; }
.ansi48-192 { background: #a8d254; }
.inv48-192 { color: #a8d254; }
.ansi38-193 { color: #a8d27e; }
.inv38-193 { background: #a8d27e; }
.ansi48-193 { background: #a8d27e; }
.inv48-193 { color: #a8d27e; }
.ansi38-194 { color: #a8d2a8; }
.inv38-194 { background: #a8d2a8; }
.ansi48-194 { background: #a8d2a8; }
.inv48-194 { color: #a8d2a8; }
.ansi38-195 { color: #a8d2d2; }
.inv38-195 { background: #a8d2d2; }
.ansi48-195 { background: #a8d2d2; }
.inv48-195 { color: #a8d2d2; }
.ansi38-226 { color: #d2d200; }
.inv38-226 { background: #d2d200; }
.ansi48-226 { background: #d2d200; }
.inv48-226 { color: #d2d200; }
.ansi38-227 { color: #d2d22a; }
.inv38-227 { background: #d2d22a; }
.ansi48-227 { background: #d2d22a; }
.inv48-227 { color: #d2d22a; }
.ansi38-228 { color: #d2d254; }
.inv38-228 { background: #d2d254; }
.ansi48-228 { background: #d2d254; }
.inv48-228 { color: #d2d254; }
.ansi38-229 { color: #d2d27e; }
.inv38-229 { background: #d2d27e; }
.ansi48-229 { background: #d2d27e; }
.inv48-229 { color: #d2d27e; }
.ansi38-230 { color: #d2d2a8; }
.inv38-230 { background: #d2d2a8; }
.ansi48-230 { background: #d2d2a8; }
.inv48-230 { color: #d2d2a8; }
.ansi38-231 { color: #d2d2d2; }
.inv38-231 { background: #d2d2d2; }
.ansi48-231 { background: #d2d2d2; }
.inv48-231 { color: #d2d2d2; }
.ansi38-232 { color: #080808; }
.inv38-232 { background: #080808; }
.ansi48-232 { background: #080808; }
.inv48-232 { color: #080808; }
.ansi38-233 { color: #121212; }
.inv38-233 { background: #121212; }
.ansi48-233 { background: #121212; }
.inv48-233 { color: #121212; }
.ansi38-234 { color: #1c1c1c; }
.inv38-234 { background: #1c1c1c; }
.ansi48-234 { background: #1c1c1c; }
.inv48-234 { color: #1c1c1c; }
.ansi38-235 { color: #262626; }
.inv38-235 { background: #262626; }
.ansi48-235 { background: #262626; }
.inv48-235 { color: #262626; }
.ansi38-236 { color: #303030; }
.inv38-236 { background: #303030; }
.ansi48-236 { background: #303030; }
.inv48-236 { color: #303030; }
.ansi38-237 { color: #3a3a3a; }
.inv38-237 { background: #3a3a3a; }
.ansi48-237 { background: #3a3a3a; }
.inv48-237 { color: #3a3a3a; }
.ansi38-238 { color: #444444; }
.inv38-238 { background: #444444; }
.ansi48-238 { background: #444444; }
.inv48-238 { color: #444444; }
.ansi38-239 { color: #4e4e4e; }
.inv38-239 { background: #4e4e4e; }
.ansi48-239 { background: #4e4e4e; }
.inv48-239 { color: #4e4e4e; }
.ansi38-240 { color: #585858; }
.inv38-240 { background: #585858; }
.ansi48-240 { background: #585858; }
.inv48-240 { color: #585858; }
.ansi38-241 { color: #626262; }
.inv38-241 { background: #626262; }
.ansi48-241 { background: #626262; }
.inv48-241 { color: #626262; }
.ansi38-242 { color: #6c6c6c; }
.inv38-242 { background: #6c6c6c; }
.ansi48-242 { background: #6c6c6c; }
.inv48-242 { color: #6c6c6c; }
.ansi38-243 { color: #767676; }
.inv38-243 { background: #767676; }
.ansi48-243 { background: #767676; }
.inv48-243 { color: #767676; }
.ansi38-244 { color: #808080; }
.inv38-244 { background: #808080; }
.ansi48-244 { background: #808080; }
.inv48-244 { color: #808080; }
.ansi38-245 { color: #8a8a8a; }
.inv38-245 { background: #8a8a8a; }
.ansi48-245 { background: #8a8a8a; }
.inv48-245 { color: #8a8a8a; }
.ansi38-246 { color: #949494; }
.inv38-246 { background: #949494; }
.ansi48-246 { background: #949494; }
.inv48-246 { color: #949494; }
.ansi38-247 { color: #9e9e9e; }
.inv38-247 { background: #9e9e9e; }
.ansi48-247 { background: #9e9e9e; }
.inv48-247 { color: #9e9e9e; }
.ansi38-248 { color: #a8a8a8; }
.inv38-248 { background: #a8a8a8; }
.ansi48-248 { background: #a8a8a8; }
.inv48-248 { color: #a8a8a8; }
.ansi38-249 { color: #b2b2b2; }
.inv38-249 { background: #b2b2b2; }
.ansi48-249 { background: #b2b2b2; }
.inv48-249 { color: #b2b2b2; }
.ansi38-250 { color: #bcbcbc; }
.inv38-250 { background: #bcbcbc; }
.ansi48-250 { background: #bcbcbc; }
.inv48-250 { color: #bcbcbc; }
.ansi38-251 { color: #c6c6c6; }
.inv38-251 { background: #c6c6c6; }
.ansi48-251 { background: #c6c6c6; }
.inv48-251 { color: #c6c6c6; }
.ansi38-252 { color: #d0d0d0; }
.inv38-252 { background: #d0d0d0; }
.ansi48-252 { background: #d0d0d0; }
.inv48-252 { color: #d0d0d0; }
.ansi38-253 { color: #dadada; }
.inv38-253 { background: #dadada; }
.ansi48-253 { background: #dadada; }
.inv48-253 { color: #dadada; }
.ansi38-254 { color: #e4e4e4; }
.inv38-254 { background: #e4e4e4; }
.ansi48-254 { background: #e4e4e4; }
.inv48-254 { color: #e4e4e4; }
.ansi38-255 { color: #eeeeee; }
.inv38-255 { background: #eeeeee; }
.ansi48-255 { background: #eeeeee; }
.inv48-255 { color: #eeeeee; }

.ColorTag {
	border-radius: 3px;
	padding-left: 5px;
	padding-right: 5px;
	text-align: center;
	display: inline-block;
	border: #0073bb 1px solid;
	text-shadow: 0 1px 0 rgba(0, 51, 83, 0.3);
	box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), inset 0 1px rgba(255, 255, 255, 0.03);
	width: calc(100% - 15px);
}

.BlueTag {
	border-radius: 3px;
	padding-left: 5px;
	padding-right: 5px;
	text-align: center;
	background-color: #1b9dec;
	background-image: linear-gradient(to bottom, #1da7ee, #178ee9);
	background-repeat: repeat-x;
	color: #ffffff;
	display: inline-block;
	border: #0073bb 1px solid;
	text-shadow: 0 1px 0 rgba(0, 51, 83, 0.3);
	box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), inset 0 1px rgba(255, 255, 255, 0.03);
}

.SmallButton {
	padding-right: 7px !important;
	padding-left: 11px !important;
	padding-top: 2px !important;
	padding-bottom: 2px !important;
}

/** Small filter buttons **/

.ms-parent {
	float: right;
	margin-top: 2px !important;
	margin-left: -20px !important;
}

.ms-choice {
	border: none !important;
	height: 19px !important;
}

.ms-choice > div {
	width: 18px !important;
	height: 20px !important;
	background-position-y: -3px !important;
}

.ms-choice > div.open {
	background-position-x: -18px !important;
	background-position-y: -3px !important;
}

.ms-drop {
	text-align: left;
	border-radius: 4px 0px 4px 4px !important;
}

.ms-parent {
	color: black !important;
}

.ms-choice > div,
.ms-choice > div.open {
	background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAABmJLR0QAAAAkAP/rBbrOAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4QkGBhYoFBc+tQAAAHhJREFUOMvVk+EKwCAIhO+qvf8b6/4YtFhFzsEmSET64akBgcbunhwMwRtGczV/xEk3Ut1ANr0SZ3Ws+eyavwtkk3eZngAoG7Jp8dNpFjt14m3c0mZAADjukkZLqp5FTZFL+z+YRMLU3hglUwDkAVA/0df6dfJK9gkAax0qqPfdiQAAAABJRU5ErkJggg==') no-repeat !important;
	background-size: 15px 15px !important;
	background-position-x: 4px !important;
	background-position-y: 2px !important;
	opacity: 0.2 !important;
}

.FilteredColumnCell .ms-choice > div,
.FilteredColumnCell .ms-choice > div.open {
	background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAABmJLR0QAAAAkAP/rBbrOAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4QkGBhIJPBLr7wAAAIxJREFUOMvVlEEOhCAMRV8r3sP7n8qDkHYWOpEQRWyYxGnCggZeftsPMDCk2muAYfwiZF/OsnqYsi4CiJ6UGhYmRa8spG5TpYBJ1fxnwAJUT8+AtB/oBaVymmcXE5CbCg9QvvNVbirc8nMNapnUI0bVkab9P5iNhDmg3Z7rKNOA6QLor+jr96VMdz/MB5VpJCvm3FB4AAAAAElFTkSuQmCC') no-repeat !important;
	background-size: 15px 15px !important;
	background-position-x: 4px !important;
	background-position-y: 2px !important;
	opacity: 0.8 !important;
}

th.EmptyContent .ms-choice > div,
th.EmptyContent .ms-choice > div.open {
	background-position-x: 3px !important;
}

th.EmptyContent {
	padding-bottom: 6px !important;
}

.ms-parent * {
	background-color: white !important;
	color: black !important;
}

.text-wrapper {
	display: inline-block;
	padding-right: 23px;
}

#trColumnNames {
	vertical-align: bottom;
}


.EmptyColorTag {
	display: none;
}

.text {
	padding-left: 2px;
	padding-right: 3px;
}

#trActionOnSelected > th {
	padding-bottom: 4px !important;
}


.click-triggers-selection {
	cursor: pointer;
}

.ui-widget-overlay {
	background-color: #000000;
}

/** stylesheets/flexmenu.css **/
#cssmenu {
	box-shadow: 2px 2px 10px rgba(0, 0, 0, .5);
}

#cssmenu ul {
	margin: 0;
	padding: 0;
	list-style: none;
}

#cssmenu li {
	margin: 0;
	padding: 0;
}

#cssmenu a {
	margin: 0;
	padding: 0;
	text-decoration: none;
}

#cssmenu  {
	width: 100%;
	height: 32px;
	background-color: #132F4D;
	border-bottom: 1px solid #bbb;
}

#cssmenu > ul > li 
{
    float: left;
    position: relative;
}

#cssmenu > ul > li > a,
.login,
#cssmenu .MenuBarRightTable td {
    color: #efefef;
    font-size: 14px;
    line-height: 32px;
    padding-top: 15px;
    padding-bottom: 15px;
    padding-left: 20px;
    padding-right: 20px;
}

#cssmenu > ul > li {
	border-right: 1px solid #555;
}

#cssmenu .MenuBarRightTable > tbody td {
	padding: 0px;
}

#cssmenu .MenuBarRightTable > tbody > tr > td > li {
	padding-top: 0px !important;
	padding-bottom: 0px !important;
	padding-left: 10px !important;
	padding-right: 10px !important;
}

#cssmenu > ul > li:hover,
#cssmenu .MenuBarRightTable > tbody > tr > td > li:hover {
	background-color: #5E5E5E; 
}

#cssmenu > ul > li:hover {
	box-shadow: 5px 5px 5px rgba(0,0,0,.4);
}

#cssmenu .MenuBarRightTable > tbody > tr > td > li:hover {
	box-shadow: -5px 5px 5px rgba(0,0,0,.4);
}

#cssmenu td {
	vertical-align: top;
}

#cssmenu table {
	border-spacing: 0px;
	border-collapse: collapse;
}

#cssmenu .has-sub > table {
	/* For some reason we need 1px more than 100% to cover the entire menu item width in case the table is narrower */
	width: calc(100% + 1px);

    opacity: 1;
    visibility: hidden;
    padding: 0px;
	background-color: #5E5E5E; 
    text-align: left;
    white-space: nowrap;
    position: absolute;
    top: 32px;
    margin: 0px;
	box-shadow: 5px 5px 5px rgba(0,0,0,.4);
}

#cssmenu .MenuBarRightTable .has-sub > table {
	box-shadow: -5px 5px 5px rgba(0,0,0,.4);
}

#cssmenu .has-sub:hover > table {
    visibility: visible;
    z-index: 2147483647;
}

#cssmenu .has-sub > table:before {
    content: '';
    display: block;
    border-color: transparent;
    border-style: solid;
    border-width: 0px;
    position: absolute;
    margin: 0px;
}

#cssmenu .has-sub > ul > li
{ 
	position: relative;
}

#cssmenu .mega-menu ul a,
#cssmenu .has-sub ul a
{
    color: #ffffff;
	font-size: 12px;
    display: block;
}

#cssmenu .mega-menu ul a {
    padding: 5px 15px 3px 15px;
}

#cssmenu .has-sub ul a {
    padding: 5px 15px 3px 10px;
}

#cssmenu .has-sub th a
{
    color: #ffffff;
	font-size: 14px;
    padding: 5px 5px 5px 5px;
    display: block;
}

#cssmenu .has-sub ul a:hover,
#cssmenu .has-sub th a:hover,
#cssmenu .has-sub .has-sub ul a:hover,
#cssmenu .has-sub .has-sub th a:hover {
	background-color: #aaa;
}

#cssmenu hr {
	margin-top: 2px;
	margin-bottom: 2px;
}

.mega-menu-header {
	font-size: 14px;
	font-weight: bold;
	color: #FFAE57;
	padding-left: 10px;
	padding-right: 10px;
	margin-top: 0px;
	margin-bottom: 0px;
}

.mega-menu > table {
	padding: 10px !important;
}

.mega-menu > table td {
	padding-top: 3px;
	padding-bottom: 4px;
}

.mega-menu > a {
	text-align: center;
	display: inline-block;
	padding-top: 0px !important;
	padding-bottom: 0px !important;
}

/** stylesheets/styleTables.css **/
/* ------------------
 styling for the tables 
   ------------------   */


body
{
	line-height: 1.6em;
}

table.defaultStyle th,
table.defaultStyle td
{
	font-size: 12px !important;
	color: #404040; !important;
	padding: 0px !important;
	white-space: nowrap !important;
	border: 0px !important;
}

table.table-no-borders 
{
	border: none !important;
}

table.table-no-borders th, table.table-no-borders td
{
	border: none !important;
}

table.hor-minimalist-c
{
	font-family: "Lucida Sans Unicode", "Lucida Grande", Sans-Serif;
	border-collapse: collapse;
	text-align: left;
}
table.hor-minimalist-c tbody tr:first-child {
	border-top: 1px solid #404040;
}
table.hor-minimalist-c th
{
	font-size: 13px;
	font-weight: bold;
	color: #404040;
	padding-top: 4px;
	padding-bottom: 2px;
	padding-left: 4px;
	padding-right: 6px;
	white-space: nowrap;
}
table.hor-minimalist-c td
{
	border-bottom: 1px solid #808080;
	color: #808080;
	padding: 4px 4px;
}
table.hor-minimalist-c tbody tr:hover
{
	background-color: #f5f5f5 !important;
}
table.hor-minimalist-c th.horizontal-borders-cell, table.hor-minimalist-c td.horizontal-borders-cell
{
	border-top: 1px solid #808080 !important;
	border-bottom: 1px solid #808080 !important;
}
table.hor-minimalist-c th.SetupParameterCell, table.hor-minimalist-c td.SetupParameterCell, table.hor-minimalist-c th.VerticalBordersCell, table.hor-minimalist-c td.VerticalBordersCell
{
	border-left: 1px solid #808080 !important;
	border-right: 1px solid #808080 !important;
}
table.hor-minimalist-c th.LeftBorderCell, table.hor-minimalist-c td.LeftBorderCell
{
	border-left: 1px solid #000000 !important;
}
table.hor-minimalist-c th.RightBorderCell, table.hor-minimalist-c td.RightBorderCell
{
	border-right: 1px solid #000000 !important;
}


table.hor-minimalist-d
{
	font-family: "Lucida Sans Unicode", "Lucida Grande", Sans-Serif;
	background: transparent;
	margin: 10px;
	border-collapse: collapse;
	text-align: left;
}

table.hor-minimalist-d th
{
	font-size: 13px;
	font-weight: bold;
	color: #404040;
	padding: 6px 6px;
	border-top: 1px solid #404040;
	border-bottom: 1px solid #404040;
	border-left: 1px solid #404040;
	border-right: 1px solid #404040;
	white-space: nowrap;
}
table.hor-minimalist-d tr#trColumnNames th
{
	color: #2966B8 !important;
}
table.hor-minimalist-d td
{
	border-bottom: 1px solid #808080;
	border-right: 1px solid #404040;
	border-left: 1px solid #404040;
	color: #808080;
	padding: 4px 4px;
}

tr.highlighted
{
	background-color: yellow;
}
tr.grayed
{
	background-color: silver;
}

#ver-minimalist
{
	font-family: "Lucida Sans Unicode", "Lucida Grande", Sans-Serif;
	font-size: 12px;
	margin: 45px;
	width: 480px;
	text-align: left;
	border-collapse: collapse;
}
#ver-minimalist th
{
	padding: 8px 2px;
	font-weight: normal;
	font-size: 14px;
	border-bottom: 2px solid #6678b1;
	border-right: 30px solid #fff;
	border-left: 30px solid #fff;
	color: #039;
}
#ver-minimalist td
{
	padding: 12px 2px 0px 2px;
	border-right: 30px solid #fff;
	border-left: 30px solid #fff;
	color: #669;
}


#box-table-a
{
	font-family: "Lucida Sans Unicode", "Lucida Grande", Sans-Serif;
	font-size: 12px;
	margin: 45px;
	width: 480px;
	text-align: left;
	border-collapse: collapse;
}
#box-table-a th
{
	font-size: 13px;
	font-weight: normal;
	padding: 8px;
	background: #b9c9fe;
	border-top: 4px solid #aabcfe;
	border-bottom: 1px solid #fff;
	color: #039;
}
#box-table-a td
{
	padding: 8px;
	background: #e8edff; 
	border-bottom: 1px solid #fff;
	color: #669;
	border-top: 1px solid transparent;
}
#box-table-a tr:hover td
{
	background: #d0dafd;
	color: #339;
}


#box-table-b
{
	font-family: "Lucida Sans Unicode", "Lucida Grande", Sans-Serif;
	font-size: 12px;
	margin: 45px;
	width: 480px;
	text-align: center;
	border-collapse: collapse;
	border-top: 7px solid #9baff1;
	border-bottom: 7px solid #9baff1;
}
#box-table-b th
{
	font-size: 13px;
	font-weight: normal;
	padding: 8px;
	background: #e8edff;
	border-right: 1px solid #9baff1;
	border-left: 1px solid #9baff1;
	color: #039;
}
#box-table-b td
{
	padding: 8px;
	background: #e8edff; 
	border-right: 1px solid #aabcfe;
	border-left: 1px solid #aabcfe;
	color: #669;
}


#hor-zebra
{
	font-family: "Lucida Sans Unicode", "Lucida Grande", Sans-Serif;
	font-size: 12px;
	margin: 45px;
	width: 480px;
	text-align: left;
	border-collapse: collapse;
}
#hor-zebra th
{
	font-size: 14px;
	font-weight: normal;
	padding: 10px 8px;
	color: #039;
}
#hor-zebra td
{
	padding: 8px;
	color: #669;
}
#hor-zebra .odd
{
	background: #e8edff; 
}


#ver-zebra
{
	font-family: "Lucida Sans Unicode", "Lucida Grande", Sans-Serif;
	font-size: 12px;
	margin: 45px;
	width: 480px;
	text-align: left;
	border-collapse: collapse;
}
#ver-zebra th
{
	font-size: 14px;
	font-weight: normal;
	padding: 12px 15px;
	border-right: 1px solid #fff;
	border-left: 1px solid #fff;
	color: #039;
}
#ver-zebra td
{
	padding: 8px 15px;
	border-right: 1px solid #fff;
	border-left: 1px solid #fff;
	color: #669;
}
.vzebra-odd
{
	background: #eff2ff;
}
.vzebra-even
{
	background: #e8edff;
}
#ver-zebra #vzebra-adventure, #ver-zebra #vzebra-children
{
	background: #d0dafd;
	border-bottom: 1px solid #c8d4fd;
}
#ver-zebra #vzebra-comedy, #ver-zebra #vzebra-action
{
	background: #dce4ff;
	border-bottom: 1px solid #d6dfff;
}


#one-column-emphasis
{
	font-family: "Lucida Sans Unicode", "Lucida Grande", Sans-Serif;
	font-size: 12px;
	margin: 45px;
	width: 480px;
	text-align: left;
	border-collapse: collapse;
}
#one-column-emphasis th
{
	font-size: 14px;
	font-weight: normal;
	padding: 12px 15px;
	color: #039;
}
#one-column-emphasis td
{
	padding: 10px 15px;
	color: #669;
	border-top: 1px solid #e8edff;
}
.oce-first
{
	background: #d0dafd;
	border-right: 10px solid transparent;
	border-left: 10px solid transparent;
}
#one-column-emphasis tr:hover td
{
	color: #339;
	background: #eff2ff;
}


#newspaper-a
{
	font-family: "Lucida Sans Unicode", "Lucida Grande", Sans-Serif;
	font-size: 12px;
	margin: 45px;
	width: 480px;
	text-align: left;
	border-collapse: collapse;
	border: 1px solid #69c;
}
#newspaper-a th
{
	padding: 12px 17px 12px 17px;
	font-weight: normal;
	font-size: 14px;
	color: #039;
	border-bottom: 1px dashed #69c;
}
#newspaper-a td
{
	padding: 7px 17px 7px 17px;
	color: #669;
}
#newspaper-a tbody tr:hover td
{
	color: #339;
	background: #d0dafd;
}


#newspaper-b
{
	font-family: "Lucida Sans Unicode", "Lucida Grande", Sans-Serif;
	font-size: 12px;
	margin: 45px;
	width: 480px;
	text-align: left;
	border-collapse: collapse;
	border: 1px solid #69c;
}
#newspaper-b th
{
	padding: 15px 10px 10px 10px;
	font-weight: normal;
	font-size: 14px;
	color: #039;
}
#newspaper-b tbody
{
	background: #e8edff;
}
#newspaper-b td
{
	padding: 10px;
	color: #669;
	border-top: 1px dashed #fff;
}
#newspaper-b tbody tr:hover td
{
	color: #339;
	background: #d0dafd;
}


#newspaper-c
{
	font-family: "Lucida Sans Unicode", "Lucida Grande", Sans-Serif;
	font-size: 12px;
	margin: 45px;
	width: 480px;
	text-align: left;
	border-collapse: collapse;
	border: 1px solid #6cf;
}
#newspaper-c th
{
	padding: 20px;
	font-weight: normal;
	font-size: 13px;
	color: #039;
	text-transform: uppercase;
	border-right: 1px solid #0865c2;
	border-top: 1px solid #0865c2;
	border-left: 1px solid #0865c2;
	border-bottom: 1px solid #fff;
}
#newspaper-c td
{
	padding: 10px 20px;
	color: #669;
	border-right: 1px dashed #6cf;
}


#rounded-corner
{
	font-family: "Lucida Sans Unicode", "Lucida Grande", Sans-Serif;
	font-size: 12px;
	margin: 45px;
	width: 480px;
	text-align: left;
	border-collapse: collapse;
}
#rounded-corner thead th.rounded-company
{
	background: #b9c9fe url('table-images/left.png') left -1px no-repeat;
}
#rounded-corner thead th.rounded-q4
{
	background: #b9c9fe url('table-images/right.png') right -1px no-repeat;
}
#rounded-corner th
{
	padding: 8px;
	font-weight: normal;
	font-size: 13px;
	color: #039;
	background: #b9c9fe;
}
#rounded-corner td
{
	padding: 8px;
	background: #e8edff;
	border-top: 1px solid #fff;
	color: #669;
}
#rounded-corner tfoot td.rounded-foot-left
{
	background: #e8edff url('table-images/botleft.png') left bottom no-repeat;
}
#rounded-corner tfoot td.rounded-foot-right
{
	background: #e8edff url('table-images/botright.png') right bottom no-repeat;
}
#rounded-corner tbody tr:hover td
{
	background: #d0dafd;
}


#background-image
{
	font-family: "Lucida Sans Unicode", "Lucida Grande", Sans-Serif;
	font-size: 12px;
	margin: 45px;
	width: 480px;
	text-align: left;
	border-collapse: collapse;
	background: url('table-images/blurry.jpg') 330px 59px no-repeat;
}
#background-image th
{
	padding: 12px;
	font-weight: normal;
	font-size: 14px;
	color: #339;
}
#background-image td
{
	padding: 9px 12px;
	color: #669;
	border-top: 1px solid #fff;
}
#background-image tfoot td
{
	font-size: 11px;
}
#background-image tbody td
{
	background: url('table-images/back.png');
}
#background-image tbody tr:hover td
{
	color: #339;
	background: none;
}


#gradient-style
{
	font-family: "Lucida Sans Unicode", "Lucida Grande", Sans-Serif;
	font-size: 12px;
	margin: 45px;
	width: 480px;
	text-align: left;
	border-collapse: collapse;
}
#gradient-style th
{
	font-size: 13px;
	font-weight: normal;
	padding: 8px;
	background: #b9c9fe url('table-images/gradhead.png') repeat-x;
	border-top: 2px solid #d3ddff;
	border-bottom: 1px solid #fff;
	color: #039;
}
#gradient-style td
{
	padding: 8px; 
	border-bottom: 1px solid #fff;
	color: #669;
	border-top: 1px solid #fff;
	background: #e8edff url('table-images/gradback.png') repeat-x;
}
#gradient-style tfoot tr td
{
	background: #e8edff;
	font-size: 12px;
	color: #99c;
}
#gradient-style tbody tr:hover td
{
	background: #d0dafd url('table-images/gradhover.png') repeat-x;
	color: #339;
}


#pattern-style-a
{
	font-family: "Lucida Sans Unicode", "Lucida Grande", Sans-Serif;
	font-size: 12px;
	margin: 45px;
	width: 480px;
	text-align: left;
	border-collapse: collapse;
	background: url('table-images/pattern.png');
}
#pattern-style-a thead tr
{
	background: url('table-images/pattern-head.png');
}
#pattern-style-a th
{
	font-size: 13px;
	font-weight: normal;
	padding: 8px;
	border-bottom: 1px solid #fff;
	color: #039;
}
#pattern-style-a td
{
	padding: 8px; 
	border-bottom: 1px solid #fff;
	color: #669;
	border-top: 1px solid transparent;
}
#pattern-style-a tbody tr:hover td
{
	color: #339;
	background: #fff;
}


#pattern-style-b
{
	font-family: "Lucida Sans Unicode", "Lucida Grande", Sans-Serif;
	font-size: 12px;
	margin: 45px;
	width: 480px;
	text-align: left;
	border-collapse: collapse;
	background: url('table-images/patternb.png');
}
#pattern-style-b thead tr
{
	background: url('table-images/patternb-head.png');
}
#pattern-style-b th
{
	font-size: 13px;
	font-weight: normal;
	padding: 8px;
	border-bottom: 1px solid #fff;
	color: #039;
}
#pattern-style-b td
{
	padding: 8px; 
	border-bottom: 1px solid #fff;
	color: #669;
	border-top: 1px solid transparent;
}
#pattern-style-b tbody tr:hover td
{
	color: #339;
	background: #cdcdee;
}

.ui-autocomplete {
    overflow-y: auto;
    /* prevent horizontal scrollbar */
    overflow-x: hidden;
}

/** Logs table **/

table.tbl-logs {
	border-collapse: collapse;
}

table.tbl-logs td {
	border-right: 1px solid;
	padding-right: 15px;
}

table.tbl-logs th {
	border-right: 1px solid;
	padding-right: 15px;
	text-align: center;
}

table.tbl-logs td:last-child {
	border-right: 0px;
	padding-right: 0px;
}

table.tbl-logs th:last-child {
	border-right: 0px;
	padding-right: 0px;
}

/** Change log table **/

table.tbl-changelog {
	border-collapse: collapse;
}

table.tbl-changelog thead tr:last-child th {
	border-bottom: 1px solid black;
}

table.tbl-changelog th,
table.tbl-changelog td {
	padding-right: 15px;
}

/** stylesheets/jquery-ui.min.css **/
/*! jQuery UI - v1.12.1 - 2017-02-02
* http://jqueryui.com
* Includes: draggable.css, core.css, resizable.css, selectable.css, sortable.css, accordion.css, autocomplete.css, menu.css, button.css, controlgroup.css, checkboxradio.css, datepicker.css, dialog.css, progressbar.css, selectmenu.css, slider.css, spinner.css, tabs.css, tooltip.css, theme.css
* To view and modify this theme, visit http://jqueryui.com/themeroller/?scope=&folderName=custom-theme&bgImgOpacityError=&bgImgOpacityHighlight=&bgImgOpacityActive=&bgImgOpacityHover=&bgImgOpacityDefault=&bgImgOpacityContent=&bgImgOpacityHeader=&cornerRadiusShadow=8px&offsetLeftShadow=0px&offsetTopShadow=0px&thicknessShadow=5px&opacityShadow=30&bgImgOpacityShadow=0&bgTextureShadow=flat&bgColorShadow=%23666666&opacityOverlay=30&bgImgOpacityOverlay=0&bgTextureOverlay=flat&bgColorOverlay=%23aaaaaa&iconColorError=%23cc0000&fcError=%235f3f3f&borderColorError=%23f1a899&bgTextureError=flat&bgColorError=%23fddfdf&iconColorHighlight=%23777620&fcHighlight=%23777620&borderColorHighlight=%23dad55e&bgTextureHighlight=flat&bgColorHighlight=%23fffa90&iconColorActive=%23ffffff&fcActive=%23ffffff&borderColorActive=%23003eff&bgTextureActive=flat&bgColorActive=%23007fff&iconColorHover=%23555555&fcHover=%232b2b2b&borderColorHover=%23cccccc&bgTextureHover=flat&bgColorHover=%23ededed&iconColorDefault=%23555555&fcDefault=%23454545&borderColorDefault=%23c5c5c5&bgTextureDefault=flat&bgColorDefault=%23f6f6f6&iconColorContent=%23444444&fcContent=%23333333&borderColorContent=%23dddddd&bgTextureContent=flat&bgColorContent=%23ffffff&iconColorHeader=%23444444&fcHeader=%23333333&borderColorHeader=%23dddddd&bgTextureHeader=flat&bgColorHeader=%23e9e9e9&cornerRadius=3px&fwDefault=normal&fsDefault=13.2px&ffDefault=Verdana%2C%20Arial%2C%20sans-serif
* Copyright jQuery Foundation and other contributors; Licensed MIT */

.ui-draggable-handle{-ms-touch-action:none;touch-action:none}.ui-helper-hidden{display:none}.ui-helper-hidden-accessible{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.ui-helper-reset{margin:0;padding:0;border:0;outline:0;line-height:1.3;text-decoration:none;font-size:100%;list-style:none}.ui-helper-clearfix:before,.ui-helper-clearfix:after{content:"";display:table;border-collapse:collapse}.ui-helper-clearfix:after{clear:both}.ui-helper-zfix{width:100%;height:100%;top:0;left:0;position:absolute;opacity:0;filter:Alpha(Opacity=0)}.ui-front{z-index:100}.ui-state-disabled{cursor:default!important;pointer-events:none}.ui-icon{display:inline-block;vertical-align:middle;margin-top:-.25em;position:relative;text-indent:-99999px;overflow:hidden;background-repeat:no-repeat}.ui-widget-icon-block{left:50%;margin-left:-8px;display:block}.ui-widget-overlay{position:fixed;top:0;left:0;width:100%;height:100%}.ui-resizable{position:relative}.ui-resizable-handle{position:absolute;font-size:0.1px;display:block;-ms-touch-action:none;touch-action:none}.ui-resizable-disabled .ui-resizable-handle,.ui-resizable-autohide .ui-resizable-handle{display:none}.ui-resizable-n{cursor:n-resize;height:7px;width:100%;top:-5px;left:0}.ui-resizable-s{cursor:s-resize;height:7px;width:100%;bottom:-5px;left:0}.ui-resizable-e{cursor:e-resize;width:7px;right:-5px;top:0;height:100%}.ui-resizable-w{cursor:w-resize;width:7px;left:-5px;top:0;height:100%}.ui-resizable-se{cursor:se-resize;width:12px;height:12px;right:1px;bottom:1px}.ui-resizable-sw{cursor:sw-resize;width:9px;height:9px;left:-5px;bottom:-5px}.ui-resizable-nw{cursor:nw-resize;width:9px;height:9px;left:-5px;top:-5px}.ui-resizable-ne{cursor:ne-resize;width:9px;height:9px;right:-5px;top:-5px}.ui-selectable{-ms-touch-action:none;touch-action:none}.ui-selectable-helper{position:absolute;z-index:100;border:1px dotted black}.ui-sortable-handle{-ms-touch-action:none;touch-action:none}.ui-accordion .ui-accordion-header{display:block;cursor:pointer;position:relative;margin:2px 0 0 0;padding:.5em .5em .5em .7em;font-size:100%}.ui-accordion .ui-accordion-content{padding:1em 2.2em;border-top:0;overflow:auto}.ui-autocomplete{position:absolute;top:0;left:0;cursor:default}.ui-menu{list-style:none;padding:0;margin:0;display:block;outline:0}.ui-menu .ui-menu{position:absolute}.ui-menu .ui-menu-item{margin:0;cursor:pointer;list-style-image:url("data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7")}.ui-menu .ui-menu-item-wrapper{position:relative;padding:3px 1em 3px .4em}.ui-menu .ui-menu-divider{margin:5px 0;height:0;font-size:0;line-height:0;border-width:1px 0 0 0}.ui-menu .ui-state-focus,.ui-menu .ui-state-active{margin:-1px}.ui-menu-icons{position:relative}.ui-menu-icons .ui-menu-item-wrapper{padding-left:2em}.ui-menu .ui-icon{position:absolute;top:0;bottom:0;left:.2em;margin:auto 0}.ui-menu .ui-menu-icon{left:auto;right:0}.ui-button{padding:.4em 1em;display:inline-block;position:relative;line-height:normal;margin-right:.1em;cursor:pointer;vertical-align:middle;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;overflow:visible}.ui-button,.ui-button:link,.ui-button:visited,.ui-button:hover,.ui-button:active{text-decoration:none}.ui-button-icon-only{width:2em;box-sizing:border-box;text-indent:-9999px;white-space:nowrap}input.ui-button.ui-button-icon-only{text-indent:0}.ui-button-icon-only .ui-icon{position:absolute;top:50%;left:50%;margin-top:-8px;margin-left:-8px}.ui-button.ui-icon-notext .ui-icon{padding:0;width:2.1em;height:2.1em;text-indent:-9999px;white-space:nowrap}input.ui-button.ui-icon-notext .ui-icon{width:auto;height:auto;text-indent:0;white-space:normal;padding:.4em 1em}input.ui-button::-moz-focus-inner,button.ui-button::-moz-focus-inner{border:0;padding:0}.ui-controlgroup{vertical-align:middle;display:inline-block}.ui-controlgroup > .ui-controlgroup-item{float:left;margin-left:0;margin-right:0}.ui-controlgroup > .ui-controlgroup-item:focus,.ui-controlgroup > .ui-controlgroup-item.ui-visual-focus{z-index:9999}.ui-controlgroup-vertical > .ui-controlgroup-item{display:block;float:none;width:100%;margin-top:0;margin-bottom:0;text-align:left}.ui-controlgroup-vertical .ui-controlgroup-item{box-sizing:border-box}.ui-controlgroup .ui-controlgroup-label{padding:.4em 1em}.ui-controlgroup .ui-controlgroup-label span{font-size:80%}.ui-controlgroup-horizontal .ui-controlgroup-label + .ui-controlgroup-item{border-left:none}.ui-controlgroup-vertical .ui-controlgroup-label + .ui-controlgroup-item{border-top:none}.ui-controlgroup-horizontal .ui-controlgroup-label.ui-widget-content{border-right:none}.ui-controlgroup-vertical .ui-controlgroup-label.ui-widget-content{border-bottom:none}.ui-controlgroup-vertical .ui-spinner-input{width:75%;width:calc( 100% - 2.4em )}.ui-controlgroup-vertical .ui-spinner .ui-spinner-up{border-top-style:solid}.ui-checkboxradio-label .ui-icon-background{box-shadow:inset 1px 1px 1px #ccc;border-radius:.12em;border:none}.ui-checkboxradio-radio-label .ui-icon-background{width:16px;height:16px;border-radius:1em;overflow:visible;border:none}.ui-checkboxradio-radio-label.ui-checkboxradio-checked .ui-icon,.ui-checkboxradio-radio-label.ui-checkboxradio-checked:hover .ui-icon{background-image:none;width:8px;height:8px;border-width:4px;border-style:solid}.ui-checkboxradio-disabled{pointer-events:none}.ui-datepicker{width:17em;padding:.2em .2em 0;display:none}.ui-datepicker .ui-datepicker-header{position:relative;padding:.2em 0}.ui-datepicker .ui-datepicker-prev,.ui-datepicker .ui-datepicker-next{position:absolute;top:2px;width:1.8em;height:1.8em}.ui-datepicker .ui-datepicker-prev-hover,.ui-datepicker .ui-datepicker-next-hover{top:1px}.ui-datepicker .ui-datepicker-prev{left:2px}.ui-datepicker .ui-datepicker-next{right:2px}.ui-datepicker .ui-datepicker-prev-hover{left:1px}.ui-datepicker .ui-datepicker-next-hover{right:1px}.ui-datepicker .ui-datepicker-prev span,.ui-datepicker .ui-datepicker-next span{display:block;position:absolute;left:50%;margin-left:-8px;top:50%;margin-top:-8px}.ui-datepicker .ui-datepicker-title{margin:0 2.3em;line-height:1.8em;text-align:center}.ui-datepicker .ui-datepicker-title select{font-size:1em;margin:1px 0}.ui-datepicker select.ui-datepicker-month,.ui-datepicker select.ui-datepicker-year{width:45%}.ui-datepicker table{width:100%;font-size:.9em;border-collapse:collapse;margin:0 0 .4em}.ui-datepicker th{padding:.7em .3em;text-align:center;font-weight:bold;border:0}.ui-datepicker td{border:0;padding:1px}.ui-datepicker td span,.ui-datepicker td a{display:block;padding:.2em;text-align:right;text-decoration:none}.ui-datepicker .ui-datepicker-buttonpane{background-image:none;margin:.7em 0 0 0;padding:0 .2em;border-left:0;border-right:0;border-bottom:0}.ui-datepicker .ui-datepicker-buttonpane button{float:right;margin:.5em .2em .4em;cursor:pointer;padding:.2em .6em .3em .6em;width:auto;overflow:visible}.ui-datepicker .ui-datepicker-buttonpane button.ui-datepicker-current{float:left}.ui-datepicker.ui-datepicker-multi{width:auto}.ui-datepicker-multi .ui-datepicker-group{float:left}.ui-datepicker-multi .ui-datepicker-group table{width:95%;margin:0 auto .4em}.ui-datepicker-multi-2 .ui-datepicker-group{width:50%}.ui-datepicker-multi-3 .ui-datepicker-group{width:33.3%}.ui-datepicker-multi-4 .ui-datepicker-group{width:25%}.ui-datepicker-multi .ui-datepicker-group-last .ui-datepicker-header,.ui-datepicker-multi .ui-datepicker-group-middle .ui-datepicker-header{border-left-width:0}.ui-datepicker-multi .ui-datepicker-buttonpane{clear:left}.ui-datepicker-row-break{clear:both;width:100%;font-size:0}.ui-datepicker-rtl{direction:rtl}.ui-datepicker-rtl .ui-datepicker-prev{right:2px;left:auto}.ui-datepicker-rtl .ui-datepicker-next{left:2px;right:auto}.ui-datepicker-rtl .ui-datepicker-prev:hover{right:1px;left:auto}.ui-datepicker-rtl .ui-datepicker-next:hover{left:1px;right:auto}.ui-datepicker-rtl .ui-datepicker-buttonpane{clear:right}.ui-datepicker-rtl .ui-datepicker-buttonpane button{float:left}.ui-datepicker-rtl .ui-datepicker-buttonpane button.ui-datepicker-current,.ui-datepicker-rtl .ui-datepicker-group{float:right}.ui-datepicker-rtl .ui-datepicker-group-last .ui-datepicker-header,.ui-datepicker-rtl .ui-datepicker-group-middle .ui-datepicker-header{border-right-width:0;border-left-width:1px}.ui-datepicker .ui-icon{display:block;text-indent:-99999px;overflow:hidden;background-repeat:no-repeat;left:.5em;top:.3em}.ui-dialog{position:absolute;top:0;left:0;padding:.2em;outline:0}.ui-dialog .ui-dialog-titlebar{padding:.4em 1em;position:relative}.ui-dialog .ui-dialog-title{float:left;margin:.1em 0;white-space:nowrap;width:90%;overflow:hidden;text-overflow:ellipsis}.ui-dialog .ui-dialog-titlebar-close{position:absolute;right:.3em;top:50%;width:20px;margin:-10px 0 0 0;padding:1px;height:20px}.ui-dialog .ui-dialog-content{position:relative;border:0;padding:.5em 1em;background:none;overflow:auto}.ui-dialog .ui-dialog-buttonpane{text-align:left;border-width:1px 0 0 0;background-image:none;margin-top:.5em;padding:.3em 1em .5em .4em}.ui-dialog .ui-dialog-buttonpane .ui-dialog-buttonset{float:right}.ui-dialog .ui-dialog-buttonpane button{margin:.5em .4em .5em 0;cursor:pointer}.ui-dialog .ui-resizable-n{height:2px;top:0}.ui-dialog .ui-resizable-e{width:2px;right:0}.ui-dialog .ui-resizable-s{height:2px;bottom:0}.ui-dialog .ui-resizable-w{width:2px;left:0}.ui-dialog .ui-resizable-se,.ui-dialog .ui-resizable-sw,.ui-dialog .ui-resizable-ne,.ui-dialog .ui-resizable-nw{width:7px;height:7px}.ui-dialog .ui-resizable-se{right:0;bottom:0}.ui-dialog .ui-resizable-sw{left:0;bottom:0}.ui-dialog .ui-resizable-ne{right:0;top:0}.ui-dialog .ui-resizable-nw{left:0;top:0}.ui-draggable .ui-dialog-titlebar{cursor:move}.ui-progressbar{height:2em;text-align:left;overflow:hidden}.ui-progressbar .ui-progressbar-value{margin:-1px;height:100%}.ui-progressbar .ui-progressbar-overlay{background:url("data:image/gif;base64,R0lGODlhKAAoAIABAAAAAP///yH/C05FVFNDQVBFMi4wAwEAAAAh+QQJAQABACwAAAAAKAAoAAACkYwNqXrdC52DS06a7MFZI+4FHBCKoDeWKXqymPqGqxvJrXZbMx7Ttc+w9XgU2FB3lOyQRWET2IFGiU9m1frDVpxZZc6bfHwv4c1YXP6k1Vdy292Fb6UkuvFtXpvWSzA+HycXJHUXiGYIiMg2R6W459gnWGfHNdjIqDWVqemH2ekpObkpOlppWUqZiqr6edqqWQAAIfkECQEAAQAsAAAAACgAKAAAApSMgZnGfaqcg1E2uuzDmmHUBR8Qil95hiPKqWn3aqtLsS18y7G1SzNeowWBENtQd+T1JktP05nzPTdJZlR6vUxNWWjV+vUWhWNkWFwxl9VpZRedYcflIOLafaa28XdsH/ynlcc1uPVDZxQIR0K25+cICCmoqCe5mGhZOfeYSUh5yJcJyrkZWWpaR8doJ2o4NYq62lAAACH5BAkBAAEALAAAAAAoACgAAAKVDI4Yy22ZnINRNqosw0Bv7i1gyHUkFj7oSaWlu3ovC8GxNso5fluz3qLVhBVeT/Lz7ZTHyxL5dDalQWPVOsQWtRnuwXaFTj9jVVh8pma9JjZ4zYSj5ZOyma7uuolffh+IR5aW97cHuBUXKGKXlKjn+DiHWMcYJah4N0lYCMlJOXipGRr5qdgoSTrqWSq6WFl2ypoaUAAAIfkECQEAAQAsAAAAACgAKAAAApaEb6HLgd/iO7FNWtcFWe+ufODGjRfoiJ2akShbueb0wtI50zm02pbvwfWEMWBQ1zKGlLIhskiEPm9R6vRXxV4ZzWT2yHOGpWMyorblKlNp8HmHEb/lCXjcW7bmtXP8Xt229OVWR1fod2eWqNfHuMjXCPkIGNileOiImVmCOEmoSfn3yXlJWmoHGhqp6ilYuWYpmTqKUgAAIfkECQEAAQAsAAAAACgAKAAAApiEH6kb58biQ3FNWtMFWW3eNVcojuFGfqnZqSebuS06w5V80/X02pKe8zFwP6EFWOT1lDFk8rGERh1TTNOocQ61Hm4Xm2VexUHpzjymViHrFbiELsefVrn6XKfnt2Q9G/+Xdie499XHd2g4h7ioOGhXGJboGAnXSBnoBwKYyfioubZJ2Hn0RuRZaflZOil56Zp6iioKSXpUAAAh+QQJAQABACwAAAAAKAAoAAACkoQRqRvnxuI7kU1a1UU5bd5tnSeOZXhmn5lWK3qNTWvRdQxP8qvaC+/yaYQzXO7BMvaUEmJRd3TsiMAgswmNYrSgZdYrTX6tSHGZO73ezuAw2uxuQ+BbeZfMxsexY35+/Qe4J1inV0g4x3WHuMhIl2jXOKT2Q+VU5fgoSUI52VfZyfkJGkha6jmY+aaYdirq+lQAACH5BAkBAAEALAAAAAAoACgAAAKWBIKpYe0L3YNKToqswUlvznigd4wiR4KhZrKt9Upqip61i9E3vMvxRdHlbEFiEXfk9YARYxOZZD6VQ2pUunBmtRXo1Lf8hMVVcNl8JafV38aM2/Fu5V16Bn63r6xt97j09+MXSFi4BniGFae3hzbH9+hYBzkpuUh5aZmHuanZOZgIuvbGiNeomCnaxxap2upaCZsq+1kAACH5BAkBAAEALAAAAAAoACgAAAKXjI8By5zf4kOxTVrXNVlv1X0d8IGZGKLnNpYtm8Lr9cqVeuOSvfOW79D9aDHizNhDJidFZhNydEahOaDH6nomtJjp1tutKoNWkvA6JqfRVLHU/QUfau9l2x7G54d1fl995xcIGAdXqMfBNadoYrhH+Mg2KBlpVpbluCiXmMnZ2Sh4GBqJ+ckIOqqJ6LmKSllZmsoq6wpQAAAh+QQJAQABACwAAAAAKAAoAAAClYx/oLvoxuJDkU1a1YUZbJ59nSd2ZXhWqbRa2/gF8Gu2DY3iqs7yrq+xBYEkYvFSM8aSSObE+ZgRl1BHFZNr7pRCavZ5BW2142hY3AN/zWtsmf12p9XxxFl2lpLn1rseztfXZjdIWIf2s5dItwjYKBgo9yg5pHgzJXTEeGlZuenpyPmpGQoKOWkYmSpaSnqKileI2FAAACH5BAkBAAEALAAAAAAoACgAAAKVjB+gu+jG4kORTVrVhRlsnn2dJ3ZleFaptFrb+CXmO9OozeL5VfP99HvAWhpiUdcwkpBH3825AwYdU8xTqlLGhtCosArKMpvfa1mMRae9VvWZfeB2XfPkeLmm18lUcBj+p5dnN8jXZ3YIGEhYuOUn45aoCDkp16hl5IjYJvjWKcnoGQpqyPlpOhr3aElaqrq56Bq7VAAAOw==");height:100%;filter:alpha(opacity=25);opacity:0.25}.ui-progressbar-indeterminate .ui-progressbar-value{background-image:none}.ui-selectmenu-menu{padding:0;margin:0;position:absolute;top:0;left:0;display:none}.ui-selectmenu-menu .ui-menu{overflow:auto;overflow-x:hidden;padding-bottom:1px}.ui-selectmenu-menu .ui-menu .ui-selectmenu-optgroup{font-size:1em;font-weight:bold;line-height:1.5;padding:2px 0.4em;margin:0.5em 0 0 0;height:auto;border:0}.ui-selectmenu-open{display:block}.ui-selectmenu-text{display:block;margin-right:20px;overflow:hidden;text-overflow:ellipsis}.ui-selectmenu-button.ui-button{text-align:left;white-space:nowrap;width:14em}.ui-selectmenu-icon.ui-icon{float:right;margin-top:0}.ui-slider{position:relative;text-align:left}.ui-slider .ui-slider-handle{position:absolute;z-index:2;width:1.2em;height:1.2em;cursor:default;-ms-touch-action:none;touch-action:none}.ui-slider .ui-slider-range{position:absolute;z-index:1;font-size:.7em;display:block;border:0;background-position:0 0}.ui-slider.ui-state-disabled .ui-slider-handle,.ui-slider.ui-state-disabled .ui-slider-range{filter:inherit}.ui-slider-horizontal{height:.8em}.ui-slider-horizontal .ui-slider-handle{top:-.3em;margin-left:-.6em}.ui-slider-horizontal .ui-slider-range{top:0;height:100%}.ui-slider-horizontal .ui-slider-range-min{left:0}.ui-slider-horizontal .ui-slider-range-max{right:0}.ui-slider-vertical{width:.8em;height:100px}.ui-slider-vertical .ui-slider-handle{left:-.3em;margin-left:0;margin-bottom:-.6em}.ui-slider-vertical .ui-slider-range{left:0;width:100%}.ui-slider-vertical .ui-slider-range-min{bottom:0}.ui-slider-vertical .ui-slider-range-max{top:0}.ui-spinner{position:relative;display:inline-block;overflow:hidden;padding:0;vertical-align:middle}.ui-spinner-input{border:none;background:none;color:inherit;padding:.222em 0;margin:.2em 0;vertical-align:middle;margin-left:.4em;margin-right:2em}.ui-spinner-button{width:1.6em;height:50%;font-size:.5em;padding:0;margin:0;text-align:center;position:absolute;cursor:default;display:block;overflow:hidden;right:0}.ui-spinner a.ui-spinner-button{border-top-style:none;border-bottom-style:none;border-right-style:none}.ui-spinner-up{top:0}.ui-spinner-down{bottom:0}.ui-tabs{position:relative;padding:.2em}.ui-tabs .ui-tabs-nav{margin:0;padding:.2em .2em 0}.ui-tabs .ui-tabs-nav li{list-style:none;float:left;position:relative;top:0;margin:1px .2em 0 0;border-bottom-width:0;padding:0;white-space:nowrap}.ui-tabs .ui-tabs-nav .ui-tabs-anchor{float:left;padding:.5em 1em;text-decoration:none}.ui-tabs .ui-tabs-nav li.ui-tabs-active{margin-bottom:-1px;padding-bottom:1px}.ui-tabs .ui-tabs-nav li.ui-tabs-active .ui-tabs-anchor,.ui-tabs .ui-tabs-nav li.ui-state-disabled .ui-tabs-anchor,.ui-tabs .ui-tabs-nav li.ui-tabs-loading .ui-tabs-anchor{cursor:text}.ui-tabs-collapsible .ui-tabs-nav li.ui-tabs-active .ui-tabs-anchor{cursor:pointer}.ui-tabs .ui-tabs-panel{display:block;border-width:0;padding:1em 1.4em;background:none}.ui-tooltip{padding:8px;position:absolute;z-index:9999;max-width:300px}body .ui-tooltip{border-width:2px}.ui-widget{font-family:Verdana,Arial,sans-serif;font-size:13.2px}.ui-widget .ui-widget{font-size:1em}.ui-widget input,.ui-widget select,.ui-widget textarea,.ui-widget button{font-family:Verdana,Arial,sans-serif;font-size:1em}.ui-widget.ui-widget-content{border:1px solid #c5c5c5}.ui-widget-content{border:1px solid #ddd;background:#fff;color:#333}.ui-widget-content a{color:#333}.ui-widget-header{border:1px solid #ddd;background:#e9e9e9;color:#333;font-weight:bold}.ui-widget-header a{color:#333}.ui-state-default,.ui-widget-content .ui-state-default,.ui-widget-header .ui-state-default,.ui-button,html .ui-button.ui-state-disabled:hover,html .ui-button.ui-state-disabled:active{border:1px solid #c5c5c5;background:#f6f6f6;font-weight:normal;color:#454545}.ui-state-default a,.ui-state-default a:link,.ui-state-default a:visited,a.ui-button,a:link.ui-button,a:visited.ui-button,.ui-button{color:#454545;text-decoration:none}.ui-state-hover,.ui-widget-content .ui-state-hover,.ui-widget-header .ui-state-hover,.ui-state-focus,.ui-widget-content .ui-state-focus,.ui-widget-header .ui-state-focus,.ui-button:hover,.ui-button:focus{border:1px solid #ccc;background:#ededed;font-weight:normal;color:#2b2b2b}.ui-state-hover a,.ui-state-hover a:hover,.ui-state-hover a:link,.ui-state-hover a:visited,.ui-state-focus a,.ui-state-focus a:hover,.ui-state-focus a:link,.ui-state-focus a:visited,a.ui-button:hover,a.ui-button:focus{color:#2b2b2b;text-decoration:none}.ui-visual-focus{box-shadow:0 0 3px 1px rgb(94,158,214)}.ui-state-active,.ui-widget-content .ui-state-active,.ui-widget-header .ui-state-active,a.ui-button:active,.ui-button:active,.ui-button.ui-state-active:hover{border:1px solid #003eff;background:#007fff;font-weight:normal;color:#fff}.ui-icon-background,.ui-state-active .ui-icon-background{border:#003eff;background-color:#fff}.ui-state-active a,.ui-state-active a:link,.ui-state-active a:visited{color:#fff;text-decoration:none}.ui-state-highlight,.ui-widget-content .ui-state-highlight,.ui-widget-header .ui-state-highlight{border:1px solid #dad55e;background:#fffa90;color:#777620}.ui-state-checked{border:1px solid #dad55e;background:#fffa90}.ui-state-highlight a,.ui-widget-content .ui-state-highlight a,.ui-widget-header .ui-state-highlight a{color:#777620}.ui-state-error,.ui-widget-content .ui-state-error,.ui-widget-header .ui-state-error{border:1px solid #f1a899;background:#fddfdf;color:#5f3f3f}.ui-state-error a,.ui-widget-content .ui-state-error a,.ui-widget-header .ui-state-error a{color:#5f3f3f}.ui-state-error-text,.ui-widget-content .ui-state-error-text,.ui-widget-header .ui-state-error-text{color:#5f3f3f}.ui-priority-primary,.ui-widget-content .ui-priority-primary,.ui-widget-header .ui-priority-primary{font-weight:bold}.ui-priority-secondary,.ui-widget-content .ui-priority-secondary,.ui-widget-header .ui-priority-secondary{opacity:.7;filter:Alpha(Opacity=70);font-weight:normal}.ui-state-disabled,.ui-widget-content .ui-state-disabled,.ui-widget-header .ui-state-disabled{opacity:.35;filter:Alpha(Opacity=35);background-image:none}.ui-state-disabled .ui-icon{filter:Alpha(Opacity=35)}.ui-icon{width:16px;height:16px}.ui-icon,.ui-widget-content .ui-icon{background-image:url("images/ui-icons_444444_256x240.png")}.ui-widget-header .ui-icon{background-image:url("images/ui-icons_444444_256x240.png")}.ui-state-hover .ui-icon,.ui-state-focus .ui-icon,.ui-button:hover .ui-icon,.ui-button:focus .ui-icon{background-image:url("images/ui-icons_555555_256x240.png")}.ui-state-active .ui-icon,.ui-button:active .ui-icon{background-image:url("images/ui-icons_ffffff_256x240.png")}.ui-state-highlight .ui-icon,.ui-button .ui-state-highlight.ui-icon{background-image:url("images/ui-icons_777620_256x240.png")}.ui-state-error .ui-icon,.ui-state-error-text .ui-icon{background-image:url("images/ui-icons_cc0000_256x240.png")}.ui-button .ui-icon{background-image:url("images/ui-icons_555555_256x240.png")}.ui-icon-blank{background-position:16px 16px}.ui-icon-caret-1-n{background-position:0 0}.ui-icon-caret-1-ne{background-position:-16px 0}.ui-icon-caret-1-e{background-position:-32px 0}.ui-icon-caret-1-se{background-position:-48px 0}.ui-icon-caret-1-s{background-position:-65px 0}.ui-icon-caret-1-sw{background-position:-80px 0}.ui-icon-caret-1-w{background-position:-96px 0}.ui-icon-caret-1-nw{background-position:-112px 0}.ui-icon-caret-2-n-s{background-position:-128px 0}.ui-icon-caret-2-e-w{background-position:-144px 0}.ui-icon-triangle-1-n{background-position:0 -16px}.ui-icon-triangle-1-ne{background-position:-16px -16px}.ui-icon-triangle-1-e{background-position:-32px -16px}.ui-icon-triangle-1-se{background-position:-48px -16px}.ui-icon-triangle-1-s{background-position:-65px -16px}.ui-icon-triangle-1-sw{background-position:-80px -16px}.ui-icon-triangle-1-w{background-position:-96px -16px}.ui-icon-triangle-1-nw{background-position:-112px -16px}.ui-icon-triangle-2-n-s{background-position:-128px -16px}.ui-icon-triangle-2-e-w{background-position:-144px -16px}.ui-icon-arrow-1-n{background-position:0 -32px}.ui-icon-arrow-1-ne{background-position:-16px -32px}.ui-icon-arrow-1-e{background-position:-32px -32px}.ui-icon-arrow-1-se{background-position:-48px -32px}.ui-icon-arrow-1-s{background-position:-65px -32px}.ui-icon-arrow-1-sw{background-position:-80px -32px}.ui-icon-arrow-1-w{background-position:-96px -32px}.ui-icon-arrow-1-nw{background-position:-112px -32px}.ui-icon-arrow-2-n-s{background-position:-128px -32px}.ui-icon-arrow-2-ne-sw{background-position:-144px -32px}.ui-icon-arrow-2-e-w{background-position:-160px -32px}.ui-icon-arrow-2-se-nw{background-position:-176px -32px}.ui-icon-arrowstop-1-n{background-position:-192px -32px}.ui-icon-arrowstop-1-e{background-position:-208px -32px}.ui-icon-arrowstop-1-s{background-position:-224px -32px}.ui-icon-arrowstop-1-w{background-position:-240px -32px}.ui-icon-arrowthick-1-n{background-position:1px -48px}.ui-icon-arrowthick-1-ne{background-position:-16px -48px}.ui-icon-arrowthick-1-e{background-position:-32px -48px}.ui-icon-arrowthick-1-se{background-position:-48px -48px}.ui-icon-arrowthick-1-s{background-position:-64px -48px}.ui-icon-arrowthick-1-sw{background-position:-80px -48px}.ui-icon-arrowthick-1-w{background-position:-96px -48px}.ui-icon-arrowthick-1-nw{background-position:-112px -48px}.ui-icon-arrowthick-2-n-s{background-position:-128px -48px}.ui-icon-arrowthick-2-ne-sw{background-position:-144px -48px}.ui-icon-arrowthick-2-e-w{background-position:-160px -48px}.ui-icon-arrowthick-2-se-nw{background-position:-176px -48px}.ui-icon-arrowthickstop-1-n{background-position:-192px -48px}.ui-icon-arrowthickstop-1-e{background-position:-208px -48px}.ui-icon-arrowthickstop-1-s{background-position:-224px -48px}.ui-icon-arrowthickstop-1-w{background-position:-240px -48px}.ui-icon-arrowreturnthick-1-w{background-position:0 -64px}.ui-icon-arrowreturnthick-1-n{background-position:-16px -64px}.ui-icon-arrowreturnthick-1-e{background-position:-32px -64px}.ui-icon-arrowreturnthick-1-s{background-position:-48px -64px}.ui-icon-arrowreturn-1-w{background-position:-64px -64px}.ui-icon-arrowreturn-1-n{background-position:-80px -64px}.ui-icon-arrowreturn-1-e{background-position:-96px -64px}.ui-icon-arrowreturn-1-s{background-position:-112px -64px}.ui-icon-arrowrefresh-1-w{background-position:-128px -64px}.ui-icon-arrowrefresh-1-n{background-position:-144px -64px}.ui-icon-arrowrefresh-1-e{background-position:-160px -64px}.ui-icon-arrowrefresh-1-s{background-position:-176px -64px}.ui-icon-arrow-4{background-position:0 -80px}.ui-icon-arrow-4-diag{background-position:-16px -80px}.ui-icon-extlink{background-position:-32px -80px}.ui-icon-newwin{background-position:-48px -80px}.ui-icon-refresh{background-position:-64px -80px}.ui-icon-shuffle{background-position:-80px -80px}.ui-icon-transfer-e-w{background-position:-96px -80px}.ui-icon-transferthick-e-w{background-position:-112px -80px}.ui-icon-folder-collapsed{background-position:0 -96px}.ui-icon-folder-open{background-position:-16px -96px}.ui-icon-document{background-position:-32px -96px}.ui-icon-document-b{background-position:-48px -96px}.ui-icon-note{background-position:-64px -96px}.ui-icon-mail-closed{background-position:-80px -96px}.ui-icon-mail-open{background-position:-96px -96px}.ui-icon-suitcase{background-position:-112px -96px}.ui-icon-comment{background-position:-128px -96px}.ui-icon-person{background-position:-144px -96px}.ui-icon-print{background-position:-160px -96px}.ui-icon-trash{background-position:-176px -96px}.ui-icon-locked{background-position:-192px -96px}.ui-icon-unlocked{background-position:-208px -96px}.ui-icon-bookmark{background-position:-224px -96px}.ui-icon-tag{background-position:-240px -96px}.ui-icon-home{background-position:0 -112px}.ui-icon-flag{background-position:-16px -112px}.ui-icon-calendar{background-position:-32px -112px}.ui-icon-cart{background-position:-48px -112px}.ui-icon-pencil{background-position:-64px -112px}.ui-icon-clock{background-position:-80px -112px}.ui-icon-disk{background-position:-96px -112px}.ui-icon-calculator{background-position:-112px -112px}.ui-icon-zoomin{background-position:-128px -112px}.ui-icon-zoomout{background-position:-144px -112px}.ui-icon-search{background-position:-160px -112px}.ui-icon-wrench{background-position:-176px -112px}.ui-icon-gear{background-position:-192px -112px}.ui-icon-heart{background-position:-208px -112px}.ui-icon-star{background-position:-224px -112px}.ui-icon-link{background-position:-240px -112px}.ui-icon-cancel{background-position:0 -128px}.ui-icon-plus{background-position:-16px -128px}.ui-icon-plusthick{background-position:-32px -128px}.ui-icon-minus{background-position:-48px -128px}.ui-icon-minusthick{background-position:-64px -128px}.ui-icon-close{background-position:-80px -128px}.ui-icon-closethick{background-position:-96px -128px}.ui-icon-key{background-position:-112px -128px}.ui-icon-lightbulb{background-position:-128px -128px}.ui-icon-scissors{background-position:-144px -128px}.ui-icon-clipboard{background-position:-160px -128px}.ui-icon-copy{background-position:-176px -128px}.ui-icon-contact{background-position:-192px -128px}.ui-icon-image{background-position:-208px -128px}.ui-icon-video{background-position:-224px -128px}.ui-icon-script{background-position:-240px -128px}.ui-icon-alert{background-position:0 -144px}.ui-icon-info{background-position:-16px -144px}.ui-icon-notice{background-position:-32px -144px}.ui-icon-help{background-position:-48px -144px}.ui-icon-check{background-position:-64px -144px}.ui-icon-bullet{background-position:-80px -144px}.ui-icon-radio-on{background-position:-96px -144px}.ui-icon-radio-off{background-position:-112px -144px}.ui-icon-pin-w{background-position:-128px -144px}.ui-icon-pin-s{background-position:-144px -144px}.ui-icon-play{background-position:0 -160px}.ui-icon-pause{background-position:-16px -160px}.ui-icon-seek-next{background-position:-32px -160px}.ui-icon-seek-prev{background-position:-48px -160px}.ui-icon-seek-end{background-position:-64px -160px}.ui-icon-seek-start{background-position:-80px -160px}.ui-icon-seek-first{background-position:-80px -160px}.ui-icon-stop{background-position:-96px -160px}.ui-icon-eject{background-position:-112px -160px}.ui-icon-volume-off{background-position:-128px -160px}.ui-icon-volume-on{background-position:-144px -160px}.ui-icon-power{background-position:0 -176px}.ui-icon-signal-diag{background-position:-16px -176px}.ui-icon-signal{background-position:-32px -176px}.ui-icon-battery-0{background-position:-48px -176px}.ui-icon-battery-1{background-position:-64px -176px}.ui-icon-battery-2{background-position:-80px -176px}.ui-icon-battery-3{background-position:-96px -176px}.ui-icon-circle-plus{background-position:0 -192px}.ui-icon-circle-minus{background-position:-16px -192px}.ui-icon-circle-close{background-position:-32px -192px}.ui-icon-circle-triangle-e{background-position:-48px -192px}.ui-icon-circle-triangle-s{background-position:-64px -192px}.ui-icon-circle-triangle-w{background-position:-80px -192px}.ui-icon-circle-triangle-n{background-position:-96px -192px}.ui-icon-circle-arrow-e{background-position:-112px -192px}.ui-icon-circle-arrow-s{background-position:-128px -192px}.ui-icon-circle-arrow-w{background-position:-144px -192px}.ui-icon-circle-arrow-n{background-position:-160px -192px}.ui-icon-circle-zoomin{background-position:-176px -192px}.ui-icon-circle-zoomout{background-position:-192px -192px}.ui-icon-circle-check{background-position:-208px -192px}.ui-icon-circlesmall-plus{background-position:0 -208px}.ui-icon-circlesmall-minus{background-position:-16px -208px}.ui-icon-circlesmall-close{background-position:-32px -208px}.ui-icon-squaresmall-plus{background-position:-48px -208px}.ui-icon-squaresmall-minus{background-position:-64px -208px}.ui-icon-squaresmall-close{background-position:-80px -208px}.ui-icon-grip-dotted-vertical{background-position:0 -224px}.ui-icon-grip-dotted-horizontal{background-position:-16px -224px}.ui-icon-grip-solid-vertical{background-position:-32px -224px}.ui-icon-grip-solid-horizontal{background-position:-48px -224px}.ui-icon-gripsmall-diagonal-se{background-position:-64px -224px}.ui-icon-grip-diagonal-se{background-position:-80px -224px}.ui-corner-all,.ui-corner-top,.ui-corner-left,.ui-corner-tl{border-top-left-radius:3px}.ui-corner-all,.ui-corner-top,.ui-corner-right,.ui-corner-tr{border-top-right-radius:3px}.ui-corner-all,.ui-corner-bottom,.ui-corner-left,.ui-corner-bl{border-bottom-left-radius:3px}.ui-corner-all,.ui-corner-bottom,.ui-corner-right,.ui-corner-br{border-bottom-right-radius:3px}.ui-widget-overlay{background:#aaa;opacity:.3;filter:Alpha(Opacity=30)}.ui-widget-shadow{-webkit-box-shadow:0 0 5px #666;box-shadow:0 0 5px #666}
/** stylesheets/jquery-ui.structure.min.css **/
/*! jQuery UI - v1.12.1 - 2017-02-02
* http://jqueryui.com
* Copyright jQuery Foundation and other contributors; Licensed MIT */

.ui-draggable-handle{-ms-touch-action:none;touch-action:none}.ui-helper-hidden{display:none}.ui-helper-hidden-accessible{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.ui-helper-reset{margin:0;padding:0;border:0;outline:0;line-height:1.3;text-decoration:none;font-size:100%;list-style:none}.ui-helper-clearfix:before,.ui-helper-clearfix:after{content:"";display:table;border-collapse:collapse}.ui-helper-clearfix:after{clear:both}.ui-helper-zfix{width:100%;height:100%;top:0;left:0;position:absolute;opacity:0;filter:Alpha(Opacity=0)}.ui-front{z-index:100}.ui-state-disabled{cursor:default!important;pointer-events:none}.ui-icon{display:inline-block;vertical-align:middle;margin-top:-.25em;position:relative;text-indent:-99999px;overflow:hidden;background-repeat:no-repeat}.ui-widget-icon-block{left:50%;margin-left:-8px;display:block}.ui-widget-overlay{position:fixed;top:0;left:0;width:100%;height:100%}.ui-resizable{position:relative}.ui-resizable-handle{position:absolute;font-size:0.1px;display:block;-ms-touch-action:none;touch-action:none}.ui-resizable-disabled .ui-resizable-handle,.ui-resizable-autohide .ui-resizable-handle{display:none}.ui-resizable-n{cursor:n-resize;height:7px;width:100%;top:-5px;left:0}.ui-resizable-s{cursor:s-resize;height:7px;width:100%;bottom:-5px;left:0}.ui-resizable-e{cursor:e-resize;width:7px;right:-5px;top:0;height:100%}.ui-resizable-w{cursor:w-resize;width:7px;left:-5px;top:0;height:100%}.ui-resizable-se{cursor:se-resize;width:12px;height:12px;right:1px;bottom:1px}.ui-resizable-sw{cursor:sw-resize;width:9px;height:9px;left:-5px;bottom:-5px}.ui-resizable-nw{cursor:nw-resize;width:9px;height:9px;left:-5px;top:-5px}.ui-resizable-ne{cursor:ne-resize;width:9px;height:9px;right:-5px;top:-5px}.ui-selectable{-ms-touch-action:none;touch-action:none}.ui-selectable-helper{position:absolute;z-index:100;border:1px dotted black}.ui-sortable-handle{-ms-touch-action:none;touch-action:none}.ui-accordion .ui-accordion-header{display:block;cursor:pointer;position:relative;margin:2px 0 0 0;padding:.5em .5em .5em .7em;font-size:100%}.ui-accordion .ui-accordion-content{padding:1em 2.2em;border-top:0;overflow:auto}.ui-autocomplete{position:absolute;top:0;left:0;cursor:default}.ui-menu{list-style:none;padding:0;margin:0;display:block;outline:0}.ui-menu .ui-menu{position:absolute}.ui-menu .ui-menu-item{margin:0;cursor:pointer;list-style-image:url("data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7")}.ui-menu .ui-menu-item-wrapper{position:relative;padding:3px 1em 3px .4em}.ui-menu .ui-menu-divider{margin:5px 0;height:0;font-size:0;line-height:0;border-width:1px 0 0 0}.ui-menu .ui-state-focus,.ui-menu .ui-state-active{margin:-1px}.ui-menu-icons{position:relative}.ui-menu-icons .ui-menu-item-wrapper{padding-left:2em}.ui-menu .ui-icon{position:absolute;top:0;bottom:0;left:.2em;margin:auto 0}.ui-menu .ui-menu-icon{left:auto;right:0}.ui-button{padding:.4em 1em;display:inline-block;position:relative;line-height:normal;margin-right:.1em;cursor:pointer;vertical-align:middle;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;overflow:visible}.ui-button,.ui-button:link,.ui-button:visited,.ui-button:hover,.ui-button:active{text-decoration:none}.ui-button-icon-only{width:2em;box-sizing:border-box;text-indent:-9999px;white-space:nowrap}input.ui-button.ui-button-icon-only{text-indent:0}.ui-button-icon-only .ui-icon{position:absolute;top:50%;left:50%;margin-top:-8px;margin-left:-8px}.ui-button.ui-icon-notext .ui-icon{padding:0;width:2.1em;height:2.1em;text-indent:-9999px;white-space:nowrap}input.ui-button.ui-icon-notext .ui-icon{width:auto;height:auto;text-indent:0;white-space:normal;padding:.4em 1em}input.ui-button::-moz-focus-inner,button.ui-button::-moz-focus-inner{border:0;padding:0}.ui-controlgroup{vertical-align:middle;display:inline-block}.ui-controlgroup > .ui-controlgroup-item{float:left;margin-left:0;margin-right:0}.ui-controlgroup > .ui-controlgroup-item:focus,.ui-controlgroup > .ui-controlgroup-item.ui-visual-focus{z-index:9999}.ui-controlgroup-vertical > .ui-controlgroup-item{display:block;float:none;width:100%;margin-top:0;margin-bottom:0;text-align:left}.ui-controlgroup-vertical .ui-controlgroup-item{box-sizing:border-box}.ui-controlgroup .ui-controlgroup-label{padding:.4em 1em}.ui-controlgroup .ui-controlgroup-label span{font-size:80%}.ui-controlgroup-horizontal .ui-controlgroup-label + .ui-controlgroup-item{border-left:none}.ui-controlgroup-vertical .ui-controlgroup-label + .ui-controlgroup-item{border-top:none}.ui-controlgroup-horizontal .ui-controlgroup-label.ui-widget-content{border-right:none}.ui-controlgroup-vertical .ui-controlgroup-label.ui-widget-content{border-bottom:none}.ui-controlgroup-vertical .ui-spinner-input{width:75%;width:calc( 100% - 2.4em )}.ui-controlgroup-vertical .ui-spinner .ui-spinner-up{border-top-style:solid}.ui-checkboxradio-label .ui-icon-background{box-shadow:inset 1px 1px 1px #ccc;border-radius:.12em;border:none}.ui-checkboxradio-radio-label .ui-icon-background{width:16px;height:16px;border-radius:1em;overflow:visible;border:none}.ui-checkboxradio-radio-label.ui-checkboxradio-checked .ui-icon,.ui-checkboxradio-radio-label.ui-checkboxradio-checked:hover .ui-icon{background-image:none;width:8px;height:8px;border-width:4px;border-style:solid}.ui-checkboxradio-disabled{pointer-events:none}.ui-datepicker{width:17em;padding:.2em .2em 0;display:none}.ui-datepicker .ui-datepicker-header{position:relative;padding:.2em 0}.ui-datepicker .ui-datepicker-prev,.ui-datepicker .ui-datepicker-next{position:absolute;top:2px;width:1.8em;height:1.8em}.ui-datepicker .ui-datepicker-prev-hover,.ui-datepicker .ui-datepicker-next-hover{top:1px}.ui-datepicker .ui-datepicker-prev{left:2px}.ui-datepicker .ui-datepicker-next{right:2px}.ui-datepicker .ui-datepicker-prev-hover{left:1px}.ui-datepicker .ui-datepicker-next-hover{right:1px}.ui-datepicker .ui-datepicker-prev span,.ui-datepicker .ui-datepicker-next span{display:block;position:absolute;left:50%;margin-left:-8px;top:50%;margin-top:-8px}.ui-datepicker .ui-datepicker-title{margin:0 2.3em;line-height:1.8em;text-align:center}.ui-datepicker .ui-datepicker-title select{font-size:1em;margin:1px 0}.ui-datepicker select.ui-datepicker-month,.ui-datepicker select.ui-datepicker-year{width:45%}.ui-datepicker table{width:100%;font-size:.9em;border-collapse:collapse;margin:0 0 .4em}.ui-datepicker th{padding:.7em .3em;text-align:center;font-weight:bold;border:0}.ui-datepicker td{border:0;padding:1px}.ui-datepicker td span,.ui-datepicker td a{display:block;padding:.2em;text-align:right;text-decoration:none}.ui-datepicker .ui-datepicker-buttonpane{background-image:none;margin:.7em 0 0 0;padding:0 .2em;border-left:0;border-right:0;border-bottom:0}.ui-datepicker .ui-datepicker-buttonpane button{float:right;margin:.5em .2em .4em;cursor:pointer;padding:.2em .6em .3em .6em;width:auto;overflow:visible}.ui-datepicker .ui-datepicker-buttonpane button.ui-datepicker-current{float:left}.ui-datepicker.ui-datepicker-multi{width:auto}.ui-datepicker-multi .ui-datepicker-group{float:left}.ui-datepicker-multi .ui-datepicker-group table{width:95%;margin:0 auto .4em}.ui-datepicker-multi-2 .ui-datepicker-group{width:50%}.ui-datepicker-multi-3 .ui-datepicker-group{width:33.3%}.ui-datepicker-multi-4 .ui-datepicker-group{width:25%}.ui-datepicker-multi .ui-datepicker-group-last .ui-datepicker-header,.ui-datepicker-multi .ui-datepicker-group-middle .ui-datepicker-header{border-left-width:0}.ui-datepicker-multi .ui-datepicker-buttonpane{clear:left}.ui-datepicker-row-break{clear:both;width:100%;font-size:0}.ui-datepicker-rtl{direction:rtl}.ui-datepicker-rtl .ui-datepicker-prev{right:2px;left:auto}.ui-datepicker-rtl .ui-datepicker-next{left:2px;right:auto}.ui-datepicker-rtl .ui-datepicker-prev:hover{right:1px;left:auto}.ui-datepicker-rtl .ui-datepicker-next:hover{left:1px;right:auto}.ui-datepicker-rtl .ui-datepicker-buttonpane{clear:right}.ui-datepicker-rtl .ui-datepicker-buttonpane button{float:left}.ui-datepicker-rtl .ui-datepicker-buttonpane button.ui-datepicker-current,.ui-datepicker-rtl .ui-datepicker-group{float:right}.ui-datepicker-rtl .ui-datepicker-group-last .ui-datepicker-header,.ui-datepicker-rtl .ui-datepicker-group-middle .ui-datepicker-header{border-right-width:0;border-left-width:1px}.ui-datepicker .ui-icon{display:block;text-indent:-99999px;overflow:hidden;background-repeat:no-repeat;left:.5em;top:.3em}.ui-dialog{position:absolute;top:0;left:0;padding:.2em;outline:0}.ui-dialog .ui-dialog-titlebar{padding:.4em 1em;position:relative}.ui-dialog .ui-dialog-title{float:left;margin:.1em 0;white-space:nowrap;width:90%;overflow:hidden;text-overflow:ellipsis}.ui-dialog .ui-dialog-titlebar-close{position:absolute;right:.3em;top:50%;width:20px;margin:-10px 0 0 0;padding:1px;height:20px}.ui-dialog .ui-dialog-content{position:relative;border:0;padding:.5em 1em;background:none;overflow:auto}.ui-dialog .ui-dialog-buttonpane{text-align:left;border-width:1px 0 0 0;background-image:none;margin-top:.5em;padding:.3em 1em .5em .4em}.ui-dialog .ui-dialog-buttonpane .ui-dialog-buttonset{float:right}.ui-dialog .ui-dialog-buttonpane button{margin:.5em .4em .5em 0;cursor:pointer}.ui-dialog .ui-resizable-n{height:2px;top:0}.ui-dialog .ui-resizable-e{width:2px;right:0}.ui-dialog .ui-resizable-s{height:2px;bottom:0}.ui-dialog .ui-resizable-w{width:2px;left:0}.ui-dialog .ui-resizable-se,.ui-dialog .ui-resizable-sw,.ui-dialog .ui-resizable-ne,.ui-dialog .ui-resizable-nw{width:7px;height:7px}.ui-dialog .ui-resizable-se{right:0;bottom:0}.ui-dialog .ui-resizable-sw{left:0;bottom:0}.ui-dialog .ui-resizable-ne{right:0;top:0}.ui-dialog .ui-resizable-nw{left:0;top:0}.ui-draggable .ui-dialog-titlebar{cursor:move}.ui-progressbar{height:2em;text-align:left;overflow:hidden}.ui-progressbar .ui-progressbar-value{margin:-1px;height:100%}.ui-progressbar .ui-progressbar-overlay{background:url("data:image/gif;base64,R0lGODlhKAAoAIABAAAAAP///yH/C05FVFNDQVBFMi4wAwEAAAAh+QQJAQABACwAAAAAKAAoAAACkYwNqXrdC52DS06a7MFZI+4FHBCKoDeWKXqymPqGqxvJrXZbMx7Ttc+w9XgU2FB3lOyQRWET2IFGiU9m1frDVpxZZc6bfHwv4c1YXP6k1Vdy292Fb6UkuvFtXpvWSzA+HycXJHUXiGYIiMg2R6W459gnWGfHNdjIqDWVqemH2ekpObkpOlppWUqZiqr6edqqWQAAIfkECQEAAQAsAAAAACgAKAAAApSMgZnGfaqcg1E2uuzDmmHUBR8Qil95hiPKqWn3aqtLsS18y7G1SzNeowWBENtQd+T1JktP05nzPTdJZlR6vUxNWWjV+vUWhWNkWFwxl9VpZRedYcflIOLafaa28XdsH/ynlcc1uPVDZxQIR0K25+cICCmoqCe5mGhZOfeYSUh5yJcJyrkZWWpaR8doJ2o4NYq62lAAACH5BAkBAAEALAAAAAAoACgAAAKVDI4Yy22ZnINRNqosw0Bv7i1gyHUkFj7oSaWlu3ovC8GxNso5fluz3qLVhBVeT/Lz7ZTHyxL5dDalQWPVOsQWtRnuwXaFTj9jVVh8pma9JjZ4zYSj5ZOyma7uuolffh+IR5aW97cHuBUXKGKXlKjn+DiHWMcYJah4N0lYCMlJOXipGRr5qdgoSTrqWSq6WFl2ypoaUAAAIfkECQEAAQAsAAAAACgAKAAAApaEb6HLgd/iO7FNWtcFWe+ufODGjRfoiJ2akShbueb0wtI50zm02pbvwfWEMWBQ1zKGlLIhskiEPm9R6vRXxV4ZzWT2yHOGpWMyorblKlNp8HmHEb/lCXjcW7bmtXP8Xt229OVWR1fod2eWqNfHuMjXCPkIGNileOiImVmCOEmoSfn3yXlJWmoHGhqp6ilYuWYpmTqKUgAAIfkECQEAAQAsAAAAACgAKAAAApiEH6kb58biQ3FNWtMFWW3eNVcojuFGfqnZqSebuS06w5V80/X02pKe8zFwP6EFWOT1lDFk8rGERh1TTNOocQ61Hm4Xm2VexUHpzjymViHrFbiELsefVrn6XKfnt2Q9G/+Xdie499XHd2g4h7ioOGhXGJboGAnXSBnoBwKYyfioubZJ2Hn0RuRZaflZOil56Zp6iioKSXpUAAAh+QQJAQABACwAAAAAKAAoAAACkoQRqRvnxuI7kU1a1UU5bd5tnSeOZXhmn5lWK3qNTWvRdQxP8qvaC+/yaYQzXO7BMvaUEmJRd3TsiMAgswmNYrSgZdYrTX6tSHGZO73ezuAw2uxuQ+BbeZfMxsexY35+/Qe4J1inV0g4x3WHuMhIl2jXOKT2Q+VU5fgoSUI52VfZyfkJGkha6jmY+aaYdirq+lQAACH5BAkBAAEALAAAAAAoACgAAAKWBIKpYe0L3YNKToqswUlvznigd4wiR4KhZrKt9Upqip61i9E3vMvxRdHlbEFiEXfk9YARYxOZZD6VQ2pUunBmtRXo1Lf8hMVVcNl8JafV38aM2/Fu5V16Bn63r6xt97j09+MXSFi4BniGFae3hzbH9+hYBzkpuUh5aZmHuanZOZgIuvbGiNeomCnaxxap2upaCZsq+1kAACH5BAkBAAEALAAAAAAoACgAAAKXjI8By5zf4kOxTVrXNVlv1X0d8IGZGKLnNpYtm8Lr9cqVeuOSvfOW79D9aDHizNhDJidFZhNydEahOaDH6nomtJjp1tutKoNWkvA6JqfRVLHU/QUfau9l2x7G54d1fl995xcIGAdXqMfBNadoYrhH+Mg2KBlpVpbluCiXmMnZ2Sh4GBqJ+ckIOqqJ6LmKSllZmsoq6wpQAAAh+QQJAQABACwAAAAAKAAoAAAClYx/oLvoxuJDkU1a1YUZbJ59nSd2ZXhWqbRa2/gF8Gu2DY3iqs7yrq+xBYEkYvFSM8aSSObE+ZgRl1BHFZNr7pRCavZ5BW2142hY3AN/zWtsmf12p9XxxFl2lpLn1rseztfXZjdIWIf2s5dItwjYKBgo9yg5pHgzJXTEeGlZuenpyPmpGQoKOWkYmSpaSnqKileI2FAAACH5BAkBAAEALAAAAAAoACgAAAKVjB+gu+jG4kORTVrVhRlsnn2dJ3ZleFaptFrb+CXmO9OozeL5VfP99HvAWhpiUdcwkpBH3825AwYdU8xTqlLGhtCosArKMpvfa1mMRae9VvWZfeB2XfPkeLmm18lUcBj+p5dnN8jXZ3YIGEhYuOUn45aoCDkp16hl5IjYJvjWKcnoGQpqyPlpOhr3aElaqrq56Bq7VAAAOw==");height:100%;filter:alpha(opacity=25);opacity:0.25}.ui-progressbar-indeterminate .ui-progressbar-value{background-image:none}.ui-selectmenu-menu{padding:0;margin:0;position:absolute;top:0;left:0;display:none}.ui-selectmenu-menu .ui-menu{overflow:auto;overflow-x:hidden;padding-bottom:1px}.ui-selectmenu-menu .ui-menu .ui-selectmenu-optgroup{font-size:1em;font-weight:bold;line-height:1.5;padding:2px 0.4em;margin:0.5em 0 0 0;height:auto;border:0}.ui-selectmenu-open{display:block}.ui-selectmenu-text{display:block;margin-right:20px;overflow:hidden;text-overflow:ellipsis}.ui-selectmenu-button.ui-button{text-align:left;white-space:nowrap;width:14em}.ui-selectmenu-icon.ui-icon{float:right;margin-top:0}.ui-slider{position:relative;text-align:left}.ui-slider .ui-slider-handle{position:absolute;z-index:2;width:1.2em;height:1.2em;cursor:default;-ms-touch-action:none;touch-action:none}.ui-slider .ui-slider-range{position:absolute;z-index:1;font-size:.7em;display:block;border:0;background-position:0 0}.ui-slider.ui-state-disabled .ui-slider-handle,.ui-slider.ui-state-disabled .ui-slider-range{filter:inherit}.ui-slider-horizontal{height:.8em}.ui-slider-horizontal .ui-slider-handle{top:-.3em;margin-left:-.6em}.ui-slider-horizontal .ui-slider-range{top:0;height:100%}.ui-slider-horizontal .ui-slider-range-min{left:0}.ui-slider-horizontal .ui-slider-range-max{right:0}.ui-slider-vertical{width:.8em;height:100px}.ui-slider-vertical .ui-slider-handle{left:-.3em;margin-left:0;margin-bottom:-.6em}.ui-slider-vertical .ui-slider-range{left:0;width:100%}.ui-slider-vertical .ui-slider-range-min{bottom:0}.ui-slider-vertical .ui-slider-range-max{top:0}.ui-spinner{position:relative;display:inline-block;overflow:hidden;padding:0;vertical-align:middle}.ui-spinner-input{border:none;background:none;color:inherit;padding:.222em 0;margin:.2em 0;vertical-align:middle;margin-left:.4em;margin-right:2em}.ui-spinner-button{width:1.6em;height:50%;font-size:.5em;padding:0;margin:0;text-align:center;position:absolute;cursor:default;display:block;overflow:hidden;right:0}.ui-spinner a.ui-spinner-button{border-top-style:none;border-bottom-style:none;border-right-style:none}.ui-spinner-up{top:0}.ui-spinner-down{bottom:0}.ui-tabs{position:relative;padding:.2em}.ui-tabs .ui-tabs-nav{margin:0;padding:.2em .2em 0}.ui-tabs .ui-tabs-nav li{list-style:none;float:left;position:relative;top:0;margin:1px .2em 0 0;border-bottom-width:0;padding:0;white-space:nowrap}.ui-tabs .ui-tabs-nav .ui-tabs-anchor{float:left;padding:.5em 1em;text-decoration:none}.ui-tabs .ui-tabs-nav li.ui-tabs-active{margin-bottom:-1px;padding-bottom:1px}.ui-tabs .ui-tabs-nav li.ui-tabs-active .ui-tabs-anchor,.ui-tabs .ui-tabs-nav li.ui-state-disabled .ui-tabs-anchor,.ui-tabs .ui-tabs-nav li.ui-tabs-loading .ui-tabs-anchor{cursor:text}.ui-tabs-collapsible .ui-tabs-nav li.ui-tabs-active .ui-tabs-anchor{cursor:pointer}.ui-tabs .ui-tabs-panel{display:block;border-width:0;padding:1em 1.4em;background:none}.ui-tooltip{padding:8px;position:absolute;z-index:9999;max-width:300px}body .ui-tooltip{border-width:2px}
/** stylesheets/jquery-ui.theme.min.css **/
/*! jQuery UI - v1.12.1 - 2017-02-02
* http://jqueryui.com
* Copyright jQuery Foundation and other contributors; Licensed MIT */

.ui-widget{font-family:Verdana,Arial,sans-serif;font-size:13.2px}.ui-widget .ui-widget{font-size:1em}.ui-widget input,.ui-widget select,.ui-widget textarea,.ui-widget button{font-family:Verdana,Arial,sans-serif;font-size:1em}.ui-widget.ui-widget-content{border:1px solid #c5c5c5}.ui-widget-content{border:1px solid #ddd;background:#fff;color:#333}.ui-widget-content a{color:#333}.ui-widget-header{border:1px solid #ddd;background:#e9e9e9;color:#333;font-weight:bold}.ui-widget-header a{color:#333}.ui-state-default,.ui-widget-content .ui-state-default,.ui-widget-header .ui-state-default,.ui-button,html .ui-button.ui-state-disabled:hover,html .ui-button.ui-state-disabled:active{border:1px solid #c5c5c5;background:#f6f6f6;font-weight:normal;color:#454545}.ui-state-default a,.ui-state-default a:link,.ui-state-default a:visited,a.ui-button,a:link.ui-button,a:visited.ui-button,.ui-button{color:#454545;text-decoration:none}.ui-state-hover,.ui-widget-content .ui-state-hover,.ui-widget-header .ui-state-hover,.ui-state-focus,.ui-widget-content .ui-state-focus,.ui-widget-header .ui-state-focus,.ui-button:hover,.ui-button:focus{border:1px solid #ccc;background:#ededed;font-weight:normal;color:#2b2b2b}.ui-state-hover a,.ui-state-hover a:hover,.ui-state-hover a:link,.ui-state-hover a:visited,.ui-state-focus a,.ui-state-focus a:hover,.ui-state-focus a:link,.ui-state-focus a:visited,a.ui-button:hover,a.ui-button:focus{color:#2b2b2b;text-decoration:none}.ui-visual-focus{box-shadow:0 0 3px 1px rgb(94,158,214)}.ui-state-active,.ui-widget-content .ui-state-active,.ui-widget-header .ui-state-active,a.ui-button:active,.ui-button:active,.ui-button.ui-state-active:hover{border:1px solid #003eff;background:#007fff;font-weight:normal;color:#fff}.ui-icon-background,.ui-state-active .ui-icon-background{border:#003eff;background-color:#fff}.ui-state-active a,.ui-state-active a:link,.ui-state-active a:visited{color:#fff;text-decoration:none}.ui-state-highlight,.ui-widget-content .ui-state-highlight,.ui-widget-header .ui-state-highlight{border:1px solid #dad55e;background:#fffa90;color:#777620}.ui-state-checked{border:1px solid #dad55e;background:#fffa90}.ui-state-highlight a,.ui-widget-content .ui-state-highlight a,.ui-widget-header .ui-state-highlight a{color:#777620}.ui-state-error,.ui-widget-content .ui-state-error,.ui-widget-header .ui-state-error{border:1px solid #f1a899;background:#fddfdf;color:#5f3f3f}.ui-state-error a,.ui-widget-content .ui-state-error a,.ui-widget-header .ui-state-error a{color:#5f3f3f}.ui-state-error-text,.ui-widget-content .ui-state-error-text,.ui-widget-header .ui-state-error-text{color:#5f3f3f}.ui-priority-primary,.ui-widget-content .ui-priority-primary,.ui-widget-header .ui-priority-primary{font-weight:bold}.ui-priority-secondary,.ui-widget-content .ui-priority-secondary,.ui-widget-header .ui-priority-secondary{opacity:.7;filter:Alpha(Opacity=70);font-weight:normal}.ui-state-disabled,.ui-widget-content .ui-state-disabled,.ui-widget-header .ui-state-disabled{opacity:.35;filter:Alpha(Opacity=35);background-image:none}.ui-state-disabled .ui-icon{filter:Alpha(Opacity=35)}.ui-icon{width:16px;height:16px}.ui-icon,.ui-widget-content .ui-icon{background-image:url("images/ui-icons_444444_256x240.png")}.ui-widget-header .ui-icon{background-image:url("images/ui-icons_444444_256x240.png")}.ui-state-hover .ui-icon,.ui-state-focus .ui-icon,.ui-button:hover .ui-icon,.ui-button:focus .ui-icon{background-image:url("images/ui-icons_555555_256x240.png")}.ui-state-active .ui-icon,.ui-button:active .ui-icon{background-image:url("images/ui-icons_ffffff_256x240.png")}.ui-state-highlight .ui-icon,.ui-button .ui-state-highlight.ui-icon{background-image:url("images/ui-icons_777620_256x240.png")}.ui-state-error .ui-icon,.ui-state-error-text .ui-icon{background-image:url("images/ui-icons_cc0000_256x240.png")}.ui-button .ui-icon{background-image:url("images/ui-icons_555555_256x240.png")}.ui-icon-blank{background-position:16px 16px}.ui-icon-caret-1-n{background-position:0 0}.ui-icon-caret-1-ne{background-position:-16px 0}.ui-icon-caret-1-e{background-position:-32px 0}.ui-icon-caret-1-se{background-position:-48px 0}.ui-icon-caret-1-s{background-position:-65px 0}.ui-icon-caret-1-sw{background-position:-80px 0}.ui-icon-caret-1-w{background-position:-96px 0}.ui-icon-caret-1-nw{background-position:-112px 0}.ui-icon-caret-2-n-s{background-position:-128px 0}.ui-icon-caret-2-e-w{background-position:-144px 0}.ui-icon-triangle-1-n{background-position:0 -16px}.ui-icon-triangle-1-ne{background-position:-16px -16px}.ui-icon-triangle-1-e{background-position:-32px -16px}.ui-icon-triangle-1-se{background-position:-48px -16px}.ui-icon-triangle-1-s{background-position:-65px -16px}.ui-icon-triangle-1-sw{background-position:-80px -16px}.ui-icon-triangle-1-w{background-position:-96px -16px}.ui-icon-triangle-1-nw{background-position:-112px -16px}.ui-icon-triangle-2-n-s{background-position:-128px -16px}.ui-icon-triangle-2-e-w{background-position:-144px -16px}.ui-icon-arrow-1-n{background-position:0 -32px}.ui-icon-arrow-1-ne{background-position:-16px -32px}.ui-icon-arrow-1-e{background-position:-32px -32px}.ui-icon-arrow-1-se{background-position:-48px -32px}.ui-icon-arrow-1-s{background-position:-65px -32px}.ui-icon-arrow-1-sw{background-position:-80px -32px}.ui-icon-arrow-1-w{background-position:-96px -32px}.ui-icon-arrow-1-nw{background-position:-112px -32px}.ui-icon-arrow-2-n-s{background-position:-128px -32px}.ui-icon-arrow-2-ne-sw{background-position:-144px -32px}.ui-icon-arrow-2-e-w{background-position:-160px -32px}.ui-icon-arrow-2-se-nw{background-position:-176px -32px}.ui-icon-arrowstop-1-n{background-position:-192px -32px}.ui-icon-arrowstop-1-e{background-position:-208px -32px}.ui-icon-arrowstop-1-s{background-position:-224px -32px}.ui-icon-arrowstop-1-w{background-position:-240px -32px}.ui-icon-arrowthick-1-n{background-position:1px -48px}.ui-icon-arrowthick-1-ne{background-position:-16px -48px}.ui-icon-arrowthick-1-e{background-position:-32px -48px}.ui-icon-arrowthick-1-se{background-position:-48px -48px}.ui-icon-arrowthick-1-s{background-position:-64px -48px}.ui-icon-arrowthick-1-sw{background-position:-80px -48px}.ui-icon-arrowthick-1-w{background-position:-96px -48px}.ui-icon-arrowthick-1-nw{background-position:-112px -48px}.ui-icon-arrowthick-2-n-s{background-position:-128px -48px}.ui-icon-arrowthick-2-ne-sw{background-position:-144px -48px}.ui-icon-arrowthick-2-e-w{background-position:-160px -48px}.ui-icon-arrowthick-2-se-nw{background-position:-176px -48px}.ui-icon-arrowthickstop-1-n{background-position:-192px -48px}.ui-icon-arrowthickstop-1-e{background-position:-208px -48px}.ui-icon-arrowthickstop-1-s{background-position:-224px -48px}.ui-icon-arrowthickstop-1-w{background-position:-240px -48px}.ui-icon-arrowreturnthick-1-w{background-position:0 -64px}.ui-icon-arrowreturnthick-1-n{background-position:-16px -64px}.ui-icon-arrowreturnthick-1-e{background-position:-32px -64px}.ui-icon-arrowreturnthick-1-s{background-position:-48px -64px}.ui-icon-arrowreturn-1-w{background-position:-64px -64px}.ui-icon-arrowreturn-1-n{background-position:-80px -64px}.ui-icon-arrowreturn-1-e{background-position:-96px -64px}.ui-icon-arrowreturn-1-s{background-position:-112px -64px}.ui-icon-arrowrefresh-1-w{background-position:-128px -64px}.ui-icon-arrowrefresh-1-n{background-position:-144px -64px}.ui-icon-arrowrefresh-1-e{background-position:-160px -64px}.ui-icon-arrowrefresh-1-s{background-position:-176px -64px}.ui-icon-arrow-4{background-position:0 -80px}.ui-icon-arrow-4-diag{background-position:-16px -80px}.ui-icon-extlink{background-position:-32px -80px}.ui-icon-newwin{background-position:-48px -80px}.ui-icon-refresh{background-position:-64px -80px}.ui-icon-shuffle{background-position:-80px -80px}.ui-icon-transfer-e-w{background-position:-96px -80px}.ui-icon-transferthick-e-w{background-position:-112px -80px}.ui-icon-folder-collapsed{background-position:0 -96px}.ui-icon-folder-open{background-position:-16px -96px}.ui-icon-document{background-position:-32px -96px}.ui-icon-document-b{background-position:-48px -96px}.ui-icon-note{background-position:-64px -96px}.ui-icon-mail-closed{background-position:-80px -96px}.ui-icon-mail-open{background-position:-96px -96px}.ui-icon-suitcase{background-position:-112px -96px}.ui-icon-comment{background-position:-128px -96px}.ui-icon-person{background-position:-144px -96px}.ui-icon-print{background-position:-160px -96px}.ui-icon-trash{background-position:-176px -96px}.ui-icon-locked{background-position:-192px -96px}.ui-icon-unlocked{background-position:-208px -96px}.ui-icon-bookmark{background-position:-224px -96px}.ui-icon-tag{background-position:-240px -96px}.ui-icon-home{background-position:0 -112px}.ui-icon-flag{background-position:-16px -112px}.ui-icon-calendar{background-position:-32px -112px}.ui-icon-cart{background-position:-48px -112px}.ui-icon-pencil{background-position:-64px -112px}.ui-icon-clock{background-position:-80px -112px}.ui-icon-disk{background-position:-96px -112px}.ui-icon-calculator{background-position:-112px -112px}.ui-icon-zoomin{background-position:-128px -112px}.ui-icon-zoomout{background-position:-144px -112px}.ui-icon-search{background-position:-160px -112px}.ui-icon-wrench{background-position:-176px -112px}.ui-icon-gear{background-position:-192px -112px}.ui-icon-heart{background-position:-208px -112px}.ui-icon-star{background-position:-224px -112px}.ui-icon-link{background-position:-240px -112px}.ui-icon-cancel{background-position:0 -128px}.ui-icon-plus{background-position:-16px -128px}.ui-icon-plusthick{background-position:-32px -128px}.ui-icon-minus{background-position:-48px -128px}.ui-icon-minusthick{background-position:-64px -128px}.ui-icon-close{background-position:-80px -128px}.ui-icon-closethick{background-position:-96px -128px}.ui-icon-key{background-position:-112px -128px}.ui-icon-lightbulb{background-position:-128px -128px}.ui-icon-scissors{background-position:-144px -128px}.ui-icon-clipboard{background-position:-160px -128px}.ui-icon-copy{background-position:-176px -128px}.ui-icon-contact{background-position:-192px -128px}.ui-icon-image{background-position:-208px -128px}.ui-icon-video{background-position:-224px -128px}.ui-icon-script{background-position:-240px -128px}.ui-icon-alert{background-position:0 -144px}.ui-icon-info{background-position:-16px -144px}.ui-icon-notice{background-position:-32px -144px}.ui-icon-help{background-position:-48px -144px}.ui-icon-check{background-position:-64px -144px}.ui-icon-bullet{background-position:-80px -144px}.ui-icon-radio-on{background-position:-96px -144px}.ui-icon-radio-off{background-position:-112px -144px}.ui-icon-pin-w{background-position:-128px -144px}.ui-icon-pin-s{background-position:-144px -144px}.ui-icon-play{background-position:0 -160px}.ui-icon-pause{background-position:-16px -160px}.ui-icon-seek-next{background-position:-32px -160px}.ui-icon-seek-prev{background-position:-48px -160px}.ui-icon-seek-end{background-position:-64px -160px}.ui-icon-seek-start{background-position:-80px -160px}.ui-icon-seek-first{background-position:-80px -160px}.ui-icon-stop{background-position:-96px -160px}.ui-icon-eject{background-position:-112px -160px}.ui-icon-volume-off{background-position:-128px -160px}.ui-icon-volume-on{background-position:-144px -160px}.ui-icon-power{background-position:0 -176px}.ui-icon-signal-diag{background-position:-16px -176px}.ui-icon-signal{background-position:-32px -176px}.ui-icon-battery-0{background-position:-48px -176px}.ui-icon-battery-1{background-position:-64px -176px}.ui-icon-battery-2{background-position:-80px -176px}.ui-icon-battery-3{background-position:-96px -176px}.ui-icon-circle-plus{background-position:0 -192px}.ui-icon-circle-minus{background-position:-16px -192px}.ui-icon-circle-close{background-position:-32px -192px}.ui-icon-circle-triangle-e{background-position:-48px -192px}.ui-icon-circle-triangle-s{background-position:-64px -192px}.ui-icon-circle-triangle-w{background-position:-80px -192px}.ui-icon-circle-triangle-n{background-position:-96px -192px}.ui-icon-circle-arrow-e{background-position:-112px -192px}.ui-icon-circle-arrow-s{background-position:-128px -192px}.ui-icon-circle-arrow-w{background-position:-144px -192px}.ui-icon-circle-arrow-n{background-position:-160px -192px}.ui-icon-circle-zoomin{background-position:-176px -192px}.ui-icon-circle-zoomout{background-position:-192px -192px}.ui-icon-circle-check{background-position:-208px -192px}.ui-icon-circlesmall-plus{background-position:0 -208px}.ui-icon-circlesmall-minus{background-position:-16px -208px}.ui-icon-circlesmall-close{background-position:-32px -208px}.ui-icon-squaresmall-plus{background-position:-48px -208px}.ui-icon-squaresmall-minus{background-position:-64px -208px}.ui-icon-squaresmall-close{background-position:-80px -208px}.ui-icon-grip-dotted-vertical{background-position:0 -224px}.ui-icon-grip-dotted-horizontal{background-position:-16px -224px}.ui-icon-grip-solid-vertical{background-position:-32px -224px}.ui-icon-grip-solid-horizontal{background-position:-48px -224px}.ui-icon-gripsmall-diagonal-se{background-position:-64px -224px}.ui-icon-grip-diagonal-se{background-position:-80px -224px}.ui-corner-all,.ui-corner-top,.ui-corner-left,.ui-corner-tl{border-top-left-radius:3px}.ui-corner-all,.ui-corner-top,.ui-corner-right,.ui-corner-tr{border-top-right-radius:3px}.ui-corner-all,.ui-corner-bottom,.ui-corner-left,.ui-corner-bl{border-bottom-left-radius:3px}.ui-corner-all,.ui-corner-bottom,.ui-corner-right,.ui-corner-br{border-bottom-right-radius:3px}.ui-widget-overlay{background:#aaa;opacity:.3;filter:Alpha(Opacity=30)}.ui-widget-shadow{-webkit-box-shadow:0 0 5px #666;box-shadow:0 0 5px #666}
/** stylesheets/combobox_autocomplete.css **/
.custom-combobox {
    position: relative;
    display: inline-block;
}

.custom-combobox-toggle {
    position: absolute;
    top: 0;
    bottom: 0;
    margin-left: -1px;
    padding: 0;
}

.custom-combobox-input {
    margin: 0;
    padding-left: 0.4em;
    padding-right: 0.4em;
    padding-top: 0.3em;
    padding-bottom: 0.3em;
}

.custom-combobox .custom-combobox-toggle {
	height: 26px !important;
}

.ui-autocomplete {
	max-height: 500px;
	overflow-y: scroll;
}

.AutocompleteComboboxContainer {
	margin-top: 1px;
}

.AutocompleteComboboxContainer button {
	margin-top: 0px !important;
}
/** stylesheets/multiple-select.css **/
/**
 * @author zhixin wen <wenzhixin2010@gmail.com>
 */

.ms-parent {
    display: inline-block;
    position: relative;
    vertical-align: middle;
}

.ms-choice {
    display: block;
    width: 100%;
    height: 26px;
    padding: 0;
    overflow: hidden;
    cursor: pointer;
    border: 1px solid #aaa;
    text-align: left;
    white-space: nowrap;
    line-height: 26px;
    color: #444;
    text-decoration: none;
    -webkit-border-radius: 4px;
    -moz-border-radius: 4px;
    border-radius: 4px;
    background-color: #fff;
}

.ms-choice.disabled {
    background-color: #f4f4f4;
    background-image: none;
    border: 1px solid #ddd;
    cursor: default;
}

.ms-choice > span {
    position: absolute;
    top: 0;
    left: 0;
    right: 20px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    display: block;
    padding-left: 8px;
}

.ms-choice > span.placeholder {
    color: #999;
}

.ms-choice > div {
    position: absolute;
    top: 0;
    right: 0;
    width: 20px;
    height: 25px;
    background: url('images/multiple-select.png') left top no-repeat;
}

.ms-choice > div.open {
    background: url('images/multiple-select.png') right top no-repeat;
}

.ms-drop {
    min-width: 99%;
    overflow: hidden;
    display: none;
    margin-top: -1px;
    padding: 0;
    position: absolute;
    z-index: 1000;
    background: #fff;
    color: #000;
    border: 1px solid #aaa;
    -webkit-border-radius: 4px;
    -moz-border-radius: 4px;
    border-radius: 4px;
}

.restrict-ms-drop-size .ms-drop {
	max-width: 200%;
}

.ms-drop.bottom {
    top: 100%;
    -webkit-box-shadow: 0 4px 5px rgba(0, 0, 0, .15);
    -moz-box-shadow: 0 4px 5px rgba(0, 0, 0, .15);
    box-shadow: 0 4px 5px rgba(0, 0, 0, .15);
}

.ms-drop.top {
    bottom: 100%;
    -webkit-box-shadow: 0 -4px 5px rgba(0, 0, 0, .15);
    -moz-box-shadow: 0 -4px 5px rgba(0, 0, 0, .15);
    box-shadow: 0 -4px 5px rgba(0, 0, 0, .15);
}

.ms-search {
    display: inline-block;
    margin: 0;
    min-height: 26px;
    padding: 4px;
    position: relative;
    white-space: nowrap;
    width: 100%;
    z-index: 10000;
}

.ms-search input {
    width: 100%;
    height: auto !important;
    min-height: 24px;
    padding: 0 20px 0 5px;
    margin: 0;
    outline: 0;
    font-family: sans-serif;
    font-size: 1em;
    border: 1px solid #aaa;
    -webkit-border-radius: 0;
    -moz-border-radius: 0;
    border-radius: 0;
    -webkit-box-shadow: none;
    -moz-box-shadow: none;
    box-shadow: none;
    background: #fff url('images/multiple-select.png') no-repeat 100% -22px;
    background: url('images/multiple-select.png') no-repeat 100% -22px, -webkit-gradient(linear, left bottom, left top, color-stop(0.85, white), color-stop(0.99, #eeeeee));
    background: url('images/multiple-select.png') no-repeat 100% -22px, -webkit-linear-gradient(center bottom, white 85%, #eeeeee 99%);
    background: url('images/multiple-select.png') no-repeat 100% -22px, -moz-linear-gradient(center bottom, white 85%, #eeeeee 99%);
    background: url('images/multiple-select.png') no-repeat 100% -22px, -o-linear-gradient(bottom, white 85%, #eeeeee 99%);
    background: url('images/multiple-select.png') no-repeat 100% -22px, -ms-linear-gradient(top, #ffffff 85%, #eeeeee 99%);
    background: url('images/multiple-select.png') no-repeat 100% -22px, linear-gradient(top, #ffffff 85%, #eeeeee 99%);
}

.ms-search, .ms-search input {
    -webkit-box-sizing: border-box;
    -khtml-box-sizing: border-box;
    -moz-box-sizing: border-box;
    -ms-box-sizing: border-box;
    box-sizing: border-box;
}

.ms-drop ul {
    overflow: auto;
    margin: 0;
    padding: 5px 8px;
}

.ms-drop ul > li {
    list-style: none;
    display: list-item;
    background-image: none;
    position: static;
}

.ms-drop ul > li .disabled {
    opacity: .35;
    filter: Alpha(Opacity=35);
}

.ms-drop ul > li.multiple {
    display: block;
    float: left;
}

.ms-drop ul > li.group {
    clear: both;
}

.ms-drop ul > li.multiple label {
    width: 100%;
    display: block;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.ms-drop ul > li label {
    font-weight: normal;
    display: block;
    white-space: nowrap;
}

.ms-drop ul > li label.optgroup {
    font-weight: bold;
}

.ms-drop input[type="checkbox"] {
    vertical-align: middle;
}

.ms-drop .ms-no-results {
    display: none;
}

/** stylesheets/onOffSwitch.css **/
.onoffswitch {
    position: relative; width: 66px;
    -webkit-user-select:none; -moz-user-select:none; -ms-user-select: none;
}
.onoffswitch-checkbox {
    display: none;
}
.onoffswitch-label {
    display: block; overflow: hidden; cursor: pointer;
    border: 2px solid #999999; border-radius: 17px;
}
.onoffswitch-inner {
    width: 200%; margin-left: -100%;
    -moz-transition: margin 0.3s ease-in 0s; -webkit-transition: margin 0.3s ease-in 0s;
    -o-transition: margin 0.3s ease-in 0s; transition: margin 0.3s ease-in 0s;
}
.onoffswitch-inner:before, .onoffswitch-inner:after {
    float: left; width: 50%; height: 20px; padding: 0; line-height: 20px;
    font-size: 14px; color: white; font-family: Trebuchet, Arial, sans-serif; font-weight: bold;
    -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box;
}
.onoffswitch-inner:before {
    content: "ON";
    padding-left: 10px;
    background-color: #00B7EB; color: #FFFFFF;
}
.onoffswitch-inner:after {
    content: "OFF";
    padding-right: 10px;
    background-color: #EEEEEE; color: #999999;
    text-align: right;
}
.onoffswitch-switch {
    width: 10px; margin: 5px;
    background: #FFFFFF;
    border: 2px solid #999999; border-radius: 17px;
    position: absolute; top: 0; bottom: 0; right: 42px;
    -moz-transition: all 0.3s ease-in 0s; -webkit-transition: all 0.3s ease-in 0s;
    -o-transition: all 0.3s ease-in 0s; transition: all 0.3s ease-in 0s; 
}
.onoffswitch-checkbox:checked + .onoffswitch-label .onoffswitch-inner {
    margin-left: 0;
}
.onoffswitch-checkbox:checked + .onoffswitch-label .onoffswitch-switch {
    right: 0px; 
}
/** stylesheets/selectizecss/selectize.css **/
/**
 * selectize.default.css (v0.11.2) - Default Theme
 * Copyright (c) 2013 Brian Reavis & contributors
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this
 * file except in compliance with the License. You may obtain a copy of the License at:
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF
 * ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 *
 * @author Brian Reavis <brian@thirdroute.com>
 */
.selectize-control.plugin-drag_drop.multi > .selectize-input > div.ui-sortable-placeholder {
  visibility: visible !important;
  background: #f2f2f2 !important;
  background: rgba(0, 0, 0, 0.06) !important;
  border: 0 none !important;
  -webkit-box-shadow: inset 0 0 12px 4px #ffffff;
  box-shadow: inset 0 0 12px 4px #ffffff;
}
.selectize-control.plugin-drag_drop .ui-sortable-placeholder::after {
  content: '!';
  visibility: hidden;
}
.selectize-control.plugin-drag_drop .ui-sortable-helper {
  -webkit-box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
}
.selectize-dropdown-header {
  position: relative;
  padding: 5px 8px;
  border-bottom: 1px solid #d0d0d0;
  background: #f8f8f8;
  -webkit-border-radius: 3px 3px 0 0;
  -moz-border-radius: 3px 3px 0 0;
  border-radius: 3px 3px 0 0;
}
.selectize-dropdown-header-close {
  position: absolute;
  right: 8px;
  top: 50%;
  color: #303030;
  opacity: 0.4;
  margin-top: -12px;
  line-height: 20px;
  font-size: 20px !important;
}
.selectize-dropdown-header-close:hover {
  color: #000000;
}
.selectize-dropdown.plugin-optgroup_columns .optgroup {
  border-right: 1px solid #f2f2f2;
  border-top: 0 none;
  float: left;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
.selectize-dropdown.plugin-optgroup_columns .optgroup:last-child {
  border-right: 0 none;
}
.selectize-dropdown.plugin-optgroup_columns .optgroup:before {
  display: none;
}
.selectize-dropdown.plugin-optgroup_columns .optgroup-header {
  border-top: 0 none;
}
.selectize-control.plugin-remove_button [data-value] {
  position: relative;
  padding-right: 24px !important;
}
.selectize-control.plugin-remove_button [data-value] .remove {
  z-index: 1;
  /* fixes ie bug (see #392) */
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  width: 17px;
  text-align: center;
  font-weight: bold;
  font-size: 12px;
  color: inherit;
  text-decoration: none;
  vertical-align: middle;
  display: inline-block;
  padding: 2px 0 0 0;
  border-left: 1px solid #0073bb;
  -webkit-border-radius: 0 2px 2px 0;
  -moz-border-radius: 0 2px 2px 0;
  border-radius: 0 2px 2px 0;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
.selectize-control.plugin-remove_button [data-value] .remove:hover {
  background: rgba(0, 0, 0, 0.05);
}
.selectize-control.plugin-remove_button [data-value].active .remove {
  border-left-color: #00578d;
}
.selectize-control.plugin-remove_button .disabled [data-value] .remove:hover {
  background: none;
}
.selectize-control.plugin-remove_button .disabled [data-value] .remove {
  border-left-color: #aaaaaa;
}
.selectize-control {
  position: relative;
}
.selectize-dropdown,
.selectize-input,
.selectize-input input {
  color: #303030;
  font-family: inherit;
  font-size: 13px;
  line-height: 18px;
  -webkit-font-smoothing: inherit;
}
.selectize-input,
.selectize-control.single .selectize-input.input-active {
  background: #ffffff;
  cursor: text;
  display: inline-block;
}
.selectize-input {
  border: 1px solid #d0d0d0;
  padding: 8px 8px;
  display: inline-block;
  width: 100%;
  overflow: hidden;
  position: relative;
  z-index: 1;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.1);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.1);
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px;
}
.selectize-control.multi .selectize-input.has-items {
  padding: 5px 8px 2px;
}
.selectize-input.full {
  background-color: #ffffff;
}
.selectize-input.disabled,
.selectize-input.disabled * {
  cursor: default !important;
}
.selectize-input.focus {
  -webkit-box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.15);
  box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.15);
}
.selectize-input.dropdown-active {
  -webkit-border-radius: 3px 3px 0 0;
  -moz-border-radius: 3px 3px 0 0;
  border-radius: 3px 3px 0 0;
}
.selectize-input > * {
  vertical-align: baseline;
  display: -moz-inline-stack;
  display: inline-block;
  zoom: 1;
  *display: inline;
}
.selectize-control.multi .selectize-input > div {
  cursor: pointer;
  margin: 0 3px 3px 0;
  padding: 2px 6px;
  background: #1da7ee;
  color: #ffffff;
  border: 1px solid #0073bb;
}
.selectize-control.multi .selectize-input > div.active {
  background: #92c836;
  color: #ffffff;
  border: 1px solid #00578d;
}
.selectize-control.multi .selectize-input.disabled > div,
.selectize-control.multi .selectize-input.disabled > div.active {
  color: #ffffff;
  background: #d2d2d2;
  border: 1px solid #aaaaaa;
}
.selectize-input > input {
  display: inline-block !important;
  padding: 0 !important;
  min-height: 0 !important;
  max-height: none !important;
  max-width: 100% !important;
  margin: 0 1px !important;
  text-indent: 0 !important;
  border: 0 none !important;
  background: none !important;
  line-height: inherit !important;
  -webkit-user-select: auto !important;
  -webkit-box-shadow: none !important;
  box-shadow: none !important;
}
.selectize-input > input::-ms-clear {
  display: none;
}
.selectize-input > input:focus {
  outline: none !important;
}
.selectize-input::after {
  content: ' ';
  display: block;
  clear: left;
}
.selectize-input.dropdown-active::before {
  content: ' ';
  display: block;
  position: absolute;
  background: #f0f0f0;
  height: 1px;
  bottom: 0;
  left: 0;
  right: 0;
}
.selectize-dropdown {
  position: absolute;
  z-index: 50;
  border: 1px solid #d0d0d0;
  background: #ffffff;
  margin: -1px 0 0 0;
  border-top: 0 none;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
  -webkit-box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
  -webkit-border-radius: 0 0 3px 3px;
  -moz-border-radius: 0 0 3px 3px;
  border-radius: 0 0 3px 3px;
}
.selectize-dropdown [data-selectable] {
  cursor: pointer;
  overflow: hidden;
}
.selectize-dropdown [data-selectable] .highlight {
  background: rgba(125, 168, 208, 0.2);
  -webkit-border-radius: 1px;
  -moz-border-radius: 1px;
  border-radius: 1px;
}
.selectize-dropdown [data-selectable],
.selectize-dropdown .optgroup-header {
  padding: 5px 8px;
}
.selectize-dropdown .optgroup:first-child .optgroup-header {
  border-top: 0 none;
}
.selectize-dropdown .optgroup-header {
  color: #303030;
  background: #ffffff;
  cursor: default;
}
.selectize-dropdown .active {
  background-color: #f5fafd;
  color: #495c68;
}
.selectize-dropdown .active.create {
  color: #495c68;
}
.selectize-dropdown .create {
  color: rgba(48, 48, 48, 0.5);
}
.selectize-dropdown-content {
  overflow-y: auto;
  overflow-x: hidden;
  max-height: 200px;
}
.selectize-control.single .selectize-input,
.selectize-control.single .selectize-input input {
  cursor: pointer;
}
.selectize-control.single .selectize-input.input-active,
.selectize-control.single .selectize-input.input-active input {
  cursor: text;
}
.selectize-control.single .selectize-input:after {
  content: ' ';
  display: block;
  position: absolute;
  top: 50%;
  right: 15px;
  margin-top: -3px;
  width: 0;
  height: 0;
  border-style: solid;
  border-width: 5px 5px 0 5px;
  border-color: #808080 transparent transparent transparent;
}
.selectize-control.single .selectize-input.dropdown-active:after {
  margin-top: -4px;
  border-width: 0 5px 5px 5px;
  border-color: transparent transparent #808080 transparent;
}
.selectize-control.rtl.single .selectize-input:after {
  left: 15px;
  right: auto;
}
.selectize-control.rtl .selectize-input > input {
  margin: 0 4px 0 -2px !important;
}
.selectize-control .selectize-input.disabled {
  opacity: 0.5;
  background-color: #fafafa;
}
.selectize-control.multi .selectize-input.has-items {
  padding-left: 5px;
  padding-right: 5px;
}
.selectize-control.multi .selectize-input.disabled [data-value] {
  color: #999;
  text-shadow: none;
  background: none;
  -webkit-box-shadow: none;
  box-shadow: none;
}
.selectize-control.multi .selectize-input.disabled [data-value],
.selectize-control.multi .selectize-input.disabled [data-value] .remove {
  border-color: #e6e6e6;
}
.selectize-control.multi .selectize-input.disabled [data-value] .remove {
  background: none;
}
.selectize-control.multi .selectize-input [data-value] {
  text-shadow: 0 1px 0 rgba(0, 51, 83, 0.3);
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px;
  background-color: #1b9dec;
  background-image: -moz-linear-gradient(top, #1da7ee, #178ee9);
  background-image: -webkit-gradient(linear, 0 0, 0 100%, from(#1da7ee), to(#178ee9));
  background-image: -webkit-linear-gradient(top, #1da7ee, #178ee9);
  background-image: -o-linear-gradient(top, #1da7ee, #178ee9);
  background-image: linear-gradient(to bottom, #1da7ee, #178ee9);
  background-repeat: repeat-x;
  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#ff1da7ee', endColorstr='#ff178ee9', GradientType=0);
  -webkit-box-shadow: 0 1px 0 rgba(0,0,0,0.2),inset 0 1px rgba(255,255,255,0.03);
  box-shadow: 0 1px 0 rgba(0,0,0,0.2),inset 0 1px rgba(255,255,255,0.03);
}
.selectize-control.multi .selectize-input [data-value].active {
  background-color: #0085d4;
  background-image: -moz-linear-gradient(top, #008fd8, #0075cf);
  background-image: -webkit-gradient(linear, 0 0, 0 100%, from(#008fd8), to(#0075cf));
  background-image: -webkit-linear-gradient(top, #008fd8, #0075cf);
  background-image: -o-linear-gradient(top, #008fd8, #0075cf);
  background-image: linear-gradient(to bottom, #008fd8, #0075cf);
  background-repeat: repeat-x;
  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#ff008fd8', endColorstr='#ff0075cf', GradientType=0);
}
.selectize-control.single .selectize-input {
  -webkit-box-shadow: 0 1px 0 rgba(0,0,0,0.05), inset 0 1px 0 rgba(255,255,255,0.8);
  box-shadow: 0 1px 0 rgba(0,0,0,0.05), inset 0 1px 0 rgba(255,255,255,0.8);
  background-color: #f9f9f9;
  background-image: -moz-linear-gradient(top, #fefefe, #f2f2f2);
  background-image: -webkit-gradient(linear, 0 0, 0 100%, from(#fefefe), to(#f2f2f2));
  background-image: -webkit-linear-gradient(top, #fefefe, #f2f2f2);
  background-image: -o-linear-gradient(top, #fefefe, #f2f2f2);
  background-image: linear-gradient(to bottom, #fefefe, #f2f2f2);
  background-repeat: repeat-x;
  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#fffefefe', endColorstr='#fff2f2f2', GradientType=0);
}
.selectize-control.single .selectize-input,
.selectize-dropdown.single {
  border-color: #b8b8b8;
}
.selectize-dropdown .optgroup-header {
  padding-top: 7px;
  font-weight: bold;
  font-size: 0.85em;
}
.selectize-dropdown .optgroup {
  border-top: 1px solid #f0f0f0;
}
.selectize-dropdown .optgroup:first-child {
  border-top: 0 none;
}


.small-selectize * {
	line-height: 10px !important;
}

.small-selectize .selectize-dropdown * {
	line-height: 14px !important;
}

.small-selectize .selectize-control {
	height: 28px;
}

.small-selectize .selectize-input {
	padding: 2px 8px 2px;
	height: 28px;
}

.small-selectize input {
	height: 20px !important;
}

.small-selectize .item {
	margin-top: 5px;
}

.small-selectize .ui-button {
	margin-top: -2px;
	height: 28px;
}

/** stylesheets/jquery.datetimepicker.css **/
.xdsoft_datetimepicker {
	box-shadow: 0 5px 15px -5px rgba(0, 0, 0, 0.506);
	background: #fff;
	border-bottom: 1px solid #bbb;
	border-left: 1px solid #ccc;
	border-right: 1px solid #ccc;
	border-top: 1px solid #ccc;
	color: #333;
	font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
	padding: 8px;
	padding-left: 0;
	padding-top: 2px;
	position: absolute;
	z-index: 9999;
	-moz-box-sizing: border-box;
	box-sizing: border-box;
	display: none;
}
.xdsoft_datetimepicker.xdsoft_rtl {
	padding: 8px 0 8px 8px;
}

.xdsoft_datetimepicker iframe {
	position: absolute;
	left: 0;
	top: 0;
	width: 75px;
	height: 210px;
	background: transparent;
	border: none;
}

/*For IE8 or lower*/
.xdsoft_datetimepicker button {
	border: none !important;
}

.xdsoft_noselect {
	-webkit-touch-callout: none;
	-webkit-user-select: none;
	-khtml-user-select: none;
	-moz-user-select: none;
	-ms-user-select: none;
	-o-user-select: none;
	user-select: none;
}

.xdsoft_noselect::selection { background: transparent }
.xdsoft_noselect::-moz-selection { background: transparent }

.xdsoft_datetimepicker.xdsoft_inline {
	display: inline-block;
	position: static;
	box-shadow: none;
}

.xdsoft_datetimepicker * {
	-moz-box-sizing: border-box;
	box-sizing: border-box;
	padding: 0;
	margin: 0;
}

.xdsoft_datetimepicker .xdsoft_datepicker, .xdsoft_datetimepicker .xdsoft_timepicker {
	display: none;
}

.xdsoft_datetimepicker .xdsoft_datepicker.active, .xdsoft_datetimepicker .xdsoft_timepicker.active {
	display: block;
}

.xdsoft_datetimepicker .xdsoft_datepicker {
	width: 224px;
	float: left;
	margin-left: 8px;
}
.xdsoft_datetimepicker.xdsoft_rtl .xdsoft_datepicker {
	float: right;
	margin-right: 8px;
	margin-left: 0;
}

.xdsoft_datetimepicker.xdsoft_showweeks .xdsoft_datepicker {
	width: 256px;
}

.xdsoft_datetimepicker .xdsoft_timepicker {
	width: 58px;
	float: left;
	text-align: center;
	margin-left: 8px;
	margin-top: 0;
}
.xdsoft_datetimepicker.xdsoft_rtl .xdsoft_timepicker {
	float: right;
	margin-right: 8px;
	margin-left: 0;
}

.xdsoft_datetimepicker .xdsoft_datepicker.active+.xdsoft_timepicker {
	margin-top: 8px;
	margin-bottom: 3px
}

.xdsoft_datetimepicker .xdsoft_monthpicker {
	position: relative;
	text-align: center;
}

.xdsoft_datetimepicker .xdsoft_label i,
.xdsoft_datetimepicker .xdsoft_prev,
.xdsoft_datetimepicker .xdsoft_next,
.xdsoft_datetimepicker .xdsoft_today_button {
	background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAeCAYAAADaW7vzAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6Q0NBRjI1NjM0M0UwMTFFNDk4NkFGMzJFQkQzQjEwRUIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6Q0NBRjI1NjQ0M0UwMTFFNDk4NkFGMzJFQkQzQjEwRUIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpDQ0FGMjU2MTQzRTAxMUU0OTg2QUYzMkVCRDNCMTBFQiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpDQ0FGMjU2MjQzRTAxMUU0OTg2QUYzMkVCRDNCMTBFQiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PoNEP54AAAIOSURBVHja7Jq9TsMwEMcxrZD4WpBYeKUCe+kTMCACHZh4BFfHO/AAIHZGFhYkBBsSEqxsLCAgXKhbXYOTxh9pfJVP+qutnZ5s/5Lz2Y5I03QhWji2GIcgAokWgfCxNvcOCCGKqiSqhUp0laHOne05vdEyGMfkdxJDVjgwDlEQgYQBgx+ULJaWSXXS6r/ER5FBVR8VfGftTKcITNs+a1XpcFoExREIDF14AVIFxgQUS+h520cdud6wNkC0UBw6BCO/HoCYwBhD8QCkQ/x1mwDyD4plh4D6DDV0TAGyo4HcawLIBBSLDkHeH0Mg2yVP3l4TQMZQDDsEOl/MgHQqhMNuE0D+oBh0CIr8MAKyazBH9WyBuKxDWgbXfjNf32TZ1KWm/Ap1oSk/R53UtQ5xTh3LUlMmT8gt6g51Q9p+SobxgJQ/qmsfZhWywGFSl0yBjCLJCMgXail3b7+rumdVJ2YRss4cN+r6qAHDkPWjPjdJCF4n9RmAD/V9A/Wp4NQassDjwlB6XBiCxcJQWmZZb8THFilfy/lfrTvLghq2TqTHrRMTKNJ0sIhdo15RT+RpyWwFdY96UZ/LdQKBGjcXpcc1AlSFEfLmouD+1knuxBDUVrvOBmoOC/rEcN7OQxKVeJTCiAdUzUJhA2Oez9QTkp72OTVcxDcXY8iKNkxGAJXmJCOQwOa6dhyXsOa6XwEGAKdeb5ET3rQdAAAAAElFTkSuQmCC);
}

.xdsoft_datetimepicker .xdsoft_label i {
	opacity: 0.5;
	background-position: -92px -19px;
	display: inline-block;
	width: 9px;
	height: 20px;
	vertical-align: middle;
}

.xdsoft_datetimepicker .xdsoft_prev {
	float: left;
	background-position: -20px 0;
}
.xdsoft_datetimepicker .xdsoft_today_button {
	float: left;
	background-position: -70px 0;
	margin-left: 5px;
}

.xdsoft_datetimepicker .xdsoft_next {
	float: right;
	background-position: 0 0;
}

.xdsoft_datetimepicker .xdsoft_next,
.xdsoft_datetimepicker .xdsoft_prev ,
.xdsoft_datetimepicker .xdsoft_today_button {
	background-color: transparent;
	background-repeat: no-repeat;
	border: 0 none;
	cursor: pointer;
	display: block;
	height: 30px;
	opacity: 0.5;
	-ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=50)";
	outline: medium none;
	overflow: hidden;
	padding: 0;
	position: relative;
	text-indent: 100%;
	white-space: nowrap;
	width: 20px;
	min-width: 0;
}

.xdsoft_datetimepicker .xdsoft_timepicker .xdsoft_prev,
.xdsoft_datetimepicker .xdsoft_timepicker .xdsoft_next {
	float: none;
	background-position: -40px -15px;
	height: 15px;
	width: 30px;
	display: block;
	margin-left: 14px;
	margin-top: 7px;
}
.xdsoft_datetimepicker.xdsoft_rtl .xdsoft_timepicker .xdsoft_prev,
.xdsoft_datetimepicker.xdsoft_rtl .xdsoft_timepicker .xdsoft_next {
	float: none;
	margin-left: 0;
	margin-right: 14px;
}

.xdsoft_datetimepicker .xdsoft_timepicker .xdsoft_prev {
	background-position: -40px 0;
	margin-bottom: 7px;
	margin-top: 0;
}

.xdsoft_datetimepicker .xdsoft_timepicker .xdsoft_time_box {
	height: 151px;
	overflow: hidden;
	border-bottom: 1px solid #ddd;
}

.xdsoft_datetimepicker .xdsoft_timepicker .xdsoft_time_box >div >div {
	background: #f5f5f5;
	border-top: 1px solid #ddd;
	color: #666;
	font-size: 12px;
	text-align: center;
	border-collapse: collapse;
	cursor: pointer;
	border-bottom-width: 0;
	height: 25px;
	line-height: 25px;
}

.xdsoft_datetimepicker .xdsoft_timepicker .xdsoft_time_box >div > div:first-child {
	border-top-width: 0;
}

.xdsoft_datetimepicker .xdsoft_today_button:hover,
.xdsoft_datetimepicker .xdsoft_next:hover,
.xdsoft_datetimepicker .xdsoft_prev:hover {
	opacity: 1;
	-ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=100)";
}

.xdsoft_datetimepicker .xdsoft_label {
	display: inline;
	position: relative;
	z-index: 9999;
	margin: 0;
	padding: 5px 3px;
	font-size: 14px;
	line-height: 20px;
	font-weight: bold;
	background-color: #fff;
	float: left;
	width: 182px;
	text-align: center;
	cursor: pointer;
}

.xdsoft_datetimepicker .xdsoft_label:hover>span {
	text-decoration: underline;
}

.xdsoft_datetimepicker .xdsoft_label:hover i {
	opacity: 1.0;
}

.xdsoft_datetimepicker .xdsoft_label > .xdsoft_select {
	border: 1px solid #ccc;
	position: absolute;
	right: 0;
	top: 30px;
	z-index: 101;
	display: none;
	background: #fff;
	max-height: 160px;
	overflow-y: hidden;
}

.xdsoft_datetimepicker .xdsoft_label > .xdsoft_select.xdsoft_monthselect{ right: -7px }
.xdsoft_datetimepicker .xdsoft_label > .xdsoft_select.xdsoft_yearselect{ right: 2px }
.xdsoft_datetimepicker .xdsoft_label > .xdsoft_select > div > .xdsoft_option:hover {
	color: #fff;
	background: #ff8000;
}

.xdsoft_datetimepicker .xdsoft_label > .xdsoft_select > div > .xdsoft_option {
	padding: 2px 10px 2px 5px;
	text-decoration: none !important;
}

.xdsoft_datetimepicker .xdsoft_label > .xdsoft_select > div > .xdsoft_option.xdsoft_current {
	background: #33aaff;
	box-shadow: #178fe5 0 1px 3px 0 inset;
	color: #fff;
	font-weight: 700;
}

.xdsoft_datetimepicker .xdsoft_month {
	width: 100px;
	text-align: right;
}

.xdsoft_datetimepicker .xdsoft_calendar {
	clear: both;
}

.xdsoft_datetimepicker .xdsoft_year{
	width: 48px;
	margin-left: 5px;
}

.xdsoft_datetimepicker .xdsoft_calendar table {
	border-collapse: collapse;
	width: 100%;

}

.xdsoft_datetimepicker .xdsoft_calendar td > div {
	padding-right: 5px;
}

.xdsoft_datetimepicker .xdsoft_calendar th {
	height: 25px;
}

.xdsoft_datetimepicker .xdsoft_calendar td,.xdsoft_datetimepicker .xdsoft_calendar th {
	width: 14.2857142%;
	background: #f5f5f5;
	border: 1px solid #ddd;
	color: #666;
	font-size: 12px;
	text-align: right;
	vertical-align: middle;
	padding: 0;
	border-collapse: collapse;
	cursor: pointer;
	height: 25px;
}
.xdsoft_datetimepicker.xdsoft_showweeks .xdsoft_calendar td,.xdsoft_datetimepicker.xdsoft_showweeks .xdsoft_calendar th {
	width: 12.5%;
}

.xdsoft_datetimepicker .xdsoft_calendar th {
	background: #f1f1f1;
}

.xdsoft_datetimepicker .xdsoft_calendar td.xdsoft_today {
	color: #33aaff;
}

.xdsoft_datetimepicker .xdsoft_calendar td.xdsoft_highlighted_default {
	background: #ffe9d2;
	box-shadow: #ffb871 0 1px 4px 0 inset;
	color: #000;
}
.xdsoft_datetimepicker .xdsoft_calendar td.xdsoft_highlighted_mint {
	background: #c1ffc9;
	box-shadow: #00dd1c 0 1px 4px 0 inset;
	color: #000;
}

.xdsoft_datetimepicker .xdsoft_calendar td.xdsoft_default,
.xdsoft_datetimepicker .xdsoft_calendar td.xdsoft_current,
.xdsoft_datetimepicker .xdsoft_timepicker .xdsoft_time_box >div >div.xdsoft_current {
	background: #33aaff;
	box-shadow: #178fe5 0 1px 3px 0 inset;
	color: #fff;
	font-weight: 700;
}

.xdsoft_datetimepicker .xdsoft_calendar td.xdsoft_other_month,
.xdsoft_datetimepicker .xdsoft_calendar td.xdsoft_disabled,
.xdsoft_datetimepicker .xdsoft_time_box >div >div.xdsoft_disabled {
	opacity: 0.5;
	-ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=50)";
	cursor: default;
}

.xdsoft_datetimepicker .xdsoft_calendar td.xdsoft_other_month.xdsoft_disabled {
	opacity: 0.2;
	-ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=20)";
}

.xdsoft_datetimepicker .xdsoft_calendar td:hover,
.xdsoft_datetimepicker .xdsoft_timepicker .xdsoft_time_box >div >div:hover {
	color: #fff !important;
	background: #ff8000 !important;
	box-shadow: none !important;
}

.xdsoft_datetimepicker .xdsoft_calendar td.xdsoft_current.xdsoft_disabled:hover,
.xdsoft_datetimepicker .xdsoft_timepicker .xdsoft_time_box>div>div.xdsoft_current.xdsoft_disabled:hover {
	background: #33aaff !important;
	box-shadow: #178fe5 0 1px 3px 0 inset !important;
	color: #fff !important;
}

.xdsoft_datetimepicker .xdsoft_calendar td.xdsoft_disabled:hover,
.xdsoft_datetimepicker .xdsoft_timepicker .xdsoft_time_box >div >div.xdsoft_disabled:hover {
	color: inherit	!important;
	background: inherit !important;
	box-shadow: inherit !important;
}

.xdsoft_datetimepicker .xdsoft_calendar th {
	font-weight: 700;
	text-align: center;
	color: #999;
	cursor: default;
}

.xdsoft_datetimepicker .xdsoft_copyright {
	color: #ccc !important;
	font-size: 10px;
	clear: both;
	float: none;
	margin-left: 8px;
}

.xdsoft_datetimepicker .xdsoft_copyright a { color: #eee !important }
.xdsoft_datetimepicker .xdsoft_copyright a:hover { color: #aaa !important }

.xdsoft_time_box {
	position: relative;
	border: 1px solid #ccc;
}
.xdsoft_scrollbar >.xdsoft_scroller {
	background: #ccc !important;
	height: 20px;
	border-radius: 3px;
}
.xdsoft_scrollbar {
	position: absolute;
	width: 7px;
	right: 0;
	top: 0;
	bottom: 0;
	cursor: pointer;
}
.xdsoft_datetimepicker.xdsoft_rtl .xdsoft_scrollbar {
	left: 0;
	right: auto;
}
.xdsoft_scroller_box {
	position: relative;
}

.xdsoft_datetimepicker.xdsoft_dark {
	box-shadow: 0 5px 15px -5px rgba(255, 255, 255, 0.506);
	background: #000;
	border-bottom: 1px solid #444;
	border-left: 1px solid #333;
	border-right: 1px solid #333;
	border-top: 1px solid #333;
	color: #ccc;
}

.xdsoft_datetimepicker.xdsoft_dark .xdsoft_timepicker .xdsoft_time_box {
	border-bottom: 1px solid #222;
}
.xdsoft_datetimepicker.xdsoft_dark .xdsoft_timepicker .xdsoft_time_box >div >div {
	background: #0a0a0a;
	border-top: 1px solid #222;
	color: #999;
}

.xdsoft_datetimepicker.xdsoft_dark .xdsoft_label {
	background-color: #000;
}
.xdsoft_datetimepicker.xdsoft_dark .xdsoft_label > .xdsoft_select {
	border: 1px solid #333;
	background: #000;
}

.xdsoft_datetimepicker.xdsoft_dark .xdsoft_label > .xdsoft_select > div > .xdsoft_option:hover {
	color: #000;
	background: #007fff;
}

.xdsoft_datetimepicker.xdsoft_dark .xdsoft_label > .xdsoft_select > div > .xdsoft_option.xdsoft_current {
	background: #cc5500;
	box-shadow: #b03e00 0 1px 3px 0 inset;
	color: #000;
}

.xdsoft_datetimepicker.xdsoft_dark .xdsoft_label i,
.xdsoft_datetimepicker.xdsoft_dark .xdsoft_prev,
.xdsoft_datetimepicker.xdsoft_dark .xdsoft_next,
.xdsoft_datetimepicker.xdsoft_dark .xdsoft_today_button {
	background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAeCAYAAADaW7vzAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QUExQUUzOTA0M0UyMTFFNDlBM0FFQTJENTExRDVBODYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QUExQUUzOTE0M0UyMTFFNDlBM0FFQTJENTExRDVBODYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpBQTFBRTM4RTQzRTIxMUU0OUEzQUVBMkQ1MTFENUE4NiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBQTFBRTM4RjQzRTIxMUU0OUEzQUVBMkQ1MTFENUE4NiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pp0VxGEAAAIASURBVHja7JrNSgMxEMebtgh+3MSLr1T1Xn2CHoSKB08+QmR8Bx9A8e7RixdB9CKCoNdexIugxFlJa7rNZneTbLIpM/CnNLsdMvNjM8l0mRCiQ9Ye61IKCAgZAUnH+mU3MMZaHYChBnJUDzWOFZdVfc5+ZFLbrWDeXPwbxIqrLLfaeS0hEBVGIRQCEiZoHQwtlGSByCCdYBl8g8egTTAWoKQMRBRBcZxYlhzhKegqMOageErsCHVkk3hXIFooDgHB1KkHIHVgzKB4ADJQ/A1jAFmAYhkQqA5TOBtocrKrgXwQA8gcFIuAIO8sQSA7hidvPwaQGZSaAYHOUWJABhWWw2EMIH9QagQERU4SArJXo0ZZL18uvaxejXt/Em8xjVBXmvFr1KVm/AJ10tRe2XnraNqaJvKE3KHuUbfK1E+VHB0q40/y3sdQSxY4FHWeKJCunP8UyDdqJZenT3ntVV5jIYCAh20vT7ioP8tpf6E2lfEMwERe+whV1MHjwZB7PBiCxcGQWwKZKD62lfGNnP/1poFAA60T7rF1UgcKd2id3KDeUS+oLWV8DfWAepOfq00CgQabi9zjcgJVYVD7PVzQUAUGAQkbNJTBICDhgwYTjDYD6XeW08ZKh+A4pYkzenOxXUbvZcWz7E8ykRMnIHGX1XPl+1m2vPYpL+2qdb8CDAARlKFEz/ZVkAAAAABJRU5ErkJggg==);
}

.xdsoft_datetimepicker.xdsoft_dark .xdsoft_calendar td,
.xdsoft_datetimepicker.xdsoft_dark .xdsoft_calendar th {
	background: #0a0a0a;
	border: 1px solid #222;
	color: #999;
}

.xdsoft_datetimepicker.xdsoft_dark .xdsoft_calendar th {
	background: #0e0e0e;
}

.xdsoft_datetimepicker.xdsoft_dark .xdsoft_calendar td.xdsoft_today {
	color: #cc5500;
}

.xdsoft_datetimepicker.xdsoft_dark .xdsoft_calendar td.xdsoft_highlighted_default {
	background: #ffe9d2;
	box-shadow: #ffb871 0 1px 4px 0 inset;
	color:#000;
}
.xdsoft_datetimepicker.xdsoft_dark .xdsoft_calendar td.xdsoft_highlighted_mint {
	background: #c1ffc9;
	box-shadow: #00dd1c 0 1px 4px 0 inset;
	color:#000;
}

.xdsoft_datetimepicker.xdsoft_dark .xdsoft_calendar td.xdsoft_default,
.xdsoft_datetimepicker.xdsoft_dark .xdsoft_calendar td.xdsoft_current,
.xdsoft_datetimepicker.xdsoft_dark .xdsoft_timepicker .xdsoft_time_box >div >div.xdsoft_current {
	background: #cc5500;
	box-shadow: #b03e00 0 1px 3px 0 inset;
	color: #000;
}

.xdsoft_datetimepicker.xdsoft_dark .xdsoft_calendar td:hover,
.xdsoft_datetimepicker.xdsoft_dark .xdsoft_timepicker .xdsoft_time_box >div >div:hover {
	color: #000 !important;
	background: #007fff !important;
}

.xdsoft_datetimepicker.xdsoft_dark .xdsoft_calendar th {
	color: #666;
}

.xdsoft_datetimepicker.xdsoft_dark .xdsoft_copyright { color: #333 !important }
.xdsoft_datetimepicker.xdsoft_dark .xdsoft_copyright a { color: #111 !important }
.xdsoft_datetimepicker.xdsoft_dark .xdsoft_copyright a:hover { color: #555 !important }

.xdsoft_dark .xdsoft_time_box {
	border: 1px solid #333;
}

.xdsoft_dark .xdsoft_scrollbar >.xdsoft_scroller {
	background: #333 !important;
}
.xdsoft_datetimepicker .xdsoft_save_selected {
    display: block;
    border: 1px solid #dddddd !important;
    margin-top: 5px;
    width: 100%;
    color: #454551;
    font-size: 13px;
}
.xdsoft_datetimepicker .blue-gradient-button {
	font-family: "museo-sans", "Book Antiqua", sans-serif;
	font-size: 12px;
	font-weight: 300;
	color: #82878c;
	height: 28px;
	position: relative;
	padding: 4px 17px 4px 33px;
	border: 1px solid #d7d8da;
	background: -moz-linear-gradient(top, #fff 0%, #f4f8fa 73%);
	/* FF3.6+ */
	background: -webkit-gradient(linear, left top, left bottom, color-stop(0%, #fff), color-stop(73%, #f4f8fa));
	/* Chrome,Safari4+ */
	background: -webkit-linear-gradient(top, #fff 0%, #f4f8fa 73%);
	/* Chrome10+,Safari5.1+ */
	background: -o-linear-gradient(top, #fff 0%, #f4f8fa 73%);
	/* Opera 11.10+ */
	background: -ms-linear-gradient(top, #fff 0%, #f4f8fa 73%);
	/* IE10+ */
	background: linear-gradient(to bottom, #fff 0%, #f4f8fa 73%);
	/* W3C */
	filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#fff', endColorstr='#f4f8fa',GradientType=0 );
/* IE6-9 */
}
.xdsoft_datetimepicker .blue-gradient-button:hover, .xdsoft_datetimepicker .blue-gradient-button:focus, .xdsoft_datetimepicker .blue-gradient-button:hover span, .xdsoft_datetimepicker .blue-gradient-button:focus span {
  color: #454551;
  background: -moz-linear-gradient(top, #f4f8fa 0%, #FFF 73%);
  /* FF3.6+ */
  background: -webkit-gradient(linear, left top, left bottom, color-stop(0%, #f4f8fa), color-stop(73%, #FFF));
  /* Chrome,Safari4+ */
  background: -webkit-linear-gradient(top, #f4f8fa 0%, #FFF 73%);
  /* Chrome10+,Safari5.1+ */
  background: -o-linear-gradient(top, #f4f8fa 0%, #FFF 73%);
  /* Opera 11.10+ */
  background: -ms-linear-gradient(top, #f4f8fa 0%, #FFF 73%);
  /* IE10+ */
  background: linear-gradient(to bottom, #f4f8fa 0%, #FFF 73%);
  /* W3C */
  filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#f4f8fa', endColorstr='#FFF',GradientType=0 );
  /* IE6-9 */
}
Xtext/cssUutf-8_Vhttps://hdc-lm-dsi.euro.apple.com:9000/assets/stylesheets/generated_default_styles.css‘O¨bplist00‘jkX$versionX$objectsY$archiverT$top Ü†Ø#)*0123MNOPQRSTUVWXYZ[\]^_`aeU$null›	
 !"R$6S$10R$2R$7R$3S$11R$8V$classR$4R$9R$0R$5R$1Ä	ÄÄÄ ÄÄÄÄ”$%'(WNS.base[NS.relativeÄ ÄÄ_\https://hdc-lm-dsi.euro.apple.com:9000/assets/stylesheets/images/ui-icons_ffffff_256x240.png“+,-.Z$classnameX$classesUNSURL¢-/XNSObject#Aø±Æbãß€ »”456ALWNS.keysZNS.objects™789:;<=>?@Ä	Ä
ÄÄÄÄÄÄÄÄ™BDEFGHIJKÄÄÄÄÄÄÄÄÄÄÄTEtag\Content-Type]Last-Modified_Strict-Transport-Security]Accept-RangesTDate_Content-Encoding^Content-Length]Cache-ControlTVary_*"fed1857d4b06a74d0c2d04a275f58febe623fc7d"Yimage/png_Mon, 06 Feb 2017 07:49:38 GMT_max-age=2592000Ubytes_Tue, 07 Nov 2017 08:44:48 GMTTgzipT6176_public, max-age=3600_Accept-Encoding“+,bc_NSMutableDictionary£bd/\NSDictionary“+,fg_NSHTTPURLResponse£hi/_NSHTTPURLResponse]NSURLResponse_NSKeyedArchiver—lm_WebResourceResponseÄ    # - 2 7 Y _ z } Å Ñ á ä é ë ò õ û ° § ß © ´ ≠ Ø ± ≤ ¥ ∂ ∏ ∫ º æ ¿ « œ € › ﬂ ·@EPY_bktvxáíùü°£•ß©´≠Ø±ºæ¿¬ƒ∆» ÃŒ–“◊‰Ú!4CQVÉç≠ø≈ÂÍÔ37DI]auÉïòÆ             n              ∞OõâPNG

   IHDR         Eûr@   bKGD ˇáèÃø   	pHYs   H   H F…k>  ∏IDATx⁄Ì]]à%«u˛zΩ∂fV^ß«Ö;l≤´Yå‚†03∫±ÇÓ&)Î›]PÅªñ'„¨M@+Å»ãa∞ k§Ÿ≈‡`¬J!&~H2÷Ñ F⁄Çÿ∆»?ô!ê0ä_&`ãìá˛´™>u™∫˚ﬁπ?U_3sÔÌSuÍÁ|U›]ß™:!DÑå”Œ@ƒt	8"tÙ@ËM;«âH =Ïÿâ„&¿Ù€OmÔk3ÛØ¬FÅBÛÙÀ8FËê;@*	ÆˆcèOyÍ=kW⁄Ö€ï 3ˇANIÛı*∆—Æv–Pƒ-⁄astâ$Hp ‡ 	Asó2Œí≤1E,⁄Å‘™GE¶'iøhe∂Ù]iS«º˚jvïqéPı rË©∫/YÍí	e-›⁄¶t	R5wÎgfI„;&πIm∞J™m€qkê€¶úwπ¨4ª˙ôπBs»†©WM˚≠	&_Ç
Õ”/„1nÃ;zÿ_$Û∫	8‚H`‡àë Å# pDéHÄ¿	8‚| 3Ó¥ÛÃh2¿oFÄÀ”Á»)∏Õ”e>Ä€ûÂ}°H“l>ÄüLÆBªÅV-ﬂ}uªÃÔ“æo|⁄µ/ÃlÄ˙|Äˆ—"î‰o≥À]±}ÊHπìSw«óAπÓ‚s!†œ‡æÎ8Í¯0ÓˆÈ3@j~y≥”áú≥ö§4h„íÆ≥>@"ó´ˇ)J›¡¶_9]ÁL;ˇ«åËq (pDéHÄ¿	8"G$@‡à'ßùÅôMqîø˚Xi„¸üÏ}"ï0Õê3Ì]AÓòS(π~	 @Ùı˚Ï@-$M—6W˛3”'¢79⁄∆ˆ+ÅO®qOh\≈O<
`èüxTêOHpˆ¯‰/d˙g≥4
âª‰ "Gl¿’àµ¸´ó ﬂ‚€fÎ∏+)CO¢'“uÌí*c'¨TMùK•h^ˆ<ê óuW•ìõÅöÀhzH≠« áùÌ⁄∏üqÌíÅ|Ù∂≠©	˙Ëv◊AMﬁ‰1∞Í‚|BÒ2πt3X÷·Íb˝∫hWr•ÓsŸnäªÂZLwpËOÛù~ã«»8 pƒë¿¿	8"G$@‡àë Å# pËãCãÕRß˜~‡ìÑO¯xD€≈s≠çˆM•*£|∂{oW„C;]Æú˚’Ä¥’lÂçÎ5éù˘)ã√^Ü^Î #ó ¯≈°ÚNèvè97>
ÿt˘maœø_ÿ“ËÀk{çbW%pı@›ñ¶◊ËÍC¡>€©ªñ`€à˙Õ§qÁ¿¶«ΩÖª;Á~“Û>∑∫iCÓZX^á[üHöfŸalsX'ı0M	‡_IÉ∏~9ê´–'}˜⁄~{˙Æÿ.∏Î@6†õ 2Å,hˆPU@èU¢Ë‡µìˆ)•ﬂUæ€ﬁCH©ØÊ“‚
ŒÔ  •_ƒ‰Ô\ö´Ω§ıÕf.Œê*@øÅëä/gN*¢§C-ö{⁄g7•H4÷‡…ºÂko¸râ¶ó ?_59∑àêØÇ]b˚U/_økp˜)míûˆ/µqﬂ∞àÛTÙúoLZ8Dé88"G$@‡àë Å#`‹ò≥«*s>Äíø ßËΩé˛ÓI£{Ó«`˜åïΩ>@Ç‰1˜%,<v´LÌË∫∏J^û8óø∫lã/iü™Å 5[Ó›~ÎÉçÍ“»voˇˆh$èù+vbßûµy;•≈£‰%ı/È±Äø∞M:ê˝U’•°Õ§Ö¨Â∏ßMŸ˜0 ¯˙˙ígπtπÙ›+õgÊ˚™*l˙nÛí4à[H˝ñ@ªo∑ﬂBB2£´á◊,ÌpÃ®z ’Qÿ&kÆ7	∏ù≠]Øéâ“É=Ñ˛…ÖO+ÊR–{è1ø~	8(3≈u‡YüM˜‚q ŒÒˆª∑áêQÕ‡ßT»U_]ÑÏªã!ìÜR5D€	5Ô$kÓ„,µ›é√ŸÍ7k±Ìç¶œM$ Ag∆∏>àÓ`3”5"G
ë Å# pDéHÄ¿1{HgÀ[∂Ë0	‡ÁÀñ\6‰%µÖHqx,O‚”ﬁaf–lªxüÌ§¨t»œ!
í§b∏∂[÷WX†7ÄwÅN yîZÌ.ZuäCñTîÚk˜≤Æ•qhâ_|k∑©∫⁄˚¯Ωj~¡Q@ﬂÓΩé n€2=Aíõˇ6-πkœ∫˛∞"¨ù-RÁ”◊gòZ¸∂è≈P∞ﬂÍv	≈\õ˘Õπ8f/‚˙-ù≠KÃpÊˆ“[ŒÉÇ:%,A›L&ÏS¸&Dÿ'ïô≤M…‡sË⁄>A'¯ÇΩæ™F®Ufﬂ`ƒ˝÷ﬂ◊Jÿ‰®vQ8Ç˘]˘ı¸¯º6" ∑?Äﬂ ı∫_ﬁΩCç$ÕnÂ∫∂ƒÎ\˜BÅ¬ˇÖ˙¨ÿÍ˚∏aøãËˇÌ#Ç¬¨Õòî˘#,ò5D3fœq¨àë Å# p,˙•'†?˝'±îÕﬁ∑:”»0Ã+n√÷ö^vx˙] ‹–f45b{Â˜=6vø=N‚WxG8¬£¯KÅæ3˜kπtÕíÜ]Óä	<gr
∆‹¢´4†IE∂:?$X*?∑µ∏j^{vå®Ø…Gö¥O&˙ç‰zπ‹≠Ò◊˘≠—-—:-	5¿ßQáTC˛5ƒ∂wÀìÔ ÓX&s‹∆óq@ä€Âπ;∏`e„,#äÀÂ∑£öÏ&æ!¥ø=dKdÿaOKa[J lr7ﬁWróÂ–åÀx@˜ç∞z>Å-F‚õõ./üó±Ü˜ÀÔ•¶Ç ˜ÛOuÜöÂ{ ~Ñ#q∂œR˛y√‚£BÏ+x€Ç¸íÊJæ§P1√€
∂∂!%®ã3˘Ü≈/ Ôü`Û >ÅßÑ\^d¶GíóÛ/†N-Õ^òˇœÍÈÍZvËP#’¬ËY»∞"h≥µ¿’ oï \¬[LàÇuÛgHçœzÓ~]ÃÈ˛‡±¡∆()ƒÁ`+Ô©ÙﬁÍ8Pòˇè∞¨S¿˜~ñ3Ωπ£ ⁄ŒOYô´(( ã˘ëßÎMﬁy„”ƒ~û;ÀHƒªÿ¿} x·ˇπ9©Ì2SwGÔ
Ò9¸MÌ\f˛/‡A ˇ  ≈‹ˇ1∞n~≥Äßp
ß∞åS÷NÚ<Ä p-Ï¶√¸@o·.·-ÀtŒ>0ƒ-ÔÛóÒ[˘±\À_g@¯6∞Å úßînYåN˘≥a	.∏B|ã9óë˛>ÜÔ  .‡N&hˇD[/‚≤3ŒÖêÆ†á o˚Lı˜59GÅﬂ0>Õ* Z…≤;"Ωüx˜¸§¸}¬å¢.¸Q«¸ÑŸü‰ÂÀÓœJÛ£|LèQÓGòó5˘À÷«˚cÃç	>I’ß-}Êê{às=Ë5}ç¨•˜	°ñê◊_<‘≥≥„Ó¯Â˜{ñ©…Ç úWZ˙¯µgòŒ‘î5ºØµ~ƒ˘ ¡cë|-	8"G$@‡àX,ºÇWöE–	êÇ‡ZòmïéåÆè}pı-ÂÒµÓoèΩCCæm»πA'’[æ69 ¸•£~¥Æ∑”¯
æÇ”éP#å0*)uíQü˙Dî÷vi)F∏FÎ4dáAn‰€t√êÀûlÛË≥·∑O6—;Rı¯ÓÅú,Ã:≠”˙Ñ‰EòlP«î®êKÕ·ö‹:D€Ñºt)£˚.›k∑L—9AO†üè°’’ıçÉqr—üÂW≠‘ßlJﬂ¢ñ\&˝;ÅÓËﬂàü2A¥ûK÷9D˘iZ¢”yQ˝#5Æ¡€¨|ª{õMHD#J´ëD’\8)˜∞’j£uÆ Ô9|˚¯1~Äü„=ãO∞è=\¬Vón¸~ﬂ√æá'/÷PŸX˙Ü(◊«,u¸≤Ê'¨0¬M »ˇ◊ÎÔP˚≈Éümq÷„ |	¿J~yLÒ ‡Ü1öﬁßç{ µÉ≥ı WâË/àË∂ÖÙâÿ÷?Æ‡o	Ù]}ãñòÙuÙ Ö¢‹ﬁå¥‹ôóÄÅíÎÉFÂ˚™&˚*SÉÁË\=u3â~NÑzıèÉ ü°ﬂ§œ—˘¸Øâ˘ıYq6§DîRö_/M˘wàË€˘ﬂﬂ’‰E˘l◊J˛∏CŒ«ØÆΩŸqæ!Lw]*‘êÏj“Œõ
‘O]∂DCB…°B&@›_◊ƒ¸fÒdÚ≥Ù]zòvÈa˙{˙¥!_≠Ânm¨Ú ¸∞∫âSQnìﬁÕoM˘àäkˇn[¿qPûç‘3<o‡æUæeT0˜êñEÁ	b'`Ü«πÎ"á√¸>.˜Ç)#{ä>Ão¸∂ÈCzä!¿U’„˙&Ô6®~ ﬂÉJìñeÛõÿ™I]”∫e9Qœaú.Úë”¸Æ«¿ä©%ˆsÂ˜Áj±≠=êØ;xÔ˙åËà†{Ï«Ñ ‡ñy:Œ—8"G$@‡à· s…†|6z‘Cèm7≈9ª´V	∞^V¿zk}4µ*HAÿ…øÔ¿6´·Zæ®t∑FÅﬂ«..„2>ÖO·á¯t-fV;WÛ_Ÿû•ÍæÁõ¯,O‡	>ãÕZ|y˚äaÌ¡~ËêªBki#@ÊŸu"⁄•!Èê*ß7‡!fê3D˚cîÁkùT…∞C†k.ä·êsÏP◊©Ú¯;∫C√<ôûìæ}ØR§ña0˘L;µË…∆˚π7L˘‘Î≈w5@6JºCDáV#Nì ≈XüFaˆÍ≥Æ·ö8÷yÇ>B	%Ù:¡dH ¢AÈ”Ár'@ıáò+ó2oHø¨„:†Õ¢® ”∫]é…r8C´˘¡`òW„;„«E rVÅ€∏r¸uE∆ıP;äú3*Í'J cçI˝zkóR•l˜ê‚‡	`Oü Wº*}úCùc	 Ö |ü≤Nõ¥Y˙+Ï‰U«O˘r1\—L »ÂSìZ5„)√¿êõà÷ÚÉË:£aP∫lπÙâNw"¿C˘Ÿá ˇfÏ¢ˇ—9K`Øø>ù°3¥JghìàÆeÁ’˜|Ä7Ò˘¸IﬁqNπ¥õ∏[ •∞^Ócí≠—7ÒM¸q˘˝˚¯=Mñ*3ûÄ+ı1q¨„K ØóÒ3!ı¨ñÃÚØ ¯ KfÉ¬ä6œ |¡≈#⁄y¬œπ>_Ë&ælÃ⁄ ∂œ&ÀÓ1€˘_ ÄˇTjWÎ`iHC⁄•Ÿº	,Zü∆7À÷ü·Æ∑ü∑˚‘™≥l;Áÿ‘wË*Qﬁwyˆ˘êÂFœúhc∂ﬂ«Ë1„ø‹4øRü6iì6âh≥~	PØ±6Ûœ˛S¿]*Ê∆r’3p§∞C€¥ÕNßB;£G~ôg◊j!Üµ|hƒ<W;ö›À√B ﬂV8-»G™¥˙ªdzÕ≥÷·S:[˛≥ûÂêR*n'ìZ‹œ”g®'‘î˚]∂î?dˇÕmËÍ1)2•jÈ¥2Fw∞äáÄÒ?¨tÑ‹Ãﬂfê‚Òk⁄õ\˜HÄæôÂ$Ê=∑@$@‡œ°! pDì CÎ~·q´º°º%nâ1O–n—mÊÊãµáê/NÂa/c>‘œî∆}∆vQ{z,pëQ∏GD{÷‰~Í9 è«Ï)Ùﬂõzn&@Ä€T¯úÃ>‡5ñ Ø1
ÂÅ†⁄0Ñ’¸I‹À´\!\r¢Ωr∏hèï˚ÂééÍÎ3öÅı>¿Ü¶ Å]∏Y7ΩüP◊÷ÚtÖ—”¥DO[5¯ïnA	ê]ˇØ≥ﬁËó™aõlÀ¬TÛÔ2íA˘…_&\∆An¯4'':ˇˆ¥†aOHcÅ	0 ™¸	¿wﬁ∫¶{åGÆàg3ø/R≤˜1Té∞◊˝ıÏË—Ì—˘¯Ê‰0+¿¸ﬁî Æ£0R›¸ôŸmÊüÖ`Åo´ˆü*~Á _g	uF°´∞jƒ«ü˛=ÄõÇsxpE´Ú)V˙£–U9v©‘˙uèZáË˙êÖô∫—∆OÄ=÷¿j<_ì>o5„@HP¢G€ﬁ„xè#Äø;¯IÒÁ˘˜Ø·¸Î¥«0ßÑ∂ÔöQƒ˘ Å#zG$@‡àë Å# pDòÄZKÁ*àŸ6Aa\ØÑònÔ6Äv[KÁ∆(—Æ0ßzLI/µj–nÓ–Æ†Ñ|yì.ﬂ÷4µq◊ÉÕèÿEÿµÃ’¡WüÕÑ‘xıjîq˘
{YÉù ∂¯>ê§≤£ß.]ê!a[!˘i.d&¨~ÎRJ„π4ÿ`èÔ&@S€•¸sy7Åwpﬂhq=πÉ∏Älù‹eÃ<QŒ^w¬-4ÿ‡ä<X$o@çÂã|‡:ºPùAÑ;xIl_î≥ø¯ú/®O.∂‹g˜˘Ì§sâË41¿Æ`bY:áàq$0pDéHÄ¿	8"áI R^, *§˘V©gq÷≤◊~6ttÕ"çòKHqXnÛY#o‡æÜqËÒB	sxa€Å‹>fyÑyçÌ—_àËE ˆ≈µçß‚^¬’®ºÎwˇXÂÒ∞ÖQâÓÙ"tèloßﬁ°sî9eS´R~ß⁄•|;ı”˘üπ”Ìií6\/‰$ ó ø•÷°¿éì ÄÛ ﬁ º x8_€ tõ∏â+xópà+∏ﬁ®´˘§“È$®è@<ˇK¿/ø:ùˇ}¸ÊÚ∞íÀWkº~í»|)q_y——=l`E€	∑@äC‹¡Ï‡
[…îÔT_ﬂ≠˛∑µﬂˇaÏï;iyÑyW∞K’¢ÈÒõ∏dæÏ}∂ó ÿÊÀËÔØœ7ö¥<ñ£fÔ√∏è7Ò,6¿øë£öp`‹¢jÎ_∞5¥ãã ºék˘É‡∏_
‚|Ä¿}Å# pDéHÄ¿Q¿ı>ÄÆÚ'qΩî_«ì«.üt˘¶-oã\ßÎ} ]ÂÆmÊ&-üt˘¶-o}dâCı>ÄÆr◊FììñO∫|”ñw8≤K¿Â≤CHîºÀÃ7¶¸Ö<nÇ˘≥ä~0güÂ‘[‰Iã¯óŸ¯\˘\ÂWÛﬂ<˛€Hî∂¯í\ÕoïÜ»Ç™—†§ˆKós)‰	ÄÁºÆùü~ü¯n˝jà¶ÒÃ®¡oR¥‘Â ¯kk˝g7Ò∆≤HM%Ä˛.Íz\r‡º‡yº&V∞≠Ç‹˙VõØ‹˙etØü§<ﬂN˛8ﬁQÃ?úÏÆB¡á ˇÊ gè C]éﬁFC¢|∂âOq]n≤?dè„ûf˛±`‹óÄÄ[h	Ëﬁ≈€ÛW◊–ÆóÙ˚ı Æ ñ˛„∏ßô=@v¯*+{ï˘&…üp7Ûo™¸u%1g_W§.9D9Xπû™ù}Uì∏‰mÎß(µñø£ôüOµ)ÇxõˆcË§Âù« f⁄Qìñw& ËI∫^*øNO÷Çvï_§[•¸3à1i˘§À7myÀ#N	—8"G$@‡àë Å# p®Œ†∫”Q«¨À#Z@˜.óﬂéÿ–]Â3á˙%†õÈéú∫µ‹§≥Ü&\<¬ë(_∆ë“‘·2†:%äµÙıGX``∏åeQ~Ñeë y¬DÓ°∞"Æ;3ÍóÄÂZÙÿ≤ÜnÌ◊E†àÜ–ﬂ†Ijag]——8‚@P‡àë Å# pDéHÄ¿1øË≈°q@'@˜q6BÑ˛ƒÛ›√>V'ûJ –	∞öˇMÆ÷ùôˇ`⁄Ÿ\Ëÿœˇ¶WÎéÊ#|{ BØˆ◊Ã™$ôyÌ4,ÃÔ∆}F–>Ï≥nñÑ˘kÜ-ØPÖ˘WE˘AºtH=¿jiö‚ØY'ºW;S'QO—œQL7ºå≥‘DÛOæ=@w∏ﬂﬂ—Ã¸=K∏àFÌéRÔ¬ô?ﬁå˙Ñê–õ…ŒïÚNﬂ¸åËà8#(pÃØ/ b,¯Ç?P¶w∑»   %tEXtdate:create 2016-07-13T10:21:59+00:00âã   %tEXtdate:modify 2016-07-13T09:26:54+00:00ÛÕ†   tEXtSoftware Adobe ImageReadyq…e<    IENDÆB`ÇYimage/png_\https://hdc-lm-dsi.euro.apple.com:9000/assets/stylesheets/images/ui-icons_ffffff_256x240.png‘O1bplist00‘45X$versionX$objectsY$archiverT$top Ü†´%&,-./0U$null€	
R$3V$classR$6R$1R$9R$4R$7R$2R$5R$0R$8ÄÄ
Ä Ä	ÄÄ ÄÄ” 
!#$WNS.base[NS.relativeÄ ÄÄ_Fdata:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KTMInWQAABqNJREFUGBnVwXlYDggCx/FvvYbQ43ixlnKmi6TU5hjnGPGMxv3GOPIUWufkmlEKRRemKUm5p7eJNWrQmsd0uHO182jyhJ4Y5nEtmTHYZ9fK0W/fZ3nWM48Z1c7jj/l8+D1rN2HCxAKgA68a4+Lis4E3bLAsYmPX3gXsealVack9xceaHwCugBVvyChZPKmsUvD0+eeAelhMmbK4sPJRlZyd+5cDvoCBN8RdL3xXfl/GJi0TgfdPFlZqR2aFgDygF7XQGLChFmJiVv9NFpWPqjRl4ryrHl1Hns7IeKCAgL0CUgEHasiqZ8+enwPOgIGa67pz+5c3b1y7r+Sk3c/69v3on1Onfatmzcc9BkKBptRQr6iolaWAO9CQ2onPzyvSp5/8Rd7ei+XuuV3AWWAyUJ+amDv3wwyTyXQI8ALqUXMG6n1wLywsW6kpORo/PkE2DfweAmmADzVkuH377jNgPeBG7Qx3cE7QyugCnS2+rpi4w3L3CKkEIqmFobIAlgNteFU7A/XHGo2d5huNDguh3ry2bb3NzZp5fNbEOOyKvUOCAqdm6eqVOzp/7q4mBx4W1n63AUdqwjTCFCULYCHQmP9p5DjBtLTg88/OKi25TAlrzigiLF+hodu1b9/3mjMnV55/+kR2HVZpyLAtOnLksr7KKVDXrlPk0nWrwHYHYE11Ylas2S0LIBR4i+daBAdu+9e+Pf9Wbs5PysmukHnTZSWsOaOCA9eUnX1RAQG71d0rVZ2cE+XVK0WZGWe1JytXnV17a8CgrYKBPwDeVGfTpswTsgBW84JNXZflKck3lJZcJvPmSzJvvqy1n57TxrRzOl30dyUmfiPfoely67ZO3Tw2qmWrWM2as0eVj6r03cWf9GHIQRlb/FmAP9VZu3bLMVn07zM4nxd691p0ITrqgmJXnlFSQqmSEkoVtaxIGeYynTpxU7Pn7Fe37uvk7bNFzq4xcvdYKXC4GRQUcVcWhw7dku/QdAFrqM6KyIQDsigvuyPAD4tRI8wKmXNUixYcU3hooZYsLtTM4FylrDuprF3l6ts/Ra5d4uTllaSxY9MUEnJM0OMKsNg0JrhUFl9k/aC6NsNuAe14Hd93Rybrhb1ZByugQZrv4G1PJ036StOC9it4ep5mTC/QuLHpio/bqw0bLsjNPVrtOi5VZ7f5WrLkuOaGHFUT47QnwHuAo2nU9POyWBx6WkAC1Rh+9cpTXb70RD9WPNPmTSfUr99mDRu2U6NHZ8vff48WLTqs9PTzCl+6S/Gr8hQeXqDW9kGC1ho5eoPCws6ok+NCAcE85zR7RsSdJ5VV8vRaIMCb1/lg/EelJcWPlZ97S2tWFciz+zq9/Xa6BgxIl2lsttLSzup44W1t3HhWkwPMmj8/U/u/vqoRIxLVuKmfIiOPa8jQzQIieKnfli05Kil5LOhwhGqMS0os0pfZ9xQXVyhn55Vy99gob59NCpiSo127Lio//6YyM8sUFXlK77yTpKCpqfqm6IHGjIlXcPB6hYWeErAPeA/owHMRhw6WK+TjQwKiqcaK4OCdiosrUzfPVWrbMVGd3VJk8s9WRuYF5eXd0PYd5YqOPqHx47+Qo1OEFixKV0ZmsdzcZyk1tUS+vvHy8Vml1vaLBZj4L4M5Yc1+Bc85IWhhBurwKwzAjMaN+5S16zBTf7SLVyenZI0cnaX160uUm39DZvN5xcScVmBgjly7xAnsK5r9wf0q8H1ISNqTlJQS2TYaIWj/I7AAqINFD6u3Ctq38LgBza8D/QEDv8Ia8ATCoPdtB0ezevZOUWTkMRUVPdCOHeVKTv5Wc+ceVb0Gox4CW4FZwMQ+fQKv37nzTMOHL7kPfA0E8NJAO9gJjAK8gbpUwwAMAKdiG9tZcnIJ1bx55qqCgmvavfuqZs7OqgJygUmALc/5+fj4X7py5amSkkpl32aGgB684A6RNhBELTkB4UB6q1aDruXmPtCpU/9QbGyegI1AI36ub5cu/td9fUMFNpeBQKARzxnbQCzQF7CihqyAloCLtXV7c9SKYmVnV+jkyUoNHDj7EuDOq/oD0cByYCjQkJfaAiZeqkMt2ALLWtsNuRkWXqy/7nuoj0P3CIOHGRjAS/UBR8ABsOXnXN6Fy01hdUdYBXhRSw0BX2Cns+u0J/kHHmnd+otycl4mYBiv1wToAvQEFgLbADv+T7ZAuLH5+5V2bUwCVwFLASO/zApoB9gDnsAgwBcw8hv5AUuAUMAPaMQvswKsAQNgAxiB+oCB38gGaAG0BBrye/Qfn69lSjkErBgAAAAASUVORK5CYII=“'()*Z$classnameX$classesUNSURL¢)+XNSObject#Aø±Æbã±‚Yimage/pngc#Ôˇˇˇˇˇˇ“'(12]NSURLResponse¢3+]NSURLResponse_NSKeyedArchiver—67_WebResourceResponseÄ    # - 2 7 C I ` c j m p s v y |  Ç Ö á â ã ç è ë ì ï ó ô õ ¢ ™ ∂ ∏ ∫ º%(1:DGPUcftÜâü             8              °OcâPNG

   IHDR           szzÙ   sRGB ÆŒÈ   	pHYs     öú  YiTXtXML:com.adobe.xmp     <x:xmpmeta xmlns:x="adobe:ns:meta/" x:xmptk="XMP Core 5.4.0">
   <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
      <rdf:Description rdf:about=""
            xmlns:tiff="http://ns.adobe.com/tiff/1.0/">
         <tiff:Orientation>1</tiff:Orientation>
      </rdf:Description>
   </rdf:RDF>
</x:xmpmeta>
L¬'Y  £IDAT’¡yX«ÒoΩÜ–„x±ñr¶ã§‘ÊÁÒå∆˝∆8ÚZÁ‰öQ
E¶)Iπß∑â5j–ö«t∏sµÛhÚÑûÊq-ô1ÿg◊ —oﬂgy÷3è’Œ„è˘|¯=k7a¬ƒ†Ø„‚‚≥Å7l∞,bc◊ﬁÏy©Ui…=≈«ö ÆÄo»(Y<©¨RÙ˘ÁÄzXLô≤∏∞ÚQïúù˚óæÄÅ7ƒ]/|W~_∆&-Å˜OVjGfÖÄ<†µ–∞°bbVˇMïè™4e‚º´]GûŒ»x†ÄÄΩRj»™gœûüŒÄÅöÎ∫s˚ó7o\ªØ‰§›œ˙ˆ˝ËüSß}´fÕ«=BÅ¶‘PØ®®ï•Ä;–ê⁄âœœ+“ßü¸EﬁﬁãÂÓπ]¿Y`2Püöò;˜√ì…tÍQsÍ}p/,,[©)9?>A6¸iÄ5d∏}˚Ó3`=‡FÌwpN– Ëù-æÆò∏√r˜©"©Ö°≤ ñmxU;ı«çùÊç°ﬁº∂mΩÕÕöy|÷ƒ8ÏäΩCÇßfÈÍï;:ÓÆ&÷~∑Gj¬4¬%`!–òˇi‰8¡¥¥‡ÛœŒ*-πL	kŒ(",_°°€µoﬂ˜ö3'Wû˙DvVi»∞-:r‰≤æ )P◊ÆS‰“u´¿v`MubV¨Ÿ- xãÁZn˚◊æ=ˇVnŒO …Æêy”e%¨9£Ç◊îù}Qª’›+UùúÂ’+Eôgµ'+Wù]{k¿†≠ÇÅ? ﬁTg”¶Ã≤ VÛÇM]óÂ)…7îñ\&ÛÊK2oæ¨µüû”∆¥s:]Ùw%&~#ﬂ°ÈrÎ∂N›<6™e´XÕö≥Gïè™Ù›≈üÙa»A[¸YÄ?’YªvÀ1YÙÔ38üz˜Zt!:ÍÇbWûQRB©íJµ¨HÊ2ù:qS≥ÁÏW∑ÓÎ‰Ì≥EŒÆ1r˜X)p∏qWá›íÔ–tk®Œä»Ñ≤(/ª#¿ãQ#Ã
ôsTãSxh°ñ,.‘Ã‡\•¨;©¨]ÂÍ€?EÆ]‚‰Âï§±c”rL–„
∞ÿ4&∏T_d˝†∫6√nÌxﬂwG&ÎÖΩY+†AöÔ‡mO'M˙J”Çˆ+xzûfL/–∏±Èäè€´.»Õ=ZÌ:.Ug∑˘Z≤‰∏ÊÜU„¥'¿{Ä£i‘ÙÛ≤XzZ@’~ı S]æÙD?V<”ÊM'‘Øﬂf∂S£GgÀﬂè-:¨ÙÙÛ
_∫KÒ´Ú^†÷ˆAÇ÷9zÉ¬¬Œ®ì„B¡<Á4{Fƒù'ïUÚÙZ ¿õ◊˘`¸G•%≈èïü{KkV»≥˚:Ω˝v∫Hóil∂““ŒÍx·mm‹xVìÃö??S˚øæ™#’∏©ü"#èk»–Õ"x©ﬂñ-9*)y,ËpÑjåKJ,“óŸ˜W(gÁïr˜ÿ(oüM
òí£]ª.*?ˇ¶23ÀyJÔºì§†©©˙¶ËÅ∆åâWpzÖÖû∞xË¿sáñ+‰„C¢©∆ä‡‡ùäã+S7œUj€1Qù›RdÚœVFÊÂÂ›–ˆÂäé>°Ò„øê£SÑ,JWFf±‹‹g)5µDææÒÚÒY•÷ˆãò¯/É9aÕ~œ9!haÍ+¿å∆ç˚îµÎ0S¥ãW'ßdçù•ıÎKîõCfÛy≈ƒúV``é\ªƒ	Ï+ö˝¡˝*}HH⁄ìîîŸ6!hˇ#∞ ®ÉE´∑
⁄∑∏ÕØ˝ø¬¬†˜mG≥zˆNQd‰1=–éÂJN˛VsÁUΩ£[ÅY¿ƒ>}ØﬂπÛL√á/π|“@;ÿ	åºÅ∫T√  ßb€Yrr	’ºyÊ™ÇÇk⁄Ω˚™fŒŒ™rÅIÄ-œ˘˘¯¯_∫rÂ©ííJeﬂfÜÄº‡ë6D-9·@z´VÉÆÂÊ>–©SˇPllûÄç@#~Æoó.˛◊}}C6óÅ@†œ€@,–∞¢Ü¨ÄñÄãµu{s‘äbegWË‰…J8˚‡Œ´˙—¿r`(–êó⁄&^™C-ÿÀZ€π^¨øÓ{®èC˜Éá¿KıG¿∞ÂÁ\ﬁÖÀMauGXxQK_`ß≥Î¥'˘i›˙ãrr^&`Ø◊ËÙ€ ;˛O∂@∏±˘˚ïvmLWK#øÃ
hÿû¿ ¿0Ú˘KÄP¿hƒ/≥¨`Å˙ÄÅﬂ»h¥Ú{ÙüØeJ9¨    IENDÆB`Ç_Fdata:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KTMInWQAABqNJREFUGBnVwXlYDggCx/FvvYbQ43ixlnKmi6TU5hjnGPGMxv3GOPIUWufkmlEKRRemKUm5p7eJNWrQmsd0uHO182jyhJ4Y5nEtmTHYZ9fK0W/fZ3nWM48Z1c7jj/l8+D1rN2HCxAKgA68a4+Lis4E3bLAsYmPX3gXsealVack9xceaHwCugBVvyChZPKmsUvD0+eeAelhMmbK4sPJRlZyd+5cDvoCBN8RdL3xXfl/GJi0TgfdPFlZqR2aFgDygF7XQGLChFmJiVv9NFpWPqjRl4ryrHl1Hns7IeKCAgL0CUgEHasiqZ8+enwPOgIGa67pz+5c3b1y7r+Sk3c/69v3on1Onfatmzcc9BkKBptRQr6iolaWAO9CQ2onPzyvSp5/8Rd7ei+XuuV3AWWAyUJ+amDv3wwyTyXQI8ALqUXMG6n1wLywsW6kpORo/PkE2DfweAmmADzVkuH377jNgPeBG7Qx3cE7QyugCnS2+rpi4w3L3CKkEIqmFobIAlgNteFU7A/XHGo2d5huNDguh3ry2bb3NzZp5fNbEOOyKvUOCAqdm6eqVOzp/7q4mBx4W1n63AUdqwjTCFCULYCHQmP9p5DjBtLTg88/OKi25TAlrzigiLF+hodu1b9/3mjMnV55/+kR2HVZpyLAtOnLksr7KKVDXrlPk0nWrwHYHYE11Ylas2S0LIBR4i+daBAdu+9e+Pf9Wbs5PysmukHnTZSWsOaOCA9eUnX1RAQG71d0rVZ2cE+XVK0WZGWe1JytXnV17a8CgrYKBPwDeVGfTpswTsgBW84JNXZflKck3lJZcJvPmSzJvvqy1n57TxrRzOl30dyUmfiPfoely67ZO3Tw2qmWrWM2as0eVj6r03cWf9GHIQRlb/FmAP9VZu3bLMVn07zM4nxd691p0ITrqgmJXnlFSQqmSEkoVtaxIGeYynTpxU7Pn7Fe37uvk7bNFzq4xcvdYKXC4GRQUcVcWhw7dku/QdAFrqM6KyIQDsigvuyPAD4tRI8wKmXNUixYcU3hooZYsLtTM4FylrDuprF3l6ts/Ra5d4uTllaSxY9MUEnJM0OMKsNg0JrhUFl9k/aC6NsNuAe14Hd93Rybrhb1ZByugQZrv4G1PJ036StOC9it4ep5mTC/QuLHpio/bqw0bLsjNPVrtOi5VZ7f5WrLkuOaGHFUT47QnwHuAo2nU9POyWBx6WkAC1Rh+9cpTXb70RD9WPNPmTSfUr99mDRu2U6NHZ8vff48WLTqs9PTzCl+6S/Gr8hQeXqDW9kGC1ho5eoPCws6ok+NCAcE85zR7RsSdJ5VV8vRaIMCb1/lg/EelJcWPlZ97S2tWFciz+zq9/Xa6BgxIl2lsttLSzup44W1t3HhWkwPMmj8/U/u/vqoRIxLVuKmfIiOPa8jQzQIieKnfli05Kil5LOhwhGqMS0os0pfZ9xQXVyhn55Vy99gob59NCpiSo127Lio//6YyM8sUFXlK77yTpKCpqfqm6IHGjIlXcPB6hYWeErAPeA/owHMRhw6WK+TjQwKiqcaK4OCdiosrUzfPVWrbMVGd3VJk8s9WRuYF5eXd0PYd5YqOPqHx47+Qo1OEFixKV0ZmsdzcZyk1tUS+vvHy8Vml1vaLBZj4L4M5Yc1+Bc85IWhhBurwKwzAjMaN+5S16zBTf7SLVyenZI0cnaX160uUm39DZvN5xcScVmBgjly7xAnsK5r9wf0q8H1ISNqTlJQS2TYaIWj/I7AAqINFD6u3Ctq38LgBza8D/QEDv8Ia8ATCoPdtB0ezevZOUWTkMRUVPdCOHeVKTv5Wc+ceVb0Gox4CW4FZwMQ+fQKv37nzTMOHL7kPfA0E8NJAO9gJjAK8gbpUwwAMAKdiG9tZcnIJ1bx55qqCgmvavfuqZs7OqgJygUmALc/5+fj4X7py5amSkkpl32aGgB684A6RNhBELTkB4UB6q1aDruXmPtCpU/9QbGyegI1AI36ub5cu/td9fUMFNpeBQKARzxnbQCzQF7CihqyAloCLtXV7c9SKYmVnV+jkyUoNHDj7EuDOq/oD0cByYCjQkJfaAiZeqkMt2ALLWtsNuRkWXqy/7nuoj0P3CIOHGRjAS/UBR8ABsOXnXN6Fy01hdUdYBXhRSw0BX2Cns+u0J/kHHmnd+otycl4mYBiv1wToAvQEFgLbADv+T7ZAuLH5+5V2bUwCVwFLASO/zApoB9gDnsAgwBcw8hv5AUuAUMAPaMQvswKsAQNgAxiB+oCB38gGaAG0BBrye/Qfn69lSjkErBgAAAAASUVORK5CYII=‘ !"O	qbplist00‘45X$versionX$objectsY$archiverT$top Ü†´%&,-./0U$null€	
R$3V$classR$6R$1R$9R$4R$7R$2R$5R$0R$8ÄÄ
Ä Ä	ÄÄ ÄÄ” 
!#$WNS.base[NS.relativeÄ ÄÄ_Üdata:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAACXBIWXMAABYlAAAWJQFJUiTwAAABy2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgICAgICAgICAgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIj4KICAgICAgICAgPHRpZmY6T3JpZW50YXRpb24+MTwvdGlmZjpPcmllbnRhdGlvbj4KICAgICAgICAgPHhtcDpDcmVhdG9yVG9vbD5BZG9iZSBJbWFnZVJlYWR5PC94bXA6Q3JlYXRvclRvb2w+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgqyI37xAAADM0lEQVQ4EV2TTWwTRxTH38x++SN2YhyTqAEao6AgrKpS4cAFya04Va16CoceGqVFcKt64oBUKZwqceECAokD91x66KktalMJqbRFkAOJCgHiyHYc29vd7NfszuzsTmctFbl50hvt7PvPb57+M6OADCEE2mo0lEsy5RS3Wi2c/c5qh2NpaUm5tLmJ1m/cGNXRYcH4/Nmv9tTj33481mm16zYfnp1cnO5/9+21u+OaEeDh4zczz396NN/baZ9yuHOaqP4iybMFOhEfVypqtTxXhliPwfg9cT69+PFHXcsSXy8vP8tAaPXmrctPXz65789RqNSrgIsaYF2AjhHgOIECNwSOcOKbXDjPY/DTMpSRx5evflH/7Pz5vupu2Wi/4cJ7F88y5UmE3Ve+YEER+dEUSnMVzEsVSCfKqjo7JZhOkT6xsNn75d7JP9d/OCUb6KtlNLk5QQxQ9qi6dXsXF775CpRyDYxCTqYGCCFIkwRYkoII/wHEE43mp7HZ+WtRAh6ptXcq7Xg/Cn0R5isf5IU6VZQ764ARA/+AZkcEjKeAVAViRUDshzlaqDKr0zuTeYCbn6/0xR7bDxiTYldQywFFAwijBCKagEc4UCp3l4tD6QsJw3xsVIjrkqwDwI0GYqqZ7g5MF7hGUnpgS2sFuG4MjkzX56BIU0PGwYsAgiAq+GqNeIE+PwJkgx7CttVzIRIhRI4JthPDwEnADgRoBoZY3rQDLwU31oXjUaNnYubGlZnr1y/PqBlASdCLcOADNyAhvYE6nOXigAAqKLL9gIMzTJAfYAhtBrhtqgVtjpJ02mhtf//uCKAWtVfm6z04Ui0ZpPMG3Nw+4hEGiiA2OWZporEoZIzYsi0hTyTt5h2PlWx39v0RoH5uYevc06CdWAF1SPsYaTmWm+aQQj0tF3tGPhoWS2F3sgZDYSArMKBLS0dn/jgx33zx9i2sra3pGxsb1Z8fru9YvqGVdGLpuDvQtc6uYcB2Lnf873xh9mX5yImdCxc+2VtZWZGWSr+zYTyuXPnyQ6v/mh+dq2/fufNgIC9SOl4f+8arq6v/A/wHO/yMlWazOarVajXRaDSEXJhpRrp/ARoNpS+DtZxPAAAAAElFTkSuQmCC“'()*Z$classnameX$classesUNSURL¢)+XNSObject#Aø±Æbã∏oYimage/pngî#Ôˇˇˇˇˇˇ“'(12]NSURLResponse¢3+]NSURLResponse_NSKeyedArchiver—67_WebResourceResponseÄ    # - 2 7 C I ` c j m p s v y |  Ç Ö á â ã ç è ë ì ï ó ô õ ¢ ™ ∂ ∏ ∫ ºFKV_ehqzÑáêï£¶¥∆…ﬂ             8              ·OîâPNG

   IHDR         Ûˇa   gAMA  ±è¸a    cHRM  z&  ÄÑ  ˙   ÄË  u0  Í`  :ò  pú∫Q<   	pHYs  %  %IR$  ÀiTXtXML:com.adobe.xmp     <x:xmpmeta xmlns:x="adobe:ns:meta/" x:xmptk="XMP Core 5.4.0">
   <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
      <rdf:Description rdf:about=""
            xmlns:tiff="http://ns.adobe.com/tiff/1.0/"
            xmlns:xmp="http://ns.adobe.com/xap/1.0/">
         <tiff:Orientation>1</tiff:Orientation>
         <xmp:CreatorTool>Adobe ImageReady</xmp:CreatorTool>
      </rdf:Description>
   </rdf:RDF>
</x:xmpmeta>
≤#~Ò  3IDAT8]ìMlG«ﬂÃ~˘#vbì®£† ¨™R·¿…≠8U≠z
á•Ep´z‚ÄT)ú*q·â˜\zË©-jS	©¥Eêâ
‚»v€€›Ï◊ÏŒÏÏNg-πy“ÌÏ˚œoû˛3£Ä!⁄j4îK2Â∑Z-ú˝ŒjáciiIπ¥πâ÷o‹’—a¡¯¸ŸØˆ‘„ﬂ~<÷iµÎ6ûù\úÓ˜Ìµª„ö‡·„73œz4ﬂ€iür∏sö®˛"…≥:W*jµ<WÜXè¡¯=q>Ω¯ÒG]À_//?À@hıÊ≠ÀO_>πÔœQ®‘´Äã`]Äé‡8Å7ép‚õ\8œc”2îë«óØ~QˇÏ¸˘æÍnŸhø·¬{œ2ÂIÑ›Wæ`A˘—JsÃKH' ™:;%òNë>±∞Ÿ˚Âﬁ…?◊8%Ë´e4π9APˆ®∫u{æ˘
îråBN¶!HìXíÇˇƒçÊß±Ÿ˘kQ©µw*Ìx?
}Ê+‰Ö:Uî;ÎÄˇÄfGåßÄTbE@Ïá9Z®2´”;ìyÄõüØÙ≈€ìbWPÀE£"öÄG8P*wóãCÈ	√|lTàÎí¨¿çb™ôÓL∏FRz`Kk∏néL◊Á†HSC∆¡ã Ç *¯jçxÅ>?dÉ¬∂’s!!Dé	∂√¿I¿hÜXﬁ¥/7÷Ö„Q£gbÊ∆ïôÎ◊/œ®@I–ãp‡7 !ΩÅ:úÂ‚Ä *(≤˝ÄÉ3Lê`m∏m™méít⁄hmˇÓ†µWÊÎ=8R-§Û‹‹>‚ä 69fi¢±(dåÿ≤-!O$ÌÊèïlwˆ˝†~naÎ‹”†ùXuH˚i9ñõÊêB=-{F>Kaw≤Ca +0†KKGg˛81ﬂ|Òˆ-¨≠≠È’üÆÔXæ°ïtbÈ∏;–µŒÆa¿v.w¸Ô|aˆe˘»âù>Ÿ[YYëñJø≥a<Æ\˘ÚC´ˇöù´oﬂπÛ` /R:^˚∆´´´ˇ¸;¸åïf≥9™’j5—h4Ñ\òiF∫•/ÉµúO    IENDÆB`Ç_Üdata:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAACXBIWXMAABYlAAAWJQFJUiTwAAABy2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgICAgICAgICAgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIj4KICAgICAgICAgPHRpZmY6T3JpZW50YXRpb24+MTwvdGlmZjpPcmllbnRhdGlvbj4KICAgICAgICAgPHhtcDpDcmVhdG9yVG9vbD5BZG9iZSBJbWFnZVJlYWR5PC94bXA6Q3JlYXRvclRvb2w+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgqyI37xAAADM0lEQVQ4EV2TTWwTRxTH38x++SN2YhyTqAEao6AgrKpS4cAFya04Va16CoceGqVFcKt64oBUKZwqceECAokD91x66KktalMJqbRFkAOJCgHiyHYc29vd7NfszuzsTmctFbl50hvt7PvPb57+M6OADCEE2mo0lEsy5RS3Wi2c/c5qh2NpaUm5tLmJ1m/cGNXRYcH4/Nmv9tTj33481mm16zYfnp1cnO5/9+21u+OaEeDh4zczz396NN/baZ9yuHOaqP4iybMFOhEfVypqtTxXhliPwfg9cT69+PFHXcsSXy8vP8tAaPXmrctPXz65789RqNSrgIsaYF2AjhHgOIECNwSOcOKbXDjPY/DTMpSRx5evflH/7Pz5vupu2Wi/4cJ7F88y5UmE3Ve+YEER+dEUSnMVzEsVSCfKqjo7JZhOkT6xsNn75d7JP9d/OCUb6KtlNLk5QQxQ9qi6dXsXF775CpRyDYxCTqYGCCFIkwRYkoII/wHEE43mp7HZ+WtRAh6ptXcq7Xg/Cn0R5isf5IU6VZQ764ARA/+AZkcEjKeAVAViRUDshzlaqDKr0zuTeYCbn6/0xR7bDxiTYldQywFFAwijBCKagEc4UCp3l4tD6QsJw3xsVIjrkqwDwI0GYqqZ7g5MF7hGUnpgS2sFuG4MjkzX56BIU0PGwYsAgiAq+GqNeIE+PwJkgx7CttVzIRIhRI4JthPDwEnADgRoBoZY3rQDLwU31oXjUaNnYubGlZnr1y/PqBlASdCLcOADNyAhvYE6nOXigAAqKLL9gIMzTJAfYAhtBrhtqgVtjpJ02mhtf//uCKAWtVfm6z04Ui0ZpPMG3Nw+4hEGiiA2OWZporEoZIzYsi0hTyTt5h2PlWx39v0RoH5uYevc06CdWAF1SPsYaTmWm+aQQj0tF3tGPhoWS2F3sgZDYSArMKBLS0dn/jgx33zx9i2sra3pGxsb1Z8fru9YvqGVdGLpuDvQtc6uYcB2Lnf873xh9mX5yImdCxc+2VtZWZGWSr+zYTyuXPnyQ6v/mh+dq2/fufNgIC9SOl4f+8arq6v/A/wHO/yMlWazOarVajXRaDSEXJhpRrp/ARoNpS+DtZxPAAAAAElFTkSuQmCC‘$%&O˝bplist00‘45X$versionX$objectsY$archiverT$top Ü†´%&,-./0U$null€	
R$3V$classR$6R$1R$9R$4R$7R$2R$5R$0R$8ÄÄ
Ä Ä	ÄÄ ÄÄ” 
!#$WNS.base[NS.relativeÄ ÄÄ_data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAOCAYAAAAmL5yKAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KTMInWQAAATxJREFUKBVjYKAQMCPpZwKyGZH4RDPRNYEMBRlGFAC7oKGhgenPnz9G5ubmP69du/YNqPO/g4MDy4MHD/4RZQpIEVBzo66u7nFTU9MgojUBFYJcAPaClZXV+S9fvvz78eNHtpiYmJWWltZFoAs+wOSJNjQpKYnXxMSkV1NT876dnZ0TVCPOAIYFFjwgnz17Jvz7929pZmbm1ywsLCAX4AUgjSD838/PT/zRo0dFwMD0AGpcpaqqOnH16tVfgHIgS/4DMTJA5zMwmJmZderp6W10dnY2RVaJhw13NcP///8ZgdGmEBoayomkgUlFRYUdyJcBYnkgloPSIDYvEIMBwhSYCMTJIGf/AWJJJiamOCDNDcS/gJgViBmA4bMdGE4ngExGZANgIQ1KPDA/gqIZ5CpkdUAuw08gBhlIOQAAsXJQfxd1L1sAAAAASUVORK5CYII=“'()*Z$classnameX$classesUNSURL¢)+XNSObject#Aø±ÆbãΩ‡Yimage/png¸#Ôˇˇˇˇˇˇ“'(12]NSURLResponse¢3+]NSURLResponse_NSKeyedArchiver—67_WebResourceResponseÄ    # - 2 7 C I ` c j m p s v y |  Ç Ö á â ã ç è ë ì ï ó ô õ ¢ ™ ∂ ∏ ∫ º“◊‚ÎÒÙ˝!/2@RUk             8              mO¸âPNG

   IHDR         &/úä   sRGB ÆŒÈ   	pHYs     öú  YiTXtXML:com.adobe.xmp     <x:xmpmeta xmlns:x="adobe:ns:meta/" x:xmptk="XMP Core 5.4.0">
   <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
      <rdf:Description rdf:about=""
            xmlns:tiff="http://ns.adobe.com/tiff/1.0/">
         <tiff:Orientation>1</tiff:Orientation>
      </rdf:Description>
   </rdf:RDF>
</x:xmpmeta>
L¬'Y  <IDAT(c`†0#Èg≤ë¯D3—5ÅF ª†°°ÅÈœü?FÊÊÊ?Ø]ªˆ®ÛøÉÉÀÉ˛e
HPs£ÆÆÓqSS” ¢5Ç\ ˆÇïï’˘/_æ¸˚Ò„G∂òòòïññ÷E†>¿‰â64))â◊ƒƒ§WSSÛæùùùT#Œ Ü< ü={&¸˚˜oiffÊ◊,,, ‡ ç ¸ﬂœœO¸—£GE¿¿Ù j\•™™:qıÍ’_Är K˛12@Á30òôôuÍÈÈmtvv6EVâáw5√ˇˇˇÅ—¶ â§ÅIEEÖ»óby ñÉ“ 6/É¬òƒ… gˇbI&&¶8 ÕƒøÄòàÄ·≥N'ÄLFd`!J<0?Ç¢‰*du@.√O H9  ±rPu/[    IENDÆB`Ç_data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAOCAYAAAAmL5yKAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KTMInWQAAATxJREFUKBVjYKAQMCPpZwKyGZH4RDPRNYEMBRlGFAC7oKGhgenPnz9G5ubmP69du/YNqPO/g4MDy4MHD/4RZQpIEVBzo66u7nFTU9MgojUBFYJcAPaClZXV+S9fvvz78eNHtpiYmJWWltZFoAs+wOSJNjQpKYnXxMSkV1NT876dnZ0TVCPOAIYFFjwgnz17Jvz7929pZmbm1ywsLCAX4AUgjSD838/PT/zRo0dFwMD0AGpcpaqqOnH16tVfgHIgS/4DMTJA5zMwmJmZderp6W10dnY2RVaJhw13NcP///8ZgdGmEBoayomkgUlFRYUdyJcBYnkgloPSIDYvEIMBwhSYCMTJIGf/AWJJJiamOCDNDcS/gJgViBmA4bMdGE4ngExGZANgIQ1KPDA/gqIZ5CpkdUAuw08gBhlIOQAAsXJQfxd1L1sAAAAASUVORK5CYII=‘()*Oôbplist00‘45X$versionX$objectsY$archiverT$top Ü†´%&,-./0U$null€	
R$3V$classR$6R$1R$9R$4R$7R$2R$5R$0R$8ÄÄ
Ä Ä	ÄÄ ÄÄ” 
!#$WNS.base[NS.relativeÄ ÄÄ_Ædata:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAAB50RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNS4xqx9I6wAAABZ0RVh0Q3JlYXRpb24gVGltZQAxMS8yOC8xMaVolhIAAACGSURBVBiVjdDBCcJAFEXRE5lJGynBwKxjLXFjGyZluJGAnbiegJYwnbgwulLjhbf5XB6fV1lIpzSgR7OcCqZ8yANUkM7phq3P3PM+t1W6pAHHL9KLMYj6FQn6IL5/+kUTxD80BFFhtbVs1CY1K5me81xX5ulyu4F5N7eiUVRElhTRmLvcwgNEiB33B43RyQAAAABJRU5ErkJggg==“'()*Z$classnameX$classesUNSURL¢)+XNSObject#Aø±Æbã¬DYimage/png0#Ôˇˇˇˇˇˇ“'(12]NSURLResponse¢3+]NSURLResponse_NSKeyedArchiver—67_WebResourceResponseÄ    # - 2 7 C I ` c j m p s v y |  Ç Ö á â ã ç è ë ì ï ó ô õ ¢ ™ ∂ ∏ ∫ ºns~áçêô¢¨Ø∏ΩÀŒ‹ÓÒ             8              	O0âPNG

   IHDR   
   
   ç2œΩ   sBIT|dà   	pHYs    “›~¸   tEXtSoftware Adobe Fireworks CS5.1´HÎ   tEXtCreation Time 11/28/11•hñ   ÜIDATïç–¡	¬@E—ôI)¡¿¨c-qc&e∏ëÄù∏ûÄñ0ù∏0∫R„Ö∑˘\üWYHß4†G≥ú
¶|»TêŒÈÜ≠œ‹Û>∑U∫§«/“ã1à˙	˙ æ˙Eƒ?4Qaµµl‘&5+ôûÛ\WÊÈrªÅy7∑¢QTDñ—òª‹¬Dà˜ç—…    IENDÆB`Ç_Ædata:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAAB50RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNS4xqx9I6wAAABZ0RVh0Q3JlYXRpb24gVGltZQAxMS8yOC8xMaVolhIAAACGSURBVBiVjdDBCcJAFEXRE5lJGynBwKxjLXFjGyZluJGAnbiegJYwnbgwulLjhbf5XB6fV1lIpzSgR7OcCqZ8yANUkM7phq3P3PM+t1W6pAHHL9KLMYj6FQn6IL5/+kUTxD80BFFhtbVs1CY1K5me81xX5ulyu4F5N7eiUVRElhTRmLvcwgNEiB33B43RyQAAAABJRU5ErkJggg==‘,-.OHbplist00‘45X$versionX$objectsY$archiverT$top Ü†´%&,-./0U$null€	
R$3V$classR$6R$1R$9R$4R$7R$2R$5R$0R$8ÄÄ
Ä Ä	ÄÄ ÄÄ” 
!#$WNS.base[NS.relativeÄ ÄÄ_^data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsSAAALEgHS3X78AAAAB3RJTUUH4AYbDBAOdqhSLgAAAINJREFUGNON0LERgzAUg+FfOu/hEeJRTAmVN4nZhAaOjlWSEbxJGhcpEuC7U/NOjZ7o1nWtQAFiPzVgmaapAghg27YX8OC39ziOSfu+V+DJuTlIKlwrQVK8UYxBEncE2+1r6T/NkhZJXGQRwHEcp+/JOScDDMOQbM+2m216mu0555wAPo+VHP+uBpBNAAAAAElFTkSuQmCC“'()*Z$classnameX$classesUNSURL¢)+XNSObject#Aø±Æbã«÷Yimage/pngˆ#Ôˇˇˇˇˇˇ“'(12]NSURLResponse¢3+]NSURLResponse_NSKeyedArchiver—67_WebResourceResponseÄ    # - 2 7 C I ` c j m p s v y |  Ç Ö á â ã ç è ë ì ï ó ô õ ¢ ™ ∂ ∏ ∫ º#.7=@IR\^glz}ãù†∂             8              ∏OˆâPNG

   IHDR   
   
   ç2œΩ   bKGD ˇ ˇ ˇ†Ωßì   	pHYs    “›~¸   tIME‡v®R.   ÉIDAT”ç–±É0É·_:Ô·‚QL	ï7âŸÑééUíºI)‡ªSÛNçûË÷u≠@b?5`ô¶©`€∂‡∑˜8éI˚æW‡…π9H*\+ARºQåAw€ÌkÈ?ÕíI\d¿qßÔ…9'√êlœ∂õmzöÌ9Áú >èïˇÆêM    IENDÆB`Ç_^data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsSAAALEgHS3X78AAAAB3RJTUUH4AYbDBAOdqhSLgAAAINJREFUGNON0LERgzAUg+FfOu/hEeJRTAmVN4nZhAaOjlWSEbxJGhcpEuC7U/NOjZ7o1nWtQAFiPzVgmaapAghg27YX8OC39ziOSfu+V+DJuTlIKlwrQVK8UYxBEncE2+1r6T/NkhZJXGQRwHEcp+/JOScDDMOQbM+2m216mu0555wAPo+VHP+uBpBNAAAAAElFTkSuQmCC‘0123OÖbplist00‘45X$versionX$objectsY$archiverT$top Ü†´%&,-./0U$null€	
R$3V$classR$6R$1R$9R$4R$7R$2R$5R$0R$8ÄÄ
Ä Ä	ÄÄ ÄÄ” 
!#$WNS.base[NS.relativeÄ ÄÄ_ödata:image/gif;base64,R0lGODlhDgASAKUAAP///25ra3Rxcfz8/NDPz3Jvb8C/v4yJifr6+u3s7HBtbfHx8f39/eXk5Kmnp8vKyqempvPz83t4eK2rq+Hg4HVzc4SCgpORkdXV1XFubnNwcO7u7piVlbi2tsLAwPv7+5WSkqKgoNva2o6MjH17e728vLe2tv///////////////////////////////////////////////////////////////////////////////////////////////////yH5BAEKAD8ALAAAAAAOABIAAAY+wJ9wSCwaj8jkcDRR/iABwSNpUAQCJMoRU7leL0dOQUDWCErOtDrt8Ho7R5A7hGxYrodEkpCRiJwmHmuDRUEAOw==“'()*Z$classnameX$classesUNSURL¢)+XNSObject#Aø±ÆbãÀÅYimage/gif!#Ôˇˇˇˇˇˇ“'(12]NSURLResponse¢3+]NSURLResponse_NSKeyedArchiver—67_WebResourceResponseÄ    # - 2 7 C I ` c j m p s v y |  Ç Ö á â ã ç è ë ì ï ó ô õ ¢ ™ ∂ ∏ ∫ ºZ_jsy|Öéòõ§©∑∫»⁄›Û             8              ıO!GIF89a  •  ˇˇˇnkktqq¸¸¸–œœroo¿øøåââ˙˙˙ÌÏÏpmmÒÒÒ˝˝˝Â‰‰©ßßÀ  ß¶¶ÛÛÛ{xx≠´´·‡‡ussÑÇÇìëë’’’qnnsppÓÓÓòïï∏∂∂¬¿¿˚˚˚ïíí¢††€⁄⁄éåå}{{Ωºº∑∂∂ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ!˘
 ? ,       >¿üpH,è»‰p4Q˛ ¡#iP$ Sπ^/GNA@÷JŒ¥:Ìz;Gê;ÑlXÆáDíêëàú&kÉEA ;Yimage/gif_ödata:image/gif;base64,R0lGODlhDgASAKUAAP///25ra3Rxcfz8/NDPz3Jvb8C/v4yJifr6+u3s7HBtbfHx8f39/eXk5Kmnp8vKyqempvPz83t4eK2rq+Hg4HVzc4SCgpORkdXV1XFubnNwcO7u7piVlbi2tsLAwPv7+5WSkqKgoNva2o6MjH17e728vLe2tv///////////////////////////////////////////////////////////////////////////////////////////////////yH5BAEKAD8ALAAAAAAOABIAAAY+wJ9wSCwaj8jkcDRR/iABwSNpUAQCJMoRU7leL0dOQUDWCErOtDrt8Ho7R5A7hGxYrodEkpCRiJwmHmuDRUEAOw==‘567Oçbplist00‘45X$versionX$objectsY$archiverT$top Ü†´%&,-./0U$null€	
R$3V$classR$6R$1R$9R$4R$7R$2R$5R$0R$8ÄÄ
Ä Ä	ÄÄ ÄÄ” 
!#$WNS.base[NS.relativeÄ ÄÄ_¢data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAD8ElEQVRIia2U3W8UVRiHnzOzs7uz293ultLWwiJFQBAkixENES+amhDBj14oFzQY0ESjiYn9I4g3RrgxamLSGkm4aBRuxIiS+pUoKIqaIIrQltRua+m2uzs7Ozsf53ixQO220gK+VzNn3t/7nPd33jNwC9F9cry7++R46lY02lITnx+c6Humo+HYlrQx+OSJsexSdWKxhF3HR1IrEuG+B1c2dJ/O+2xIhAgF/sypEevAx09ljt8RYOfA5dWbWmPHVqTN7JmrLp6srXckQrQa8P2Y1TuwO3P4tgCPHb2Y3ZZJDkbNcOrs3w4CqJYqhMwwuqHTGNHJNoX5JWf1jxWrvSf33DOzZMDTA3/uX9/a0FcMYLTkoaTEvWrxRBJOFyT5VBwjGsbQ4IHWGENT5XMjU5XOU3vXz4PMA+w8cuHQ1tVNr40Uq0xXfAIvwMhbvLLOZPPaKMWCzztnLC6EDSLJGACbWuNYtjvze67YOfjcxnMLAna8+3OqOWUeWtPeuH9o0saq+nhVj5W2wwv3J1izKnxD5FUkR38o8XlBYjTF0TSN1mSExqjO5VzxwIm99/bPAWx/68dUpi052JyOZ/8YKxJIhVuqcB+SVx9J05jW59kYuIqvzpd575KNno6hGyGSMYP2tMnQWOHwJz0begGEUorHPzhfbGlOJoZzBZRSuAWbXcsi9DzUiBH/76uiJFwaqXLw9BRO0sQww0QMjVVtSa78NfPNp/s2PqoBlMtu4tKVKTzHxR6f4cVMnH07UjctDiA0WNsR4c2uFjJWBTtfomK7XBzO4/vBDrh2k+1yFafsEJos8frDLXRtS6Abi97BG5FeHuLg7rvoNHVKEwWcskNxqjZQIQAZBO/bM+XhNzpX7+1YG1kn/rVxZxKcqQVgChpWKULx2qsRF7zU2Uziu+kvPpqwv9RDRgrqxlQpxYWzwyq2fJaQ/xV++2wCiU+pVCQWj4PUiJlxNj+bItY2W8LJK9Zn7xZCzK4t+rMLPInjVIg26njSwUzpaJGActFGycXtCy0OULhVn4rl4lU9KiUX1/HBFUip5pqwgJPzAKIuSQYKz/NwygrP9XFsF8/10T0dbquDOoAKoFDIM5qbRinJ9HQegPZla1Dq5puDBc5A1GUppdCEjq4bKKUQQkPXjZp0HmEJHVx0BVFL3Ei2qxBIn0B6BMoHKVBIZBAwWtUIVzRAIARIV7FuMUD/kMQK1wRCCLZchWjg4wceUgYASKUhZcCHOZ1JGap1LQQpV9FV78j1h+1v/3TE0LQeKeZ+NqsKYZWRKkChENckhh7GSZr4xtyZV4Ec96Tc8+3LW7+eA1D1ft5hXD9L8X8Xro9/AG95vVGiPYb2AAAAAElFTkSuQmCC“'()*Z$classnameX$classesUNSURL¢)+XNSObject#Aø±Æbãœ-Yimage/png)#Ôˇˇˇˇˇˇ“'(12]NSURLResponse¢3+]NSURLResponse_NSKeyedArchiver—67_WebResourceResponseÄ    # - 2 7 C I ` c j m p s v y |  Ç Ö á â ã ç è ë ì ï ó ô õ ¢ ™ ∂ ∏ ∫ ºbgr{ÅÑçñ†£¨±ø¬–‚Â˚             8              ˝O)âPNG

   IHDR         ‡w=¯  IDATHâ≠î›oUáü3≥≥ª≥€›Óñ“÷¬"E@$ã/öö¡è^(4–D£ââ˝#à7F∏1jb“I∏hnƒàí˙ï((äö ä–ñ‘nkÈ∂ª;;;;Áx±@Ì∂“æW3gﬁﬂ˚ú˜wﬁ3p—}rºª˚‰xÍV4⁄RüúË{¶£·ÿñ¥1¯‰â±ÏRub±Ñ]«GR+·æW6tüŒ˚lHÑ˛Ã©Î¿«Oeéﬂ`Á¿Â’õZc«V§ÕÏô´.û¨≠w$B¥˝ò’;∞;s¯∂ èΩò›ñIFÕpÍÏﬂ®ñ*ÑÃ0∫°”—…6Ö˘%gıè´Ω'˜‹3≥d¿”Ó_ﬂ⁄–W`¥‰°§ƒΩjÒDN$˘T#∆–‡Å÷CSÂs#SïŒS{◊œÉÃÏ<r·–÷’MØç´LW|/¿»[º≤ŒdÛ⁄(≈Çœ;g,.Ñ"… õZ„X∂;Û{Æÿ9¯‹∆svº˚s™9eZ”ﬁ∏h“∆™˙xUèï∂√˜'X≥*|C‰U$G(ÒyAb4≈—4ç÷dÑ∆®ŒÂ\Ò¿âΩ˜ˆœlÎ«T¶-9ÿúégˇ+HÖ[™píWI”ò÷ÁŸ∏äØŒóyÔíçûé°!í1Éˆ¥…–X·'=zÑRä«?8_liN&ÜsîR∏õ]À"Ù<‘àˇÔ´¢$\©rÙN“ƒ0√DçUmIÆ¸5ÛÕß˚6>™îÀn‚“ï)<«≈ü·≈Lú};R7- 4X€·ÕÆ2V;_¢bª\Œ„˚¡∏vìÌrßÏö,Ò˙√-tmK†ãﬁ¡ë^‚‡ÓªË4uJú≤Cq™6P! Ô€3Â·7:WÔÌXY'˛µqgú©`
V)BÒ⁄´º‘ŸL‚ªÈ/>ö∞ø‘CF
Í∆T)≈Ö≥√*∂|ñêˇ~˚lâO©T$èÉ‘àôq6?õ"÷6[¬…+÷gÔBÃÆ-˙≥<â„Tà6Íx“¡LÈhëÄr—F…≈Ì-P∏UüäÂ‚U=*%◊Ò¡H©Êö∞ÄìÛ ¢.I
œÛp 
œıqlœı—=n´É:Ä
†P»3öõF)…ÙtÄˆekPÍÊõÉŒ@‘e)•–ÑéÆ(•BC◊çöta	\tQK‹H∂´Hü@z )PHd0Z’W4@ HW±n1@ˇêƒ
◊B∂\Öh‡„R H•!e¿á9ùI™u-)W—UÔ»ıáÌoˇtƒ–¥)Ê~6´
aïë*@°◊$Ü∆Iö¯∆‹ôWÅ˜§‹ÛÌÀ[øûPı~ﬁa\?KÒÆè oyΩQ¢=Üˆ    IENDÆB`Ç_¢data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAD8ElEQVRIia2U3W8UVRiHnzOzs7uz293ultLWwiJFQBAkixENES+amhDBj14oFzQY0ESjiYn9I4g3RrgxamLSGkm4aBRuxIiS+pUoKIqaIIrQltRua+m2uzs7Ozsf53ixQO220gK+VzNn3t/7nPd33jNwC9F9cry7++R46lY02lITnx+c6Humo+HYlrQx+OSJsexSdWKxhF3HR1IrEuG+B1c2dJ/O+2xIhAgF/sypEevAx09ljt8RYOfA5dWbWmPHVqTN7JmrLp6srXckQrQa8P2Y1TuwO3P4tgCPHb2Y3ZZJDkbNcOrs3w4CqJYqhMwwuqHTGNHJNoX5JWf1jxWrvSf33DOzZMDTA3/uX9/a0FcMYLTkoaTEvWrxRBJOFyT5VBwjGsbQ4IHWGENT5XMjU5XOU3vXz4PMA+w8cuHQ1tVNr40Uq0xXfAIvwMhbvLLOZPPaKMWCzztnLC6EDSLJGACbWuNYtjvze67YOfjcxnMLAna8+3OqOWUeWtPeuH9o0saq+nhVj5W2wwv3J1izKnxD5FUkR38o8XlBYjTF0TSN1mSExqjO5VzxwIm99/bPAWx/68dUpi052JyOZ/8YKxJIhVuqcB+SVx9J05jW59kYuIqvzpd575KNno6hGyGSMYP2tMnQWOHwJz0begGEUorHPzhfbGlOJoZzBZRSuAWbXcsi9DzUiBH/76uiJFwaqXLw9BRO0sQww0QMjVVtSa78NfPNp/s2PqoBlMtu4tKVKTzHxR6f4cVMnH07UjctDiA0WNsR4c2uFjJWBTtfomK7XBzO4/vBDrh2k+1yFafsEJos8frDLXRtS6Abi97BG5FeHuLg7rvoNHVKEwWcskNxqjZQIQAZBO/bM+XhNzpX7+1YG1kn/rVxZxKcqQVgChpWKULx2qsRF7zU2Uziu+kvPpqwv9RDRgrqxlQpxYWzwyq2fJaQ/xV++2wCiU+pVCQWj4PUiJlxNj+bItY2W8LJK9Zn7xZCzK4t+rMLPInjVIg26njSwUzpaJGActFGycXtCy0OULhVn4rl4lU9KiUX1/HBFUip5pqwgJPzAKIuSQYKz/NwygrP9XFsF8/10T0dbquDOoAKoFDIM5qbRinJ9HQegPZla1Dq5puDBc5A1GUppdCEjq4bKKUQQkPXjZp0HmEJHVx0BVFL3Ei2qxBIn0B6BMoHKVBIZBAwWtUIVzRAIARIV7FuMUD/kMQK1wRCCLZchWjg4wceUgYASKUhZcCHOZ1JGap1LQQpV9FV78j1h+1v/3TE0LQeKeZ+NqsKYZWRKkChENckhh7GSZr4xtyZV4Ec96Tc8+3LW7+eA1D1ft5hXD9L8X8Xro9/AG95vVGiPYb2AAAAAElFTkSuQmCC‘9:;OÕbplist00‘45X$versionX$objectsY$archiverT$top Ü†´%&,-./0U$null€	
R$3V$classR$6R$1R$9R$4R$7R$2R$5R$0R$8ÄÄ
Ä Ä	ÄÄ ÄÄ” 
!#$WNS.base[NS.relativeÄ ÄÄ_‚data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAABIAAAASABGyWs+AAAACXZwQWcAAAAQAAAAEABcxq3DAAACwklEQVQ4y22TT2hcVRTGf+e+N5mapEkmJs2kqSWpZGyJQjRWUUEKuirdibRYFy1aN0WXBcWNutKFK3VTkaKLKugiigUFpYKC1JaWWtSkpKaRTmaS4CTpe2/en/vucTEjSf/c3eV853fOd7mfcJdz4e8bT/QNbNt/qR7vulqPZKnRnFusLX93+uW9P9+ulc2X46d/G39ysnKyWCg8vZo6QTdqmc2prgS/zi/Ujn12dOrKHYAjn158dM/4ju+LWwolEbmlqM6BMahCs5kG1/5ZOXDy4J6fAAzAgXe+6B+5rzydIqUgyQkSS5hYgsRSLuQcrnSyo+gIEosV6S4Plb46+OHZ7QA+wNjk46+nynYbW0TAbDJWGuyka0sBqxDGGU7Bqd47NDr2FnBM9r54wps6dLwmxgyYdrOItECqlDuF1AnLsaKqbQDgXDTz4/SA37dz9+6bcTZgRDBGWgCEsR6P/ZU+Joa3cm5hjVOXGxsApzjVzt6dDzzi5+KVgyjDMyBGMCJs6/Twjc/izZSJYagFGUEzRZUWxCnOQY5X9tMsT8MoaU03gogQNmFxLeGVx4ZQVX6YbRBEtwMUEpv660vV2bw8ocYYkbYNBJ6qlOgqFpipB/xVC1BVaK/fhmhevzFjLp96s55E8fkwjImimDCMicKEZyslAM5cWeLhwQ6iMGGzJo6aV8+9/9KsD9Bcb7zr/O4vpW2hq+jx4EgPAKO9HcxW1wnDBLQ1XZ3iYd8D8ABWfvn8z61Tz1eyzD2UZTnW5uwa7OLCfIOPz85z6foqNrVkaY5NLblNv127+M2J8Nr5ja/c/8yrHR3j+z5RzGERAbklJqBK6xHsdL74+wvLX78d3REmgO59rz3n9Y684fWPToKY/9vzxvW5+I8zH+Qrcx/Zfxeyu6ZxI6Piyz39w6anfD+o79aqVW2uVoEQyDZL/wN0KnGLRYYg1QAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxMC0wMi0xMFQxMjowMTo1OC0wNjowMBPHUbwAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMDktMDEtMDRUMTQ6Mjc6MDAtMDY6MDAp2xYhAAAAAElFTkSuQmCC“'()*Z$classnameX$classesUNSURL¢)+XNSObject#Aø±Æbã“˙Yimage/pngô#Ôˇˇˇˇˇˇ“'(12]NSURLResponse¢3+]NSURLResponse_NSKeyedArchiver—67_WebResourceResponseÄ    # - 2 7 C I ` c j m p s v y |  Ç Ö á â ã ç è ë ì ï ó ô õ ¢ ™ ∂ ∏ ∫ º¢ß≤ª¡ƒÕ÷‡„ÏÒˇ"%;             8              =OôâPNG

   IHDR         Ûˇa   bKGD ˇ ˇ ˇ†Ωßì   	pHYs   H   H F…k>   	vpAg       \∆≠√  ¬IDAT8ÀmìOh\U∆Áæ7ôö§I&&Õ§©%©dlâB4VQA
∫*›â¥X-Z7Eó≈ç∫“Ö+uSë¢ã*Ë"ä•ÇÇ‘ññZ‘§§¶ëNfí‡$È{oﬁü˚Óq1#Iˇ‹›Â|ÁwŒwπüpós·ÔOÙl€©Ô∫Zèd©—ú[¨-w˙ÂΩ?ﬂÆïÕó„ßr≤r≤X(<Ωö:A7jôÕ©ÆøŒ/‘é}vtÍ Ä#ü^|tœ¯éÔã[
%π•®ŒÅ1®B≥ô◊˛Y9pÚ‡ûü ¿ÅwæËπØ<ù"• …	KòXÇƒR.‰Æt≤£ËãÈ.ïæ:¯·ŸÌ >¿ÿ‰„Øß v[D¿l2VÏ§kK´∆N¡©ﬁ;4:ˆpLˆæx¬õ:tº&∆òv≥à¥@™î;Ö‘	À±¢™m ‡\4Û„ÙÄﬂ∑s˜Óõq6`D0FZ Ñ±è˝ï>&Ü∑rnaçSó ß8’Œﬁù<‚Á‚ïÉ(√3 F0"lÎÙçœ‚Õîâa®A3Eïƒ)ŒAéWˆ”,O√(iM7Çà6aq-·ï«ÜPU~òmD∑õ˙ÎK’Ÿº<°∆ë∂û™îË*ò©¸UPUhØﬂÜh^ø1c.üz≥ûDÒ˘0åâ¢ò0åâ¬Ñg+% Œ\Y‚·¡¢0a≥&éöWœΩˇ“¨–\oºÎ¸Ó/•m°´ËÒ‡H £ΩÃV◊	√¥5]ù‚aﬂ V~˘¸œ≠SœW≤Ã=îe9÷ÊÏÏ‚¬|ÉèœŒsÈ˙*6µdiéM-πMø]ª¯Õâ⁄˘çØ‹ˇÃ´„˚>QÃaπ%&†JÎÏtæ¯˚À_ø›&ÄÓ}Ø=Áıéº·ıèNÇòˇ€Û∆ıπ¯è3‰+sŸ≤ª¶q#£‚À=˝√¶ß|?®Ô÷™UmÆVÅ»6Kˇt*qãEÜ ’   %tEXtdate:create 2010-02-10T12:01:58-06:00«Qº   %tEXtdate:modify 2009-01-04T14:27:00-06:00)€!    IENDÆB`Ç_‚data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAABIAAAASABGyWs+AAAACXZwQWcAAAAQAAAAEABcxq3DAAACwklEQVQ4y22TT2hcVRTGf+e+N5mapEkmJs2kqSWpZGyJQjRWUUEKuirdibRYFy1aN0WXBcWNutKFK3VTkaKLKugiigUFpYKC1JaWWtSkpKaRTmaS4CTpe2/en/vucTEjSf/c3eV853fOd7mfcJdz4e8bT/QNbNt/qR7vulqPZKnRnFusLX93+uW9P9+ulc2X46d/G39ysnKyWCg8vZo6QTdqmc2prgS/zi/Ujn12dOrKHYAjn158dM/4ju+LWwolEbmlqM6BMahCs5kG1/5ZOXDy4J6fAAzAgXe+6B+5rzydIqUgyQkSS5hYgsRSLuQcrnSyo+gIEosV6S4Plb46+OHZ7QA+wNjk46+nynYbW0TAbDJWGuyka0sBqxDGGU7Bqd47NDr2FnBM9r54wps6dLwmxgyYdrOItECqlDuF1AnLsaKqbQDgXDTz4/SA37dz9+6bcTZgRDBGWgCEsR6P/ZU+Joa3cm5hjVOXGxsApzjVzt6dDzzi5+KVgyjDMyBGMCJs6/Twjc/izZSJYagFGUEzRZUWxCnOQY5X9tMsT8MoaU03gogQNmFxLeGVx4ZQVX6YbRBEtwMUEpv660vV2bw8ocYYkbYNBJ6qlOgqFpipB/xVC1BVaK/fhmhevzFjLp96s55E8fkwjImimDCMicKEZyslAM5cWeLhwQ6iMGGzJo6aV8+9/9KsD9Bcb7zr/O4vpW2hq+jx4EgPAKO9HcxW1wnDBLQ1XZ3iYd8D8ABWfvn8z61Tz1eyzD2UZTnW5uwa7OLCfIOPz85z6foqNrVkaY5NLblNv127+M2J8Nr5ja/c/8yrHR3j+z5RzGERAbklJqBK6xHsdL74+wvLX78d3REmgO59rz3n9Y684fWPToKY/9vzxvW5+I8zH+Qrcx/Zfxeyu6ZxI6Piyz39w6anfD+o79aqVW2uVoEQyDZL/wN0KnGLRYYg1QAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxMC0wMi0xMFQxMjowMTo1OC0wNjowMBPHUbwAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMDktMDEtMDRUMTQ6Mjc6MDAtMDY6MDAp2xYhAAAAAElFTkSuQmCC‘=>?O<bplist00‘45X$versionX$objectsY$archiverT$top Ü†´%&,-./0U$null€	
R$3V$classR$6R$1R$9R$4R$7R$2R$5R$0R$8ÄÄ
Ä Ä	ÄÄ ÄÄ” 
!#$WNS.base[NS.relativeÄ ÄÄ_Rdata:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAABmJLR0QAAAAkAP/rBbrOAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4QkGBhYoFBc+tQAAAHhJREFUOMvVk+EKwCAIhO+qvf8b6/4YtFhFzsEmSET64akBgcbunhwMwRtGczV/xEk3Ut1ANr0SZ3Ws+eyavwtkk3eZngAoG7Jp8dNpFjt14m3c0mZAADjukkZLqp5FTZFL+z+YRMLU3hglUwDkAVA/0df6dfJK9gkAax0qqPfdiQAAAABJRU5ErkJggg==“'()*Z$classnameX$classesUNSURL¢)+XNSObject#Aø±Æbã÷¶Yimage/pngÎ#Ôˇˇˇˇˇˇ“'(12]NSURLResponse¢3+]NSURLResponse_NSKeyedArchiver—67_WebResourceResponseÄ    # - 2 7 C I ` c j m p s v y |  Ç Ö á â ã ç è ë ì ï ó ô õ ¢ ™ ∂ ∏ ∫ º"+14=FPR[`nqëî™             8              ¨OÎâPNG

   IHDR         rP6Ã   bKGD   $ ˇÎ∫Œ   	pHYs     öú   tIME·	(>µ   xIDAT8À’ì·
¿ ÑÔ™ΩˇÎ˛¥XEŒ¡&HD˙·©Å∆Óû¡Fs5ƒI7R›@6Ωgu¨˘Ïöødìwôû (≤iÒ”i;u‚m‹“f@ 8ÓíFK™ûEMëK˚?òD¬‘ﬁ%S ‰P?—◊˙uÚJˆ	 k*®˜›â    IENDÆB`Ç_Rdata:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAABmJLR0QAAAAkAP/rBbrOAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4QkGBhYoFBc+tQAAAHhJREFUOMvVk+EKwCAIhO+qvf8b6/4YtFhFzsEmSET64akBgcbunhwMwRtGczV/xEk3Ut1ANr0SZ3Ws+eyavwtkk3eZngAoG7Jp8dNpFjt14m3c0mZAADjukkZLqp5FTZFL+z+YRMLU3hglUwDkAVA/0df6dfJK9gkAax0qqPfdiQAAAABJRU5ErkJggg==‘AB2CO7bplist00‘45X$versionX$objectsY$archiverT$top Ü†´%&,-./0U$null€	
R$3V$classR$6R$1R$9R$4R$7R$2R$5R$0R$8ÄÄ
Ä Ä	ÄÄ ÄÄ” 
!#$WNS.base[NS.relativeÄ ÄÄ_Ndata:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7“'()*Z$classnameX$classesUNSURL¢)+XNSObject#Aø±Æbã⁄@Yimage/gif*#Ôˇˇˇˇˇˇ“'(12]NSURLResponse¢3+]NSURLResponse_NSKeyedArchiver—67_WebResourceResponseÄ    # - 2 7 C I ` c j m p s v y |  Ç Ö á â ã ç è ë ì ï ó ô õ ¢ ™ ∂ ∏ ∫ º&,/8AKMV[ilzåè•             8              ßO*GIF89a  Ä     ˇˇˇ!˘    ,       D ;_Ndata:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7‘EF2GObplist00‘45X$versionX$objectsY$archiverT$top Ü†´%&,-./0U$null€	
R$3V$classR$6R$1R$9R$4R$7R$2R$5R$0R$8ÄÄ
Ä Ä	ÄÄ ÄÄ” 
!#$WNS.base[NS.relativeÄ ÄÄ_	&data:image/gif;base64,R0lGODlhKAAoAIABAAAAAP///yH/C05FVFNDQVBFMi4wAwEAAAAh+QQJAQABACwAAAAAKAAoAAACkYwNqXrdC52DS06a7MFZI+4FHBCKoDeWKXqymPqGqxvJrXZbMx7Ttc+w9XgU2FB3lOyQRWET2IFGiU9m1frDVpxZZc6bfHwv4c1YXP6k1Vdy292Fb6UkuvFtXpvWSzA+HycXJHUXiGYIiMg2R6W459gnWGfHNdjIqDWVqemH2ekpObkpOlppWUqZiqr6edqqWQAAIfkECQEAAQAsAAAAACgAKAAAApSMgZnGfaqcg1E2uuzDmmHUBR8Qil95hiPKqWn3aqtLsS18y7G1SzNeowWBENtQd+T1JktP05nzPTdJZlR6vUxNWWjV+vUWhWNkWFwxl9VpZRedYcflIOLafaa28XdsH/ynlcc1uPVDZxQIR0K25+cICCmoqCe5mGhZOfeYSUh5yJcJyrkZWWpaR8doJ2o4NYq62lAAACH5BAkBAAEALAAAAAAoACgAAAKVDI4Yy22ZnINRNqosw0Bv7i1gyHUkFj7oSaWlu3ovC8GxNso5fluz3qLVhBVeT/Lz7ZTHyxL5dDalQWPVOsQWtRnuwXaFTj9jVVh8pma9JjZ4zYSj5ZOyma7uuolffh+IR5aW97cHuBUXKGKXlKjn+DiHWMcYJah4N0lYCMlJOXipGRr5qdgoSTrqWSq6WFl2ypoaUAAAIfkECQEAAQAsAAAAACgAKAAAApaEb6HLgd/iO7FNWtcFWe+ufODGjRfoiJ2akShbueb0wtI50zm02pbvwfWEMWBQ1zKGlLIhskiEPm9R6vRXxV4ZzWT2yHOGpWMyorblKlNp8HmHEb/lCXjcW7bmtXP8Xt229OVWR1fod2eWqNfHuMjXCPkIGNileOiImVmCOEmoSfn3yXlJWmoHGhqp6ilYuWYpmTqKUgAAIfkECQEAAQAsAAAAACgAKAAAApiEH6kb58biQ3FNWtMFWW3eNVcojuFGfqnZqSebuS06w5V80/X02pKe8zFwP6EFWOT1lDFk8rGERh1TTNOocQ61Hm4Xm2VexUHpzjymViHrFbiELsefVrn6XKfnt2Q9G/+Xdie499XHd2g4h7ioOGhXGJboGAnXSBnoBwKYyfioubZJ2Hn0RuRZaflZOil56Zp6iioKSXpUAAAh+QQJAQABACwAAAAAKAAoAAACkoQRqRvnxuI7kU1a1UU5bd5tnSeOZXhmn5lWK3qNTWvRdQxP8qvaC+/yaYQzXO7BMvaUEmJRd3TsiMAgswmNYrSgZdYrTX6tSHGZO73ezuAw2uxuQ+BbeZfMxsexY35+/Qe4J1inV0g4x3WHuMhIl2jXOKT2Q+VU5fgoSUI52VfZyfkJGkha6jmY+aaYdirq+lQAACH5BAkBAAEALAAAAAAoACgAAAKWBIKpYe0L3YNKToqswUlvznigd4wiR4KhZrKt9Upqip61i9E3vMvxRdHlbEFiEXfk9YARYxOZZD6VQ2pUunBmtRXo1Lf8hMVVcNl8JafV38aM2/Fu5V16Bn63r6xt97j09+MXSFi4BniGFae3hzbH9+hYBzkpuUh5aZmHuanZOZgIuvbGiNeomCnaxxap2upaCZsq+1kAACH5BAkBAAEALAAAAAAoACgAAAKXjI8By5zf4kOxTVrXNVlv1X0d8IGZGKLnNpYtm8Lr9cqVeuOSvfOW79D9aDHizNhDJidFZhNydEahOaDH6nomtJjp1tutKoNWkvA6JqfRVLHU/QUfau9l2x7G54d1fl995xcIGAdXqMfBNadoYrhH+Mg2KBlpVpbluCiXmMnZ2Sh4GBqJ+ckIOqqJ6LmKSllZmsoq6wpQAAAh+QQJAQABACwAAAAAKAAoAAAClYx/oLvoxuJDkU1a1YUZbJ59nSd2ZXhWqbRa2/gF8Gu2DY3iqs7yrq+xBYEkYvFSM8aSSObE+ZgRl1BHFZNr7pRCavZ5BW2142hY3AN/zWtsmf12p9XxxFl2lpLn1rseztfXZjdIWIf2s5dItwjYKBgo9yg5pHgzJXTEeGlZuenpyPmpGQoKOWkYmSpaSnqKileI2FAAACH5BAkBAAEALAAAAAAoACgAAAKVjB+gu+jG4kORTVrVhRlsnn2dJ3ZleFaptFrb+CXmO9OozeL5VfP99HvAWhpiUdcwkpBH3825AwYdU8xTqlLGhtCosArKMpvfa1mMRae9VvWZfeB2XfPkeLmm18lUcBj+p5dnN8jXZ3YIGEhYuOUn45aoCDkp16hl5IjYJvjWKcnoGQpqyPlpOhr3aElaqrq56Bq7VAAAOw==“'()*Z$classnameX$classesUNSURL¢)+XNSObject#Aø±Æbã›€Yimage/gif #Ôˇˇˇˇˇˇ“'(12]NSURLResponse¢3+]NSURLResponse_NSKeyedArchiver—67_WebResourceResponseÄ    # - 2 7 C I ` c j m p s v y |  Ç Ö á â ã ç è ë ì ï ó ô õ ¢ ™ ∂ ∏ ∫ º	Ê	Î	ˆ	ˇ




$
'
0
5
C
F
T
f
i
             8              
ÅO GIF89a( ( Ä    ˇˇˇ!ˇNETSCAPE2.0   !˘	  ,    ( (  ëå©z›ùÉKNöÏ¡Y#Óä†7ñ)z≤ò˙Ü´…≠v[3”µœ∞ıxÿPwîÏêEaÿÅFâOf’˙√VúYeŒõ||/·ÕX\˛§’Wr€›Öo•$∫Òm^õ÷K0>'$uàfà»6G•∏Áÿ'Xg«5ÿ»®5ï©ÈáŸÈ)9π):ZiYJôä™˙y⁄™Y  !˘	  ,    ( (  îåÅô∆}™úÉQ6∫Ï√öa‘ä_yÜ# ©i˜j´K±-|À±µK3^£Å€Pw‰ı&KO”ôÛ=7IfTzΩLMYh’˙ıÖcdX\1ó’ieùa«Â ‚⁄}¶∂Òwl¸ßï«5∏ıCgGB∂ÁÁ)®®'πòhY9˜òIHy»ó	 πYjZG«h'j85ä∫⁄P  !˘	  ,    ( (  ïéÀmôúÉQ6™,√@oÓ-`»u$>ËI••ªz/¡±6 9~[≥ﬁ¢’Ñ^OÚÛÌî«À˘t6•Ac’:ƒµÓ¡vÖN?cUX|¶fΩ&6xÕÑ£Âì≤ôÆÓ∫â_~àGññ˜∑∏(bóî®Á¯8áX«%®x7IX…I9x©˘©ÿ(I:ÍY*∫XYv öP  !˘	  ,    ( (  ñÑo°ÀÅﬂ‚;±MZ◊YÔÆ|‡∆çËàùöë([πÊÙ¬“9”9¥⁄ñÔ¡ıÑ1`P◊2Üî≤!≤HÑ>oQÍÙW≈^Õdˆ»sÜ•c2¢∂Â*SiyáøÂ	x‹[∂Êµs¸^›∂ÙÂVGWËwgñ®◊«∏»◊˘ÿ•xËàôYÇ8I®I˘˜…yIZj©Í)Xπf)ô:äR  !˘	  ,    ( (  òÑ©Á∆‚CqMZ”Ymﬁ5W(é·F~©Ÿ©'õπ-:√ï|”ıÙ⁄íûÛ1p?°X‰ıî1dÚ±ÑFSL”®qµnõe^≈AÈŒ<¶V!Î∏Ñ.«üVπ˙\ßÁ∑d=ˇóv'∏˜’«wh8á∏®8hWñË	◊HËò…¯®π∂IÿyÙF‰Yi˘Y:)yÈözä*
IzT  !˘	  ,    ( (  íÑ©Á∆‚;ëMZ’E9mﬁmù'éexfüôV+zçMk—uOÚ´⁄ÔÚiÑ3\Ó¡2ˆîbQwtÏà¿ ≥	çb¥†e÷+M~≠Hqô;ΩﬁŒ‡0⁄ÏnC‡[yóÃ∆«±c~~˝∏'XßWH8«uá∏»Hóh◊8§ˆCÂTÂ¯(IB9ŸWŸ…˘	HZÍ9ò˘¶òv*Í˙T  !˘	  ,    ( (  ñÇ©aÌ›ÉJNä¨¡IoŒx†wå"GÇ°f≤≠ıJjäûµã—7ºÀÒE—ÂlAbw‰ıÄcôd>ïCjT∫pfµË‘∑¸Ñ≈UpŸ|%ß’ﬂ∆å€ÒnÂ]z~∑Ø¨m˜∏Ù˜„HX∏xÜß∑á6«˜ËX9)πHyiôáπ©Ÿ9ò∫ˆ∆à◊®ò)⁄«©⁄ÍZ	õ*˚Y  !˘	  ,    ( (  óåèÀúﬂ‚C±MZ◊5Yo’}Åô¢Á6ñ-õ¬Îı ïz„íΩÛñÔ–˝h1‚ÃÿC&'EfrtF°9†«Íz&¥òÈ÷€≠*ÉVí:&ß—T±‘˝jÔe€∆Ááu~_}ÁW®«¡5ßhb∏G¯»6(iVñÂ∏(óò…ŸŸ(xâ˘…:™âËπäJYYö *Î
P  !˘	  ,    ( (  ïå†ªË∆‚CëMZ’Ölû}ù'vexV©¥Z€¯k∂ç‚™ŒÚÆØ±Å$bÒR3∆íHÊƒ˘òóPGìkÓîBjˆymµ„hX‹Õklô˝vß’ÒƒYvñíÁ÷ªŒ◊◊f7HXáˆ≥óH∑ÿ((˜(9§x3%tƒxiYπÈÈ»˘©

9iô*ZJzääWàÿP  !˘	  ,    ( (  ïå†ªË∆‚CëMZ’Ölû}ù'vexV©¥Z€¯%Ê;”®Õ‚˘UÛ˝Ù{¿ZbQ◊0íêGﬂÕπSÃS™R∆Ü–®∞
 2õﬂkYåEßΩVıô}‡v]Û‰xπ¶◊…Tp˛ßóg7»◊gvHX∏Â'„ñ®9)◊®e‰àÿ&¯÷)…Ë
j»˘i:˜hIZ™∫πËªT  ;_	&data:image/gif;base64,R0lGODlhKAAoAIABAAAAAP///yH/C05FVFNDQVBFMi4wAwEAAAAh+QQJAQABACwAAAAAKAAoAAACkYwNqXrdC52DS06a7MFZI+4FHBCKoDeWKXqymPqGqxvJrXZbMx7Ttc+w9XgU2FB3lOyQRWET2IFGiU9m1frDVpxZZc6bfHwv4c1YXP6k1Vdy292Fb6UkuvFtXpvWSzA+HycXJHUXiGYIiMg2R6W459gnWGfHNdjIqDWVqemH2ekpObkpOlppWUqZiqr6edqqWQAAIfkECQEAAQAsAAAAACgAKAAAApSMgZnGfaqcg1E2uuzDmmHUBR8Qil95hiPKqWn3aqtLsS18y7G1SzNeowWBENtQd+T1JktP05nzPTdJZlR6vUxNWWjV+vUWhWNkWFwxl9VpZRedYcflIOLafaa28XdsH/ynlcc1uPVDZxQIR0K25+cICCmoqCe5mGhZOfeYSUh5yJcJyrkZWWpaR8doJ2o4NYq62lAAACH5BAkBAAEALAAAAAAoACgAAAKVDI4Yy22ZnINRNqosw0Bv7i1gyHUkFj7oSaWlu3ovC8GxNso5fluz3qLVhBVeT/Lz7ZTHyxL5dDalQWPVOsQWtRnuwXaFTj9jVVh8pma9JjZ4zYSj5ZOyma7uuolffh+IR5aW97cHuBUXKGKXlKjn+DiHWMcYJah4N0lYCMlJOXipGRr5qdgoSTrqWSq6WFl2ypoaUAAAIfkECQEAAQAsAAAAACgAKAAAApaEb6HLgd/iO7FNWtcFWe+ufODGjRfoiJ2akShbueb0wtI50zm02pbvwfWEMWBQ1zKGlLIhskiEPm9R6vRXxV4ZzWT2yHOGpWMyorblKlNp8HmHEb/lCXjcW7bmtXP8Xt229OVWR1fod2eWqNfHuMjXCPkIGNileOiImVmCOEmoSfn3yXlJWmoHGhqp6ilYuWYpmTqKUgAAIfkECQEAAQAsAAAAACgAKAAAApiEH6kb58biQ3FNWtMFWW3eNVcojuFGfqnZqSebuS06w5V80/X02pKe8zFwP6EFWOT1lDFk8rGERh1TTNOocQ61Hm4Xm2VexUHpzjymViHrFbiELsefVrn6XKfnt2Q9G/+Xdie499XHd2g4h7ioOGhXGJboGAnXSBnoBwKYyfioubZJ2Hn0RuRZaflZOil56Zp6iioKSXpUAAAh+QQJAQABACwAAAAAKAAoAAACkoQRqRvnxuI7kU1a1UU5bd5tnSeOZXhmn5lWK3qNTWvRdQxP8qvaC+/yaYQzXO7BMvaUEmJRd3TsiMAgswmNYrSgZdYrTX6tSHGZO73ezuAw2uxuQ+BbeZfMxsexY35+/Qe4J1inV0g4x3WHuMhIl2jXOKT2Q+VU5fgoSUI52VfZyfkJGkha6jmY+aaYdirq+lQAACH5BAkBAAEALAAAAAAoACgAAAKWBIKpYe0L3YNKToqswUlvznigd4wiR4KhZrKt9Upqip61i9E3vMvxRdHlbEFiEXfk9YARYxOZZD6VQ2pUunBmtRXo1Lf8hMVVcNl8JafV38aM2/Fu5V16Bn63r6xt97j09+MXSFi4BniGFae3hzbH9+hYBzkpuUh5aZmHuanZOZgIuvbGiNeomCnaxxap2upaCZsq+1kAACH5BAkBAAEALAAAAAAoACgAAAKXjI8By5zf4kOxTVrXNVlv1X0d8IGZGKLnNpYtm8Lr9cqVeuOSvfOW79D9aDHizNhDJidFZhNydEahOaDH6nomtJjp1tutKoNWkvA6JqfRVLHU/QUfau9l2x7G54d1fl995xcIGAdXqMfBNadoYrhH+Mg2KBlpVpbluCiXmMnZ2Sh4GBqJ+ckIOqqJ6LmKSllZmsoq6wpQAAAh+QQJAQABACwAAAAAKAAoAAAClYx/oLvoxuJDkU1a1YUZbJ59nSd2ZXhWqbRa2/gF8Gu2DY3iqs7yrq+xBYEkYvFSM8aSSObE+ZgRl1BHFZNr7pRCavZ5BW2142hY3AN/zWtsmf12p9XxxFl2lpLn1rseztfXZjdIWIf2s5dItwjYKBgo9yg5pHgzJXTEeGlZuenpyPmpGQoKOWkYmSpaSnqKileI2FAAACH5BAkBAAEALAAAAAAoACgAAAKVjB+gu+jG4kORTVrVhRlsnn2dJ3ZleFaptFrb+CXmO9OozeL5VfP99HvAWhpiUdcwkpBH3825AwYdU8xTqlLGhtCosArKMpvfa1mMRae9VvWZfeB2XfPkeLmm18lUcBj+p5dnN8jXZ3YIGEhYuOUn45aoCDkp16hl5IjYJvjWKcnoGQpqyPlpOhr3aElaqrq56Bq7VAAAOw==‘IJKO¨bplist00‘jkX$versionX$objectsY$archiverT$top Ü†Ø#)*0123MNOPQRSTUVWXYZ[\]^_`aeU$null›	
 !"R$6S$10R$2R$7R$3S$11R$8V$classR$4R$9R$0R$5R$1Ä	ÄÄÄ ÄÄÄÄ”$%'(WNS.base[NS.relativeÄ ÄÄ_\https://hdc-lm-dsi.euro.apple.com:9000/assets/stylesheets/images/ui-icons_444444_256x240.png“+,-.Z$classnameX$classesUNSURL¢-/XNSObject#Aø±Æbã„~ »”456ALWNS.keysZNS.objects™789:;<=>?@Ä	Ä
ÄÄÄÄÄÄÄÄ™BDEFGHIJKÄÄÄÄÄÄÄÄÄÄÄTEtag\Content-Type]Last-Modified_Strict-Transport-Security]Accept-RangesTDate_Content-Encoding^Content-Length]Cache-ControlTVary_*"4ff444d8eea38d3871745cbad4bb5d5557882a98"Yimage/png_Mon, 06 Feb 2017 07:49:38 GMT_max-age=2592000Ubytes_Tue, 07 Nov 2017 08:44:51 GMTTgzipT6867_public, max-age=3600_Accept-Encoding“+,bc_NSMutableDictionary£bd/\NSDictionary“+,fg_NSHTTPURLResponse£hi/_NSHTTPURLResponse]NSURLResponse_NSKeyedArchiver—lm_WebResourceResponseÄ    # - 2 7 Y _ z } Å Ñ á ä é ë ò õ û ° § ß © ´ ≠ Ø ± ≤ ¥ ∂ ∏ ∫ º æ ¿ « œ € › ﬂ ·@EPY_bktvxáíùü°£•ß©´≠Ø±ºæ¿¬ƒ∆» ÃŒ–“◊‰Ú!4CQVÉç≠ø≈ÂÍÔ37DI]auÉïòÆ             n              ∞OPâPNG

   IHDR         Eûr@   bKGD D€<¶ª   	pHYs   H   H F…k>  mIDATx⁄Ìù{leG}«?g≥K÷Ÿ$ΩÜñ»Uˆ!ö>TÌ›ÿR• uÕ&H`oE©*U≤ì».B©RE*%°B˝ã$EÌFdΩE)·›à¬Ü>l‘B∞≥^••PîR±Uïˆ∫È%·ÙèÛö9g^Áú{}ØÔôÔ {Ô=øyˇ~Ûõ9Ûõ˘Mn<öåÉ.Ä«`·†· cÇêâAb/·@ƒ[¿VìD†◊0¯˛3AX9Ê0âNíî_«B ≥”&ÿ˙è>~Á>°cÀ;abµDÏﬂéE¿îÚÈQ z° 'k§êƒM˙ay‘â€¿6Å!Â:u:È:@R≈§ËB°yDDÈï‚'ΩLóø-Ô∞fŸ]S∂’q!” fË
S¥QÓ&öS©◊7MCêòr==3dJØö{ë©fçZµÔÿS0˜MsŸÕ:0KŸ¶gˆ øˆÈõ&HˇUÖ=Ömcœ4Áùi?UƒîGÜ˝U4¿hcÇ≠QbØ]Ä!√ˆhLÌ‹·W/ áÄÜ√@√·†·–pxh8¸~Ä|‹AóèQf?Ä€é õ1f¬∏¿úÉù=uˆÿÕ·QŸGJH Ìp≥ÄôõPœ†IÕw◊¥mÏ∑•æï˚‘ß>2ªä˚"ËW√ìP&{õûnãÌ≤¿T:sÓˆ¯fÑq⁄…ÁH@ﬁ†˙.c€I®√ÿ˚ßÀ~ Sˇs+õ^|BÎnÉ29ÌdHˇÙ∞ãÄÆâ]‘Ûvº-Àå-mÏ™eãhÚß>ı≤ˆ⁄ºq&ÿ™¨ûgÓΩ9x#cÉn„å¡~!®Ò–pxh8º 4^ / áÄÜ√oœ#‡Z@˝≥S•À∞^Ùæ4¬ KZKP›dè9ÄöÀC@F[øãÄ∞•,™Êa+ƒ˙¿òä]8™∆v´ÅK®qHl’w9◊ßè84êKBÉπ◊•|ÅÅ&ñÀ#°ÿ[¿\C≥ Öñÿ`ÎƒR˘≈!¿µ˙∫›:ˆF
z†‡C£µﬂ6ä÷)Aò∆îT1wU.I˜“ó!4–Õigµ3w±îîùÜΩ« E:´ıq7Ê©õ‰ín’0uAó¥ÌmP†óyÃTúK(5Õ¨ÌlN√¶b›T¥≠ŸrwôDVÖ]ƒÌt©e4ÄõÍ¨7ÀµLø ¨[∫ÅCò™0”ÊP˜†&–‡0ËÏÁ¸+ƒı+ÅáÄÜ√@√·†·–pxh8º 4Ú·–ƒYÍ‡`˜ﬁO∏¥ÄãE¥Z<€Ÿh◊\J!Ä‰‰ûãª˜j–;TKÀVr∑0πöÕ¨q•cÀáÛÙuò®‹aÆîÄ˙p®˘üãE{BÒ¨w"†KÀÕ5Ñæ¸n-†Àc"wºv¢TÏ¨6TÔhz·ÄÆ|6–≈ù∫Ì∂Œô≤€N{	tÈÿ]∏€KÓÊê^m1(≤6»—mÀ3Ê®Œ'ÜR fÉ±Œ`√îùÍ´ è_≈>§Ò´jÇ,Æ*ˇ-E)Ùe®õ{˘U˜,ñÆ\u∞ìäoVîÄ:`o˛Ñm¶Ke≤t™Â_WÙπO∆‘dW3¡îêZ’îrv|›~^ògî€`j yc™æπp¶*ö“´fﬂˆ•bÅ] M5ÿŒ9êÿ.ùÇLÏ›NØΩq+%Â¿ΩÁ€Øå0Œvcàc’J◊√E M5»óñkk™#IŸ<õ¿‹x_Äà	ÎçI#0DÑw·—4xh8º 4^ / áÄ^cêÊÏ
»Ô∞¡dØr©˙DM{wøQøtÅe±{»Í^‹`Ç…bÓr./±ÿM:0’£Ó·*ÛÒ¿z¸’Œ`]|SÍB∂(Àe)∑hÕé/Vª˝€Ì‹Æ…"aO!åoˇ,±uÊ^”·—–âÍ^”=Åz†€t`∂WeCCïMQœ±oõ“˚0qµı%û™ÚUÂo?Ÿ<î»@6ñ∑HG/Î˜ÿêŸÚ™†Œ¬‘uAQ-_∑u||Ùô à÷¥*2l≥∆Ÿç≠uG«@– j!™BÙ¶´rêµ«–Ë	q»L!*)¯hªó€∆˝ .∆Vª{3≤Ω Í-Ê¶œ!Ωwë$dPí*Ü®∫°¶/P[∑t1ñ™¬l3Èhlµy◊põËÈ‚◊Ò0bﬁ’gøL∆} Ÿ3®†¸$…%\/å≠.)TwQ·"uK7d+Å2ˆ!Î¡@√·†·–pxh8º 4√' ≠aY$mÚ‡fÀ6ôlB'™.DãÓûºä⁄¬–†úªx7SÃxçÚtIÑ§eW’e}Ü∫ºd0ØRõWªì^›¢´Å0](Uü›ãTˇx¢´âü|´ÊT›|ÇπÅ»@v˜^Df◊πLbˆÔ(Û2´ˆHıÔ0n8;õ‰ÆŒ_ﬁQêO≈Õ}D„êÿ≤&3{º∂Y≤ˆW«wúÃ5*ˆãeÀó?ŸÃñ—GË
¯:H iZ”ñ)/MP£˛ï(:˝!Áû/É|B±Ñ[i®§îç:™GfõLÔ`ƒ~ÎÖÎµ:z$aaëÇ’^˘ÂÚÙ ≠|PÊ- kb›û<€ïL&˙xJÌAABÓ™Å»ºüHv·ë¢Ã[ÄySïÕ…ôÕw«NJuyçü%pw—0∏_a"zÛ†xˆﬂ√Ê ¬3iè1|∂ è=ÖÄÜ√@√·†·%òJW¶˙í˛A«ˇÜmÍ\ë Ã∆∑ lÂî>a±Ù€rV⁄-PñâS¨ßﬂ◊ï±ßjâ«A^Á&vŸÂ&^Wä¿îµÙ«cÍqMz∫-&| ˜œúC •Ëxx»}\Z¨Å≥W≤ŸÙ˘4IgÁÍñ8´YLë1œaÅÛR„ÆÁ¬O≥QÇ.óPU∫„º(˝>¡K“Ô√‹ƒ&c¿.mæœO¥-†Œ√ÊM\8SƒYÀ€Íò.ù'í|Ä5Õ*‹äB@÷òAá%M∆“oª⁄2è£«:ëcâ[Ñ¨K9¨3-â¿tén«ãBÈ¢Ê„o2∆`*]9aZAq?W’Ø√≥¢àß)%∞ä€0ƒ"_æœÆqôˆp¸yV‚ê!ˆ/∞h†œI.(Ê$]∞!àÄ™˜ÁœÁràW”Ô◊+ÀpÑÎ	∏∆P ;4≥4õ„E*Â<aˇoÛ‚„l,ÎZ¯>ªÖ0r"7§¶Î7`” \*!s<ßëà@ë˝ZπœbÈn0ñ¥Õèπ¯me¸HEH]ÇÈXSM¨~#aˇÔ1&ãÄÎ|V≈˛bÇYQE}Áe%Õ¶@√~‚‹—NÚN‰>Û8Ã„o7*®G∏BõM†ÕﬁRò‰-©U= ÿΩ-ƒÖ¬≥à˝Kæê‡ÓØÅEˆÁ+x◊pc\£UíWs5W™∂la?LsÃÒúf;Á€Ã2Àv≈y˛øˇ+îoÇ∑Ú*m⁄ ‰m∆-•”Ê˛t8å∂üW<ãÑ˛,o‚ã Ã∞™ø—´8fçÛ=CHõò`‚æø≠h˛)âÆÅ_Ã}Êõ(Í%m¢ë¨'ﬁ &Ôõ¥;äÍ(¯›ö!‘{:^äÎÕœRˆõ@ú…ïNë˝Œ“Ø"Ã*—<òVºÊï°º5˜ôo¢h~qêı¬+`6Iü‰ßi∂I<%¸±¿≤ΩZ=^JE\`ˇ0]1¸∫˚ÕD™øA¡˛^¶a0fÔ„º(≥ò¿c %[ÄGxh8º 4^ / £ÖOÚ…rdh9Ã÷√ÂÊM7L)-Í”Ç-ª¯ñ?K(˝õÕ—st’¢ìh-?ﬁ:¿_X⁄ßCßrª]««˘8◊YBÕ3œ|ÚC|l—eXWÏÕ_ÂéxÍ!V8∆ä¬b˝8úñòbQ¢óªÛ7±ÌÀ·ß˘N¸4JÌπ•ü»û‡l!æ´=æD?Ωß'a`^⁄Ô –aïq∫¿8›¸˚:-∫¿è≥»YPûüxñ[ÅoÚõÜ÷ùèìX„Q "ˆG÷¥¢Ñ±£W}ÛŸ÷
£ÛÑÊ1>Ãc‹«√ööbÉYV
6=ÒËß*óÎ€ø≈ª∏Ã)˛âﬂ–¯8hsÖêÄìÖïæåË/Òá8Æ§'Õø ,ól¡Ñ∫îö€E˙b¡ø§\YùeÖ.–M6‹àÊ‡d9uùÈJéZƒΩjÀ·-lÒ˛çÚÇ∆&8≈:s\–ötÎ‡Ôy'óhsâ[¯Gm®h-Ωm§Àkñ2^SÏJêÙæe%u\j5›Œınãû |èá«;Ÿ‡¨¥öæŒ¥a[á;Ï–•Àéˆp◊?Ûª|ùyæ¬RaC$Ï_a™/À¿ÔÊ)NÛUNÛÂ∆çõ ”˘»Ñpïñ~à√öç/Û„Ûk˘ùò˝…È…n©π¿˝|J˙˝)Ó/Ñ9 Q:¿√,≥¿˘àK‚ Ñx†R‡ˆ!  ·B%˝]lq+ﬂÊù|õw¨÷	˚’Ω_\GWÕ)"3]aCJû˛%>¿ì|ê'˘ _Êå∆ÖDPç·˝*ﬁ0“’Ò≥±7¬≥π=àV”ZEıìg≠úV-ŒL˙à‚'—Ú÷@}œÎ2«é∆™[øPáÈ¬'Äô˝rEm["vîOˇÑ#‹À‹À5¸g$⁄$?äøm∆ü'zJœÿ^SÊµxHjñgé4DŸﬂ‡õ¿≠ƒÍ=ó4ˆØ…—Ú@Ï≈˘F7#
—äõø¸~ò®‚zˆ'o	To„©ãöbÃìƒddˇcÈÍ–B˚U%T9“äD@ı.Ò!˘+NÛwuûeÓ£Àr>n¶ƒ-âU∏$U`I∆v%ã©˜ØÛAﬁQ∞ˇü‡E∫d”œ
∫¸;õ”ò:Ù+˚a&˜Xƒé ‚yº∆ÔÛ% ßÀkä˘∏ÆÊ‡ìÒÎèGø—ÅºöÓ	Êä"Ë˜4ﬁ–pxh8º 4^ éÊ	@d6Ó((ù‘î{ìC::[ﬂ>ÛH,
¿…¥NVNØ∫Ä∫hr.˛~Nª´·¡ÿ±ZÅﬂbï3ú·ÌºùÔÒ+ÖòQÎ|,˛%ﬁt·Ô%‰n!‰Ωú*ƒ7ªØ»Ôf»Ôg(“m!fy»Ù§"Èk‡I6Y„/ÅeZ©Ÿ≥òàã+…˛Ïzügô6W8…¶bQ% yôª8Ø∑Î◊√èÒ2≈ï¬#È˜◊˘©b-tôßY°Õï8y≠ﬁnOÏ{]•!Ÿºˆ*¨É›\à ›(≥ÆpÂ2.ƒHÕŸôÿdç.>ZÏ(N¬À¿&Ûl¢2®&kÌ	˚U&◊£Òß⁄˝~ .ª¸î◊ïÙßπ åß6˝µ“58A7Ω£®í}P:∫√BlkU€[√8ï)–j·∑1…$ì¸WÚ ” !s\‡±§õ˜≥Ë≤QFËn(qRKïÜ:'òXóπ´@œ€”Ú=$Î«x±ê˚#|Ä5:†‘@‚â«]•–Á2Ô∏S¶iÄ.ƒ&πW
óÎ$`
8´tÊ“Ê 3 =⁄&[#ˆﬂ•ÙÊæU3ˆËöﬂW“≥q Í.H{øö˝‚ûá¸Z˚ì¸,µº»£Ö¯„"…‹AΩ™HπÔä#ÈÁèÅüWÑ¯( +Ã±¬1Ö…é•;‘ﬂ¿œ8¿/<EèE∞C+n∫U:∂|a·∂·…îÉM|é?LøÁ˜≈…ÏW1$~}ÇWπ´,Í£o öVËºÖìûáºR– ¢˛àl{ÂÊ 7ˇ	¿è≤÷Õ‘^õ;<Õ,´t[¢≤Ø⁄Á∑¯T"»˝3SU9l∆ÃÀæãHÿÈà[yV¢&Ïüaú@ŸØ‚Eˆ√&À‹<D4”(bá˛è7qïÚˇ¥≈¡∆µ\ÀÀ\ÀuÒˇf®Œ€Ê 7rÄ∏ÅÄõìŸ˘øà^í⁄Ci˚[àﬂ.≥©hÄà˝ﬂ‰.ﬁŒ≠D€"DDÏ_3§ôeæ¸íÇ˝ ücçáY„Q∫,ÄB@§fUÿ∂±/ú?ûã◊gˇœÂB¥Rë¸ŒC‹&£ﬁ2£åP÷8»◊@3ZtS≈ˇ,∑Ê¨Ê—v7˚^#¥Âè¶ò;c'ûN»πÑÅª˘.?d[€J!Az^ ?Õ<ÃØ±o…õÊ_s[Kg{(eó}˘Eá~Jˇﬁ,‚-<<†È≈Ûå≥ãUãˇÂÁ
"&B% ¢7√~Ï{Æ / GÛlº 4^ éº Ãj˝Öﬂ…˘‘ítﬁË’cAûÆ0\(ºÉ¬ÛÈ‹ì{˘Ã†ÔQ¢8˜˛YNÁB›ô≤?[°˚¥R¨‹$ækêéµ\ˆ{èu¡öæ◊æ~˚Q ñÄq∆)Î8£å´z:G≠G„œUK©:ä07˛º6û-Ñç
WMY<≠˘æØëß˘Ÿ—∞;∏$5å&v·â}%∞•8∏)#9&)/‹ŒK^2œ+‚ŸBÃ≥Ãiæ¡m\“§‡Ê–›V√}ÖLDΩæØ1/i¬€nﬁ]2ƒç“Ô¢>˘“I?UÏó7x®œ◊G€4∆c˜*˙iû·'<√iM
¿p¨œÌËƒ„7∂YÕVÖˇ=˛”°l*&ôâ“◊±ﬂÿ—^jﬂ»}fpŸÀ8l∞¡ÙÈZ™ D3H—$"´æ:ä0:√ªì{ö±]œ~ª+ÊX‡≥,£V‡ßyÄ€π§Ma#en>Ñx’∆®Ã"–I∑3cˆÙ1e\’”éeé(ˆ≤$˜ôzˇÇÊª¸tônÍÖßHøƒÌÊv.|mO9QFLÿ&yÔ·Î
ÍÔ‰Œ†g)È5ÉﬁúlW˛v'∂6z»KÒ,`]”«´ﬁ2§à@}œû®ÊÓÊ≥9Í=<°à”a’8~õˆÿ‚FR \p≥Ò∂DxîäâT3–XIxk`√·†·–pxh8º 4^ ÚËXº˘Ô36à*≠H!zu%ƒ†p÷‚ªc‹´–±Ódÿwê5@áU´®ë	OKõBá’ÿ“–aµ B≤¯-*ËãRJ*,¯ø(î`ëEC˝‹ŸÔ≤´i_ Ô+8¬)ódıﬁÑC)^H~M?jº Ë@‹x¶9[†GW Ë‚À50˚04[ 	uDV’sÄ´÷ªºuÒFã}4ûö5LíÇU5TTä‚∑∫)Ì{®`ç„UŒ:¨1√â»zH <5õ{ít∞≈ﬂåDﬂèPÄµäçúƒk± A.Ö5fX•eHﬂ-Á™Âì}®©3∆∏"5¨pc¬PBûË∆˛,Ñ˛FÅ·áyîèêÕU S˜%º50è´õ©˚^ øÿpxh8º 4^ / G^ Lgo=Fô ¥bW©7r£∆◊~dg{PCıÿóH†E7usåÆí…mfxîË:\(ë7ó,ÊÆ+X‹c∫á…B–9¯4!‰A"T∫Cé–bÖé’ôl—Uq˛∑Ï(±ﬂt"h—eìS¿|É5.”÷‹NΩÃ'xÖU:öL£p*_’c±;ıCº∆°Ç?ÌêÎyïÎáÎj˙´Z˙m7˛SyÏ˜P r}∏{ëøHõÖ‘ÊÀ,på9∫,H©úﬁú~Sﬂ˛}m¸ßæ|Æãˇﬁå⁄-0”«=Û]ë◊ ‘ 	π∆ÁX–∫CVkÄ_ï~∑†¬˚K˜– “ ;¨—a>>4=Oõ5Õçs¨pîß'ÏUX‚ªπﬂ{J˜– ôF˜alrë˜”F}c@∂`fQ±˜è»éπ—áxm‹ÉÒã‡ #<˙ ø†·∂ÄÜ√@√·†·–pd`ª†.˝6IÈèp€û”˚]øA”+"y∞›Póns3◊ozøÎ7hzeDp'´†ΩóØ∆ﬂÍ“mé&˚MÔw˝MØÅh»<ˇã«¶Œ(æâ»”ÔIØñΩ'Gøê>äßÔW%Ø°‚üQ∆W’œV±¸Â„oH”tÒMt±jÆîDﬁU¨⁄¥ÕïlÊ ˆn‡	ÈIÔ“wâoO_Â€5~Ä˙ÄYX‚w(§R§ˇ ≠mø‰È)ûß'á‘DêÌÎ≈ÿË…∏õç«Í÷5ê=˝@ôö+ÏÈõ†~˚ÈÛjÙõy^`O‡`˝$º!¸_°U#ò!GØíB |Vâ:ƒµô…>d†›Ãeâ˝=AØáÄy‡<’áÄ˙*^_æb
’T∏)}7b”P∫¸oÊ≤ƒ˛hÄhhª¿ç~7∞Ãr¸M§ã/d°‚È’F«HGIóÀû>&QlÙ™Ìì‘/¨L^bø:◊íà‡¢TÄﬂD‰ÈüM≥9˙óÖÙQ<˝≤*y=¨ˇ¢2æ™~∂˙ãÂ/?Ôº™,êîøö+%q’qÄó¯ﬁó£‹√SÈ˜∫Ù?‹ë£ﬂÀÁ˜åﬁÔ˙ö^ë ¿e÷ÿ·]Ò”G˘SV§puÈœÒ^ßˇ˙Óÿ≥Ù~◊o–Ù Bol8º 4^ / áÄÜ√@√!É‹/ON∫G»÷¿±Ù€Æ2t]∫«–°8‘c›Æ5Öz=7®ùÇáÑº ÿ∏ÀÆëû∏g–¡∆@ù/ÔaE[øáy#«3“#zÑò7Lò.|˚Ü
èí(cRëcõS®◊m‰QÚ$–6˛◊•{D∞©÷aß{TÄ_j8º 4^ / áÄÜ√@√±`¬/ı≤ ‘_gô"d™ÔÂû`ã…æÁ“ »0ˇ∂ﬁ±{–≈»∞ˇ∂ﬁÌŸﬂC∏jÄêâ¬_9ÑÖjDÏ’ãa¬~?Ë	dc–[öªµãÂ0Ì*aˇ§ëæÌÁ ΩÇ, &0ô≤&˘+ßÑ◊OäB4!§Ø1ô˝~ËÜIxˆ Æ†>Ï8îcˇÑ&úG)∏jÄΩÄIª®ÿÔÁ =@Ø5@øvÌ&J?ˇÈQ≤ l«√á@ÛÈQ˚◊‡—¸?ªx^yô3   %tEXtdate:create 2016-07-13T10:21:59+00:00âã   %tEXtdate:modify 2016-07-13T09:26:54+00:00ÛÕ†   tEXtSoftware Adobe ImageReadyq…e<    IENDÆB`Ç_\https://hdc-lm-dsi.euro.apple.com:9000/assets/stylesheets/images/ui-icons_444444_256x240.png‘MNOO¨bplist00‘jkX$versionX$objectsY$archiverT$top Ü†Ø#)*0123MNOPQRSTUVWXYZ[\]^_`aeU$null›	
 !"R$6S$10R$2R$7R$3S$11R$8V$classR$4R$9R$0R$5R$1Ä	ÄÄÄ ÄÄÄÄ”$%'(WNS.base[NS.relativeÄ ÄÄ_\https://hdc-lm-dsi.euro.apple.com:9000/assets/stylesheets/images/ui-icons_555555_256x240.png“+,-.Z$classnameX$classesUNSURL¢-/XNSObject#Aø±ÆbãÏÓ »”456ALWNS.keysZNS.objects™789:;<=>?@Ä	Ä
ÄÄÄÄÄÄÄÄ™BDEFGHIJKÄÄÄÄÄÄÄÄÄÄÄTEtag\Content-Type]Last-Modified_Strict-Transport-Security]Accept-RangesTDate_Content-Encoding^Content-Length]Cache-ControlTVary_*"a3656d98a69607ed4991fc00169edfb3f4672399"Yimage/png_Mon, 06 Feb 2017 07:49:38 GMT_max-age=2592000Ubytes_Tue, 07 Nov 2017 08:44:38 GMTTgzipT6858_public, max-age=3600_Accept-Encoding“+,bc_NSMutableDictionary£bd/\NSDictionary“+,fg_NSHTTPURLResponse£hi/_NSHTTPURLResponse]NSURLResponse_NSKeyedArchiver—lm_WebResourceResponseÄ    # - 2 7 Y _ z } Å Ñ á ä é ë ò õ û ° § ß © ´ ≠ Ø ± ≤ ¥ ∂ ∏ ∫ º æ ¿ « œ € › ﬂ ·@EPY_bktvxáíùü°£•ß©´≠Ø±ºæ¿¬ƒ∆» ÃŒ–“◊‰Ú!4CQVÉç≠ø≈ÂÍÔ37DI]auÉïòÆ             n              ∞OLâPNG

   IHDR         Eûr@   bKGD U±åÜI   	pHYs   H   H F…k>  iIDATx⁄ÌùleGu«?w≥K÷ªI˙-ë≠TŸ¢iã™};ÇT[Âπ-e$boE©*U≤ìh]Ñö@§J©D6Í_$)(j7Çı	§ ¬ªÖÖ˛∞QP¡ŒzïñB—ÊáTlU•}n˙áÉ6‰ˆè˚kÊﬁ˘uÔ}œÔŸwæ+Ô{Ôû˘}Œúô;gÊL<öå=É.Ä«`·†· cåê±Ab;·@ƒÎ¿zìD†◊0¯˛3FX9Ê:0éNíî_«B ≥”&ÿ˙è>~Á>¶cÀ;abµDÏﬂàE¿îÚ.“¢ ÙBé◊H!âõÙ√Ú®6ÄC uÍ8t“uÄ§äI?–!ÑBÛàà“	*≈Ozô.[ﬁaÕ≤ª¶l´„B¶Ã
–¶>h>¢‹M,4ßRØoöÜ 1Âzzf»î^	4˜"SÃµjﬂ±ß`ÓõÊ≤õu`ñ≤MœÏ(î,Ï”7Mê˛´
{
∆ûiŒ;”~™:à)Ôˆ√ﬁß7¯qq£F6g]Àﬁ$Â¡◊±áËµ Ït‘ü	øÿpxh8º 4^ / áÄÜ√@√·˜‰„∫¸€å2˚‹vÿå1c∆˝ ÊÏÏ©≥¿nè æ´Ñ§‹~ 7òπ	ı◊|wM€∆~[ÍÎπO}Íªf7@q?@Ω±#	e≤∑ÈÈ∂ÿ.˚L•3ÁnèoFßù|Ó
»˚Tﬂel8iu{ˇtŸ`Íne”ãOh›mP&ßÅL Èüv–5±ãzﬁà∑eô±Æç]µlM˛‘ßæãÃ¡Â7Ñòºq∆XØ¨û«∆‡]
ø†Wqw(¸BP√·†·–pxh8º 4^ / áﬂûG8¿µÄ˙gßJóoΩË}iÑAñ ¥ñ†∫)»s 5óáÄå∂~ˇ aJYTÕ√V˛àıÅ1ªpTçÌVóP%‚Óëÿ™ÔrÆO?ph ó*ÑsØK˘M˛,óGò≥µÄπÜf
-±¡÷â•ÚãCÄkıuªuÏçÙ@¡áFkøm≠SÇ0ç(©bÓ™\íÓ•/Ch†õ”ŒjgÓb)(;	zè-îãtVÎ„nÃR71»%›™-`ÍÇ.i€€†@/Ûò©8óPjöY⁄%ÿúÜM≈∫©h[≤ÂÓ2â¨
ªà€ÈR	 h 7’Yoñ8jô~ï10*X∑tá0Ua¶Õ†2Ó^M†¡a–%ÿ…˘WàÎW/ áÄÜ√@√·†·–pxh8‰√°â≥‘¡¡Óºüpiãhµx∂≥—ÆπîB& ……=wÔ’†w®ññ≠‰n-`r5õY„∆J«ñÁÈÎ0Vπ¬\)ı·PÛ>ãˆò‚YÔD@óñõk}˘›Z@ó«XÓxÌX©ÿYl®ﬁ—Ù¬]˘l†ã;u€lù3e∑ù4ˆË“±ªp∑ó‹Õ!Ω⁄bPdmê£€ñgÃQùO•îÕcù¡:(Ü);	‘WAøä}(H„W’Y\U˛ÎäRËÀP7˜Ú´ÓY,]∏Í`∆ﬂ¨(' u¿ﬁ¸	€Ló dÈTÀøÆËsè©…ÆfÇ)ˇ µ&™)ÂÏ¯∫˝º0œ(∑¿‘ Ú∆T}s·LU4•!VÕæÌK≈ª öj∞ës ±Q:7òÿªë^{„VJ 	Ä{œ∑_a*úÌ∆«™ïÆáã öjê.,◊÷TGí≤y6Äπ#Ωv±≥1fΩ1i◊¡·Dx4^ / áÄÜ√@√·†◊§9ªÚ˚l0Ÿ´\™>V”ﬁ›o‘/]`YÏ≤∫˜ò`≤òªúÀK,v„Lı®{∏ |<<∞µ3Xﬂî˙Äêﬂ-“ÆsS¸ ›Çã€π]ì=—ﬁ¥°ë¡ŸRn®†Ê˝Ö´”÷ü6•>0®Á ∫Mf{U∆¯*õ¢∂oõ“˚0qµı%û™ÚUàÌdÛP" ŸPXﬁ"]º¨ﬂ`C@fÀ´vÄ:S◊Eµ|›B‘ÒÒ—d Z”™»∞Õg7∂÷UçÅ†A‘B˛TÖËM/VÂ kè°—‚êçÃ*)¯hªó∆˝ .∆Vª{3„(lk˙l“{IB%©bà™j˙µ5p›PAc©*Lt5ªK|õwªí5πP©„aƒº´œ~ôå˚@≤mP@˘IíK∏^[]R®Ó¢¬EÍñn»‡WeÏ@÷ÉÄÜ√@√·†·–pxh8ÜO Z√≤H⁄‰¿Õñm2ŸÑNT]à›my¥Ñ°A9wÒn¶ò—ÂÈíIÀÆ™À˙ªË:ê¿ºJm^ÌNzuãÆR¬t°T}v/R˝£iàÆ&~Ú≠öSuÛ	Ê" Ÿ›{ô=\Á2= àŸø©ÃÀ¨⁄#’ø…®·Ïlíª:yGA>7˜çCb»öÃÏÒ⁄f…Jÿ_}ﬂt2◊®ÿ/ñ-_˛d3[FﬂEW¿◊A" I”äˇ´R◊ü∑mÙ÷È9˜|‰ãä%\OC%•l‘P=2k†ÿdz#ˆ[/\Øï–—#Ûàƒ¨ˆ /óßWnÂÄ2o∂mçˆ+ôLÙ—î⁄ÇÇÑ‹Uëy?ëÏ>¬#Eô∑ Û¶*õì3õÔéÕîÍÚ8>K‡Ó>¢apø0¬6DÙÊ9@4ÏøÜÕAÑg“6c¯l€
/ áÄÜ√@√±õ`"]iòËK˙{Ÿˇ∂©sD07‹”ïSzÃbÈ∑!‰¨¥[†,'XIøØ(cO‘èΩº¡ml±≈mº°Å	kÈèƒ‘#ö<Ùt[L¯@Óü9áîKë£»êáπ¥XgØd”ÈÛ.híŒŒ’ÕsV≥ò,"bñ¬Á•∆]…Öüdµ].°™tG∏*˝> K“Ô˝‹∆#¿m~»Î⁄PÁaÛ&.á	ú)bà¨ÂmuLóŒIæ¿≤fnQ! ÀL°√º¶ #È∑≠mÅß—cÖ»±DÑuBV§VòîD`2G∑„™P∫®Ñ˘¯kåpòàAWNòTP‹œUıÎ¨(‚iJâ ¨≈ü‚6±»óÅ≤e\¶›û’Üÿgà=«ãú6–g°
ôët¿™ ™ﬁü?ü[d»>^Køﬂ§,√An"‡Ä°î˜hfh6«äT 	x¬˛ﬂ‚ƒ«ŸX÷µ$C∂
a‰"D0jHM◊o¿¶‡˘TBfx^"Å"˚#¥rü≈“›l,iõüp7u⁄ ¯´êäê∫ì±¶ö,X˝F¬˛ﬂcD◊˘¨ä˝≈≥¢ä˙ŒÀJöM$"ÄÜ˝ƒπ£ù‰Õ}Ê±üW„o∑*®πBõ5†ÕﬁVò‰-©U= ÿΩ-ƒÖ¬≥à˝Ûæ
ê‡ÓØÅEˆÁ+xÄ`ÑZ%y=◊s=†Íaˆ√œ3√œk∂sN∞¡4”lTúÁèÀÒøëB˘∆∏Öê◊h”f!∑∑îNjòH¯”a?6ÿB|^Ò,˙≥ºÖ/0≈rD®˛F[¨‚à5Œ!m`åà˚˛Ü¢˘'$∫J~1˜ôo¢®ó¥âfD≤ûx;k º¨—6Ï(™£‡∑jÜPÔÈx)Æ_4?KŸo q&[T:Eˆˇ9/Jøä0´DÛ`RÒöWÜˆ‹gæâ¢˘≈^V
ØÄŸ$Y|íü¶Ÿ&ye·Øà9ÑÔ’BËÒR*‚˚áÈ¬à	‡◊Ñﬂ/j&R˝E
ˆ˜2ıÉ1{·™Ã˛a èÅ`7Ÿ<*¿@√·†·–pxÿ]¯ü(AÄñ√¡l=\nﬁt√Ñ“¢>)ÿ≤ão˘”Ñ“øÈ˝téÆZt≠ÂG˙@¯K˚tËTn∑˘„FK®YfôM~àØÅ-∫L+äΩ˘K‹Ø@ùaë√,*,÷O≥ Y`û	NKÙrw˛&∂}9¸$ﬂãüF©›ë[˙âÏ·	Œ‚ª⁄„€@¥”{z& f•˝ ñ•å“ÕøØ”¢ÃÛ4ß9 Ûœq¯6øah›Ÿx1iée^ bdM+ä@;z’7üm≠0:O¯aû‚√<≈√<Æi†	Vôf±`”è~™rpπæ˝;ºõÀÁü¯uçèÉ6W	8VXÈÀËÄÅ˛◊ÿ«%=i˛9`°d&‘˘‘‹.“OåÛ ï’iô„›d√çhNñSWò¨‰®E‹+†∂ﬁ…:?‚ﬂxï56¡	Vò·Ç÷§[œª∏DõK‹…?jCEkÈm#]^≥îqM±W(A“˚î‘Q©’t;/‘ª-nux0è-6≥9¿Yi5}ÖI√∂6Ÿ§KóMÌ·ÆÊw˘&≥|ï˘¬ÜHÿø»D_ñÅõ/síØqí/(7n‹òŒG&ÙÄÄÎ¥Ù}Ï◊l|ôïü_ÀÔƒÏONOvKÕ·ì“ÔOÚH!Ã!—gÅ9ŒG\Á !ƒs ï∑Ÿ*ÈÔfù|ówÒ]ﬁU∞Z'ÏW˜~q]5ßàÃtÖ)y˙ó¯ œAû·É|ÖSm@5ÜgÙÎ¯ôëÆéüçΩûÀÌAÏ∞î÷*™ü<hÂ¥jq !EŒƒO¢Â≠Å˙û◊eÜäU∑~?†ìÖ1N 3˚Âä⁄∂Dl*ü˛	yêõyê¸ß$⁄8?éø≠≈üG{Jœÿ^SÊÂxHjñg¶4DŸﬂ‡€¿	bıûÀ?˚óÂhy ˆ‚|£õÖh≈Õ_~?LTq=˚ì∑Ä™∑Ä—‘EM±ÊIb2≤ˇã±tuË°Å˝™™iE"†zxó¯Oß˘+NÚwuñ¶ÀB>n¶ƒ-âU8/U`^∆v%ã©˜Øpá wÏˇGπJól˙yTAóÁasSá>ge?LÂ^ãÿD<èk¸>_‡i∫\SÑxòÀ«u5ã_<˙ç‰’tO0PAø†·∂ÄÜ√@√·†·–p4O "≥qGAÈ§¶‹€“—Ÿ˙vòGbQ é•p¨rz’˝‘EãêsÒ˜s⁄]è∆6à•Ç¸&Kú‚Ô‡¸Ä_)ƒåZÁ£Ò/Ò¶„«y!wr'!Ô„x!æŸ}E~7C~?Cën1]»C¶'I_è±∆2	,–JÕû≈D\\Iˆg◊˚,¥π¬1÷ã*QŒ‹«πxΩ]ø~òó)ÆLøø¡Ok°<À"mÆƒÈ»kıvsxbﬂÎ*…Êµ◊PaÏÊBÈFôÖ+ﬂêQ!FjŒŒ4¿ÀLqÅ˜”bSqfX ÷òeïA5YkOÿØ2πä?’¶Ë◊˘)[lÒSﬁP“üÂ0ö⁄ÙóK◊‡(›ÙJå¢HˆAÈtË&s±≠Umo„T&@´Öoaúq∆˘Ø‰A¶Bf∏¿9ÊbI7Ôg—e/¢å–›P ‚ò ñ*uN0±.p_Åû∑ßÂ{H÷sµê˚|Äe:†‘@‚â«-•–Á2Ô∏Q¶iÄ.ƒ&πW
óÎ$`8´tÊ“f&êmì≠Å˚ÔSz

sﬂ™{tÕÔÇ+ÈŸ∏9Â u§Ω_Õ~qœC~≠˝ﬁLÌWy≤ˇ£\$ô;®Wı˜)W‡]q0˝¸	Ûä`ë9¨–!Ÿ±‘báö ˛xì=¸/p&z,jÄMZq”-—©∞Âc∑O¶l‡s¸a˙=ø/NføäÅ«xH¯ıØrW	X‘G¿5≠–y
9,=y•†D˝Ÿˆ Õn˛Äg≠õ©Ω6-6yñiñË(∂De3^µœoÒ©*Dê˚g¶™rXãôó}ë∞?“'xN¢&Ïübî@ŸØiÊ‚Eˆ√<ú!öi±…&ˇ«[∏NyÇ“‚`„n‡en‡∆¯3TgÉmsÄ[Ÿ√Õ‹ÃÕ¿ÌIàlà¸_D/IÌ°¥˝Õ≈oóYS4@ƒ˛osÔ‡—∂˚óÈ_fÅÔ ø§`?¿ÁXÊqñyí.s†–©YVÖm,G
Áèg‚√ıŸˇ3π≠TG$øÛ∑…®∑Ã(<#îµÚ5–å›TÒ?«âú’<⁄ÓfﬂkÑ∂¸—sì√l∆”…=9ó0p?ﬂÁU6¥≠§ÁÚ”Ã˝ºìïxKﬁ$ˇö€Z:≠ÿC)ªÏÀá(:ÙS˙/Ê`o„qM/ûeîÖX¨Z¸/?W1*Ωˆcﬂsxh8ögê‡†·–p‰`ZÎ/¸Œßñ§ÛFó®;Ú$pëi‡B·˛òOÂû<»ß]xè˙5¿…∏˜Os2Íûî˝Ÿ
›ßîZ`Ö–‡&ÒÂXÉt¨Â≤áÿ~¨÷ÙÌˆı€7à0å2JÒX«)e\’”	08j=.YJ’QlÿÄŸ∏ÒgµÒl!lÙP∏j¢»‚IÕ˜çl8…◊…éÜ›Õ%©a4±OÏ+Å-≈¡M…1Iy·vVÚíy^œbñNÚ-Ó‚í&7áÓ∂Ó(d Íı≠xçy^ﬁvÛÓº!nî~ı…óN˙©bøº¡C}æ>⁄¶1ª_P—OÚ^Áú‘§ «˙‹ˆ!ÄN<˛wcõ’t≈Q¯ﬂ„?∫¿öbíô(}˚]qÅMÌ•6≠‹góΩå¿*´¨BüÆ• HFÂ¨á€∆i5ñ	¨¨õ*lfàÿæTõ˝0MÀpÒ’]πœ.∑äü%2∂N@˜CäH :ÈÔñ`fÃû>•å´z⁄±ÃÒ≈^ñ‰˛!˚Á4ﬂÂßtS/<E˙%ﬁÀ~ﬁÀ%ÉØÌ	' Æ— …≠aj¸˘æ©†˛NÓzñíæ/ÈÕ…ˆﬁow≤`a£á¨2œV43˝™7Å)"Pﬂ≥∑*4¡˝|&G}Äœ*‚tX2*p”~[‹·¿Æ ‹≈tº-û‰Çb"’4V <v%º5∞·–pxh8º 4^ / yt,ﬁ¸wòDïVx§Ω∫bP8kY≈Ôm ùäí!Ü¨:,YÖ@çLxZ⁄:,≈ñÜKí≈Ô¥Ç~ZJI%ÇˇÖúÊ¥°~ÓÏwŸ’¥#P™
Aoì)ñ
‘!dâ)6ÈªÂ\]Hcìö…!°Å˝yj∞[tÅz–a…zó∑.ﬁ—jøÿGC·©ôyI
:Tg~—√AuÏ‘Pµ ,3eº Yáe¶ò"j†)aÕ<ûöÕ=I
:ÿ‚ovë5†( À9â◊bâ©¬∂êe¶X¢eHﬂ-Á™Âì}®©S∆∏"5¨pc¬PBæ/`ô3∆¶5›(0¸0ﬂ®°ìVÂ©;ﬁòGá%ãÕ‘/ á_	l8º 4^ / áÄÜ#/ ¶≥∑ªô ¥bW©∑r´∆◊~dg{TCıÿëH†E7=SwòÆí…m¶xíè”u∏P"o.9ùªÆ‡Ù6”=4HÇŒ1«ßxàêG9C®tá°≈"´3Ÿ¢´‚¸oŸQbøÈD–¢À«ÅèÛ-ñπL[s;ıèÒ
Kt4òF·Tæ™GbwÍ˚∏∆æÇ?ÌêõxçõáÎj˙kZ˙m+˛SyÏ˜P r}∏{ëøHõ£Ö‘Ê8Ãqò∫ÃÒD©úﬁö~Sﬂ˛}C¸ßæ|nåˇﬁä⁄0”G=Û]ë◊ ‘ 	πÃÁò”∫CVkÄ_ï~ø†¬˚K˜– “ õ,”a6>4=KõeÕç3,ràg'ÏUòÁ˚πﬂ´€J˜– ôF˜a¨që{i£æ1 €0
≥®ÿ˚wŸ⁄›Ò⁄∏G„¡<:îFxÙ~?@√·máÄÜ√@√·†·»¿v@]˙]<ë“üP∏jÏ7Ωﬂı4Ω"í∑ €} uÈ67s˝¶˜ª~É¶WF$ ˜∑
⁄˚¯Z¸≠.›Êh≤ﬂÙ~◊o–ÙàÜÄÃÛøxlÍî‚õà<˝ÅÙjŸrÙ{ÖÙQ<ΩWïºÜTàJ_U?[˝≈Úóèø*L”≈7—≈R®πRyW±A·óLWDt{?YÈIÔ“wâoO_Q6~Ä˙ÄYX‚w(§R§ˇ ≠mø‰Èq^†'á‘DêÌÎ≈ÿË…∏õç«Í÷5ê=˝@ôö+ÏÈõ†~˚ÈÛjÙ€yA`O`o˝$¸L¯ø<B´F0C<é^%Ö@¯¨?tàk3ì}»@ªùÀ˚{Ç^≥¿y™ıUºæ|≈™©pS˙nƒ¶°t˘ﬂŒeâ˝=– —$–vÄ˝~`ÅÖ¯õH_»B≈”œ
T#%].Xx˙îD±—´∂ORø∞2˝â˝Í\K"ÄãR\T|ëß&m¿œ‰Ë_“GÒÙ+™‰5Ù∞B¸ã ¯™˙ŸÍ/ñøl¸ºÛ™≤t@R˛jÆîƒuÔxâˇ‡˝9 |9˝^ó˛#˛áªsÙ˘¸∂—˚]øA”k  ∏Ã2õº;~˙$ ¢Æ.˝yæ«¥„_√#{∂ÉﬁÔ˙ö^~CH√·≠ÅáÄÜ√@√·†·–pxh8Dcê˚ÂÈ√I˜® Ÿ8í~€RÜÆK˜:áÄz¨€≤¶PØÁµSêê ∑ÿ2“˜:ÿhª∆=¨hÎ˜– / #`d‡#Fz‰°CèÛÜ	”Ö/`ﬂP·Q≈!`§B*rls
ı˙ØMÄ<JBû⁄∆ˇ∫tè°É( 6’:Ïtè
AáÄÜ√@√·†·–pxh8vÆ å˘°^@Ä˙Îl!ÑLÙΩ‹c¨3ﬁ˜\ Y ∆„øA√÷ª#ˆo∫òª≤ ¨«ÉÖ≠w{ˆ˜Æ d¨Wa·ü{ıbò∞ﬂœzŸ¥N¿∫ÊnÌ‚_9L:ÖJÿ?n§o¯9@Ø ÄIåß¨I˛ )·ï¬ì¢ç	È´DLføzÄa“ û˝Ä´®˚Âÿ?¶	ÁQ
Æ`;`“.*ˆ˚9@–k–Ø]ªâ“œz‘Ñ, Òﬂ!–|z‘ƒŒµxÙˇ¿u\ªv!ΩQ   %tEXtdate:create 2016-07-13T10:21:59+00:00âã   %tEXtdate:modify 2016-07-13T09:26:54+00:00ÛÕ†   tEXtSoftware Adobe ImageReadyq…e<    IENDÆB`Ç_\https://hdc-lm-dsi.euro.apple.com:9000/assets/stylesheets/images/ui-icons_555555_256x240.png’QRSTOÈbplist00‘klX$versionX$objectsY$archiverT$top Ü†Ø #)*0123MNOPQRSTUVWXYZ[\]^_`aefU$null›	
 !"R$6S$10R$2R$7R$3S$11R$8V$classR$4R$9R$0R$5R$1Ä	ÄÄÄ ÄÄÄÄ”$%'(WNS.base[NS.relativeÄ ÄÄ_Vhttps://hdc-lm-dsi.euro.apple.com:9000/assets/javascripts/generated_default_scripts.js“+,-.Z$classnameX$classesUNSURL¢-/XNSObject#Aø±Æbãˆı »”456ALWNS.keysZNS.objects™789:;<=>?@Ä	Ä
ÄÄÄÄÄÄÄÄ™BCDEFGHIJKÄÄÄÄÄÄÄÄÄÄÄTVary\Content-TypeTEtag]Last-Modified_Strict-Transport-Security]Accept-RangesTDate_Content-Encoding]Cache-Control_Transfer-Encoding_Accept-Encoding_%application/javascript; charset=UTF-8_*"fa44e9478b831fe08624810a128f659812f54e25"_Mon, 06 Nov 2017 07:24:04 GMT_max-age=2592000Ubytes_Tue, 07 Nov 2017 08:44:38 GMTTgzip_public, max-age=3600XIdentity“+,bc_NSMutableDictionary£bd/\NSDictionary_application/javascript“+,gh_NSHTTPURLResponse£ij/_NSHTTPURLResponse]NSURLResponse_NSKeyedArchiver—mn_WebResourceResponseÄ    # - 2 7 Z ` { ~ Ç Ö à ã è í ô ú ü ¢ • ® ™ ¨ Æ ∞ ≤ ≥ µ ∑ π ª Ω ø ¡ » – ‹ ﬁ ‡ ‚;@KTZ]foqszÇçòöúû†¢§¶®™¨∑πªΩø¡√≈«…ÀÕ“ﬂ‰Ú!4BVhêΩ›Ôı1:?UYfÑòú∞æ–”È             o              ÎO »ø
/** javascripts/jquery-3.1.1.min.js **/
/*! jQuery v3.1.1 | (c) jQuery Foundation | jquery.org/license */
!function(a,b){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){"use strict";var c=[],d=a.document,e=Object.getPrototypeOf,f=c.slice,g=c.concat,h=c.push,i=c.indexOf,j={},k=j.toString,l=j.hasOwnProperty,m=l.toString,n=m.call(Object),o={};function p(a,b){b=b||d;var c=b.createElement("script");c.text=a,b.head.appendChild(c).parentNode.removeChild(c)}var q="3.1.1",r=function(a,b){return new r.fn.init(a,b)},s=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,t=/^-ms-/,u=/-([a-z])/g,v=function(a,b){return b.toUpperCase()};r.fn=r.prototype={jquery:q,constructor:r,length:0,toArray:function(){return f.call(this)},get:function(a){return null==a?f.call(this):a<0?this[a+this.length]:this[a]},pushStack:function(a){var b=r.merge(this.constructor(),a);return b.prevObject=this,b},each:function(a){return r.each(this,a)},map:function(a){return this.pushStack(r.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(f.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(a<0?b:0);return this.pushStack(c>=0&&c<b?[this[c]]:[])},end:function(){return this.prevObject||this.constructor()},push:h,sort:c.sort,splice:c.splice},r.extend=r.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||r.isFunction(g)||(g={}),h===i&&(g=this,h--);h<i;h++)if(null!=(a=arguments[h]))for(b in a)c=g[b],d=a[b],g!==d&&(j&&d&&(r.isPlainObject(d)||(e=r.isArray(d)))?(e?(e=!1,f=c&&r.isArray(c)?c:[]):f=c&&r.isPlainObject(c)?c:{},g[b]=r.extend(j,f,d)):void 0!==d&&(g[b]=d));return g},r.extend({expando:"jQuery"+(q+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===r.type(a)},isArray:Array.isArray,isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){var b=r.type(a);return("number"===b||"string"===b)&&!isNaN(a-parseFloat(a))},isPlainObject:function(a){var b,c;return!(!a||"[object Object]"!==k.call(a))&&(!(b=e(a))||(c=l.call(b,"constructor")&&b.constructor,"function"==typeof c&&m.call(c)===n))},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?j[k.call(a)]||"object":typeof a},globalEval:function(a){p(a)},camelCase:function(a){return a.replace(t,"ms-").replace(u,v)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b){var c,d=0;if(w(a)){for(c=a.length;d<c;d++)if(b.call(a[d],d,a[d])===!1)break}else for(d in a)if(b.call(a[d],d,a[d])===!1)break;return a},trim:function(a){return null==a?"":(a+"").replace(s,"")},makeArray:function(a,b){var c=b||[];return null!=a&&(w(Object(a))?r.merge(c,"string"==typeof a?[a]:a):h.call(c,a)),c},inArray:function(a,b,c){return null==b?-1:i.call(b,a,c)},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;d<c;d++)a[e++]=b[d];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;f<g;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,c){var d,e,f=0,h=[];if(w(a))for(d=a.length;f<d;f++)e=b(a[f],f,c),null!=e&&h.push(e);else for(f in a)e=b(a[f],f,c),null!=e&&h.push(e);return g.apply([],h)},guid:1,proxy:function(a,b){var c,d,e;if("string"==typeof b&&(c=a[b],b=a,a=c),r.isFunction(a))return d=f.call(arguments,2),e=function(){return a.apply(b||this,d.concat(f.call(arguments)))},e.guid=a.guid=a.guid||r.guid++,e},now:Date.now,support:o}),"function"==typeof Symbol&&(r.fn[Symbol.iterator]=c[Symbol.iterator]),r.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(a,b){j["[object "+b+"]"]=b.toLowerCase()});function w(a){var b=!!a&&"length"in a&&a.length,c=r.type(a);return"function"!==c&&!r.isWindow(a)&&("array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a)}var x=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u="sizzle"+1*new Date,v=a.document,w=0,x=0,y=ha(),z=ha(),A=ha(),B=function(a,b){return a===b&&(l=!0),0},C={}.hasOwnProperty,D=[],E=D.pop,F=D.push,G=D.push,H=D.slice,I=function(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},J="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",K="[\\x20\\t\\r\\n\\f]",L="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",M="\\["+K+"*("+L+")(?:"+K+"*([*^$|!~]?=)"+K+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+L+"))|)"+K+"*\\]",N=":("+L+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+M+")*)|.*)\\)|)",O=new RegExp(K+"+","g"),P=new RegExp("^"+K+"+|((?:^|[^\\\\])(?:\\\\.)*)"+K+"+$","g"),Q=new RegExp("^"+K+"*,"+K+"*"),R=new RegExp("^"+K+"*([>+~]|"+K+")"+K+"*"),S=new RegExp("="+K+"*([^\\]'\"]*?)"+K+"*\\]","g"),T=new RegExp(N),U=new RegExp("^"+L+"$"),V={ID:new RegExp("^#("+L+")"),CLASS:new RegExp("^\\.("+L+")"),TAG:new RegExp("^("+L+"|[*])"),ATTR:new RegExp("^"+M),PSEUDO:new RegExp("^"+N),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+K+"*(even|odd|(([+-]|)(\\d*)n|)"+K+"*(?:([+-]|)"+K+"*(\\d+)|))"+K+"*\\)|)","i"),bool:new RegExp("^(?:"+J+")$","i"),needsContext:new RegExp("^"+K+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+K+"*((?:-\\d)?\\d*)"+K+"*\\)|)(?=[^-]|$)","i")},W=/^(?:input|select|textarea|button)$/i,X=/^h\d$/i,Y=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,$=/[+~]/,_=new RegExp("\\\\([\\da-f]{1,6}"+K+"?|("+K+")|.)","ig"),aa=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:d<0?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)},ba=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ca=function(a,b){return b?"\0"===a?"\ufffd":a.slice(0,-1)+"\\"+a.charCodeAt(a.length-1).toString(16)+" ":"\\"+a},da=function(){m()},ea=ta(function(a){return a.disabled===!0&&("form"in a||"label"in a)},{dir:"parentNode",next:"legend"});try{G.apply(D=H.call(v.childNodes),v.childNodes),D[v.childNodes.length].nodeType}catch(fa){G={apply:D.length?function(a,b){F.apply(a,H.call(b))}:function(a,b){var c=a.length,d=0;while(a[c++]=b[d++]);a.length=c-1}}}function ga(a,b,d,e){var f,h,j,k,l,o,r,s=b&&b.ownerDocument,w=b?b.nodeType:9;if(d=d||[],"string"!=typeof a||!a||1!==w&&9!==w&&11!==w)return d;if(!e&&((b?b.ownerDocument||b:v)!==n&&m(b),b=b||n,p)){if(11!==w&&(l=Z.exec(a)))if(f=l[1]){if(9===w){if(!(j=b.getElementById(f)))return d;if(j.id===f)return d.push(j),d}else if(s&&(j=s.getElementById(f))&&t(b,j)&&j.id===f)return d.push(j),d}else{if(l[2])return G.apply(d,b.getElementsByTagName(a)),d;if((f=l[3])&&c.getElementsByClassName&&b.getElementsByClassName)return G.apply(d,b.getElementsByClassName(f)),d}if(c.qsa&&!A[a+" "]&&(!q||!q.test(a))){if(1!==w)s=b,r=a;else if("object"!==b.nodeName.toLowerCase()){(k=b.getAttribute("id"))?k=k.replace(ba,ca):b.setAttribute("id",k=u),o=g(a),h=o.length;while(h--)o[h]="#"+k+" "+sa(o[h]);r=o.join(","),s=$.test(a)&&qa(b.parentNode)||b}if(r)try{return G.apply(d,s.querySelectorAll(r)),d}catch(x){}finally{k===u&&b.removeAttribute("id")}}}return i(a.replace(P,"$1"),b,d,e)}function ha(){var a=[];function b(c,e){return a.push(c+" ")>d.cacheLength&&delete b[a.shift()],b[c+" "]=e}return b}function ia(a){return a[u]=!0,a}function ja(a){var b=n.createElement("fieldset");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function ka(a,b){var c=a.split("|"),e=c.length;while(e--)d.attrHandle[c[e]]=b}function la(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&a.sourceIndex-b.sourceIndex;if(d)return d;if(c)while(c=c.nextSibling)if(c===b)return-1;return a?1:-1}function ma(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function na(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function oa(a){return function(b){return"form"in b?b.parentNode&&b.disabled===!1?"label"in b?"label"in b.parentNode?b.parentNode.disabled===a:b.disabled===a:b.isDisabled===a||b.isDisabled!==!a&&ea(b)===a:b.disabled===a:"label"in b&&b.disabled===a}}function pa(a){return ia(function(b){return b=+b,ia(function(c,d){var e,f=a([],c.length,b),g=f.length;while(g--)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function qa(a){return a&&"undefined"!=typeof a.getElementsByTagName&&a}c=ga.support={},f=ga.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return!!b&&"HTML"!==b.nodeName},m=ga.setDocument=function(a){var b,e,g=a?a.ownerDocument||a:v;return g!==n&&9===g.nodeType&&g.documentElement?(n=g,o=n.documentElement,p=!f(n),v!==n&&(e=n.defaultView)&&e.top!==e&&(e.addEventListener?e.addEventListener("unload",da,!1):e.attachEvent&&e.attachEvent("onunload",da)),c.attributes=ja(function(a){return a.className="i",!a.getAttribute("className")}),c.getElementsByTagName=ja(function(a){return a.appendChild(n.createComment("")),!a.getElementsByTagName("*").length}),c.getElementsByClassName=Y.test(n.getElementsByClassName),c.getById=ja(function(a){return o.appendChild(a).id=u,!n.getElementsByName||!n.getElementsByName(u).length}),c.getById?(d.filter.ID=function(a){var b=a.replace(_,aa);return function(a){return a.getAttribute("id")===b}},d.find.ID=function(a,b){if("undefined"!=typeof b.getElementById&&p){var c=b.getElementById(a);return c?[c]:[]}}):(d.filter.ID=function(a){var b=a.replace(_,aa);return function(a){var c="undefined"!=typeof a.getAttributeNode&&a.getAttributeNode("id");return c&&c.value===b}},d.find.ID=function(a,b){if("undefined"!=typeof b.getElementById&&p){var c,d,e,f=b.getElementById(a);if(f){if(c=f.getAttributeNode("id"),c&&c.value===a)return[f];e=b.getElementsByName(a),d=0;while(f=e[d++])if(c=f.getAttributeNode("id"),c&&c.value===a)return[f]}return[]}}),d.find.TAG=c.getElementsByTagName?function(a,b){return"undefined"!=typeof b.getElementsByTagName?b.getElementsByTagName(a):c.qsa?b.querySelectorAll(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){while(c=f[e++])1===c.nodeType&&d.push(c);return d}return f},d.find.CLASS=c.getElementsByClassName&&function(a,b){if("undefined"!=typeof b.getElementsByClassName&&p)return b.getElementsByClassName(a)},r=[],q=[],(c.qsa=Y.test(n.querySelectorAll))&&(ja(function(a){o.appendChild(a).innerHTML="<a id='"+u+"'></a><select id='"+u+"-\r\\' msallowcapture=''><option selected=''></option></select>",a.querySelectorAll("[msallowcapture^='']").length&&q.push("[*^$]="+K+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||q.push("\\["+K+"*(?:value|"+J+")"),a.querySelectorAll("[id~="+u+"-]").length||q.push("~="),a.querySelectorAll(":checked").length||q.push(":checked"),a.querySelectorAll("a#"+u+"+*").length||q.push(".#.+[+~]")}),ja(function(a){a.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var b=n.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&q.push("name"+K+"*[*^$|!~]?="),2!==a.querySelectorAll(":enabled").length&&q.push(":enabled",":disabled"),o.appendChild(a).disabled=!0,2!==a.querySelectorAll(":disabled").length&&q.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),q.push(",.*:")})),(c.matchesSelector=Y.test(s=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.oMatchesSelector||o.msMatchesSelector))&&ja(function(a){c.disconnectedMatch=s.call(a,"*"),s.call(a,"[s!='']:x"),r.push("!=",N)}),q=q.length&&new RegExp(q.join("|")),r=r.length&&new RegExp(r.join("|")),b=Y.test(o.compareDocumentPosition),t=b||Y.test(o.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)while(b=b.parentNode)if(b===a)return!0;return!1},B=b?function(a,b){if(a===b)return l=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d?d:(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!c.sortDetached&&b.compareDocumentPosition(a)===d?a===n||a.ownerDocument===v&&t(v,a)?-1:b===n||b.ownerDocument===v&&t(v,b)?1:k?I(k,a)-I(k,b):0:4&d?-1:1)}:function(a,b){if(a===b)return l=!0,0;var c,d=0,e=a.parentNode,f=b.parentNode,g=[a],h=[b];if(!e||!f)return a===n?-1:b===n?1:e?-1:f?1:k?I(k,a)-I(k,b):0;if(e===f)return la(a,b);c=a;while(c=c.parentNode)g.unshift(c);c=b;while(c=c.parentNode)h.unshift(c);while(g[d]===h[d])d++;return d?la(g[d],h[d]):g[d]===v?-1:h[d]===v?1:0},n):n},ga.matches=function(a,b){return ga(a,null,null,b)},ga.matchesSelector=function(a,b){if((a.ownerDocument||a)!==n&&m(a),b=b.replace(S,"='$1']"),c.matchesSelector&&p&&!A[b+" "]&&(!r||!r.test(b))&&(!q||!q.test(b)))try{var d=s.call(a,b);if(d||c.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return ga(b,n,null,[a]).length>0},ga.contains=function(a,b){return(a.ownerDocument||a)!==n&&m(a),t(a,b)},ga.attr=function(a,b){(a.ownerDocument||a)!==n&&m(a);var e=d.attrHandle[b.toLowerCase()],f=e&&C.call(d.attrHandle,b.toLowerCase())?e(a,b,!p):void 0;return void 0!==f?f:c.attributes||!p?a.getAttribute(b):(f=a.getAttributeNode(b))&&f.specified?f.value:null},ga.escape=function(a){return(a+"").replace(ba,ca)},ga.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},ga.uniqueSort=function(a){var b,d=[],e=0,f=0;if(l=!c.detectDuplicates,k=!c.sortStable&&a.slice(0),a.sort(B),l){while(b=a[f++])b===a[f]&&(e=d.push(f));while(e--)a.splice(d[e],1)}return k=null,a},e=ga.getText=function(a){var b,c="",d=0,f=a.nodeType;if(f){if(1===f||9===f||11===f){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=e(a)}else if(3===f||4===f)return a.nodeValue}else while(b=a[d++])c+=e(b);return c},d=ga.selectors={cacheLength:50,createPseudo:ia,match:V,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(_,aa),a[3]=(a[3]||a[4]||a[5]||"").replace(_,aa),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||ga.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&ga.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return V.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&T.test(c)&&(b=g(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(_,aa).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=y[a+" "];return b||(b=new RegExp("(^|"+K+")"+a+"("+K+"|$)"))&&y(a,function(a){return b.test("string"==typeof a.className&&a.className||"undefined"!=typeof a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,b,c){return function(d){var e=ga.attr(d,a);return null==e?"!="===b:!b||(e+="","="===b?e===c:"!="===b?e!==c:"^="===b?c&&0===e.indexOf(c):"*="===b?c&&e.indexOf(c)>-1:"$="===b?c&&e.slice(-c.length)===c:"~="===b?(" "+e.replace(O," ")+" ").indexOf(c)>-1:"|="===b&&(e===c||e.slice(0,c.length+1)===c+"-"))}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h,t=!1;if(q){if(f){while(p){m=b;while(m=m[p])if(h?m.nodeName.toLowerCase()===r:1===m.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){m=q,l=m[u]||(m[u]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),j=k[a]||[],n=j[0]===w&&j[1],t=n&&j[2],m=n&&q.childNodes[n];while(m=++n&&m&&m[p]||(t=n=0)||o.pop())if(1===m.nodeType&&++t&&m===b){k[a]=[w,n,t];break}}else if(s&&(m=b,l=m[u]||(m[u]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),j=k[a]||[],n=j[0]===w&&j[1],t=n),t===!1)while(m=++n&&m&&m[p]||(t=n=0)||o.pop())if((h?m.nodeName.toLowerCase()===r:1===m.nodeType)&&++t&&(s&&(l=m[u]||(m[u]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),k[a]=[w,t]),m===b))break;return t-=e,t===d||t%d===0&&t/d>=0}}},PSEUDO:function(a,b){var c,e=d.pseudos[a]||d.setFilters[a.toLowerCase()]||ga.error("unsupported pseudo: "+a);return e[u]?e(b):e.length>1?(c=[a,a,"",b],d.setFilters.hasOwnProperty(a.toLowerCase())?ia(function(a,c){var d,f=e(a,b),g=f.length;while(g--)d=I(a,f[g]),a[d]=!(c[d]=f[g])}):function(a){return e(a,0,c)}):e}},pseudos:{not:ia(function(a){var b=[],c=[],d=h(a.replace(P,"$1"));return d[u]?ia(function(a,b,c,e){var f,g=d(a,null,e,[]),h=a.length;while(h--)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,e,f){return b[0]=a,d(b,null,f,c),b[0]=null,!c.pop()}}),has:ia(function(a){return function(b){return ga(a,b).length>0}}),contains:ia(function(a){return a=a.replace(_,aa),function(b){return(b.textContent||b.innerText||e(b)).indexOf(a)>-1}}),lang:ia(function(a){return U.test(a||"")||ga.error("unsupported lang: "+a),a=a.replace(_,aa).toLowerCase(),function(b){var c;do if(c=p?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===o},focus:function(a){return a===n.activeElement&&(!n.hasFocus||n.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:oa(!1),disabled:oa(!0),checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!d.pseudos.empty(a)},header:function(a){return X.test(a.nodeName)},input:function(a){return W.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:pa(function(){return[0]}),last:pa(function(a,b){return[b-1]}),eq:pa(function(a,b,c){return[c<0?c+b:c]}),even:pa(function(a,b){for(var c=0;c<b;c+=2)a.push(c);return a}),odd:pa(function(a,b){for(var c=1;c<b;c+=2)a.push(c);return a}),lt:pa(function(a,b,c){for(var d=c<0?c+b:c;--d>=0;)a.push(d);return a}),gt:pa(function(a,b,c){for(var d=c<0?c+b:c;++d<b;)a.push(d);return a})}},d.pseudos.nth=d.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})d.pseudos[b]=ma(b);for(b in{submit:!0,reset:!0})d.pseudos[b]=na(b);function ra(){}ra.prototype=d.filters=d.pseudos,d.setFilters=new ra,g=ga.tokenize=function(a,b){var c,e,f,g,h,i,j,k=z[a+" "];if(k)return b?0:k.slice(0);h=a,i=[],j=d.preFilter;while(h){c&&!(e=Q.exec(h))||(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),c=!1,(e=R.exec(h))&&(c=e.shift(),f.push({value:c,type:e[0].replace(P," ")}),h=h.slice(c.length));for(g in d.filter)!(e=V[g].exec(h))||j[g]&&!(e=j[g](e))||(c=e.shift(),f.push({value:c,type:g,matches:e}),h=h.slice(c.length));if(!c)break}return b?h.length:h?ga.error(a):z(a,i).slice(0)};function sa(a){for(var b=0,c=a.length,d="";b<c;b++)d+=a[b].value;return d}function ta(a,b,c){var d=b.dir,e=b.next,f=e||d,g=c&&"parentNode"===f,h=x++;return b.first?function(b,c,e){while(b=b[d])if(1===b.nodeType||g)return a(b,c,e);return!1}:function(b,c,i){var j,k,l,m=[w,h];if(i){while(b=b[d])if((1===b.nodeType||g)&&a(b,c,i))return!0}else while(b=b[d])if(1===b.nodeType||g)if(l=b[u]||(b[u]={}),k=l[b.uniqueID]||(l[b.uniqueID]={}),e&&e===b.nodeName.toLowerCase())b=b[d]||b;else{if((j=k[f])&&j[0]===w&&j[1]===h)return m[2]=j[2];if(k[f]=m,m[2]=a(b,c,i))return!0}return!1}}function ua(a){return a.length>1?function(b,c,d){var e=a.length;while(e--)if(!a[e](b,c,d))return!1;return!0}:a[0]}function va(a,b,c){for(var d=0,e=b.length;d<e;d++)ga(a,b[d],c);return c}function wa(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;h<i;h++)(f=a[h])&&(c&&!c(f,d,e)||(g.push(f),j&&b.push(h)));return g}function xa(a,b,c,d,e,f){return d&&!d[u]&&(d=xa(d)),e&&!e[u]&&(e=xa(e,f)),ia(function(f,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=f||va(b||"*",h.nodeType?[h]:h,[]),q=!a||!f&&b?p:wa(p,m,a,h,i),r=c?e||(f?a:o||d)?[]:g:q;if(c&&c(q,r,h,i),d){j=wa(r,n),d(j,[],h,i),k=j.length;while(k--)(l=j[k])&&(r[n[k]]=!(q[n[k]]=l))}if(f){if(e||a){if(e){j=[],k=r.length;while(k--)(l=r[k])&&j.push(q[k]=l);e(null,r=[],j,i)}k=r.length;while(k--)(l=r[k])&&(j=e?I(f,l):m[k])>-1&&(f[j]=!(g[j]=l))}}else r=wa(r===g?r.splice(o,r.length):r),e?e(null,g,r,i):G.apply(g,r)})}function ya(a){for(var b,c,e,f=a.length,g=d.relative[a[0].type],h=g||d.relative[" "],i=g?1:0,k=ta(function(a){return a===b},h,!0),l=ta(function(a){return I(b,a)>-1},h,!0),m=[function(a,c,d){var e=!g&&(d||c!==j)||((b=c).nodeType?k(a,c,d):l(a,c,d));return b=null,e}];i<f;i++)if(c=d.relative[a[i].type])m=[ta(ua(m),c)];else{if(c=d.filter[a[i].type].apply(null,a[i].matches),c[u]){for(e=++i;e<f;e++)if(d.relative[a[e].type])break;return xa(i>1&&ua(m),i>1&&sa(a.slice(0,i-1).concat({value:" "===a[i-2].type?"*":""})).replace(P,"$1"),c,i<e&&ya(a.slice(i,e)),e<f&&ya(a=a.slice(e)),e<f&&sa(a))}m.push(c)}return ua(m)}function za(a,b){var c=b.length>0,e=a.length>0,f=function(f,g,h,i,k){var l,o,q,r=0,s="0",t=f&&[],u=[],v=j,x=f||e&&d.find.TAG("*",k),y=w+=null==v?1:Math.random()||.1,z=x.length;for(k&&(j=g===n||g||k);s!==z&&null!=(l=x[s]);s++){if(e&&l){o=0,g||l.ownerDocument===n||(m(l),h=!p);while(q=a[o++])if(q(l,g||n,h)){i.push(l);break}k&&(w=y)}c&&((l=!q&&l)&&r--,f&&t.push(l))}if(r+=s,c&&s!==r){o=0;while(q=b[o++])q(t,u,g,h);if(f){if(r>0)while(s--)t[s]||u[s]||(u[s]=E.call(i));u=wa(u)}G.apply(i,u),k&&!f&&u.length>0&&r+b.length>1&&ga.uniqueSort(i)}return k&&(w=y,j=v),t};return c?ia(f):f}return h=ga.compile=function(a,b){var c,d=[],e=[],f=A[a+" "];if(!f){b||(b=g(a)),c=b.length;while(c--)f=ya(b[c]),f[u]?d.push(f):e.push(f);f=A(a,za(e,d)),f.selector=a}return f},i=ga.select=function(a,b,c,e){var f,i,j,k,l,m="function"==typeof a&&a,n=!e&&g(a=m.selector||a);if(c=c||[],1===n.length){if(i=n[0]=n[0].slice(0),i.length>2&&"ID"===(j=i[0]).type&&9===b.nodeType&&p&&d.relative[i[1].type]){if(b=(d.find.ID(j.matches[0].replace(_,aa),b)||[])[0],!b)return c;m&&(b=b.parentNode),a=a.slice(i.shift().value.length)}f=V.needsContext.test(a)?0:i.length;while(f--){if(j=i[f],d.relative[k=j.type])break;if((l=d.find[k])&&(e=l(j.matches[0].replace(_,aa),$.test(i[0].type)&&qa(b.parentNode)||b))){if(i.splice(f,1),a=e.length&&sa(i),!a)return G.apply(c,e),c;break}}}return(m||h(a,n))(e,b,!p,c,!b||$.test(a)&&qa(b.parentNode)||b),c},c.sortStable=u.split("").sort(B).join("")===u,c.detectDuplicates=!!l,m(),c.sortDetached=ja(function(a){return 1&a.compareDocumentPosition(n.createElement("fieldset"))}),ja(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||ka("type|href|height|width",function(a,b,c){if(!c)return a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),c.attributes&&ja(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||ka("value",function(a,b,c){if(!c&&"input"===a.nodeName.toLowerCase())return a.defaultValue}),ja(function(a){return null==a.getAttribute("disabled")})||ka(J,function(a,b,c){var d;if(!c)return a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),ga}(a);r.find=x,r.expr=x.selectors,r.expr[":"]=r.expr.pseudos,r.uniqueSort=r.unique=x.uniqueSort,r.text=x.getText,r.isXMLDoc=x.isXML,r.contains=x.contains,r.escapeSelector=x.escape;var y=function(a,b,c){var d=[],e=void 0!==c;while((a=a[b])&&9!==a.nodeType)if(1===a.nodeType){if(e&&r(a).is(c))break;d.push(a)}return d},z=function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c},A=r.expr.match.needsContext,B=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i,C=/^.[^:#\[\.,]*$/;function D(a,b,c){return r.isFunction(b)?r.grep(a,function(a,d){return!!b.call(a,d,a)!==c}):b.nodeType?r.grep(a,function(a){return a===b!==c}):"string"!=typeof b?r.grep(a,function(a){return i.call(b,a)>-1!==c}):C.test(b)?r.filter(b,a,c):(b=r.filter(b,a),r.grep(a,function(a){return i.call(b,a)>-1!==c&&1===a.nodeType}))}r.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?r.find.matchesSelector(d,a)?[d]:[]:r.find.matches(a,r.grep(b,function(a){return 1===a.nodeType}))},r.fn.extend({find:function(a){var b,c,d=this.length,e=this;if("string"!=typeof a)return this.pushStack(r(a).filter(function(){for(b=0;b<d;b++)if(r.contains(e[b],this))return!0}));for(c=this.pushStack([]),b=0;b<d;b++)r.find(a,e[b],c);return d>1?r.uniqueSort(c):c},filter:function(a){return this.pushStack(D(this,a||[],!1))},not:function(a){return this.pushStack(D(this,a||[],!0))},is:function(a){return!!D(this,"string"==typeof a&&A.test(a)?r(a):a||[],!1).length}});var E,F=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,G=r.fn.init=function(a,b,c){var e,f;if(!a)return this;if(c=c||E,"string"==typeof a){if(e="<"===a[0]&&">"===a[a.length-1]&&a.length>=3?[null,a,null]:F.exec(a),!e||!e[1]&&b)return!b||b.jquery?(b||c).find(a):this.constructor(b).find(a);if(e[1]){if(b=b instanceof r?b[0]:b,r.merge(this,r.parseHTML(e[1],b&&b.nodeType?b.ownerDocument||b:d,!0)),B.test(e[1])&&r.isPlainObject(b))for(e in b)r.isFunction(this[e])?this[e](b[e]):this.attr(e,b[e]);return this}return f=d.getElementById(e[2]),f&&(this[0]=f,this.length=1),this}return a.nodeType?(this[0]=a,this.length=1,this):r.isFunction(a)?void 0!==c.ready?c.ready(a):a(r):r.makeArray(a,this)};G.prototype=r.fn,E=r(d);var H=/^(?:parents|prev(?:Until|All))/,I={children:!0,contents:!0,next:!0,prev:!0};r.fn.extend({has:function(a){var b=r(a,this),c=b.length;return this.filter(function(){for(var a=0;a<c;a++)if(r.contains(this,b[a]))return!0})},closest:function(a,b){var c,d=0,e=this.length,f=[],g="string"!=typeof a&&r(a);if(!A.test(a))for(;d<e;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&r.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?r.uniqueSort(f):f)},index:function(a){return a?"string"==typeof a?i.call(r(a),this[0]):i.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(r.uniqueSort(r.merge(this.get(),r(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});function J(a,b){while((a=a[b])&&1!==a.nodeType);return a}r.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return y(a,"parentNode")},parentsUntil:function(a,b,c){return y(a,"parentNode",c)},next:function(a){return J(a,"nextSibling")},prev:function(a){return J(a,"previousSibling")},nextAll:function(a){return y(a,"nextSibling")},prevAll:function(a){return y(a,"previousSibling")},nextUntil:function(a,b,c){return y(a,"nextSibling",c)},prevUntil:function(a,b,c){return y(a,"previousSibling",c)},siblings:function(a){return z((a.parentNode||{}).firstChild,a)},children:function(a){return z(a.firstChild)},contents:function(a){return a.contentDocument||r.merge([],a.childNodes)}},function(a,b){r.fn[a]=function(c,d){var e=r.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=r.filter(d,e)),this.length>1&&(I[a]||r.uniqueSort(e),H.test(a)&&e.reverse()),this.pushStack(e)}});var K=/[^\x20\t\r\n\f]+/g;function L(a){var b={};return r.each(a.match(K)||[],function(a,c){b[c]=!0}),b}r.Callbacks=function(a){a="string"==typeof a?L(a):r.extend({},a);var b,c,d,e,f=[],g=[],h=-1,i=function(){for(e=a.once,d=b=!0;g.length;h=-1){c=g.shift();while(++h<f.length)f[h].apply(c[0],c[1])===!1&&a.stopOnFalse&&(h=f.length,c=!1)}a.memory||(c=!1),b=!1,e&&(f=c?[]:"")},j={add:function(){return f&&(c&&!b&&(h=f.length-1,g.push(c)),function d(b){r.each(b,function(b,c){r.isFunction(c)?a.unique&&j.has(c)||f.push(c):c&&c.length&&"string"!==r.type(c)&&d(c)})}(arguments),c&&!b&&i()),this},remove:function(){return r.each(arguments,function(a,b){var c;while((c=r.inArray(b,f,c))>-1)f.splice(c,1),c<=h&&h--}),this},has:function(a){return a?r.inArray(a,f)>-1:f.length>0},empty:function(){return f&&(f=[]),this},disable:function(){return e=g=[],f=c="",this},disabled:function(){return!f},lock:function(){return e=g=[],c||b||(f=c=""),this},locked:function(){return!!e},fireWith:function(a,c){return e||(c=c||[],c=[a,c.slice?c.slice():c],g.push(c),b||i()),this},fire:function(){return j.fireWith(this,arguments),this},fired:function(){return!!d}};return j};function M(a){return a}function N(a){throw a}function O(a,b,c){var d;try{a&&r.isFunction(d=a.promise)?d.call(a).done(b).fail(c):a&&r.isFunction(d=a.then)?d.call(a,b,c):b.call(void 0,a)}catch(a){c.call(void 0,a)}}r.extend({Deferred:function(b){var c=[["notify","progress",r.Callbacks("memory"),r.Callbacks("memory"),2],["resolve","done",r.Callbacks("once memory"),r.Callbacks("once memory"),0,"resolved"],["reject","fail",r.Callbacks("once memory"),r.Callbacks("once memory"),1,"rejected"]],d="pending",e={state:function(){return d},always:function(){return f.done(arguments).fail(arguments),this},"catch":function(a){return e.then(null,a)},pipe:function(){var a=arguments;return r.Deferred(function(b){r.each(c,function(c,d){var e=r.isFunction(a[d[4]])&&a[d[4]];f[d[1]](function(){var a=e&&e.apply(this,arguments);a&&r.isFunction(a.promise)?a.promise().progress(b.notify).done(b.resolve).fail(b.reject):b[d[0]+"With"](this,e?[a]:arguments)})}),a=null}).promise()},then:function(b,d,e){var f=0;function g(b,c,d,e){return function(){var h=this,i=arguments,j=function(){var a,j;if(!(b<f)){if(a=d.apply(h,i),a===c.promise())throw new TypeError("Thenable self-resolution");j=a&&("object"==typeof a||"function"==typeof a)&&a.then,r.isFunction(j)?e?j.call(a,g(f,c,M,e),g(f,c,N,e)):(f++,j.call(a,g(f,c,M,e),g(f,c,N,e),g(f,c,M,c.notifyWith))):(d!==M&&(h=void 0,i=[a]),(e||c.resolveWith)(h,i))}},k=e?j:function(){try{j()}catch(a){r.Deferred.exceptionHook&&r.Deferred.exceptionHook(a,k.stackTrace),b+1>=f&&(d!==N&&(h=void 0,i=[a]),c.rejectWith(h,i))}};b?k():(r.Deferred.getStackHook&&(k.stackTrace=r.Deferred.getStackHook()),a.setTimeout(k))}}return r.Deferred(function(a){c[0][3].add(g(0,a,r.isFunction(e)?e:M,a.notifyWith)),c[1][3].add(g(0,a,r.isFunction(b)?b:M)),c[2][3].add(g(0,a,r.isFunction(d)?d:N))}).promise()},promise:function(a){return null!=a?r.extend(a,e):e}},f={};return r.each(c,function(a,b){var g=b[2],h=b[5];e[b[1]]=g.add,h&&g.add(function(){d=h},c[3-a][2].disable,c[0][2].lock),g.add(b[3].fire),f[b[0]]=function(){return f[b[0]+"With"](this===f?void 0:this,arguments),this},f[b[0]+"With"]=g.fireWith}),e.promise(f),b&&b.call(f,f),f},when:function(a){var b=arguments.length,c=b,d=Array(c),e=f.call(arguments),g=r.Deferred(),h=function(a){return function(c){d[a]=this,e[a]=arguments.length>1?f.call(arguments):c,--b||g.resolveWith(d,e)}};if(b<=1&&(O(a,g.done(h(c)).resolve,g.reject),"pending"===g.state()||r.isFunction(e[c]&&e[c].then)))return g.then();while(c--)O(e[c],h(c),g.reject);return g.promise()}});var P=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;r.Deferred.exceptionHook=function(b,c){a.console&&a.console.warn&&b&&P.test(b.name)&&a.console.warn("jQuery.Deferred exception: "+b.message,b.stack,c)},r.readyException=function(b){a.setTimeout(function(){throw b})};var Q=r.Deferred();r.fn.ready=function(a){return Q.then(a)["catch"](function(a){r.readyException(a)}),this},r.extend({isReady:!1,readyWait:1,holdReady:function(a){a?r.readyWait++:r.ready(!0)},ready:function(a){(a===!0?--r.readyWait:r.isReady)||(r.isReady=!0,a!==!0&&--r.readyWait>0||Q.resolveWith(d,[r]))}}),r.ready.then=Q.then;function R(){d.removeEventListener("DOMContentLoaded",R),
a.removeEventListener("load",R),r.ready()}"complete"===d.readyState||"loading"!==d.readyState&&!d.documentElement.doScroll?a.setTimeout(r.ready):(d.addEventListener("DOMContentLoaded",R),a.addEventListener("load",R));var S=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===r.type(c)){e=!0;for(h in c)S(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,r.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(r(a),c)})),b))for(;h<i;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f},T=function(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType};function U(){this.expando=r.expando+U.uid++}U.uid=1,U.prototype={cache:function(a){var b=a[this.expando];return b||(b={},T(a)&&(a.nodeType?a[this.expando]=b:Object.defineProperty(a,this.expando,{value:b,configurable:!0}))),b},set:function(a,b,c){var d,e=this.cache(a);if("string"==typeof b)e[r.camelCase(b)]=c;else for(d in b)e[r.camelCase(d)]=b[d];return e},get:function(a,b){return void 0===b?this.cache(a):a[this.expando]&&a[this.expando][r.camelCase(b)]},access:function(a,b,c){return void 0===b||b&&"string"==typeof b&&void 0===c?this.get(a,b):(this.set(a,b,c),void 0!==c?c:b)},remove:function(a,b){var c,d=a[this.expando];if(void 0!==d){if(void 0!==b){r.isArray(b)?b=b.map(r.camelCase):(b=r.camelCase(b),b=b in d?[b]:b.match(K)||[]),c=b.length;while(c--)delete d[b[c]]}(void 0===b||r.isEmptyObject(d))&&(a.nodeType?a[this.expando]=void 0:delete a[this.expando])}},hasData:function(a){var b=a[this.expando];return void 0!==b&&!r.isEmptyObject(b)}};var V=new U,W=new U,X=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Y=/[A-Z]/g;function Z(a){return"true"===a||"false"!==a&&("null"===a?null:a===+a+""?+a:X.test(a)?JSON.parse(a):a)}function $(a,b,c){var d;if(void 0===c&&1===a.nodeType)if(d="data-"+b.replace(Y,"-$&").toLowerCase(),c=a.getAttribute(d),"string"==typeof c){try{c=Z(c)}catch(e){}W.set(a,b,c)}else c=void 0;return c}r.extend({hasData:function(a){return W.hasData(a)||V.hasData(a)},data:function(a,b,c){return W.access(a,b,c)},removeData:function(a,b){W.remove(a,b)},_data:function(a,b,c){return V.access(a,b,c)},_removeData:function(a,b){V.remove(a,b)}}),r.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=W.get(f),1===f.nodeType&&!V.get(f,"hasDataAttrs"))){c=g.length;while(c--)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=r.camelCase(d.slice(5)),$(f,d,e[d])));V.set(f,"hasDataAttrs",!0)}return e}return"object"==typeof a?this.each(function(){W.set(this,a)}):S(this,function(b){var c;if(f&&void 0===b){if(c=W.get(f,a),void 0!==c)return c;if(c=$(f,a),void 0!==c)return c}else this.each(function(){W.set(this,a,b)})},null,b,arguments.length>1,null,!0)},removeData:function(a){return this.each(function(){W.remove(this,a)})}}),r.extend({queue:function(a,b,c){var d;if(a)return b=(b||"fx")+"queue",d=V.get(a,b),c&&(!d||r.isArray(c)?d=V.access(a,b,r.makeArray(c)):d.push(c)),d||[]},dequeue:function(a,b){b=b||"fx";var c=r.queue(a,b),d=c.length,e=c.shift(),f=r._queueHooks(a,b),g=function(){r.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return V.get(a,c)||V.access(a,c,{empty:r.Callbacks("once memory").add(function(){V.remove(a,[b+"queue",c])})})}}),r.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?r.queue(this[0],a):void 0===b?this:this.each(function(){var c=r.queue(this,a,b);r._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&r.dequeue(this,a)})},dequeue:function(a){return this.each(function(){r.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=r.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};"string"!=typeof a&&(b=a,a=void 0),a=a||"fx";while(g--)c=V.get(f[g],a+"queueHooks"),c&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var _=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,aa=new RegExp("^(?:([+-])=|)("+_+")([a-z%]*)$","i"),ba=["Top","Right","Bottom","Left"],ca=function(a,b){return a=b||a,"none"===a.style.display||""===a.style.display&&r.contains(a.ownerDocument,a)&&"none"===r.css(a,"display")},da=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};function ea(a,b,c,d){var e,f=1,g=20,h=d?function(){return d.cur()}:function(){return r.css(a,b,"")},i=h(),j=c&&c[3]||(r.cssNumber[b]?"":"px"),k=(r.cssNumber[b]||"px"!==j&&+i)&&aa.exec(r.css(a,b));if(k&&k[3]!==j){j=j||k[3],c=c||[],k=+i||1;do f=f||".5",k/=f,r.style(a,b,k+j);while(f!==(f=h()/i)&&1!==f&&--g)}return c&&(k=+k||+i||0,e=c[1]?k+(c[1]+1)*c[2]:+c[2],d&&(d.unit=j,d.start=k,d.end=e)),e}var fa={};function ga(a){var b,c=a.ownerDocument,d=a.nodeName,e=fa[d];return e?e:(b=c.body.appendChild(c.createElement(d)),e=r.css(b,"display"),b.parentNode.removeChild(b),"none"===e&&(e="block"),fa[d]=e,e)}function ha(a,b){for(var c,d,e=[],f=0,g=a.length;f<g;f++)d=a[f],d.style&&(c=d.style.display,b?("none"===c&&(e[f]=V.get(d,"display")||null,e[f]||(d.style.display="")),""===d.style.display&&ca(d)&&(e[f]=ga(d))):"none"!==c&&(e[f]="none",V.set(d,"display",c)));for(f=0;f<g;f++)null!=e[f]&&(a[f].style.display=e[f]);return a}r.fn.extend({show:function(){return ha(this,!0)},hide:function(){return ha(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){ca(this)?r(this).show():r(this).hide()})}});var ia=/^(?:checkbox|radio)$/i,ja=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,ka=/^$|\/(?:java|ecma)script/i,la={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};la.optgroup=la.option,la.tbody=la.tfoot=la.colgroup=la.caption=la.thead,la.th=la.td;function ma(a,b){var c;return c="undefined"!=typeof a.getElementsByTagName?a.getElementsByTagName(b||"*"):"undefined"!=typeof a.querySelectorAll?a.querySelectorAll(b||"*"):[],void 0===b||b&&r.nodeName(a,b)?r.merge([a],c):c}function na(a,b){for(var c=0,d=a.length;c<d;c++)V.set(a[c],"globalEval",!b||V.get(b[c],"globalEval"))}var oa=/<|&#?\w+;/;function pa(a,b,c,d,e){for(var f,g,h,i,j,k,l=b.createDocumentFragment(),m=[],n=0,o=a.length;n<o;n++)if(f=a[n],f||0===f)if("object"===r.type(f))r.merge(m,f.nodeType?[f]:f);else if(oa.test(f)){g=g||l.appendChild(b.createElement("div")),h=(ja.exec(f)||["",""])[1].toLowerCase(),i=la[h]||la._default,g.innerHTML=i[1]+r.htmlPrefilter(f)+i[2],k=i[0];while(k--)g=g.lastChild;r.merge(m,g.childNodes),g=l.firstChild,g.textContent=""}else m.push(b.createTextNode(f));l.textContent="",n=0;while(f=m[n++])if(d&&r.inArray(f,d)>-1)e&&e.push(f);else if(j=r.contains(f.ownerDocument,f),g=ma(l.appendChild(f),"script"),j&&na(g),c){k=0;while(f=g[k++])ka.test(f.type||"")&&c.push(f)}return l}!function(){var a=d.createDocumentFragment(),b=a.appendChild(d.createElement("div")),c=d.createElement("input");c.setAttribute("type","radio"),c.setAttribute("checked","checked"),c.setAttribute("name","t"),b.appendChild(c),o.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,b.innerHTML="<textarea>x</textarea>",o.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue}();var qa=d.documentElement,ra=/^key/,sa=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,ta=/^([^.]*)(?:\.(.+)|)/;function ua(){return!0}function va(){return!1}function wa(){try{return d.activeElement}catch(a){}}function xa(a,b,c,d,e,f){var g,h;if("object"==typeof b){"string"!=typeof c&&(d=d||c,c=void 0);for(h in b)xa(a,h,c,d,b[h],f);return a}if(null==d&&null==e?(e=c,d=c=void 0):null==e&&("string"==typeof c?(e=d,d=void 0):(e=d,d=c,c=void 0)),e===!1)e=va;else if(!e)return a;return 1===f&&(g=e,e=function(a){return r().off(a),g.apply(this,arguments)},e.guid=g.guid||(g.guid=r.guid++)),a.each(function(){r.event.add(this,b,e,d,c)})}r.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=V.get(a);if(q){c.handler&&(f=c,c=f.handler,e=f.selector),e&&r.find.matchesSelector(qa,e),c.guid||(c.guid=r.guid++),(i=q.events)||(i=q.events={}),(g=q.handle)||(g=q.handle=function(b){return"undefined"!=typeof r&&r.event.triggered!==b.type?r.event.dispatch.apply(a,arguments):void 0}),b=(b||"").match(K)||[""],j=b.length;while(j--)h=ta.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n&&(l=r.event.special[n]||{},n=(e?l.delegateType:l.bindType)||n,l=r.event.special[n]||{},k=r.extend({type:n,origType:p,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&r.expr.match.needsContext.test(e),namespace:o.join(".")},f),(m=i[n])||(m=i[n]=[],m.delegateCount=0,l.setup&&l.setup.call(a,d,o,g)!==!1||a.addEventListener&&a.addEventListener(n,g)),l.add&&(l.add.call(a,k),k.handler.guid||(k.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,k):m.push(k),r.event.global[n]=!0)}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=V.hasData(a)&&V.get(a);if(q&&(i=q.events)){b=(b||"").match(K)||[""],j=b.length;while(j--)if(h=ta.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n){l=r.event.special[n]||{},n=(d?l.delegateType:l.bindType)||n,m=i[n]||[],h=h[2]&&new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"),g=f=m.length;while(f--)k=m[f],!e&&p!==k.origType||c&&c.guid!==k.guid||h&&!h.test(k.namespace)||d&&d!==k.selector&&("**"!==d||!k.selector)||(m.splice(f,1),k.selector&&m.delegateCount--,l.remove&&l.remove.call(a,k));g&&!m.length&&(l.teardown&&l.teardown.call(a,o,q.handle)!==!1||r.removeEvent(a,n,q.handle),delete i[n])}else for(n in i)r.event.remove(a,n+b[j],c,d,!0);r.isEmptyObject(i)&&V.remove(a,"handle events")}},dispatch:function(a){var b=r.event.fix(a),c,d,e,f,g,h,i=new Array(arguments.length),j=(V.get(this,"events")||{})[b.type]||[],k=r.event.special[b.type]||{};for(i[0]=b,c=1;c<arguments.length;c++)i[c]=arguments[c];if(b.delegateTarget=this,!k.preDispatch||k.preDispatch.call(this,b)!==!1){h=r.event.handlers.call(this,b,j),c=0;while((f=h[c++])&&!b.isPropagationStopped()){b.currentTarget=f.elem,d=0;while((g=f.handlers[d++])&&!b.isImmediatePropagationStopped())b.rnamespace&&!b.rnamespace.test(g.namespace)||(b.handleObj=g,b.data=g.data,e=((r.event.special[g.origType]||{}).handle||g.handler).apply(f.elem,i),void 0!==e&&(b.result=e)===!1&&(b.preventDefault(),b.stopPropagation()))}return k.postDispatch&&k.postDispatch.call(this,b),b.result}},handlers:function(a,b){var c,d,e,f,g,h=[],i=b.delegateCount,j=a.target;if(i&&j.nodeType&&!("click"===a.type&&a.button>=1))for(;j!==this;j=j.parentNode||this)if(1===j.nodeType&&("click"!==a.type||j.disabled!==!0)){for(f=[],g={},c=0;c<i;c++)d=b[c],e=d.selector+" ",void 0===g[e]&&(g[e]=d.needsContext?r(e,this).index(j)>-1:r.find(e,this,null,[j]).length),g[e]&&f.push(d);f.length&&h.push({elem:j,handlers:f})}return j=this,i<b.length&&h.push({elem:j,handlers:b.slice(i)}),h},addProp:function(a,b){Object.defineProperty(r.Event.prototype,a,{enumerable:!0,configurable:!0,get:r.isFunction(b)?function(){if(this.originalEvent)return b(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[a]},set:function(b){Object.defineProperty(this,a,{enumerable:!0,configurable:!0,writable:!0,value:b})}})},fix:function(a){return a[r.expando]?a:new r.Event(a)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==wa()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===wa()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&r.nodeName(this,"input"))return this.click(),!1},_default:function(a){return r.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}}},r.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c)},r.Event=function(a,b){return this instanceof r.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&a.returnValue===!1?ua:va,this.target=a.target&&3===a.target.nodeType?a.target.parentNode:a.target,this.currentTarget=a.currentTarget,this.relatedTarget=a.relatedTarget):this.type=a,b&&r.extend(this,b),this.timeStamp=a&&a.timeStamp||r.now(),void(this[r.expando]=!0)):new r.Event(a,b)},r.Event.prototype={constructor:r.Event,isDefaultPrevented:va,isPropagationStopped:va,isImmediatePropagationStopped:va,isSimulated:!1,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=ua,a&&!this.isSimulated&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=ua,a&&!this.isSimulated&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=ua,a&&!this.isSimulated&&a.stopImmediatePropagation(),this.stopPropagation()}},r.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,"char":!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(a){var b=a.button;return null==a.which&&ra.test(a.type)?null!=a.charCode?a.charCode:a.keyCode:!a.which&&void 0!==b&&sa.test(a.type)?1&b?1:2&b?3:4&b?2:0:a.which}},r.event.addProp),r.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){r.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return e&&(e===d||r.contains(d,e))||(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),r.fn.extend({on:function(a,b,c,d){return xa(this,a,b,c,d)},one:function(a,b,c,d){return xa(this,a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,r(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return b!==!1&&"function"!=typeof b||(c=b,b=void 0),c===!1&&(c=va),this.each(function(){r.event.remove(this,a,c,b)})}});var ya=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,za=/<script|<style|<link/i,Aa=/checked\s*(?:[^=]|=\s*.checked.)/i,Ba=/^true\/(.*)/,Ca=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Da(a,b){return r.nodeName(a,"table")&&r.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a:a}function Ea(a){return a.type=(null!==a.getAttribute("type"))+"/"+a.type,a}function Fa(a){var b=Ba.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function Ga(a,b){var c,d,e,f,g,h,i,j;if(1===b.nodeType){if(V.hasData(a)&&(f=V.access(a),g=V.set(b,f),j=f.events)){delete g.handle,g.events={};for(e in j)for(c=0,d=j[e].length;c<d;c++)r.event.add(b,e,j[e][c])}W.hasData(a)&&(h=W.access(a),i=r.extend({},h),W.set(b,i))}}function Ha(a,b){var c=b.nodeName.toLowerCase();"input"===c&&ia.test(a.type)?b.checked=a.checked:"input"!==c&&"textarea"!==c||(b.defaultValue=a.defaultValue)}function Ia(a,b,c,d){b=g.apply([],b);var e,f,h,i,j,k,l=0,m=a.length,n=m-1,q=b[0],s=r.isFunction(q);if(s||m>1&&"string"==typeof q&&!o.checkClone&&Aa.test(q))return a.each(function(e){var f=a.eq(e);s&&(b[0]=q.call(this,e,f.html())),Ia(f,b,c,d)});if(m&&(e=pa(b,a[0].ownerDocument,!1,a,d),f=e.firstChild,1===e.childNodes.length&&(e=f),f||d)){for(h=r.map(ma(e,"script"),Ea),i=h.length;l<m;l++)j=e,l!==n&&(j=r.clone(j,!0,!0),i&&r.merge(h,ma(j,"script"))),c.call(a[l],j,l);if(i)for(k=h[h.length-1].ownerDocument,r.map(h,Fa),l=0;l<i;l++)j=h[l],ka.test(j.type||"")&&!V.access(j,"globalEval")&&r.contains(k,j)&&(j.src?r._evalUrl&&r._evalUrl(j.src):p(j.textContent.replace(Ca,""),k))}return a}function Ja(a,b,c){for(var d,e=b?r.filter(b,a):a,f=0;null!=(d=e[f]);f++)c||1!==d.nodeType||r.cleanData(ma(d)),d.parentNode&&(c&&r.contains(d.ownerDocument,d)&&na(ma(d,"script")),d.parentNode.removeChild(d));return a}r.extend({htmlPrefilter:function(a){return a.replace(ya,"<$1></$2>")},clone:function(a,b,c){var d,e,f,g,h=a.cloneNode(!0),i=r.contains(a.ownerDocument,a);if(!(o.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||r.isXMLDoc(a)))for(g=ma(h),f=ma(a),d=0,e=f.length;d<e;d++)Ha(f[d],g[d]);if(b)if(c)for(f=f||ma(a),g=g||ma(h),d=0,e=f.length;d<e;d++)Ga(f[d],g[d]);else Ga(a,h);return g=ma(h,"script"),g.length>0&&na(g,!i&&ma(a,"script")),h},cleanData:function(a){for(var b,c,d,e=r.event.special,f=0;void 0!==(c=a[f]);f++)if(T(c)){if(b=c[V.expando]){if(b.events)for(d in b.events)e[d]?r.event.remove(c,d):r.removeEvent(c,d,b.handle);c[V.expando]=void 0}c[W.expando]&&(c[W.expando]=void 0)}}}),r.fn.extend({detach:function(a){return Ja(this,a,!0)},remove:function(a){return Ja(this,a)},text:function(a){return S(this,function(a){return void 0===a?r.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=a)})},null,a,arguments.length)},append:function(){return Ia(this,arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=Da(this,a);b.appendChild(a)}})},prepend:function(){return Ia(this,arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=Da(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return Ia(this,arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return Ia(this,arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)1===a.nodeType&&(r.cleanData(ma(a,!1)),a.textContent="");return this},clone:function(a,b){return a=null!=a&&a,b=null==b?a:b,this.map(function(){return r.clone(this,a,b)})},html:function(a){return S(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a&&1===b.nodeType)return b.innerHTML;if("string"==typeof a&&!za.test(a)&&!la[(ja.exec(a)||["",""])[1].toLowerCase()]){a=r.htmlPrefilter(a);try{for(;c<d;c++)b=this[c]||{},1===b.nodeType&&(r.cleanData(ma(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=[];return Ia(this,arguments,function(b){var c=this.parentNode;r.inArray(this,a)<0&&(r.cleanData(ma(this)),c&&c.replaceChild(b,this))},a)}}),r.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){r.fn[a]=function(a){for(var c,d=[],e=r(a),f=e.length-1,g=0;g<=f;g++)c=g===f?this:this.clone(!0),r(e[g])[b](c),h.apply(d,c.get());return this.pushStack(d)}});var Ka=/^margin/,La=new RegExp("^("+_+")(?!px)[a-z%]+$","i"),Ma=function(b){var c=b.ownerDocument.defaultView;return c&&c.opener||(c=a),c.getComputedStyle(b)};!function(){function b(){if(i){i.style.cssText="box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",i.innerHTML="",qa.appendChild(h);var b=a.getComputedStyle(i);c="1%"!==b.top,g="2px"===b.marginLeft,e="4px"===b.width,i.style.marginRight="50%",f="4px"===b.marginRight,qa.removeChild(h),i=null}}var c,e,f,g,h=d.createElement("div"),i=d.createElement("div");i.style&&(i.style.backgroundClip="content-box",i.cloneNode(!0).style.backgroundClip="",o.clearCloneStyle="content-box"===i.style.backgroundClip,h.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",h.appendChild(i),r.extend(o,{pixelPosition:function(){return b(),c},boxSizingReliable:function(){return b(),e},pixelMarginRight:function(){return b(),f},reliableMarginLeft:function(){return b(),g}}))}();function Na(a,b,c){var d,e,f,g,h=a.style;return c=c||Ma(a),c&&(g=c.getPropertyValue(b)||c[b],""!==g||r.contains(a.ownerDocument,a)||(g=r.style(a,b)),!o.pixelMarginRight()&&La.test(g)&&Ka.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0!==g?g+"":g}function Oa(a,b){return{get:function(){return a()?void delete this.get:(this.get=b).apply(this,arguments)}}}var Pa=/^(none|table(?!-c[ea]).+)/,Qa={position:"absolute",visibility:"hidden",display:"block"},Ra={letterSpacing:"0",fontWeight:"400"},Sa=["Webkit","Moz","ms"],Ta=d.createElement("div").style;function Ua(a){if(a in Ta)return a;var b=a[0].toUpperCase()+a.slice(1),c=Sa.length;while(c--)if(a=Sa[c]+b,a in Ta)return a}function Va(a,b,c){var d=aa.exec(b);return d?Math.max(0,d[2]-(c||0))+(d[3]||"px"):b}function Wa(a,b,c,d,e){var f,g=0;for(f=c===(d?"border":"content")?4:"width"===b?1:0;f<4;f+=2)"margin"===c&&(g+=r.css(a,c+ba[f],!0,e)),d?("content"===c&&(g-=r.css(a,"padding"+ba[f],!0,e)),"margin"!==c&&(g-=r.css(a,"border"+ba[f]+"Width",!0,e))):(g+=r.css(a,"padding"+ba[f],!0,e),"padding"!==c&&(g+=r.css(a,"border"+ba[f]+"Width",!0,e)));return g}function Xa(a,b,c){var d,e=!0,f=Ma(a),g="border-box"===r.css(a,"boxSizing",!1,f);if(a.getClientRects().length&&(d=a.getBoundingClientRect()[b]),d<=0||null==d){if(d=Na(a,b,f),(d<0||null==d)&&(d=a.style[b]),La.test(d))return d;e=g&&(o.boxSizingReliable()||d===a.style[b]),d=parseFloat(d)||0}return d+Wa(a,b,c||(g?"border":"content"),e,f)+"px"}r.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=Na(a,"opacity");return""===c?"1":c}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=r.camelCase(b),i=a.style;return b=r.cssProps[h]||(r.cssProps[h]=Ua(h)||h),g=r.cssHooks[b]||r.cssHooks[h],void 0===c?g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b]:(f=typeof c,"string"===f&&(e=aa.exec(c))&&e[1]&&(c=ea(a,b,e),f="number"),null!=c&&c===c&&("number"===f&&(c+=e&&e[3]||(r.cssNumber[h]?"":"px")),o.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),g&&"set"in g&&void 0===(c=g.set(a,c,d))||(i[b]=c)),void 0)}},css:function(a,b,c,d){var e,f,g,h=r.camelCase(b);return b=r.cssProps[h]||(r.cssProps[h]=Ua(h)||h),g=r.cssHooks[b]||r.cssHooks[h],g&&"get"in g&&(e=g.get(a,!0,c)),void 0===e&&(e=Na(a,b,d)),"normal"===e&&b in Ra&&(e=Ra[b]),""===c||c?(f=parseFloat(e),c===!0||isFinite(f)?f||0:e):e}}),r.each(["height","width"],function(a,b){r.cssHooks[b]={get:function(a,c,d){if(c)return!Pa.test(r.css(a,"display"))||a.getClientRects().length&&a.getBoundingClientRect().width?Xa(a,b,d):da(a,Qa,function(){return Xa(a,b,d)})},set:function(a,c,d){var e,f=d&&Ma(a),g=d&&Wa(a,b,d,"border-box"===r.css(a,"boxSizing",!1,f),f);return g&&(e=aa.exec(c))&&"px"!==(e[3]||"px")&&(a.style[b]=c,c=r.css(a,b)),Va(a,c,g)}}}),r.cssHooks.marginLeft=Oa(o.reliableMarginLeft,function(a,b){if(b)return(parseFloat(Na(a,"marginLeft"))||a.getBoundingClientRect().left-da(a,{marginLeft:0},function(){return a.getBoundingClientRect().left}))+"px"}),r.each({margin:"",padding:"",border:"Width"},function(a,b){r.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];d<4;d++)e[a+ba[d]+b]=f[d]||f[d-2]||f[0];return e}},Ka.test(a)||(r.cssHooks[a+b].set=Va)}),r.fn.extend({css:function(a,b){return S(this,function(a,b,c){var d,e,f={},g=0;if(r.isArray(b)){for(d=Ma(a),e=b.length;g<e;g++)f[b[g]]=r.css(a,b[g],!1,d);return f}return void 0!==c?r.style(a,b,c):r.css(a,b)},a,b,arguments.length>1)}});function Ya(a,b,c,d,e){return new Ya.prototype.init(a,b,c,d,e)}r.Tween=Ya,Ya.prototype={constructor:Ya,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||r.easing._default,this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(r.cssNumber[c]?"":"px")},cur:function(){var a=Ya.propHooks[this.prop];return a&&a.get?a.get(this):Ya.propHooks._default.get(this)},run:function(a){var b,c=Ya.propHooks[this.prop];return this.options.duration?this.pos=b=r.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):this.pos=b=a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):Ya.propHooks._default.set(this),this}},Ya.prototype.init.prototype=Ya.prototype,Ya.propHooks={_default:{get:function(a){var b;return 1!==a.elem.nodeType||null!=a.elem[a.prop]&&null==a.elem.style[a.prop]?a.elem[a.prop]:(b=r.css(a.elem,a.prop,""),b&&"auto"!==b?b:0)},set:function(a){r.fx.step[a.prop]?r.fx.step[a.prop](a):1!==a.elem.nodeType||null==a.elem.style[r.cssProps[a.prop]]&&!r.cssHooks[a.prop]?a.elem[a.prop]=a.now:r.style(a.elem,a.prop,a.now+a.unit)}}},Ya.propHooks.scrollTop=Ya.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},r.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2},_default:"swing"},r.fx=Ya.prototype.init,r.fx.step={};var Za,$a,_a=/^(?:toggle|show|hide)$/,ab=/queueHooks$/;function bb(){$a&&(a.requestAnimationFrame(bb),r.fx.tick())}function cb(){return a.setTimeout(function(){Za=void 0}),Za=r.now()}function db(a,b){var c,d=0,e={height:a};for(b=b?1:0;d<4;d+=2-b)c=ba[d],e["margin"+c]=e["padding"+c]=a;return b&&(e.opacity=e.width=a),e}function eb(a,b,c){for(var d,e=(hb.tweeners[b]||[]).concat(hb.tweeners["*"]),f=0,g=e.length;f<g;f++)if(d=e[f].call(c,b,a))return d}function fb(a,b,c){var d,e,f,g,h,i,j,k,l="width"in b||"height"in b,m=this,n={},o=a.style,p=a.nodeType&&ca(a),q=V.get(a,"fxshow");c.queue||(g=r._queueHooks(a,"fx"),null==g.unqueued&&(g.unqueued=0,h=g.empty.fire,g.empty.fire=function(){g.unqueued||h()}),g.unqueued++,m.always(function(){m.always(function(){g.unqueued--,r.queue(a,"fx").length||g.empty.fire()})}));for(d in b)if(e=b[d],_a.test(e)){if(delete b[d],f=f||"toggle"===e,e===(p?"hide":"show")){if("show"!==e||!q||void 0===q[d])continue;p=!0}n[d]=q&&q[d]||r.style(a,d)}if(i=!r.isEmptyObject(b),i||!r.isEmptyObject(n)){l&&1===a.nodeType&&(c.overflow=[o.overflow,o.overflowX,o.overflowY],j=q&&q.display,null==j&&(j=V.get(a,"display")),k=r.css(a,"display"),"none"===k&&(j?k=j:(ha([a],!0),j=a.style.display||j,k=r.css(a,"display"),ha([a]))),("inline"===k||"inline-block"===k&&null!=j)&&"none"===r.css(a,"float")&&(i||(m.done(function(){o.display=j}),null==j&&(k=o.display,j="none"===k?"":k)),o.display="inline-block")),c.overflow&&(o.overflow="hidden",m.always(function(){o.overflow=c.overflow[0],o.overflowX=c.overflow[1],o.overflowY=c.overflow[2]})),i=!1;for(d in n)i||(q?"hidden"in q&&(p=q.hidden):q=V.access(a,"fxshow",{display:j}),f&&(q.hidden=!p),p&&ha([a],!0),m.done(function(){p||ha([a]),V.remove(a,"fxshow");for(d in n)r.style(a,d,n[d])})),i=eb(p?q[d]:0,d,m),d in q||(q[d]=i.start,p&&(i.end=i.start,i.start=0))}}function gb(a,b){var c,d,e,f,g;for(c in a)if(d=r.camelCase(c),e=b[d],f=a[c],r.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=r.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function hb(a,b,c){var d,e,f=0,g=hb.prefilters.length,h=r.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=Za||cb(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;g<i;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),f<1&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:r.extend({},b),opts:r.extend(!0,{specialEasing:{},easing:r.easing._default},c),originalProperties:b,originalOptions:c,startTime:Za||cb(),duration:c.duration,tweens:[],createTween:function(b,c){var d=r.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;c<d;c++)j.tweens[c].run(1);return b?(h.notifyWith(a,[j,1,0]),h.resolveWith(a,[j,b])):h.rejectWith(a,[j,b]),this}}),k=j.props;for(gb(k,j.opts.specialEasing);f<g;f++)if(d=hb.prefilters[f].call(j,a,k,j.opts))return r.isFunction(d.stop)&&(r._queueHooks(j.elem,j.opts.queue).stop=r.proxy(d.stop,d)),d;return r.map(k,eb,j),r.isFunction(j.opts.start)&&j.opts.start.call(a,j),r.fx.timer(r.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}r.Animation=r.extend(hb,{tweeners:{"*":[function(a,b){var c=this.createTween(a,b);return ea(c.elem,a,aa.exec(b),c),c}]},tweener:function(a,b){r.isFunction(a)?(b=a,a=["*"]):a=a.match(K);for(var c,d=0,e=a.length;d<e;d++)c=a[d],hb.tweeners[c]=hb.tweeners[c]||[],hb.tweeners[c].unshift(b)},prefilters:[fb],prefilter:function(a,b){b?hb.prefilters.unshift(a):hb.prefilters.push(a)}}),r.speed=function(a,b,c){var e=a&&"object"==typeof a?r.extend({},a):{complete:c||!c&&b||r.isFunction(a)&&a,duration:a,easing:c&&b||b&&!r.isFunction(b)&&b};return r.fx.off||d.hidden?e.duration=0:"number"!=typeof e.duration&&(e.duration in r.fx.speeds?e.duration=r.fx.speeds[e.duration]:e.duration=r.fx.speeds._default),null!=e.queue&&e.queue!==!0||(e.queue="fx"),e.old=e.complete,e.complete=function(){r.isFunction(e.old)&&e.old.call(this),e.queue&&r.dequeue(this,e.queue)},e},r.fn.extend({fadeTo:function(a,b,c,d){return this.filter(ca).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=r.isEmptyObject(a),f=r.speed(b,c,d),g=function(){var b=hb(this,r.extend({},a),f);(e||V.get(this,"finish"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=r.timers,g=V.get(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&ab.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));!b&&c||r.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=V.get(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=r.timers,g=d?d.length:0;for(c.finish=!0,r.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;b<g;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),r.each(["toggle","show","hide"],function(a,b){var c=r.fn[b];r.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(db(b,!0),a,d,e)}}),r.each({slideDown:db("show"),slideUp:db("hide"),slideToggle:db("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){r.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),r.timers=[],r.fx.tick=function(){var a,b=0,c=r.timers;for(Za=r.now();b<c.length;b++)a=c[b],a()||c[b]!==a||c.splice(b--,1);c.length||r.fx.stop(),Za=void 0},r.fx.timer=function(a){r.timers.push(a),a()?r.fx.start():r.timers.pop()},r.fx.interval=13,r.fx.start=function(){$a||($a=a.requestAnimationFrame?a.requestAnimationFrame(bb):a.setInterval(r.fx.tick,r.fx.interval))},r.fx.stop=function(){a.cancelAnimationFrame?a.cancelAnimationFrame($a):a.clearInterval($a),$a=null},r.fx.speeds={slow:600,fast:200,_default:400},r.fn.delay=function(b,c){return b=r.fx?r.fx.speeds[b]||b:b,c=c||"fx",this.queue(c,function(c,d){var e=a.setTimeout(c,b);d.stop=function(){a.clearTimeout(e)}})},function(){var a=d.createElement("input"),b=d.createElement("select"),c=b.appendChild(d.createElement("option"));a.type="checkbox",o.checkOn=""!==a.value,o.optSelected=c.selected,a=d.createElement("input"),a.value="t",a.type="radio",o.radioValue="t"===a.value}();var ib,jb=r.expr.attrHandle;r.fn.extend({attr:function(a,b){return S(this,r.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){r.removeAttr(this,a)})}}),r.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(3!==f&&8!==f&&2!==f)return"undefined"==typeof a.getAttribute?r.prop(a,b,c):(1===f&&r.isXMLDoc(a)||(e=r.attrHooks[b.toLowerCase()]||(r.expr.match.bool.test(b)?ib:void 0)),
void 0!==c?null===c?void r.removeAttr(a,b):e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:(a.setAttribute(b,c+""),c):e&&"get"in e&&null!==(d=e.get(a,b))?d:(d=r.find.attr(a,b),null==d?void 0:d))},attrHooks:{type:{set:function(a,b){if(!o.radioValue&&"radio"===b&&r.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}},removeAttr:function(a,b){var c,d=0,e=b&&b.match(K);if(e&&1===a.nodeType)while(c=e[d++])a.removeAttribute(c)}}),ib={set:function(a,b,c){return b===!1?r.removeAttr(a,c):a.setAttribute(c,c),c}},r.each(r.expr.match.bool.source.match(/\w+/g),function(a,b){var c=jb[b]||r.find.attr;jb[b]=function(a,b,d){var e,f,g=b.toLowerCase();return d||(f=jb[g],jb[g]=e,e=null!=c(a,b,d)?g:null,jb[g]=f),e}});var kb=/^(?:input|select|textarea|button)$/i,lb=/^(?:a|area)$/i;r.fn.extend({prop:function(a,b){return S(this,r.prop,a,b,arguments.length>1)},removeProp:function(a){return this.each(function(){delete this[r.propFix[a]||a]})}}),r.extend({prop:function(a,b,c){var d,e,f=a.nodeType;if(3!==f&&8!==f&&2!==f)return 1===f&&r.isXMLDoc(a)||(b=r.propFix[b]||b,e=r.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){var b=r.find.attr(a,"tabindex");return b?parseInt(b,10):kb.test(a.nodeName)||lb.test(a.nodeName)&&a.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),o.optSelected||(r.propHooks.selected={get:function(a){var b=a.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null},set:function(a){var b=a.parentNode;b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex)}}),r.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){r.propFix[this.toLowerCase()]=this});function mb(a){var b=a.match(K)||[];return b.join(" ")}function nb(a){return a.getAttribute&&a.getAttribute("class")||""}r.fn.extend({addClass:function(a){var b,c,d,e,f,g,h,i=0;if(r.isFunction(a))return this.each(function(b){r(this).addClass(a.call(this,b,nb(this)))});if("string"==typeof a&&a){b=a.match(K)||[];while(c=this[i++])if(e=nb(c),d=1===c.nodeType&&" "+mb(e)+" "){g=0;while(f=b[g++])d.indexOf(" "+f+" ")<0&&(d+=f+" ");h=mb(d),e!==h&&c.setAttribute("class",h)}}return this},removeClass:function(a){var b,c,d,e,f,g,h,i=0;if(r.isFunction(a))return this.each(function(b){r(this).removeClass(a.call(this,b,nb(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof a&&a){b=a.match(K)||[];while(c=this[i++])if(e=nb(c),d=1===c.nodeType&&" "+mb(e)+" "){g=0;while(f=b[g++])while(d.indexOf(" "+f+" ")>-1)d=d.replace(" "+f+" "," ");h=mb(d),e!==h&&c.setAttribute("class",h)}}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):r.isFunction(a)?this.each(function(c){r(this).toggleClass(a.call(this,c,nb(this),b),b)}):this.each(function(){var b,d,e,f;if("string"===c){d=0,e=r(this),f=a.match(K)||[];while(b=f[d++])e.hasClass(b)?e.removeClass(b):e.addClass(b)}else void 0!==a&&"boolean"!==c||(b=nb(this),b&&V.set(this,"__className__",b),this.setAttribute&&this.setAttribute("class",b||a===!1?"":V.get(this,"__className__")||""))})},hasClass:function(a){var b,c,d=0;b=" "+a+" ";while(c=this[d++])if(1===c.nodeType&&(" "+mb(nb(c))+" ").indexOf(b)>-1)return!0;return!1}});var ob=/\r/g;r.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=r.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,r(this).val()):a,null==e?e="":"number"==typeof e?e+="":r.isArray(e)&&(e=r.map(e,function(a){return null==a?"":a+""})),b=r.valHooks[this.type]||r.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))});if(e)return b=r.valHooks[e.type]||r.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(ob,""):null==c?"":c)}}}),r.extend({valHooks:{option:{get:function(a){var b=r.find.attr(a,"value");return null!=b?b:mb(r.text(a))}},select:{get:function(a){var b,c,d,e=a.options,f=a.selectedIndex,g="select-one"===a.type,h=g?null:[],i=g?f+1:e.length;for(d=f<0?i:g?f:0;d<i;d++)if(c=e[d],(c.selected||d===f)&&!c.disabled&&(!c.parentNode.disabled||!r.nodeName(c.parentNode,"optgroup"))){if(b=r(c).val(),g)return b;h.push(b)}return h},set:function(a,b){var c,d,e=a.options,f=r.makeArray(b),g=e.length;while(g--)d=e[g],(d.selected=r.inArray(r.valHooks.option.get(d),f)>-1)&&(c=!0);return c||(a.selectedIndex=-1),f}}}}),r.each(["radio","checkbox"],function(){r.valHooks[this]={set:function(a,b){if(r.isArray(b))return a.checked=r.inArray(r(a).val(),b)>-1}},o.checkOn||(r.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});var pb=/^(?:focusinfocus|focusoutblur)$/;r.extend(r.event,{trigger:function(b,c,e,f){var g,h,i,j,k,m,n,o=[e||d],p=l.call(b,"type")?b.type:b,q=l.call(b,"namespace")?b.namespace.split("."):[];if(h=i=e=e||d,3!==e.nodeType&&8!==e.nodeType&&!pb.test(p+r.event.triggered)&&(p.indexOf(".")>-1&&(q=p.split("."),p=q.shift(),q.sort()),k=p.indexOf(":")<0&&"on"+p,b=b[r.expando]?b:new r.Event(p,"object"==typeof b&&b),b.isTrigger=f?2:3,b.namespace=q.join("."),b.rnamespace=b.namespace?new RegExp("(^|\\.)"+q.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=e),c=null==c?[b]:r.makeArray(c,[b]),n=r.event.special[p]||{},f||!n.trigger||n.trigger.apply(e,c)!==!1)){if(!f&&!n.noBubble&&!r.isWindow(e)){for(j=n.delegateType||p,pb.test(j+p)||(h=h.parentNode);h;h=h.parentNode)o.push(h),i=h;i===(e.ownerDocument||d)&&o.push(i.defaultView||i.parentWindow||a)}g=0;while((h=o[g++])&&!b.isPropagationStopped())b.type=g>1?j:n.bindType||p,m=(V.get(h,"events")||{})[b.type]&&V.get(h,"handle"),m&&m.apply(h,c),m=k&&h[k],m&&m.apply&&T(h)&&(b.result=m.apply(h,c),b.result===!1&&b.preventDefault());return b.type=p,f||b.isDefaultPrevented()||n._default&&n._default.apply(o.pop(),c)!==!1||!T(e)||k&&r.isFunction(e[p])&&!r.isWindow(e)&&(i=e[k],i&&(e[k]=null),r.event.triggered=p,e[p](),r.event.triggered=void 0,i&&(e[k]=i)),b.result}},simulate:function(a,b,c){var d=r.extend(new r.Event,c,{type:a,isSimulated:!0});r.event.trigger(d,null,b)}}),r.fn.extend({trigger:function(a,b){return this.each(function(){r.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];if(c)return r.event.trigger(a,b,c,!0)}}),r.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(a,b){r.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),r.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),o.focusin="onfocusin"in a,o.focusin||r.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){r.event.simulate(b,a.target,r.event.fix(a))};r.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=V.access(d,b);e||d.addEventListener(a,c,!0),V.access(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=V.access(d,b)-1;e?V.access(d,b,e):(d.removeEventListener(a,c,!0),V.remove(d,b))}}});var qb=a.location,rb=r.now(),sb=/\?/;r.parseXML=function(b){var c;if(!b||"string"!=typeof b)return null;try{c=(new a.DOMParser).parseFromString(b,"text/xml")}catch(d){c=void 0}return c&&!c.getElementsByTagName("parsererror").length||r.error("Invalid XML: "+b),c};var tb=/\[\]$/,ub=/\r?\n/g,vb=/^(?:submit|button|image|reset|file)$/i,wb=/^(?:input|select|textarea|keygen)/i;function xb(a,b,c,d){var e;if(r.isArray(b))r.each(b,function(b,e){c||tb.test(a)?d(a,e):xb(a+"["+("object"==typeof e&&null!=e?b:"")+"]",e,c,d)});else if(c||"object"!==r.type(b))d(a,b);else for(e in b)xb(a+"["+e+"]",b[e],c,d)}r.param=function(a,b){var c,d=[],e=function(a,b){var c=r.isFunction(b)?b():b;d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(null==c?"":c)};if(r.isArray(a)||a.jquery&&!r.isPlainObject(a))r.each(a,function(){e(this.name,this.value)});else for(c in a)xb(c,a[c],b,e);return d.join("&")},r.fn.extend({serialize:function(){return r.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=r.prop(this,"elements");return a?r.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!r(this).is(":disabled")&&wb.test(this.nodeName)&&!vb.test(a)&&(this.checked||!ia.test(a))}).map(function(a,b){var c=r(this).val();return null==c?null:r.isArray(c)?r.map(c,function(a){return{name:b.name,value:a.replace(ub,"\r\n")}}):{name:b.name,value:c.replace(ub,"\r\n")}}).get()}});var yb=/%20/g,zb=/#.*$/,Ab=/([?&])_=[^&]*/,Bb=/^(.*?):[ \t]*([^\r\n]*)$/gm,Cb=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Db=/^(?:GET|HEAD)$/,Eb=/^\/\//,Fb={},Gb={},Hb="*/".concat("*"),Ib=d.createElement("a");Ib.href=qb.href;function Jb(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(K)||[];if(r.isFunction(c))while(d=f[e++])"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function Kb(a,b,c,d){var e={},f=a===Gb;function g(h){var i;return e[h]=!0,r.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||f||e[j]?f?!(i=j):void 0:(b.dataTypes.unshift(j),g(j),!1)}),i}return g(b.dataTypes[0])||!e["*"]&&g("*")}function Lb(a,b){var c,d,e=r.ajaxSettings.flatOptions||{};for(c in b)void 0!==b[c]&&((e[c]?a:d||(d={}))[c]=b[c]);return d&&r.extend(!0,a,d),a}function Mb(a,b,c){var d,e,f,g,h=a.contents,i=a.dataTypes;while("*"===i[0])i.shift(),void 0===d&&(d=a.mimeType||b.getResponseHeader("Content-Type"));if(d)for(e in h)if(h[e]&&h[e].test(d)){i.unshift(e);break}if(i[0]in c)f=i[0];else{for(e in c){if(!i[0]||a.converters[e+" "+i[0]]){f=e;break}g||(g=e)}f=f||g}if(f)return f!==i[0]&&i.unshift(f),c[f]}function Nb(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];f=k.shift();while(f)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a["throws"])b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}r.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:qb.href,type:"GET",isLocal:Cb.test(qb.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Hb,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":r.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?Lb(Lb(a,r.ajaxSettings),b):Lb(r.ajaxSettings,a)},ajaxPrefilter:Jb(Fb),ajaxTransport:Jb(Gb),ajax:function(b,c){"object"==typeof b&&(c=b,b=void 0),c=c||{};var e,f,g,h,i,j,k,l,m,n,o=r.ajaxSetup({},c),p=o.context||o,q=o.context&&(p.nodeType||p.jquery)?r(p):r.event,s=r.Deferred(),t=r.Callbacks("once memory"),u=o.statusCode||{},v={},w={},x="canceled",y={readyState:0,getResponseHeader:function(a){var b;if(k){if(!h){h={};while(b=Bb.exec(g))h[b[1].toLowerCase()]=b[2]}b=h[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return k?g:null},setRequestHeader:function(a,b){return null==k&&(a=w[a.toLowerCase()]=w[a.toLowerCase()]||a,v[a]=b),this},overrideMimeType:function(a){return null==k&&(o.mimeType=a),this},statusCode:function(a){var b;if(a)if(k)y.always(a[y.status]);else for(b in a)u[b]=[u[b],a[b]];return this},abort:function(a){var b=a||x;return e&&e.abort(b),A(0,b),this}};if(s.promise(y),o.url=((b||o.url||qb.href)+"").replace(Eb,qb.protocol+"//"),o.type=c.method||c.type||o.method||o.type,o.dataTypes=(o.dataType||"*").toLowerCase().match(K)||[""],null==o.crossDomain){j=d.createElement("a");try{j.href=o.url,j.href=j.href,o.crossDomain=Ib.protocol+"//"+Ib.host!=j.protocol+"//"+j.host}catch(z){o.crossDomain=!0}}if(o.data&&o.processData&&"string"!=typeof o.data&&(o.data=r.param(o.data,o.traditional)),Kb(Fb,o,c,y),k)return y;l=r.event&&o.global,l&&0===r.active++&&r.event.trigger("ajaxStart"),o.type=o.type.toUpperCase(),o.hasContent=!Db.test(o.type),f=o.url.replace(zb,""),o.hasContent?o.data&&o.processData&&0===(o.contentType||"").indexOf("application/x-www-form-urlencoded")&&(o.data=o.data.replace(yb,"+")):(n=o.url.slice(f.length),o.data&&(f+=(sb.test(f)?"&":"?")+o.data,delete o.data),o.cache===!1&&(f=f.replace(Ab,"$1"),n=(sb.test(f)?"&":"?")+"_="+rb++ +n),o.url=f+n),o.ifModified&&(r.lastModified[f]&&y.setRequestHeader("If-Modified-Since",r.lastModified[f]),r.etag[f]&&y.setRequestHeader("If-None-Match",r.etag[f])),(o.data&&o.hasContent&&o.contentType!==!1||c.contentType)&&y.setRequestHeader("Content-Type",o.contentType),y.setRequestHeader("Accept",o.dataTypes[0]&&o.accepts[o.dataTypes[0]]?o.accepts[o.dataTypes[0]]+("*"!==o.dataTypes[0]?", "+Hb+"; q=0.01":""):o.accepts["*"]);for(m in o.headers)y.setRequestHeader(m,o.headers[m]);if(o.beforeSend&&(o.beforeSend.call(p,y,o)===!1||k))return y.abort();if(x="abort",t.add(o.complete),y.done(o.success),y.fail(o.error),e=Kb(Gb,o,c,y)){if(y.readyState=1,l&&q.trigger("ajaxSend",[y,o]),k)return y;o.async&&o.timeout>0&&(i=a.setTimeout(function(){y.abort("timeout")},o.timeout));try{k=!1,e.send(v,A)}catch(z){if(k)throw z;A(-1,z)}}else A(-1,"No Transport");function A(b,c,d,h){var j,m,n,v,w,x=c;k||(k=!0,i&&a.clearTimeout(i),e=void 0,g=h||"",y.readyState=b>0?4:0,j=b>=200&&b<300||304===b,d&&(v=Mb(o,y,d)),v=Nb(o,v,y,j),j?(o.ifModified&&(w=y.getResponseHeader("Last-Modified"),w&&(r.lastModified[f]=w),w=y.getResponseHeader("etag"),w&&(r.etag[f]=w)),204===b||"HEAD"===o.type?x="nocontent":304===b?x="notmodified":(x=v.state,m=v.data,n=v.error,j=!n)):(n=x,!b&&x||(x="error",b<0&&(b=0))),y.status=b,y.statusText=(c||x)+"",j?s.resolveWith(p,[m,x,y]):s.rejectWith(p,[y,x,n]),y.statusCode(u),u=void 0,l&&q.trigger(j?"ajaxSuccess":"ajaxError",[y,o,j?m:n]),t.fireWith(p,[y,x]),l&&(q.trigger("ajaxComplete",[y,o]),--r.active||r.event.trigger("ajaxStop")))}return y},getJSON:function(a,b,c){return r.get(a,b,c,"json")},getScript:function(a,b){return r.get(a,void 0,b,"script")}}),r.each(["get","post"],function(a,b){r[b]=function(a,c,d,e){return r.isFunction(c)&&(e=e||d,d=c,c=void 0),r.ajax(r.extend({url:a,type:b,dataType:e,data:c,success:d},r.isPlainObject(a)&&a))}}),r._evalUrl=function(a){return r.ajax({url:a,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,"throws":!0})},r.fn.extend({wrapAll:function(a){var b;return this[0]&&(r.isFunction(a)&&(a=a.call(this[0])),b=r(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstElementChild)a=a.firstElementChild;return a}).append(this)),this},wrapInner:function(a){return r.isFunction(a)?this.each(function(b){r(this).wrapInner(a.call(this,b))}):this.each(function(){var b=r(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=r.isFunction(a);return this.each(function(c){r(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(a){return this.parent(a).not("body").each(function(){r(this).replaceWith(this.childNodes)}),this}}),r.expr.pseudos.hidden=function(a){return!r.expr.pseudos.visible(a)},r.expr.pseudos.visible=function(a){return!!(a.offsetWidth||a.offsetHeight||a.getClientRects().length)},r.ajaxSettings.xhr=function(){try{return new a.XMLHttpRequest}catch(b){}};var Ob={0:200,1223:204},Pb=r.ajaxSettings.xhr();o.cors=!!Pb&&"withCredentials"in Pb,o.ajax=Pb=!!Pb,r.ajaxTransport(function(b){var c,d;if(o.cors||Pb&&!b.crossDomain)return{send:function(e,f){var g,h=b.xhr();if(h.open(b.type,b.url,b.async,b.username,b.password),b.xhrFields)for(g in b.xhrFields)h[g]=b.xhrFields[g];b.mimeType&&h.overrideMimeType&&h.overrideMimeType(b.mimeType),b.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest");for(g in e)h.setRequestHeader(g,e[g]);c=function(a){return function(){c&&(c=d=h.onload=h.onerror=h.onabort=h.onreadystatechange=null,"abort"===a?h.abort():"error"===a?"number"!=typeof h.status?f(0,"error"):f(h.status,h.statusText):f(Ob[h.status]||h.status,h.statusText,"text"!==(h.responseType||"text")||"string"!=typeof h.responseText?{binary:h.response}:{text:h.responseText},h.getAllResponseHeaders()))}},h.onload=c(),d=h.onerror=c("error"),void 0!==h.onabort?h.onabort=d:h.onreadystatechange=function(){4===h.readyState&&a.setTimeout(function(){c&&d()})},c=c("abort");try{h.send(b.hasContent&&b.data||null)}catch(i){if(c)throw i}},abort:function(){c&&c()}}}),r.ajaxPrefilter(function(a){a.crossDomain&&(a.contents.script=!1)}),r.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(a){return r.globalEval(a),a}}}),r.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET")}),r.ajaxTransport("script",function(a){if(a.crossDomain){var b,c;return{send:function(e,f){b=r("<script>").prop({charset:a.scriptCharset,src:a.url}).on("load error",c=function(a){b.remove(),c=null,a&&f("error"===a.type?404:200,a.type)}),d.head.appendChild(b[0])},abort:function(){c&&c()}}}});var Qb=[],Rb=/(=)\?(?=&|$)|\?\?/;r.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=Qb.pop()||r.expando+"_"+rb++;return this[a]=!0,a}}),r.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(Rb.test(b.url)?"url":"string"==typeof b.data&&0===(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&Rb.test(b.data)&&"data");if(h||"jsonp"===b.dataTypes[0])return e=b.jsonpCallback=r.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(Rb,"$1"+e):b.jsonp!==!1&&(b.url+=(sb.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||r.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){void 0===f?r(a).removeProp(e):a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,Qb.push(e)),g&&r.isFunction(f)&&f(g[0]),g=f=void 0}),"script"}),o.createHTMLDocument=function(){var a=d.implementation.createHTMLDocument("").body;return a.innerHTML="<form></form><form></form>",2===a.childNodes.length}(),r.parseHTML=function(a,b,c){if("string"!=typeof a)return[];"boolean"==typeof b&&(c=b,b=!1);var e,f,g;return b||(o.createHTMLDocument?(b=d.implementation.createHTMLDocument(""),e=b.createElement("base"),e.href=d.location.href,b.head.appendChild(e)):b=d),f=B.exec(a),g=!c&&[],f?[b.createElement(f[1])]:(f=pa([a],b,g),g&&g.length&&r(g).remove(),r.merge([],f.childNodes))},r.fn.load=function(a,b,c){var d,e,f,g=this,h=a.indexOf(" ");return h>-1&&(d=mb(a.slice(h)),a=a.slice(0,h)),r.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(e="POST"),g.length>0&&r.ajax({url:a,type:e||"GET",dataType:"html",data:b}).done(function(a){f=arguments,g.html(d?r("<div>").append(r.parseHTML(a)).find(d):a)}).always(c&&function(a,b){g.each(function(){c.apply(this,f||[a.responseText,b,a])})}),this},r.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){r.fn[b]=function(a){return this.on(b,a)}}),r.expr.pseudos.animated=function(a){return r.grep(r.timers,function(b){return a===b.elem}).length};function Sb(a){return r.isWindow(a)?a:9===a.nodeType&&a.defaultView}r.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=r.css(a,"position"),l=r(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=r.css(a,"top"),i=r.css(a,"left"),j=("absolute"===k||"fixed"===k)&&(f+i).indexOf("auto")>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),r.isFunction(b)&&(b=b.call(a,c,r.extend({},h))),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m)}},r.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){r.offset.setOffset(this,a,b)});var b,c,d,e,f=this[0];if(f)return f.getClientRects().length?(d=f.getBoundingClientRect(),d.width||d.height?(e=f.ownerDocument,c=Sb(e),b=e.documentElement,{top:d.top+c.pageYOffset-b.clientTop,left:d.left+c.pageXOffset-b.clientLeft}):d):{top:0,left:0}},position:function(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};return"fixed"===r.css(c,"position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),r.nodeName(a[0],"html")||(d=a.offset()),d={top:d.top+r.css(a[0],"borderTopWidth",!0),left:d.left+r.css(a[0],"borderLeftWidth",!0)}),{top:b.top-d.top-r.css(c,"marginTop",!0),left:b.left-d.left-r.css(c,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var a=this.offsetParent;while(a&&"static"===r.css(a,"position"))a=a.offsetParent;return a||qa})}}),r.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){var c="pageYOffset"===b;r.fn[a]=function(d){return S(this,function(a,d,e){var f=Sb(a);return void 0===e?f?f[b]:a[d]:void(f?f.scrollTo(c?f.pageXOffset:e,c?e:f.pageYOffset):a[d]=e)},a,d,arguments.length)}}),r.each(["top","left"],function(a,b){r.cssHooks[b]=Oa(o.pixelPosition,function(a,c){if(c)return c=Na(a,b),La.test(c)?r(a).position()[b]+"px":c})}),r.each({Height:"height",Width:"width"},function(a,b){r.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){r.fn[d]=function(e,f){var g=arguments.length&&(c||"boolean"!=typeof e),h=c||(e===!0||f===!0?"margin":"border");return S(this,function(b,c,e){var f;return r.isWindow(b)?0===d.indexOf("outer")?b["inner"+a]:b.document.documentElement["client"+a]:9===b.nodeType?(f=b.documentElement,Math.max(b.body["scroll"+a],f["scroll"+a],b.body["offset"+a],f["offset"+a],f["client"+a])):void 0===e?r.css(b,c,h):r.style(b,c,e,h)},b,g?e:void 0,g)}})}),r.fn.extend({bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}}),r.parseJSON=JSON.parse,"function"==typeof define&&define.amd&&define("jquery",[],function(){return r});var Tb=a.jQuery,Ub=a.$;return r.noConflict=function(b){return a.$===r&&(a.$=Ub),b&&a.jQuery===r&&(a.jQuery=Tb),r},b||(a.jQuery=a.$=r),r});

/** javascripts/jquery-ui.min.js **/
/*! jQuery UI - v1.12.1 - 2016-09-14
* http://jqueryui.com
* Includes: widget.js, position.js, data.js, disable-selection.js, effect.js, effects/effect-blind.js, effects/effect-bounce.js, effects/effect-clip.js, effects/effect-drop.js, effects/effect-explode.js, effects/effect-fade.js, effects/effect-fold.js, effects/effect-highlight.js, effects/effect-puff.js, effects/effect-pulsate.js, effects/effect-scale.js, effects/effect-shake.js, effects/effect-size.js, effects/effect-slide.js, effects/effect-transfer.js, focusable.js, form-reset-mixin.js, jquery-1-7.js, keycode.js, labels.js, scroll-parent.js, tabbable.js, unique-id.js, widgets/accordion.js, widgets/autocomplete.js, widgets/button.js, widgets/checkboxradio.js, widgets/controlgroup.js, widgets/datepicker.js, widgets/dialog.js, widgets/draggable.js, widgets/droppable.js, widgets/menu.js, widgets/mouse.js, widgets/progressbar.js, widgets/resizable.js, widgets/selectable.js, widgets/selectmenu.js, widgets/slider.js, widgets/sortable.js, widgets/spinner.js, widgets/tabs.js, widgets/tooltip.js
* Copyright jQuery Foundation and other contributors; Licensed MIT */

(function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)})(function(t){function e(t){for(var e=t.css("visibility");"inherit"===e;)t=t.parent(),e=t.css("visibility");return"hidden"!==e}function i(t){for(var e,i;t.length&&t[0]!==document;){if(e=t.css("position"),("absolute"===e||"relative"===e||"fixed"===e)&&(i=parseInt(t.css("zIndex"),10),!isNaN(i)&&0!==i))return i;t=t.parent()}return 0}function s(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},t.extend(this._defaults,this.regional[""]),this.regional.en=t.extend(!0,{},this.regional[""]),this.regional["en-US"]=t.extend(!0,{},this.regional.en),this.dpDiv=n(t("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function n(e){var i="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return e.on("mouseout",i,function(){t(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&t(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&t(this).removeClass("ui-datepicker-next-hover")}).on("mouseover",i,o)}function o(){t.datepicker._isDisabledDatepicker(m.inline?m.dpDiv.parent()[0]:m.input[0])||(t(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),t(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&t(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&t(this).addClass("ui-datepicker-next-hover"))}function a(e,i){t.extend(e,i);for(var s in i)null==i[s]&&(e[s]=i[s]);return e}function r(t){return function(){var e=this.element.val();t.apply(this,arguments),this._refresh(),e!==this.element.val()&&this._trigger("change")}}t.ui=t.ui||{},t.ui.version="1.12.1";var h=0,l=Array.prototype.slice;t.cleanData=function(e){return function(i){var s,n,o;for(o=0;null!=(n=i[o]);o++)try{s=t._data(n,"events"),s&&s.remove&&t(n).triggerHandler("remove")}catch(a){}e(i)}}(t.cleanData),t.widget=function(e,i,s){var n,o,a,r={},h=e.split(".")[0];e=e.split(".")[1];var l=h+"-"+e;return s||(s=i,i=t.Widget),t.isArray(s)&&(s=t.extend.apply(null,[{}].concat(s))),t.expr[":"][l.toLowerCase()]=function(e){return!!t.data(e,l)},t[h]=t[h]||{},n=t[h][e],o=t[h][e]=function(t,e){return this._createWidget?(arguments.length&&this._createWidget(t,e),void 0):new o(t,e)},t.extend(o,n,{version:s.version,_proto:t.extend({},s),_childConstructors:[]}),a=new i,a.options=t.widget.extend({},a.options),t.each(s,function(e,s){return t.isFunction(s)?(r[e]=function(){function t(){return i.prototype[e].apply(this,arguments)}function n(t){return i.prototype[e].apply(this,t)}return function(){var e,i=this._super,o=this._superApply;return this._super=t,this._superApply=n,e=s.apply(this,arguments),this._super=i,this._superApply=o,e}}(),void 0):(r[e]=s,void 0)}),o.prototype=t.widget.extend(a,{widgetEventPrefix:n?a.widgetEventPrefix||e:e},r,{constructor:o,namespace:h,widgetName:e,widgetFullName:l}),n?(t.each(n._childConstructors,function(e,i){var s=i.prototype;t.widget(s.namespace+"."+s.widgetName,o,i._proto)}),delete n._childConstructors):i._childConstructors.push(o),t.widget.bridge(e,o),o},t.widget.extend=function(e){for(var i,s,n=l.call(arguments,1),o=0,a=n.length;a>o;o++)for(i in n[o])s=n[o][i],n[o].hasOwnProperty(i)&&void 0!==s&&(e[i]=t.isPlainObject(s)?t.isPlainObject(e[i])?t.widget.extend({},e[i],s):t.widget.extend({},s):s);return e},t.widget.bridge=function(e,i){var s=i.prototype.widgetFullName||e;t.fn[e]=function(n){var o="string"==typeof n,a=l.call(arguments,1),r=this;return o?this.length||"instance"!==n?this.each(function(){var i,o=t.data(this,s);return"instance"===n?(r=o,!1):o?t.isFunction(o[n])&&"_"!==n.charAt(0)?(i=o[n].apply(o,a),i!==o&&void 0!==i?(r=i&&i.jquery?r.pushStack(i.get()):i,!1):void 0):t.error("no such method '"+n+"' for "+e+" widget instance"):t.error("cannot call methods on "+e+" prior to initialization; "+"attempted to call method '"+n+"'")}):r=void 0:(a.length&&(n=t.widget.extend.apply(null,[n].concat(a))),this.each(function(){var e=t.data(this,s);e?(e.option(n||{}),e._init&&e._init()):t.data(this,s,new i(n,this))})),r}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(e,i){i=t(i||this.defaultElement||this)[0],this.element=t(i),this.uuid=h++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=t(),this.hoverable=t(),this.focusable=t(),this.classesElementLookup={},i!==this&&(t.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===i&&this.destroy()}}),this.document=t(i.style?i.ownerDocument:i.document||i),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this.options=t.widget.extend({},this.options,this._getCreateOptions(),e),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){var e=this;this._destroy(),t.each(this.classesElementLookup,function(t,i){e._removeClass(i,t)}),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:t.noop,widget:function(){return this.element},option:function(e,i){var s,n,o,a=e;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof e)if(a={},s=e.split("."),e=s.shift(),s.length){for(n=a[e]=t.widget.extend({},this.options[e]),o=0;s.length-1>o;o++)n[s[o]]=n[s[o]]||{},n=n[s[o]];if(e=s.pop(),1===arguments.length)return void 0===n[e]?null:n[e];n[e]=i}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];a[e]=i}return this._setOptions(a),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return"classes"===t&&this._setOptionClasses(e),this.options[t]=e,"disabled"===t&&this._setOptionDisabled(e),this},_setOptionClasses:function(e){var i,s,n;for(i in e)n=this.classesElementLookup[i],e[i]!==this.options.classes[i]&&n&&n.length&&(s=t(n.get()),this._removeClass(n,i),s.addClass(this._classes({element:s,keys:i,classes:e,add:!0})))},_setOptionDisabled:function(t){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!t),t&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(e){function i(i,o){var a,r;for(r=0;i.length>r;r++)a=n.classesElementLookup[i[r]]||t(),a=e.add?t(t.unique(a.get().concat(e.element.get()))):t(a.not(e.element).get()),n.classesElementLookup[i[r]]=a,s.push(i[r]),o&&e.classes[i[r]]&&s.push(e.classes[i[r]])}var s=[],n=this;return e=t.extend({element:this.element,classes:this.options.classes||{}},e),this._on(e.element,{remove:"_untrackClassesElement"}),e.keys&&i(e.keys.match(/\S+/g)||[],!0),e.extra&&i(e.extra.match(/\S+/g)||[]),s.join(" ")},_untrackClassesElement:function(e){var i=this;t.each(i.classesElementLookup,function(s,n){-1!==t.inArray(e.target,n)&&(i.classesElementLookup[s]=t(n.not(e.target).get()))})},_removeClass:function(t,e,i){return this._toggleClass(t,e,i,!1)},_addClass:function(t,e,i){return this._toggleClass(t,e,i,!0)},_toggleClass:function(t,e,i,s){s="boolean"==typeof s?s:i;var n="string"==typeof t||null===t,o={extra:n?e:i,keys:n?t:e,element:n?this.element:t,add:s};return o.element.toggleClass(this._classes(o),s),this},_on:function(e,i,s){var n,o=this;"boolean"!=typeof e&&(s=i,i=e,e=!1),s?(i=n=t(i),this.bindings=this.bindings.add(i)):(s=i,i=this.element,n=this.widget()),t.each(s,function(s,a){function r(){return e||o.options.disabled!==!0&&!t(this).hasClass("ui-state-disabled")?("string"==typeof a?o[a]:a).apply(o,arguments):void 0}"string"!=typeof a&&(r.guid=a.guid=a.guid||r.guid||t.guid++);var h=s.match(/^([\w:-]*)\s*(.*)$/),l=h[1]+o.eventNamespace,c=h[2];c?n.on(l,c,r):i.on(l,r)})},_off:function(e,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.off(i).off(i),this.bindings=t(this.bindings.not(e).get()),this.focusable=t(this.focusable.not(e).get()),this.hoverable=t(this.hoverable.not(e).get())},_delay:function(t,e){function i(){return("string"==typeof t?s[t]:t).apply(s,arguments)}var s=this;return setTimeout(i,e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){this._addClass(t(e.currentTarget),null,"ui-state-hover")},mouseleave:function(e){this._removeClass(t(e.currentTarget),null,"ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){this._addClass(t(e.currentTarget),null,"ui-state-focus")},focusout:function(e){this._removeClass(t(e.currentTarget),null,"ui-state-focus")}})},_trigger:function(e,i,s){var n,o,a=this.options[e];if(s=s||{},i=t.Event(i),i.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),i.target=this.element[0],o=i.originalEvent)for(n in o)n in i||(i[n]=o[n]);return this.element.trigger(i,s),!(t.isFunction(a)&&a.apply(this.element[0],[i].concat(s))===!1||i.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},function(e,i){t.Widget.prototype["_"+e]=function(s,n,o){"string"==typeof n&&(n={effect:n});var a,r=n?n===!0||"number"==typeof n?i:n.effect||i:e;n=n||{},"number"==typeof n&&(n={duration:n}),a=!t.isEmptyObject(n),n.complete=o,n.delay&&s.delay(n.delay),a&&t.effects&&t.effects.effect[r]?s[e](n):r!==e&&s[r]?s[r](n.duration,n.easing,o):s.queue(function(i){t(this)[e](),o&&o.call(s[0]),i()})}}),t.widget,function(){function e(t,e,i){return[parseFloat(t[0])*(u.test(t[0])?e/100:1),parseFloat(t[1])*(u.test(t[1])?i/100:1)]}function i(e,i){return parseInt(t.css(e,i),10)||0}function s(e){var i=e[0];return 9===i.nodeType?{width:e.width(),height:e.height(),offset:{top:0,left:0}}:t.isWindow(i)?{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()}}var n,o=Math.max,a=Math.abs,r=/left|center|right/,h=/top|center|bottom/,l=/[\+\-]\d+(\.[\d]+)?%?/,c=/^\w+/,u=/%$/,d=t.fn.position;t.position={scrollbarWidth:function(){if(void 0!==n)return n;var e,i,s=t("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),o=s.children()[0];return t("body").append(s),e=o.offsetWidth,s.css("overflow","scroll"),i=o.offsetWidth,e===i&&(i=s[0].clientWidth),s.remove(),n=e-i},getScrollInfo:function(e){var i=e.isWindow||e.isDocument?"":e.element.css("overflow-x"),s=e.isWindow||e.isDocument?"":e.element.css("overflow-y"),n="scroll"===i||"auto"===i&&e.width<e.element[0].scrollWidth,o="scroll"===s||"auto"===s&&e.height<e.element[0].scrollHeight;return{width:o?t.position.scrollbarWidth():0,height:n?t.position.scrollbarWidth():0}},getWithinInfo:function(e){var i=t(e||window),s=t.isWindow(i[0]),n=!!i[0]&&9===i[0].nodeType,o=!s&&!n;return{element:i,isWindow:s,isDocument:n,offset:o?t(e).offset():{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:i.outerWidth(),height:i.outerHeight()}}},t.fn.position=function(n){if(!n||!n.of)return d.apply(this,arguments);n=t.extend({},n);var u,p,f,g,m,_,v=t(n.of),b=t.position.getWithinInfo(n.within),y=t.position.getScrollInfo(b),w=(n.collision||"flip").split(" "),k={};return _=s(v),v[0].preventDefault&&(n.at="left top"),p=_.width,f=_.height,g=_.offset,m=t.extend({},g),t.each(["my","at"],function(){var t,e,i=(n[this]||"").split(" ");1===i.length&&(i=r.test(i[0])?i.concat(["center"]):h.test(i[0])?["center"].concat(i):["center","center"]),i[0]=r.test(i[0])?i[0]:"center",i[1]=h.test(i[1])?i[1]:"center",t=l.exec(i[0]),e=l.exec(i[1]),k[this]=[t?t[0]:0,e?e[0]:0],n[this]=[c.exec(i[0])[0],c.exec(i[1])[0]]}),1===w.length&&(w[1]=w[0]),"right"===n.at[0]?m.left+=p:"center"===n.at[0]&&(m.left+=p/2),"bottom"===n.at[1]?m.top+=f:"center"===n.at[1]&&(m.top+=f/2),u=e(k.at,p,f),m.left+=u[0],m.top+=u[1],this.each(function(){var s,r,h=t(this),l=h.outerWidth(),c=h.outerHeight(),d=i(this,"marginLeft"),_=i(this,"marginTop"),x=l+d+i(this,"marginRight")+y.width,C=c+_+i(this,"marginBottom")+y.height,D=t.extend({},m),I=e(k.my,h.outerWidth(),h.outerHeight());"right"===n.my[0]?D.left-=l:"center"===n.my[0]&&(D.left-=l/2),"bottom"===n.my[1]?D.top-=c:"center"===n.my[1]&&(D.top-=c/2),D.left+=I[0],D.top+=I[1],s={marginLeft:d,marginTop:_},t.each(["left","top"],function(e,i){t.ui.position[w[e]]&&t.ui.position[w[e]][i](D,{targetWidth:p,targetHeight:f,elemWidth:l,elemHeight:c,collisionPosition:s,collisionWidth:x,collisionHeight:C,offset:[u[0]+I[0],u[1]+I[1]],my:n.my,at:n.at,within:b,elem:h})}),n.using&&(r=function(t){var e=g.left-D.left,i=e+p-l,s=g.top-D.top,r=s+f-c,u={target:{element:v,left:g.left,top:g.top,width:p,height:f},element:{element:h,left:D.left,top:D.top,width:l,height:c},horizontal:0>i?"left":e>0?"right":"center",vertical:0>r?"top":s>0?"bottom":"middle"};l>p&&p>a(e+i)&&(u.horizontal="center"),c>f&&f>a(s+r)&&(u.vertical="middle"),u.important=o(a(e),a(i))>o(a(s),a(r))?"horizontal":"vertical",n.using.call(this,t,u)}),h.offset(t.extend(D,{using:r}))})},t.ui.position={fit:{left:function(t,e){var i,s=e.within,n=s.isWindow?s.scrollLeft:s.offset.left,a=s.width,r=t.left-e.collisionPosition.marginLeft,h=n-r,l=r+e.collisionWidth-a-n;e.collisionWidth>a?h>0&&0>=l?(i=t.left+h+e.collisionWidth-a-n,t.left+=h-i):t.left=l>0&&0>=h?n:h>l?n+a-e.collisionWidth:n:h>0?t.left+=h:l>0?t.left-=l:t.left=o(t.left-r,t.left)},top:function(t,e){var i,s=e.within,n=s.isWindow?s.scrollTop:s.offset.top,a=e.within.height,r=t.top-e.collisionPosition.marginTop,h=n-r,l=r+e.collisionHeight-a-n;e.collisionHeight>a?h>0&&0>=l?(i=t.top+h+e.collisionHeight-a-n,t.top+=h-i):t.top=l>0&&0>=h?n:h>l?n+a-e.collisionHeight:n:h>0?t.top+=h:l>0?t.top-=l:t.top=o(t.top-r,t.top)}},flip:{left:function(t,e){var i,s,n=e.within,o=n.offset.left+n.scrollLeft,r=n.width,h=n.isWindow?n.scrollLeft:n.offset.left,l=t.left-e.collisionPosition.marginLeft,c=l-h,u=l+e.collisionWidth-r-h,d="left"===e.my[0]?-e.elemWidth:"right"===e.my[0]?e.elemWidth:0,p="left"===e.at[0]?e.targetWidth:"right"===e.at[0]?-e.targetWidth:0,f=-2*e.offset[0];0>c?(i=t.left+d+p+f+e.collisionWidth-r-o,(0>i||a(c)>i)&&(t.left+=d+p+f)):u>0&&(s=t.left-e.collisionPosition.marginLeft+d+p+f-h,(s>0||u>a(s))&&(t.left+=d+p+f))},top:function(t,e){var i,s,n=e.within,o=n.offset.top+n.scrollTop,r=n.height,h=n.isWindow?n.scrollTop:n.offset.top,l=t.top-e.collisionPosition.marginTop,c=l-h,u=l+e.collisionHeight-r-h,d="top"===e.my[1],p=d?-e.elemHeight:"bottom"===e.my[1]?e.elemHeight:0,f="top"===e.at[1]?e.targetHeight:"bottom"===e.at[1]?-e.targetHeight:0,g=-2*e.offset[1];0>c?(s=t.top+p+f+g+e.collisionHeight-r-o,(0>s||a(c)>s)&&(t.top+=p+f+g)):u>0&&(i=t.top-e.collisionPosition.marginTop+p+f+g-h,(i>0||u>a(i))&&(t.top+=p+f+g))}},flipfit:{left:function(){t.ui.position.flip.left.apply(this,arguments),t.ui.position.fit.left.apply(this,arguments)},top:function(){t.ui.position.flip.top.apply(this,arguments),t.ui.position.fit.top.apply(this,arguments)}}}}(),t.ui.position,t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo(function(e){return function(i){return!!t.data(i,e)}}):function(e,i,s){return!!t.data(e,s[3])}}),t.fn.extend({disableSelection:function(){var t="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.on(t+".ui-disableSelection",function(t){t.preventDefault()})}}(),enableSelection:function(){return this.off(".ui-disableSelection")}});var c="ui-effects-",u="ui-effects-style",d="ui-effects-animated",p=t;t.effects={effect:{}},function(t,e){function i(t,e,i){var s=u[e.type]||{};return null==t?i||!e.def?null:e.def:(t=s.floor?~~t:parseFloat(t),isNaN(t)?e.def:s.mod?(t+s.mod)%s.mod:0>t?0:t>s.max?s.max:t)}function s(i){var s=l(),n=s._rgba=[];return i=i.toLowerCase(),f(h,function(t,o){var a,r=o.re.exec(i),h=r&&o.parse(r),l=o.space||"rgba";return h?(a=s[l](h),s[c[l].cache]=a[c[l].cache],n=s._rgba=a._rgba,!1):e}),n.length?("0,0,0,0"===n.join()&&t.extend(n,o.transparent),s):o[i]}function n(t,e,i){return i=(i+1)%1,1>6*i?t+6*(e-t)*i:1>2*i?e:2>3*i?t+6*(e-t)*(2/3-i):t}var o,a="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",r=/^([\-+])=\s*(\d+\.?\d*)/,h=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[t[1],t[2],t[3],t[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[2.55*t[1],2.55*t[2],2.55*t[3],t[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(t){return[t[1],t[2]/100,t[3]/100,t[4]]}}],l=t.Color=function(e,i,s,n){return new t.Color.fn.parse(e,i,s,n)},c={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},u={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},d=l.support={},p=t("<p>")[0],f=t.each;p.style.cssText="background-color:rgba(1,1,1,.5)",d.rgba=p.style.backgroundColor.indexOf("rgba")>-1,f(c,function(t,e){e.cache="_"+t,e.props.alpha={idx:3,type:"percent",def:1}}),l.fn=t.extend(l.prototype,{parse:function(n,a,r,h){if(n===e)return this._rgba=[null,null,null,null],this;(n.jquery||n.nodeType)&&(n=t(n).css(a),a=e);var u=this,d=t.type(n),p=this._rgba=[];return a!==e&&(n=[n,a,r,h],d="array"),"string"===d?this.parse(s(n)||o._default):"array"===d?(f(c.rgba.props,function(t,e){p[e.idx]=i(n[e.idx],e)}),this):"object"===d?(n instanceof l?f(c,function(t,e){n[e.cache]&&(u[e.cache]=n[e.cache].slice())}):f(c,function(e,s){var o=s.cache;f(s.props,function(t,e){if(!u[o]&&s.to){if("alpha"===t||null==n[t])return;u[o]=s.to(u._rgba)}u[o][e.idx]=i(n[t],e,!0)}),u[o]&&0>t.inArray(null,u[o].slice(0,3))&&(u[o][3]=1,s.from&&(u._rgba=s.from(u[o])))}),this):e},is:function(t){var i=l(t),s=!0,n=this;return f(c,function(t,o){var a,r=i[o.cache];return r&&(a=n[o.cache]||o.to&&o.to(n._rgba)||[],f(o.props,function(t,i){return null!=r[i.idx]?s=r[i.idx]===a[i.idx]:e})),s}),s},_space:function(){var t=[],e=this;return f(c,function(i,s){e[s.cache]&&t.push(i)}),t.pop()},transition:function(t,e){var s=l(t),n=s._space(),o=c[n],a=0===this.alpha()?l("transparent"):this,r=a[o.cache]||o.to(a._rgba),h=r.slice();return s=s[o.cache],f(o.props,function(t,n){var o=n.idx,a=r[o],l=s[o],c=u[n.type]||{};null!==l&&(null===a?h[o]=l:(c.mod&&(l-a>c.mod/2?a+=c.mod:a-l>c.mod/2&&(a-=c.mod)),h[o]=i((l-a)*e+a,n)))}),this[n](h)},blend:function(e){if(1===this._rgba[3])return this;var i=this._rgba.slice(),s=i.pop(),n=l(e)._rgba;return l(t.map(i,function(t,e){return(1-s)*n[e]+s*t}))},toRgbaString:function(){var e="rgba(",i=t.map(this._rgba,function(t,e){return null==t?e>2?1:0:t});return 1===i[3]&&(i.pop(),e="rgb("),e+i.join()+")"},toHslaString:function(){var e="hsla(",i=t.map(this.hsla(),function(t,e){return null==t&&(t=e>2?1:0),e&&3>e&&(t=Math.round(100*t)+"%"),t});return 1===i[3]&&(i.pop(),e="hsl("),e+i.join()+")"},toHexString:function(e){var i=this._rgba.slice(),s=i.pop();return e&&i.push(~~(255*s)),"#"+t.map(i,function(t){return t=(t||0).toString(16),1===t.length?"0"+t:t}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),l.fn.parse.prototype=l.fn,c.hsla.to=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e,i,s=t[0]/255,n=t[1]/255,o=t[2]/255,a=t[3],r=Math.max(s,n,o),h=Math.min(s,n,o),l=r-h,c=r+h,u=.5*c;return e=h===r?0:s===r?60*(n-o)/l+360:n===r?60*(o-s)/l+120:60*(s-n)/l+240,i=0===l?0:.5>=u?l/c:l/(2-c),[Math.round(e)%360,i,u,null==a?1:a]},c.hsla.from=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e=t[0]/360,i=t[1],s=t[2],o=t[3],a=.5>=s?s*(1+i):s+i-s*i,r=2*s-a;return[Math.round(255*n(r,a,e+1/3)),Math.round(255*n(r,a,e)),Math.round(255*n(r,a,e-1/3)),o]},f(c,function(s,n){var o=n.props,a=n.cache,h=n.to,c=n.from;l.fn[s]=function(s){if(h&&!this[a]&&(this[a]=h(this._rgba)),s===e)return this[a].slice();var n,r=t.type(s),u="array"===r||"object"===r?s:arguments,d=this[a].slice();return f(o,function(t,e){var s=u["object"===r?t:e.idx];null==s&&(s=d[e.idx]),d[e.idx]=i(s,e)}),c?(n=l(c(d)),n[a]=d,n):l(d)},f(o,function(e,i){l.fn[e]||(l.fn[e]=function(n){var o,a=t.type(n),h="alpha"===e?this._hsla?"hsla":"rgba":s,l=this[h](),c=l[i.idx];return"undefined"===a?c:("function"===a&&(n=n.call(this,c),a=t.type(n)),null==n&&i.empty?this:("string"===a&&(o=r.exec(n),o&&(n=c+parseFloat(o[2])*("+"===o[1]?1:-1))),l[i.idx]=n,this[h](l)))})})}),l.hook=function(e){var i=e.split(" ");f(i,function(e,i){t.cssHooks[i]={set:function(e,n){var o,a,r="";if("transparent"!==n&&("string"!==t.type(n)||(o=s(n)))){if(n=l(o||n),!d.rgba&&1!==n._rgba[3]){for(a="backgroundColor"===i?e.parentNode:e;(""===r||"transparent"===r)&&a&&a.style;)try{r=t.css(a,"backgroundColor"),a=a.parentNode}catch(h){}n=n.blend(r&&"transparent"!==r?r:"_default")}n=n.toRgbaString()}try{e.style[i]=n}catch(h){}}},t.fx.step[i]=function(e){e.colorInit||(e.start=l(e.elem,i),e.end=l(e.end),e.colorInit=!0),t.cssHooks[i].set(e.elem,e.start.transition(e.end,e.pos))}})},l.hook(a),t.cssHooks.borderColor={expand:function(t){var e={};return f(["Top","Right","Bottom","Left"],function(i,s){e["border"+s+"Color"]=t}),e}},o=t.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(p),function(){function e(e){var i,s,n=e.ownerDocument.defaultView?e.ownerDocument.defaultView.getComputedStyle(e,null):e.currentStyle,o={};if(n&&n.length&&n[0]&&n[n[0]])for(s=n.length;s--;)i=n[s],"string"==typeof n[i]&&(o[t.camelCase(i)]=n[i]);else for(i in n)"string"==typeof n[i]&&(o[i]=n[i]);return o}function i(e,i){var s,o,a={};for(s in i)o=i[s],e[s]!==o&&(n[s]||(t.fx.step[s]||!isNaN(parseFloat(o)))&&(a[s]=o));return a}var s=["add","remove","toggle"],n={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};t.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(e,i){t.fx.step[i]=function(t){("none"!==t.end&&!t.setAttr||1===t.pos&&!t.setAttr)&&(p.style(t.elem,i,t.end),t.setAttr=!0)}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t.effects.animateClass=function(n,o,a,r){var h=t.speed(o,a,r);return this.queue(function(){var o,a=t(this),r=a.attr("class")||"",l=h.children?a.find("*").addBack():a;l=l.map(function(){var i=t(this);return{el:i,start:e(this)}}),o=function(){t.each(s,function(t,e){n[e]&&a[e+"Class"](n[e])})},o(),l=l.map(function(){return this.end=e(this.el[0]),this.diff=i(this.start,this.end),this}),a.attr("class",r),l=l.map(function(){var e=this,i=t.Deferred(),s=t.extend({},h,{queue:!1,complete:function(){i.resolve(e)}});return this.el.animate(this.diff,s),i.promise()}),t.when.apply(t,l.get()).done(function(){o(),t.each(arguments,function(){var e=this.el;t.each(this.diff,function(t){e.css(t,"")})}),h.complete.call(a[0])})})},t.fn.extend({addClass:function(e){return function(i,s,n,o){return s?t.effects.animateClass.call(this,{add:i},s,n,o):e.apply(this,arguments)}}(t.fn.addClass),removeClass:function(e){return function(i,s,n,o){return arguments.length>1?t.effects.animateClass.call(this,{remove:i},s,n,o):e.apply(this,arguments)}}(t.fn.removeClass),toggleClass:function(e){return function(i,s,n,o,a){return"boolean"==typeof s||void 0===s?n?t.effects.animateClass.call(this,s?{add:i}:{remove:i},n,o,a):e.apply(this,arguments):t.effects.animateClass.call(this,{toggle:i},s,n,o)}}(t.fn.toggleClass),switchClass:function(e,i,s,n,o){return t.effects.animateClass.call(this,{add:i,remove:e},s,n,o)}})}(),function(){function e(e,i,s,n){return t.isPlainObject(e)&&(i=e,e=e.effect),e={effect:e},null==i&&(i={}),t.isFunction(i)&&(n=i,s=null,i={}),("number"==typeof i||t.fx.speeds[i])&&(n=s,s=i,i={}),t.isFunction(s)&&(n=s,s=null),i&&t.extend(e,i),s=s||i.duration,e.duration=t.fx.off?0:"number"==typeof s?s:s in t.fx.speeds?t.fx.speeds[s]:t.fx.speeds._default,e.complete=n||i.complete,e}function i(e){return!e||"number"==typeof e||t.fx.speeds[e]?!0:"string"!=typeof e||t.effects.effect[e]?t.isFunction(e)?!0:"object"!=typeof e||e.effect?!1:!0:!0}function s(t,e){var i=e.outerWidth(),s=e.outerHeight(),n=/^rect\((-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto)\)$/,o=n.exec(t)||["",0,i,s,0];return{top:parseFloat(o[1])||0,right:"auto"===o[2]?i:parseFloat(o[2]),bottom:"auto"===o[3]?s:parseFloat(o[3]),left:parseFloat(o[4])||0}}t.expr&&t.expr.filters&&t.expr.filters.animated&&(t.expr.filters.animated=function(e){return function(i){return!!t(i).data(d)||e(i)}}(t.expr.filters.animated)),t.uiBackCompat!==!1&&t.extend(t.effects,{save:function(t,e){for(var i=0,s=e.length;s>i;i++)null!==e[i]&&t.data(c+e[i],t[0].style[e[i]])},restore:function(t,e){for(var i,s=0,n=e.length;n>s;s++)null!==e[s]&&(i=t.data(c+e[s]),t.css(e[s],i))},setMode:function(t,e){return"toggle"===e&&(e=t.is(":hidden")?"show":"hide"),e},createWrapper:function(e){if(e.parent().is(".ui-effects-wrapper"))return e.parent();var i={width:e.outerWidth(!0),height:e.outerHeight(!0),"float":e.css("float")},s=t("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),n={width:e.width(),height:e.height()},o=document.activeElement;try{o.id}catch(a){o=document.body}return e.wrap(s),(e[0]===o||t.contains(e[0],o))&&t(o).trigger("focus"),s=e.parent(),"static"===e.css("position")?(s.css({position:"relative"}),e.css({position:"relative"})):(t.extend(i,{position:e.css("position"),zIndex:e.css("z-index")}),t.each(["top","left","bottom","right"],function(t,s){i[s]=e.css(s),isNaN(parseInt(i[s],10))&&(i[s]="auto")}),e.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),e.css(n),s.css(i).show()},removeWrapper:function(e){var i=document.activeElement;return e.parent().is(".ui-effects-wrapper")&&(e.parent().replaceWith(e),(e[0]===i||t.contains(e[0],i))&&t(i).trigger("focus")),e}}),t.extend(t.effects,{version:"1.12.1",define:function(e,i,s){return s||(s=i,i="effect"),t.effects.effect[e]=s,t.effects.effect[e].mode=i,s},scaledDimensions:function(t,e,i){if(0===e)return{height:0,width:0,outerHeight:0,outerWidth:0};var s="horizontal"!==i?(e||100)/100:1,n="vertical"!==i?(e||100)/100:1;return{height:t.height()*n,width:t.width()*s,outerHeight:t.outerHeight()*n,outerWidth:t.outerWidth()*s}},clipToBox:function(t){return{width:t.clip.right-t.clip.left,height:t.clip.bottom-t.clip.top,left:t.clip.left,top:t.clip.top}},unshift:function(t,e,i){var s=t.queue();e>1&&s.splice.apply(s,[1,0].concat(s.splice(e,i))),t.dequeue()},saveStyle:function(t){t.data(u,t[0].style.cssText)},restoreStyle:function(t){t[0].style.cssText=t.data(u)||"",t.removeData(u)},mode:function(t,e){var i=t.is(":hidden");return"toggle"===e&&(e=i?"show":"hide"),(i?"hide"===e:"show"===e)&&(e="none"),e},getBaseline:function(t,e){var i,s;switch(t[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=t[0]/e.height}switch(t[1]){case"left":s=0;break;case"center":s=.5;break;case"right":s=1;break;default:s=t[1]/e.width}return{x:s,y:i}},createPlaceholder:function(e){var i,s=e.css("position"),n=e.position();return e.css({marginTop:e.css("marginTop"),marginBottom:e.css("marginBottom"),marginLeft:e.css("marginLeft"),marginRight:e.css("marginRight")}).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()),/^(static|relative)/.test(s)&&(s="absolute",i=t("<"+e[0].nodeName+">").insertAfter(e).css({display:/^(inline|ruby)/.test(e.css("display"))?"inline-block":"block",visibility:"hidden",marginTop:e.css("marginTop"),marginBottom:e.css("marginBottom"),marginLeft:e.css("marginLeft"),marginRight:e.css("marginRight"),"float":e.css("float")}).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).addClass("ui-effects-placeholder"),e.data(c+"placeholder",i)),e.css({position:s,left:n.left,top:n.top}),i},removePlaceholder:function(t){var e=c+"placeholder",i=t.data(e);i&&(i.remove(),t.removeData(e))},cleanUp:function(e){t.effects.restoreStyle(e),t.effects.removePlaceholder(e)},setTransition:function(e,i,s,n){return n=n||{},t.each(i,function(t,i){var o=e.cssUnit(i);o[0]>0&&(n[i]=o[0]*s+o[1])}),n}}),t.fn.extend({effect:function(){function i(e){function i(){r.removeData(d),t.effects.cleanUp(r),"hide"===s.mode&&r.hide(),a()}function a(){t.isFunction(h)&&h.call(r[0]),t.isFunction(e)&&e()}var r=t(this);s.mode=c.shift(),t.uiBackCompat===!1||o?"none"===s.mode?(r[l](),a()):n.call(r[0],s,i):(r.is(":hidden")?"hide"===l:"show"===l)?(r[l](),a()):n.call(r[0],s,a)}var s=e.apply(this,arguments),n=t.effects.effect[s.effect],o=n.mode,a=s.queue,r=a||"fx",h=s.complete,l=s.mode,c=[],u=function(e){var i=t(this),s=t.effects.mode(i,l)||o;i.data(d,!0),c.push(s),o&&("show"===s||s===o&&"hide"===s)&&i.show(),o&&"none"===s||t.effects.saveStyle(i),t.isFunction(e)&&e()};return t.fx.off||!n?l?this[l](s.duration,h):this.each(function(){h&&h.call(this)}):a===!1?this.each(u).each(i):this.queue(r,u).queue(r,i)},show:function(t){return function(s){if(i(s))return t.apply(this,arguments);var n=e.apply(this,arguments);return n.mode="show",this.effect.call(this,n)
}}(t.fn.show),hide:function(t){return function(s){if(i(s))return t.apply(this,arguments);var n=e.apply(this,arguments);return n.mode="hide",this.effect.call(this,n)}}(t.fn.hide),toggle:function(t){return function(s){if(i(s)||"boolean"==typeof s)return t.apply(this,arguments);var n=e.apply(this,arguments);return n.mode="toggle",this.effect.call(this,n)}}(t.fn.toggle),cssUnit:function(e){var i=this.css(e),s=[];return t.each(["em","px","%","pt"],function(t,e){i.indexOf(e)>0&&(s=[parseFloat(i),e])}),s},cssClip:function(t){return t?this.css("clip","rect("+t.top+"px "+t.right+"px "+t.bottom+"px "+t.left+"px)"):s(this.css("clip"),this)},transfer:function(e,i){var s=t(this),n=t(e.to),o="fixed"===n.css("position"),a=t("body"),r=o?a.scrollTop():0,h=o?a.scrollLeft():0,l=n.offset(),c={top:l.top-r,left:l.left-h,height:n.innerHeight(),width:n.innerWidth()},u=s.offset(),d=t("<div class='ui-effects-transfer'></div>").appendTo("body").addClass(e.className).css({top:u.top-r,left:u.left-h,height:s.innerHeight(),width:s.innerWidth(),position:o?"fixed":"absolute"}).animate(c,e.duration,e.easing,function(){d.remove(),t.isFunction(i)&&i()})}}),t.fx.step.clip=function(e){e.clipInit||(e.start=t(e.elem).cssClip(),"string"==typeof e.end&&(e.end=s(e.end,e.elem)),e.clipInit=!0),t(e.elem).cssClip({top:e.pos*(e.end.top-e.start.top)+e.start.top,right:e.pos*(e.end.right-e.start.right)+e.start.right,bottom:e.pos*(e.end.bottom-e.start.bottom)+e.start.bottom,left:e.pos*(e.end.left-e.start.left)+e.start.left})}}(),function(){var e={};t.each(["Quad","Cubic","Quart","Quint","Expo"],function(t,i){e[i]=function(e){return Math.pow(e,t+2)}}),t.extend(e,{Sine:function(t){return 1-Math.cos(t*Math.PI/2)},Circ:function(t){return 1-Math.sqrt(1-t*t)},Elastic:function(t){return 0===t||1===t?t:-Math.pow(2,8*(t-1))*Math.sin((80*(t-1)-7.5)*Math.PI/15)},Back:function(t){return t*t*(3*t-2)},Bounce:function(t){for(var e,i=4;((e=Math.pow(2,--i))-1)/11>t;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*e-2)/22-t,2)}}),t.each(e,function(e,i){t.easing["easeIn"+e]=i,t.easing["easeOut"+e]=function(t){return 1-i(1-t)},t.easing["easeInOut"+e]=function(t){return.5>t?i(2*t)/2:1-i(-2*t+2)/2}})}();var f=t.effects;t.effects.define("blind","hide",function(e,i){var s={up:["bottom","top"],vertical:["bottom","top"],down:["top","bottom"],left:["right","left"],horizontal:["right","left"],right:["left","right"]},n=t(this),o=e.direction||"up",a=n.cssClip(),r={clip:t.extend({},a)},h=t.effects.createPlaceholder(n);r.clip[s[o][0]]=r.clip[s[o][1]],"show"===e.mode&&(n.cssClip(r.clip),h&&h.css(t.effects.clipToBox(r)),r.clip=a),h&&h.animate(t.effects.clipToBox(r),e.duration,e.easing),n.animate(r,{queue:!1,duration:e.duration,easing:e.easing,complete:i})}),t.effects.define("bounce",function(e,i){var s,n,o,a=t(this),r=e.mode,h="hide"===r,l="show"===r,c=e.direction||"up",u=e.distance,d=e.times||5,p=2*d+(l||h?1:0),f=e.duration/p,g=e.easing,m="up"===c||"down"===c?"top":"left",_="up"===c||"left"===c,v=0,b=a.queue().length;for(t.effects.createPlaceholder(a),o=a.css(m),u||(u=a["top"===m?"outerHeight":"outerWidth"]()/3),l&&(n={opacity:1},n[m]=o,a.css("opacity",0).css(m,_?2*-u:2*u).animate(n,f,g)),h&&(u/=Math.pow(2,d-1)),n={},n[m]=o;d>v;v++)s={},s[m]=(_?"-=":"+=")+u,a.animate(s,f,g).animate(n,f,g),u=h?2*u:u/2;h&&(s={opacity:0},s[m]=(_?"-=":"+=")+u,a.animate(s,f,g)),a.queue(i),t.effects.unshift(a,b,p+1)}),t.effects.define("clip","hide",function(e,i){var s,n={},o=t(this),a=e.direction||"vertical",r="both"===a,h=r||"horizontal"===a,l=r||"vertical"===a;s=o.cssClip(),n.clip={top:l?(s.bottom-s.top)/2:s.top,right:h?(s.right-s.left)/2:s.right,bottom:l?(s.bottom-s.top)/2:s.bottom,left:h?(s.right-s.left)/2:s.left},t.effects.createPlaceholder(o),"show"===e.mode&&(o.cssClip(n.clip),n.clip=s),o.animate(n,{queue:!1,duration:e.duration,easing:e.easing,complete:i})}),t.effects.define("drop","hide",function(e,i){var s,n=t(this),o=e.mode,a="show"===o,r=e.direction||"left",h="up"===r||"down"===r?"top":"left",l="up"===r||"left"===r?"-=":"+=",c="+="===l?"-=":"+=",u={opacity:0};t.effects.createPlaceholder(n),s=e.distance||n["top"===h?"outerHeight":"outerWidth"](!0)/2,u[h]=l+s,a&&(n.css(u),u[h]=c+s,u.opacity=1),n.animate(u,{queue:!1,duration:e.duration,easing:e.easing,complete:i})}),t.effects.define("explode","hide",function(e,i){function s(){b.push(this),b.length===u*d&&n()}function n(){p.css({visibility:"visible"}),t(b).remove(),i()}var o,a,r,h,l,c,u=e.pieces?Math.round(Math.sqrt(e.pieces)):3,d=u,p=t(this),f=e.mode,g="show"===f,m=p.show().css("visibility","hidden").offset(),_=Math.ceil(p.outerWidth()/d),v=Math.ceil(p.outerHeight()/u),b=[];for(o=0;u>o;o++)for(h=m.top+o*v,c=o-(u-1)/2,a=0;d>a;a++)r=m.left+a*_,l=a-(d-1)/2,p.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-a*_,top:-o*v}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:_,height:v,left:r+(g?l*_:0),top:h+(g?c*v:0),opacity:g?0:1}).animate({left:r+(g?0:l*_),top:h+(g?0:c*v),opacity:g?1:0},e.duration||500,e.easing,s)}),t.effects.define("fade","toggle",function(e,i){var s="show"===e.mode;t(this).css("opacity",s?0:1).animate({opacity:s?1:0},{queue:!1,duration:e.duration,easing:e.easing,complete:i})}),t.effects.define("fold","hide",function(e,i){var s=t(this),n=e.mode,o="show"===n,a="hide"===n,r=e.size||15,h=/([0-9]+)%/.exec(r),l=!!e.horizFirst,c=l?["right","bottom"]:["bottom","right"],u=e.duration/2,d=t.effects.createPlaceholder(s),p=s.cssClip(),f={clip:t.extend({},p)},g={clip:t.extend({},p)},m=[p[c[0]],p[c[1]]],_=s.queue().length;h&&(r=parseInt(h[1],10)/100*m[a?0:1]),f.clip[c[0]]=r,g.clip[c[0]]=r,g.clip[c[1]]=0,o&&(s.cssClip(g.clip),d&&d.css(t.effects.clipToBox(g)),g.clip=p),s.queue(function(i){d&&d.animate(t.effects.clipToBox(f),u,e.easing).animate(t.effects.clipToBox(g),u,e.easing),i()}).animate(f,u,e.easing).animate(g,u,e.easing).queue(i),t.effects.unshift(s,_,4)}),t.effects.define("highlight","show",function(e,i){var s=t(this),n={backgroundColor:s.css("backgroundColor")};"hide"===e.mode&&(n.opacity=0),t.effects.saveStyle(s),s.css({backgroundImage:"none",backgroundColor:e.color||"#ffff99"}).animate(n,{queue:!1,duration:e.duration,easing:e.easing,complete:i})}),t.effects.define("size",function(e,i){var s,n,o,a=t(this),r=["fontSize"],h=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],l=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],c=e.mode,u="effect"!==c,d=e.scale||"both",p=e.origin||["middle","center"],f=a.css("position"),g=a.position(),m=t.effects.scaledDimensions(a),_=e.from||m,v=e.to||t.effects.scaledDimensions(a,0);t.effects.createPlaceholder(a),"show"===c&&(o=_,_=v,v=o),n={from:{y:_.height/m.height,x:_.width/m.width},to:{y:v.height/m.height,x:v.width/m.width}},("box"===d||"both"===d)&&(n.from.y!==n.to.y&&(_=t.effects.setTransition(a,h,n.from.y,_),v=t.effects.setTransition(a,h,n.to.y,v)),n.from.x!==n.to.x&&(_=t.effects.setTransition(a,l,n.from.x,_),v=t.effects.setTransition(a,l,n.to.x,v))),("content"===d||"both"===d)&&n.from.y!==n.to.y&&(_=t.effects.setTransition(a,r,n.from.y,_),v=t.effects.setTransition(a,r,n.to.y,v)),p&&(s=t.effects.getBaseline(p,m),_.top=(m.outerHeight-_.outerHeight)*s.y+g.top,_.left=(m.outerWidth-_.outerWidth)*s.x+g.left,v.top=(m.outerHeight-v.outerHeight)*s.y+g.top,v.left=(m.outerWidth-v.outerWidth)*s.x+g.left),a.css(_),("content"===d||"both"===d)&&(h=h.concat(["marginTop","marginBottom"]).concat(r),l=l.concat(["marginLeft","marginRight"]),a.find("*[width]").each(function(){var i=t(this),s=t.effects.scaledDimensions(i),o={height:s.height*n.from.y,width:s.width*n.from.x,outerHeight:s.outerHeight*n.from.y,outerWidth:s.outerWidth*n.from.x},a={height:s.height*n.to.y,width:s.width*n.to.x,outerHeight:s.height*n.to.y,outerWidth:s.width*n.to.x};n.from.y!==n.to.y&&(o=t.effects.setTransition(i,h,n.from.y,o),a=t.effects.setTransition(i,h,n.to.y,a)),n.from.x!==n.to.x&&(o=t.effects.setTransition(i,l,n.from.x,o),a=t.effects.setTransition(i,l,n.to.x,a)),u&&t.effects.saveStyle(i),i.css(o),i.animate(a,e.duration,e.easing,function(){u&&t.effects.restoreStyle(i)})})),a.animate(v,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){var e=a.offset();0===v.opacity&&a.css("opacity",_.opacity),u||(a.css("position","static"===f?"relative":f).offset(e),t.effects.saveStyle(a)),i()}})}),t.effects.define("scale",function(e,i){var s=t(this),n=e.mode,o=parseInt(e.percent,10)||(0===parseInt(e.percent,10)?0:"effect"!==n?0:100),a=t.extend(!0,{from:t.effects.scaledDimensions(s),to:t.effects.scaledDimensions(s,o,e.direction||"both"),origin:e.origin||["middle","center"]},e);e.fade&&(a.from.opacity=1,a.to.opacity=0),t.effects.effect.size.call(this,a,i)}),t.effects.define("puff","hide",function(e,i){var s=t.extend(!0,{},e,{fade:!0,percent:parseInt(e.percent,10)||150});t.effects.effect.scale.call(this,s,i)}),t.effects.define("pulsate","show",function(e,i){var s=t(this),n=e.mode,o="show"===n,a="hide"===n,r=o||a,h=2*(e.times||5)+(r?1:0),l=e.duration/h,c=0,u=1,d=s.queue().length;for((o||!s.is(":visible"))&&(s.css("opacity",0).show(),c=1);h>u;u++)s.animate({opacity:c},l,e.easing),c=1-c;s.animate({opacity:c},l,e.easing),s.queue(i),t.effects.unshift(s,d,h+1)}),t.effects.define("shake",function(e,i){var s=1,n=t(this),o=e.direction||"left",a=e.distance||20,r=e.times||3,h=2*r+1,l=Math.round(e.duration/h),c="up"===o||"down"===o?"top":"left",u="up"===o||"left"===o,d={},p={},f={},g=n.queue().length;for(t.effects.createPlaceholder(n),d[c]=(u?"-=":"+=")+a,p[c]=(u?"+=":"-=")+2*a,f[c]=(u?"-=":"+=")+2*a,n.animate(d,l,e.easing);r>s;s++)n.animate(p,l,e.easing).animate(f,l,e.easing);n.animate(p,l,e.easing).animate(d,l/2,e.easing).queue(i),t.effects.unshift(n,g,h+1)}),t.effects.define("slide","show",function(e,i){var s,n,o=t(this),a={up:["bottom","top"],down:["top","bottom"],left:["right","left"],right:["left","right"]},r=e.mode,h=e.direction||"left",l="up"===h||"down"===h?"top":"left",c="up"===h||"left"===h,u=e.distance||o["top"===l?"outerHeight":"outerWidth"](!0),d={};t.effects.createPlaceholder(o),s=o.cssClip(),n=o.position()[l],d[l]=(c?-1:1)*u+n,d.clip=o.cssClip(),d.clip[a[h][1]]=d.clip[a[h][0]],"show"===r&&(o.cssClip(d.clip),o.css(l,d[l]),d.clip=s,d[l]=n),o.animate(d,{queue:!1,duration:e.duration,easing:e.easing,complete:i})});var f;t.uiBackCompat!==!1&&(f=t.effects.define("transfer",function(e,i){t(this).transfer(e,i)})),t.ui.focusable=function(i,s){var n,o,a,r,h,l=i.nodeName.toLowerCase();return"area"===l?(n=i.parentNode,o=n.name,i.href&&o&&"map"===n.nodeName.toLowerCase()?(a=t("img[usemap='#"+o+"']"),a.length>0&&a.is(":visible")):!1):(/^(input|select|textarea|button|object)$/.test(l)?(r=!i.disabled,r&&(h=t(i).closest("fieldset")[0],h&&(r=!h.disabled))):r="a"===l?i.href||s:s,r&&t(i).is(":visible")&&e(t(i)))},t.extend(t.expr[":"],{focusable:function(e){return t.ui.focusable(e,null!=t.attr(e,"tabindex"))}}),t.ui.focusable,t.fn.form=function(){return"string"==typeof this[0].form?this.closest("form"):t(this[0].form)},t.ui.formResetMixin={_formResetHandler:function(){var e=t(this);setTimeout(function(){var i=e.data("ui-form-reset-instances");t.each(i,function(){this.refresh()})})},_bindFormResetHandler:function(){if(this.form=this.element.form(),this.form.length){var t=this.form.data("ui-form-reset-instances")||[];t.length||this.form.on("reset.ui-form-reset",this._formResetHandler),t.push(this),this.form.data("ui-form-reset-instances",t)}},_unbindFormResetHandler:function(){if(this.form.length){var e=this.form.data("ui-form-reset-instances");e.splice(t.inArray(this,e),1),e.length?this.form.data("ui-form-reset-instances",e):this.form.removeData("ui-form-reset-instances").off("reset.ui-form-reset")}}},"1.7"===t.fn.jquery.substring(0,3)&&(t.each(["Width","Height"],function(e,i){function s(e,i,s,o){return t.each(n,function(){i-=parseFloat(t.css(e,"padding"+this))||0,s&&(i-=parseFloat(t.css(e,"border"+this+"Width"))||0),o&&(i-=parseFloat(t.css(e,"margin"+this))||0)}),i}var n="Width"===i?["Left","Right"]:["Top","Bottom"],o=i.toLowerCase(),a={innerWidth:t.fn.innerWidth,innerHeight:t.fn.innerHeight,outerWidth:t.fn.outerWidth,outerHeight:t.fn.outerHeight};t.fn["inner"+i]=function(e){return void 0===e?a["inner"+i].call(this):this.each(function(){t(this).css(o,s(this,e)+"px")})},t.fn["outer"+i]=function(e,n){return"number"!=typeof e?a["outer"+i].call(this,e):this.each(function(){t(this).css(o,s(this,e,!0,n)+"px")})}}),t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},t.ui.escapeSelector=function(){var t=/([!"#$%&'()*+,.\/:;<=>?@[\]^`{|}~])/g;return function(e){return e.replace(t,"\\$1")}}(),t.fn.labels=function(){var e,i,s,n,o;return this[0].labels&&this[0].labels.length?this.pushStack(this[0].labels):(n=this.eq(0).parents("label"),s=this.attr("id"),s&&(e=this.eq(0).parents().last(),o=e.add(e.length?e.siblings():this.siblings()),i="label[for='"+t.ui.escapeSelector(s)+"']",n=n.add(o.find(i).addBack(i))),this.pushStack(n))},t.fn.scrollParent=function(e){var i=this.css("position"),s="absolute"===i,n=e?/(auto|scroll|hidden)/:/(auto|scroll)/,o=this.parents().filter(function(){var e=t(this);return s&&"static"===e.css("position")?!1:n.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))}).eq(0);return"fixed"!==i&&o.length?o:t(this[0].ownerDocument||document)},t.extend(t.expr[":"],{tabbable:function(e){var i=t.attr(e,"tabindex"),s=null!=i;return(!s||i>=0)&&t.ui.focusable(e,s)}}),t.fn.extend({uniqueId:function(){var t=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++t)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&t(this).removeAttr("id")})}}),t.widget("ui.accordion",{version:"1.12.1",options:{active:0,animate:{},classes:{"ui-accordion-header":"ui-corner-top","ui-accordion-header-collapsed":"ui-corner-all","ui-accordion-content":"ui-corner-bottom"},collapsible:!1,event:"click",header:"> li > :first-child, > :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var e=this.options;this.prevShow=this.prevHide=t(),this._addClass("ui-accordion","ui-widget ui-helper-reset"),this.element.attr("role","tablist"),e.collapsible||e.active!==!1&&null!=e.active||(e.active=0),this._processPanels(),0>e.active&&(e.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():t()}},_createIcons:function(){var e,i,s=this.options.icons;s&&(e=t("<span>"),this._addClass(e,"ui-accordion-header-icon","ui-icon "+s.header),e.prependTo(this.headers),i=this.active.children(".ui-accordion-header-icon"),this._removeClass(i,s.header)._addClass(i,null,s.activeHeader)._addClass(this.headers,"ui-accordion-icons"))},_destroyIcons:function(){this._removeClass(this.headers,"ui-accordion-icons"),this.headers.children(".ui-accordion-header-icon").remove()},_destroy:function(){var t;this.element.removeAttr("role"),this.headers.removeAttr("role aria-expanded aria-selected aria-controls tabIndex").removeUniqueId(),this._destroyIcons(),t=this.headers.next().css("display","").removeAttr("role aria-hidden aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&t.css("height","")},_setOption:function(t,e){return"active"===t?(this._activate(e),void 0):("event"===t&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(e)),this._super(t,e),"collapsible"!==t||e||this.options.active!==!1||this._activate(0),"icons"===t&&(this._destroyIcons(),e&&this._createIcons()),void 0)},_setOptionDisabled:function(t){this._super(t),this.element.attr("aria-disabled",t),this._toggleClass(null,"ui-state-disabled",!!t),this._toggleClass(this.headers.add(this.headers.next()),null,"ui-state-disabled",!!t)},_keydown:function(e){if(!e.altKey&&!e.ctrlKey){var i=t.ui.keyCode,s=this.headers.length,n=this.headers.index(e.target),o=!1;switch(e.keyCode){case i.RIGHT:case i.DOWN:o=this.headers[(n+1)%s];break;case i.LEFT:case i.UP:o=this.headers[(n-1+s)%s];break;case i.SPACE:case i.ENTER:this._eventHandler(e);break;case i.HOME:o=this.headers[0];break;case i.END:o=this.headers[s-1]}o&&(t(e.target).attr("tabIndex",-1),t(o).attr("tabIndex",0),t(o).trigger("focus"),e.preventDefault())}},_panelKeyDown:function(e){e.keyCode===t.ui.keyCode.UP&&e.ctrlKey&&t(e.currentTarget).prev().trigger("focus")},refresh:function(){var e=this.options;this._processPanels(),e.active===!1&&e.collapsible===!0||!this.headers.length?(e.active=!1,this.active=t()):e.active===!1?this._activate(0):this.active.length&&!t.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(e.active=!1,this.active=t()):this._activate(Math.max(0,e.active-1)):e.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){var t=this.headers,e=this.panels;this.headers=this.element.find(this.options.header),this._addClass(this.headers,"ui-accordion-header ui-accordion-header-collapsed","ui-state-default"),this.panels=this.headers.next().filter(":not(.ui-accordion-content-active)").hide(),this._addClass(this.panels,"ui-accordion-content","ui-helper-reset ui-widget-content"),e&&(this._off(t.not(this.headers)),this._off(e.not(this.panels)))},_refresh:function(){var e,i=this.options,s=i.heightStyle,n=this.element.parent();this.active=this._findActive(i.active),this._addClass(this.active,"ui-accordion-header-active","ui-state-active")._removeClass(this.active,"ui-accordion-header-collapsed"),this._addClass(this.active.next(),"ui-accordion-content-active"),this.active.next().show(),this.headers.attr("role","tab").each(function(){var e=t(this),i=e.uniqueId().attr("id"),s=e.next(),n=s.uniqueId().attr("id");e.attr("aria-controls",n),s.attr("aria-labelledby",i)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(i.event),"fill"===s?(e=n.height(),this.element.siblings(":visible").each(function(){var i=t(this),s=i.css("position");"absolute"!==s&&"fixed"!==s&&(e-=i.outerHeight(!0))}),this.headers.each(function(){e-=t(this).outerHeight(!0)}),this.headers.next().each(function(){t(this).height(Math.max(0,e-t(this).innerHeight()+t(this).height()))}).css("overflow","auto")):"auto"===s&&(e=0,this.headers.next().each(function(){var i=t(this).is(":visible");i||t(this).show(),e=Math.max(e,t(this).css("height","").height()),i||t(this).hide()}).height(e))},_activate:function(e){var i=this._findActive(e)[0];i!==this.active[0]&&(i=i||this.active[0],this._eventHandler({target:i,currentTarget:i,preventDefault:t.noop}))},_findActive:function(e){return"number"==typeof e?this.headers.eq(e):t()},_setupEvents:function(e){var i={keydown:"_keydown"};e&&t.each(e.split(" "),function(t,e){i[e]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,i),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(e){var i,s,n=this.options,o=this.active,a=t(e.currentTarget),r=a[0]===o[0],h=r&&n.collapsible,l=h?t():a.next(),c=o.next(),u={oldHeader:o,oldPanel:c,newHeader:h?t():a,newPanel:l};e.preventDefault(),r&&!n.collapsible||this._trigger("beforeActivate",e,u)===!1||(n.active=h?!1:this.headers.index(a),this.active=r?t():a,this._toggle(u),this._removeClass(o,"ui-accordion-header-active","ui-state-active"),n.icons&&(i=o.children(".ui-accordion-header-icon"),this._removeClass(i,null,n.icons.activeHeader)._addClass(i,null,n.icons.header)),r||(this._removeClass(a,"ui-accordion-header-collapsed")._addClass(a,"ui-accordion-header-active","ui-state-active"),n.icons&&(s=a.children(".ui-accordion-header-icon"),this._removeClass(s,null,n.icons.header)._addClass(s,null,n.icons.activeHeader)),this._addClass(a.next(),"ui-accordion-content-active")))},_toggle:function(e){var i=e.newPanel,s=this.prevShow.length?this.prevShow:e.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=i,this.prevHide=s,this.options.animate?this._animate(i,s,e):(s.hide(),i.show(),this._toggleComplete(e)),s.attr({"aria-hidden":"true"}),s.prev().attr({"aria-selected":"false","aria-expanded":"false"}),i.length&&s.length?s.prev().attr({tabIndex:-1,"aria-expanded":"false"}):i.length&&this.headers.filter(function(){return 0===parseInt(t(this).attr("tabIndex"),10)}).attr("tabIndex",-1),i.attr("aria-hidden","false").prev().attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_animate:function(t,e,i){var s,n,o,a=this,r=0,h=t.css("box-sizing"),l=t.length&&(!e.length||t.index()<e.index()),c=this.options.animate||{},u=l&&c.down||c,d=function(){a._toggleComplete(i)};return"number"==typeof u&&(o=u),"string"==typeof u&&(n=u),n=n||u.easing||c.easing,o=o||u.duration||c.duration,e.length?t.length?(s=t.show().outerHeight(),e.animate(this.hideProps,{duration:o,easing:n,step:function(t,e){e.now=Math.round(t)}}),t.hide().animate(this.showProps,{duration:o,easing:n,complete:d,step:function(t,i){i.now=Math.round(t),"height"!==i.prop?"content-box"===h&&(r+=i.now):"content"!==a.options.heightStyle&&(i.now=Math.round(s-e.outerHeight()-r),r=0)}}),void 0):e.animate(this.hideProps,o,n,d):t.animate(this.showProps,o,n,d)},_toggleComplete:function(t){var e=t.oldPanel,i=e.prev();this._removeClass(e,"ui-accordion-content-active"),this._removeClass(i,"ui-accordion-header-active")._addClass(i,"ui-accordion-header-collapsed"),e.length&&(e.parent()[0].className=e.parent()[0].className),this._trigger("activate",null,t)}}),t.ui.safeActiveElement=function(t){var e;try{e=t.activeElement}catch(i){e=t.body}return e||(e=t.body),e.nodeName||(e=t.body),e},t.widget("ui.menu",{version:"1.12.1",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-caret-1-e"},items:"> *",menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().attr({role:this.options.role,tabIndex:0}),this._addClass("ui-menu","ui-widget ui-widget-content"),this._on({"mousedown .ui-menu-item":function(t){t.preventDefault()},"click .ui-menu-item":function(e){var i=t(e.target),s=t(t.ui.safeActiveElement(this.document[0]));!this.mouseHandled&&i.not(".ui-state-disabled").length&&(this.select(e),e.isPropagationStopped()||(this.mouseHandled=!0),i.has(".ui-menu").length?this.expand(e):!this.element.is(":focus")&&s.closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(e){if(!this.previousFilter){var i=t(e.target).closest(".ui-menu-item"),s=t(e.currentTarget);i[0]===s[0]&&(this._removeClass(s.siblings().children(".ui-state-active"),null,"ui-state-active"),this.focus(e,s))}},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(t,e){var i=this.active||this.element.find(this.options.items).eq(0);e||this.focus(t,i)},blur:function(e){this._delay(function(){var i=!t.contains(this.element[0],t.ui.safeActiveElement(this.document[0]));i&&this.collapseAll(e)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(t){this._closeOnDocumentClick(t)&&this.collapseAll(t),this.mouseHandled=!1}})},_destroy:function(){var e=this.element.find(".ui-menu-item").removeAttr("role aria-disabled"),i=e.children(".ui-menu-item-wrapper").removeUniqueId().removeAttr("tabIndex role aria-haspopup");this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeAttr("role aria-labelledby aria-expanded aria-hidden aria-disabled tabIndex").removeUniqueId().show(),i.children().each(function(){var e=t(this);e.data("ui-menu-submenu-caret")&&e.remove()})},_keydown:function(e){var i,s,n,o,a=!0;switch(e.keyCode){case t.ui.keyCode.PAGE_UP:this.previousPage(e);break;case t.ui.keyCode.PAGE_DOWN:this.nextPage(e);break;case t.ui.keyCode.HOME:this._move("first","first",e);break;case t.ui.keyCode.END:this._move("last","last",e);break;case t.ui.keyCode.UP:this.previous(e);break;case t.ui.keyCode.DOWN:this.next(e);break;case t.ui.keyCode.LEFT:this.collapse(e);break;case t.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(e);break;case t.ui.keyCode.ENTER:case t.ui.keyCode.SPACE:this._activate(e);break;case t.ui.keyCode.ESCAPE:this.collapse(e);break;default:a=!1,s=this.previousFilter||"",o=!1,n=e.keyCode>=96&&105>=e.keyCode?""+(e.keyCode-96):String.fromCharCode(e.keyCode),clearTimeout(this.filterTimer),n===s?o=!0:n=s+n,i=this._filterMenuItems(n),i=o&&-1!==i.index(this.active.next())?this.active.nextAll(".ui-menu-item"):i,i.length||(n=String.fromCharCode(e.keyCode),i=this._filterMenuItems(n)),i.length?(this.focus(e,i),this.previousFilter=n,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}a&&e.preventDefault()},_activate:function(t){this.active&&!this.active.is(".ui-state-disabled")&&(this.active.children("[aria-haspopup='true']").length?this.expand(t):this.select(t))},refresh:function(){var e,i,s,n,o,a=this,r=this.options.icons.submenu,h=this.element.find(this.options.menus);this._toggleClass("ui-menu-icons",null,!!this.element.find(".ui-icon").length),s=h.filter(":not(.ui-menu)").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var e=t(this),i=e.prev(),s=t("<span>").data("ui-menu-submenu-caret",!0);a._addClass(s,"ui-menu-icon","ui-icon "+r),i.attr("aria-haspopup","true").prepend(s),e.attr("aria-labelledby",i.attr("id"))}),this._addClass(s,"ui-menu","ui-widget ui-widget-content ui-front"),e=h.add(this.element),i=e.find(this.options.items),i.not(".ui-menu-item").each(function(){var e=t(this);a._isDivider(e)&&a._addClass(e,"ui-menu-divider","ui-widget-content")}),n=i.not(".ui-menu-item, .ui-menu-divider"),o=n.children().not(".ui-menu").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),this._addClass(n,"ui-menu-item")._addClass(o,"ui-menu-item-wrapper"),i.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!t.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(t,e){if("icons"===t){var i=this.element.find(".ui-menu-icon");this._removeClass(i,null,this.options.icons.submenu)._addClass(i,null,e.submenu)}this._super(t,e)},_setOptionDisabled:function(t){this._super(t),this.element.attr("aria-disabled",t+""),this._toggleClass(null,"ui-state-disabled",!!t)},focus:function(t,e){var i,s,n;this.blur(t,t&&"focus"===t.type),this._scrollIntoView(e),this.active=e.first(),s=this.active.children(".ui-menu-item-wrapper"),this._addClass(s,null,"ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",s.attr("id")),n=this.active.parent().closest(".ui-menu-item").children(".ui-menu-item-wrapper"),this._addClass(n,null,"ui-state-active"),t&&"keydown"===t.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),i=e.children(".ui-menu"),i.length&&t&&/^mouse/.test(t.type)&&this._startOpening(i),this.activeMenu=e.parent(),this._trigger("focus",t,{item:e})},_scrollIntoView:function(e){var i,s,n,o,a,r;this._hasScroll()&&(i=parseFloat(t.css(this.activeMenu[0],"borderTopWidth"))||0,s=parseFloat(t.css(this.activeMenu[0],"paddingTop"))||0,n=e.offset().top-this.activeMenu.offset().top-i-s,o=this.activeMenu.scrollTop(),a=this.activeMenu.height(),r=e.outerHeight(),0>n?this.activeMenu.scrollTop(o+n):n+r>a&&this.activeMenu.scrollTop(o+n-a+r))},blur:function(t,e){e||clearTimeout(this.timer),this.active&&(this._removeClass(this.active.children(".ui-menu-item-wrapper"),null,"ui-state-active"),this._trigger("blur",t,{item:this.active}),this.active=null)},_startOpening:function(t){clearTimeout(this.timer),"true"===t.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(t)},this.delay))},_open:function(e){var i=t.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(e.parents(".ui-menu")).hide().attr("aria-hidden","true"),e.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(i)},collapseAll:function(e,i){clearTimeout(this.timer),this.timer=this._delay(function(){var s=i?this.element:t(e&&e.target).closest(this.element.find(".ui-menu"));s.length||(s=this.element),this._close(s),this.blur(e),this._removeClass(s.find(".ui-state-active"),null,"ui-state-active"),this.activeMenu=s},this.delay)},_close:function(t){t||(t=this.active?this.active.parent():this.element),t.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false")},_closeOnDocumentClick:function(e){return!t(e.target).closest(".ui-menu").length},_isDivider:function(t){return!/[^\-\u2014\u2013\s]/.test(t.text())},collapse:function(t){var e=this.active&&this.active.parent().closest(".ui-menu-item",this.element);e&&e.length&&(this._close(),this.focus(t,e))},expand:function(t){var e=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();e&&e.length&&(this._open(e.parent()),this._delay(function(){this.focus(t,e)}))},next:function(t){this._move("next","first",t)},previous:function(t){this._move("prev","last",t)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(t,e,i){var s;this.active&&(s="first"===t||"last"===t?this.active["first"===t?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[t+"All"](".ui-menu-item").eq(0)),s&&s.length&&this.active||(s=this.activeMenu.find(this.options.items)[e]()),this.focus(i,s)},nextPage:function(e){var i,s,n;return this.active?(this.isLastItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return i=t(this),0>i.offset().top-s-n}),this.focus(e,i)):this.focus(e,this.activeMenu.find(this.options.items)[this.active?"last":"first"]())),void 0):(this.next(e),void 0)},previousPage:function(e){var i,s,n;return this.active?(this.isFirstItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return i=t(this),i.offset().top-s+n>0}),this.focus(e,i)):this.focus(e,this.activeMenu.find(this.options.items).first())),void 0):(this.next(e),void 0)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(e){this.active=this.active||t(e.target).closest(".ui-menu-item");var i={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(e,!0),this._trigger("select",e,i)},_filterMenuItems:function(e){var i=e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),s=RegExp("^"+i,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return s.test(t.trim(t(this).children(".ui-menu-item-wrapper").text()))})}}),t.widget("ui.autocomplete",{version:"1.12.1",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var e,i,s,n=this.element[0].nodeName.toLowerCase(),o="textarea"===n,a="input"===n;
this.isMultiLine=o||!a&&this._isContentEditable(this.element),this.valueMethod=this.element[o||a?"val":"text"],this.isNewMenu=!0,this._addClass("ui-autocomplete-input"),this.element.attr("autocomplete","off"),this._on(this.element,{keydown:function(n){if(this.element.prop("readOnly"))return e=!0,s=!0,i=!0,void 0;e=!1,s=!1,i=!1;var o=t.ui.keyCode;switch(n.keyCode){case o.PAGE_UP:e=!0,this._move("previousPage",n);break;case o.PAGE_DOWN:e=!0,this._move("nextPage",n);break;case o.UP:e=!0,this._keyEvent("previous",n);break;case o.DOWN:e=!0,this._keyEvent("next",n);break;case o.ENTER:this.menu.active&&(e=!0,n.preventDefault(),this.menu.select(n));break;case o.TAB:this.menu.active&&this.menu.select(n);break;case o.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(n),n.preventDefault());break;default:i=!0,this._searchTimeout(n)}},keypress:function(s){if(e)return e=!1,(!this.isMultiLine||this.menu.element.is(":visible"))&&s.preventDefault(),void 0;if(!i){var n=t.ui.keyCode;switch(s.keyCode){case n.PAGE_UP:this._move("previousPage",s);break;case n.PAGE_DOWN:this._move("nextPage",s);break;case n.UP:this._keyEvent("previous",s);break;case n.DOWN:this._keyEvent("next",s)}}},input:function(t){return s?(s=!1,t.preventDefault(),void 0):(this._searchTimeout(t),void 0)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(t){return this.cancelBlur?(delete this.cancelBlur,void 0):(clearTimeout(this.searching),this.close(t),this._change(t),void 0)}}),this._initSource(),this.menu=t("<ul>").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._addClass(this.menu.element,"ui-autocomplete","ui-front"),this._on(this.menu.element,{mousedown:function(e){e.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,this.element[0]!==t.ui.safeActiveElement(this.document[0])&&this.element.trigger("focus")})},menufocus:function(e,i){var s,n;return this.isNewMenu&&(this.isNewMenu=!1,e.originalEvent&&/^mouse/.test(e.originalEvent.type))?(this.menu.blur(),this.document.one("mousemove",function(){t(e.target).trigger(e.originalEvent)}),void 0):(n=i.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",e,{item:n})&&e.originalEvent&&/^key/.test(e.originalEvent.type)&&this._value(n.value),s=i.item.attr("aria-label")||n.value,s&&t.trim(s).length&&(this.liveRegion.children().hide(),t("<div>").text(s).appendTo(this.liveRegion)),void 0)},menuselect:function(e,i){var s=i.item.data("ui-autocomplete-item"),n=this.previous;this.element[0]!==t.ui.safeActiveElement(this.document[0])&&(this.element.trigger("focus"),this.previous=n,this._delay(function(){this.previous=n,this.selectedItem=s})),!1!==this._trigger("select",e,{item:s})&&this._value(s.value),this.term=this._value(),this.close(e),this.selectedItem=s}}),this.liveRegion=t("<div>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body),this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible"),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(t,e){this._super(t,e),"source"===t&&this._initSource(),"appendTo"===t&&this.menu.element.appendTo(this._appendTo()),"disabled"===t&&e&&this.xhr&&this.xhr.abort()},_isEventTargetInWidget:function(e){var i=this.menu.element[0];return e.target===this.element[0]||e.target===i||t.contains(i,e.target)},_closeOnClickOutside:function(t){this._isEventTargetInWidget(t)||this.close()},_appendTo:function(){var e=this.options.appendTo;return e&&(e=e.jquery||e.nodeType?t(e):this.document.find(e).eq(0)),e&&e[0]||(e=this.element.closest(".ui-front, dialog")),e.length||(e=this.document[0].body),e},_initSource:function(){var e,i,s=this;t.isArray(this.options.source)?(e=this.options.source,this.source=function(i,s){s(t.ui.autocomplete.filter(e,i.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(e,n){s.xhr&&s.xhr.abort(),s.xhr=t.ajax({url:i,data:e,dataType:"json",success:function(t){n(t)},error:function(){n([])}})}):this.source=this.options.source},_searchTimeout:function(t){clearTimeout(this.searching),this.searching=this._delay(function(){var e=this.term===this._value(),i=this.menu.element.is(":visible"),s=t.altKey||t.ctrlKey||t.metaKey||t.shiftKey;(!e||e&&!i&&!s)&&(this.selectedItem=null,this.search(null,t))},this.options.delay)},search:function(t,e){return t=null!=t?t:this._value(),this.term=this._value(),t.length<this.options.minLength?this.close(e):this._trigger("search",e)!==!1?this._search(t):void 0},_search:function(t){this.pending++,this._addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:t},this._response())},_response:function(){var e=++this.requestIndex;return t.proxy(function(t){e===this.requestIndex&&this.__response(t),this.pending--,this.pending||this._removeClass("ui-autocomplete-loading")},this)},__response:function(t){t&&(t=this._normalize(t)),this._trigger("response",null,{content:t}),!this.options.disabled&&t&&t.length&&!this.cancelSearch?(this._suggest(t),this._trigger("open")):this._close()},close:function(t){this.cancelSearch=!0,this._close(t)},_close:function(t){this._off(this.document,"mousedown"),this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",t))},_change:function(t){this.previous!==this._value()&&this._trigger("change",t,{item:this.selectedItem})},_normalize:function(e){return e.length&&e[0].label&&e[0].value?e:t.map(e,function(e){return"string"==typeof e?{label:e,value:e}:t.extend({},e,{label:e.label||e.value,value:e.value||e.label})})},_suggest:function(e){var i=this.menu.element.empty();this._renderMenu(i,e),this.isNewMenu=!0,this.menu.refresh(),i.show(),this._resizeMenu(),i.position(t.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next(),this._on(this.document,{mousedown:"_closeOnClickOutside"})},_resizeMenu:function(){var t=this.menu.element;t.outerWidth(Math.max(t.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(e,i){var s=this;t.each(i,function(t,i){s._renderItemData(e,i)})},_renderItemData:function(t,e){return this._renderItem(t,e).data("ui-autocomplete-item",e)},_renderItem:function(e,i){return t("<li>").append(t("<div>").text(i.label)).appendTo(e)},_move:function(t,e){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(t)||this.menu.isLastItem()&&/^next/.test(t)?(this.isMultiLine||this._value(this.term),this.menu.blur(),void 0):(this.menu[t](e),void 0):(this.search(null,e),void 0)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(t,e){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(t,e),e.preventDefault())},_isContentEditable:function(t){if(!t.length)return!1;var e=t.prop("contentEditable");return"inherit"===e?this._isContentEditable(t.parent()):"true"===e}}),t.extend(t.ui.autocomplete,{escapeRegex:function(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(e,i){var s=RegExp(t.ui.autocomplete.escapeRegex(i),"i");return t.grep(e,function(t){return s.test(t.label||t.value||t)})}}),t.widget("ui.autocomplete",t.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(t){return t+(t>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(e){var i;this._superApply(arguments),this.options.disabled||this.cancelSearch||(i=e&&e.length?this.options.messages.results(e.length):this.options.messages.noResults,this.liveRegion.children().hide(),t("<div>").text(i).appendTo(this.liveRegion))}}),t.ui.autocomplete;var g=/ui-corner-([a-z]){2,6}/g;t.widget("ui.controlgroup",{version:"1.12.1",defaultElement:"<div>",options:{direction:"horizontal",disabled:null,onlyVisible:!0,items:{button:"input[type=button], input[type=submit], input[type=reset], button, a",controlgroupLabel:".ui-controlgroup-label",checkboxradio:"input[type='checkbox'], input[type='radio']",selectmenu:"select",spinner:".ui-spinner-input"}},_create:function(){this._enhance()},_enhance:function(){this.element.attr("role","toolbar"),this.refresh()},_destroy:function(){this._callChildMethod("destroy"),this.childWidgets.removeData("ui-controlgroup-data"),this.element.removeAttr("role"),this.options.items.controlgroupLabel&&this.element.find(this.options.items.controlgroupLabel).find(".ui-controlgroup-label-contents").contents().unwrap()},_initWidgets:function(){var e=this,i=[];t.each(this.options.items,function(s,n){var o,a={};return n?"controlgroupLabel"===s?(o=e.element.find(n),o.each(function(){var e=t(this);e.children(".ui-controlgroup-label-contents").length||e.contents().wrapAll("<span class='ui-controlgroup-label-contents'></span>")}),e._addClass(o,null,"ui-widget ui-widget-content ui-state-default"),i=i.concat(o.get()),void 0):(t.fn[s]&&(a=e["_"+s+"Options"]?e["_"+s+"Options"]("middle"):{classes:{}},e.element.find(n).each(function(){var n=t(this),o=n[s]("instance"),r=t.widget.extend({},a);if("button"!==s||!n.parent(".ui-spinner").length){o||(o=n[s]()[s]("instance")),o&&(r.classes=e._resolveClassesValues(r.classes,o)),n[s](r);var h=n[s]("widget");t.data(h[0],"ui-controlgroup-data",o?o:n[s]("instance")),i.push(h[0])}})),void 0):void 0}),this.childWidgets=t(t.unique(i)),this._addClass(this.childWidgets,"ui-controlgroup-item")},_callChildMethod:function(e){this.childWidgets.each(function(){var i=t(this),s=i.data("ui-controlgroup-data");s&&s[e]&&s[e]()})},_updateCornerClass:function(t,e){var i="ui-corner-top ui-corner-bottom ui-corner-left ui-corner-right ui-corner-all",s=this._buildSimpleOptions(e,"label").classes.label;this._removeClass(t,null,i),this._addClass(t,null,s)},_buildSimpleOptions:function(t,e){var i="vertical"===this.options.direction,s={classes:{}};return s.classes[e]={middle:"",first:"ui-corner-"+(i?"top":"left"),last:"ui-corner-"+(i?"bottom":"right"),only:"ui-corner-all"}[t],s},_spinnerOptions:function(t){var e=this._buildSimpleOptions(t,"ui-spinner");return e.classes["ui-spinner-up"]="",e.classes["ui-spinner-down"]="",e},_buttonOptions:function(t){return this._buildSimpleOptions(t,"ui-button")},_checkboxradioOptions:function(t){return this._buildSimpleOptions(t,"ui-checkboxradio-label")},_selectmenuOptions:function(t){var e="vertical"===this.options.direction;return{width:e?"auto":!1,classes:{middle:{"ui-selectmenu-button-open":"","ui-selectmenu-button-closed":""},first:{"ui-selectmenu-button-open":"ui-corner-"+(e?"top":"tl"),"ui-selectmenu-button-closed":"ui-corner-"+(e?"top":"left")},last:{"ui-selectmenu-button-open":e?"":"ui-corner-tr","ui-selectmenu-button-closed":"ui-corner-"+(e?"bottom":"right")},only:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"}}[t]}},_resolveClassesValues:function(e,i){var s={};return t.each(e,function(n){var o=i.options.classes[n]||"";o=t.trim(o.replace(g,"")),s[n]=(o+" "+e[n]).replace(/\s+/g," ")}),s},_setOption:function(t,e){return"direction"===t&&this._removeClass("ui-controlgroup-"+this.options.direction),this._super(t,e),"disabled"===t?(this._callChildMethod(e?"disable":"enable"),void 0):(this.refresh(),void 0)},refresh:function(){var e,i=this;this._addClass("ui-controlgroup ui-controlgroup-"+this.options.direction),"horizontal"===this.options.direction&&this._addClass(null,"ui-helper-clearfix"),this._initWidgets(),e=this.childWidgets,this.options.onlyVisible&&(e=e.filter(":visible")),e.length&&(t.each(["first","last"],function(t,s){var n=e[s]().data("ui-controlgroup-data");if(n&&i["_"+n.widgetName+"Options"]){var o=i["_"+n.widgetName+"Options"](1===e.length?"only":s);o.classes=i._resolveClassesValues(o.classes,n),n.element[n.widgetName](o)}else i._updateCornerClass(e[s](),s)}),this._callChildMethod("refresh"))}}),t.widget("ui.checkboxradio",[t.ui.formResetMixin,{version:"1.12.1",options:{disabled:null,label:null,icon:!0,classes:{"ui-checkboxradio-label":"ui-corner-all","ui-checkboxradio-icon":"ui-corner-all"}},_getCreateOptions:function(){var e,i,s=this,n=this._super()||{};return this._readType(),i=this.element.labels(),this.label=t(i[i.length-1]),this.label.length||t.error("No label found for checkboxradio widget"),this.originalLabel="",this.label.contents().not(this.element[0]).each(function(){s.originalLabel+=3===this.nodeType?t(this).text():this.outerHTML}),this.originalLabel&&(n.label=this.originalLabel),e=this.element[0].disabled,null!=e&&(n.disabled=e),n},_create:function(){var t=this.element[0].checked;this._bindFormResetHandler(),null==this.options.disabled&&(this.options.disabled=this.element[0].disabled),this._setOption("disabled",this.options.disabled),this._addClass("ui-checkboxradio","ui-helper-hidden-accessible"),this._addClass(this.label,"ui-checkboxradio-label","ui-button ui-widget"),"radio"===this.type&&this._addClass(this.label,"ui-checkboxradio-radio-label"),this.options.label&&this.options.label!==this.originalLabel?this._updateLabel():this.originalLabel&&(this.options.label=this.originalLabel),this._enhance(),t&&(this._addClass(this.label,"ui-checkboxradio-checked","ui-state-active"),this.icon&&this._addClass(this.icon,null,"ui-state-hover")),this._on({change:"_toggleClasses",focus:function(){this._addClass(this.label,null,"ui-state-focus ui-visual-focus")},blur:function(){this._removeClass(this.label,null,"ui-state-focus ui-visual-focus")}})},_readType:function(){var e=this.element[0].nodeName.toLowerCase();this.type=this.element[0].type,"input"===e&&/radio|checkbox/.test(this.type)||t.error("Can't create checkboxradio on element.nodeName="+e+" and element.type="+this.type)},_enhance:function(){this._updateIcon(this.element[0].checked)},widget:function(){return this.label},_getRadioGroup:function(){var e,i=this.element[0].name,s="input[name='"+t.ui.escapeSelector(i)+"']";return i?(e=this.form.length?t(this.form[0].elements).filter(s):t(s).filter(function(){return 0===t(this).form().length}),e.not(this.element)):t([])},_toggleClasses:function(){var e=this.element[0].checked;this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",e),this.options.icon&&"checkbox"===this.type&&this._toggleClass(this.icon,null,"ui-icon-check ui-state-checked",e)._toggleClass(this.icon,null,"ui-icon-blank",!e),"radio"===this.type&&this._getRadioGroup().each(function(){var e=t(this).checkboxradio("instance");e&&e._removeClass(e.label,"ui-checkboxradio-checked","ui-state-active")})},_destroy:function(){this._unbindFormResetHandler(),this.icon&&(this.icon.remove(),this.iconSpace.remove())},_setOption:function(t,e){return"label"!==t||e?(this._super(t,e),"disabled"===t?(this._toggleClass(this.label,null,"ui-state-disabled",e),this.element[0].disabled=e,void 0):(this.refresh(),void 0)):void 0},_updateIcon:function(e){var i="ui-icon ui-icon-background ";this.options.icon?(this.icon||(this.icon=t("<span>"),this.iconSpace=t("<span> </span>"),this._addClass(this.iconSpace,"ui-checkboxradio-icon-space")),"checkbox"===this.type?(i+=e?"ui-icon-check ui-state-checked":"ui-icon-blank",this._removeClass(this.icon,null,e?"ui-icon-blank":"ui-icon-check")):i+="ui-icon-blank",this._addClass(this.icon,"ui-checkboxradio-icon",i),e||this._removeClass(this.icon,null,"ui-icon-check ui-state-checked"),this.icon.prependTo(this.label).after(this.iconSpace)):void 0!==this.icon&&(this.icon.remove(),this.iconSpace.remove(),delete this.icon)},_updateLabel:function(){var t=this.label.contents().not(this.element[0]);this.icon&&(t=t.not(this.icon[0])),this.iconSpace&&(t=t.not(this.iconSpace[0])),t.remove(),this.label.append(this.options.label)},refresh:function(){var t=this.element[0].checked,e=this.element[0].disabled;this._updateIcon(t),this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",t),null!==this.options.label&&this._updateLabel(),e!==this.options.disabled&&this._setOptions({disabled:e})}}]),t.ui.checkboxradio,t.widget("ui.button",{version:"1.12.1",defaultElement:"<button>",options:{classes:{"ui-button":"ui-corner-all"},disabled:null,icon:null,iconPosition:"beginning",label:null,showLabel:!0},_getCreateOptions:function(){var t,e=this._super()||{};return this.isInput=this.element.is("input"),t=this.element[0].disabled,null!=t&&(e.disabled=t),this.originalLabel=this.isInput?this.element.val():this.element.html(),this.originalLabel&&(e.label=this.originalLabel),e},_create:function(){!this.option.showLabel&!this.options.icon&&(this.options.showLabel=!0),null==this.options.disabled&&(this.options.disabled=this.element[0].disabled||!1),this.hasTitle=!!this.element.attr("title"),this.options.label&&this.options.label!==this.originalLabel&&(this.isInput?this.element.val(this.options.label):this.element.html(this.options.label)),this._addClass("ui-button","ui-widget"),this._setOption("disabled",this.options.disabled),this._enhance(),this.element.is("a")&&this._on({keyup:function(e){e.keyCode===t.ui.keyCode.SPACE&&(e.preventDefault(),this.element[0].click?this.element[0].click():this.element.trigger("click"))}})},_enhance:function(){this.element.is("button")||this.element.attr("role","button"),this.options.icon&&(this._updateIcon("icon",this.options.icon),this._updateTooltip())},_updateTooltip:function(){this.title=this.element.attr("title"),this.options.showLabel||this.title||this.element.attr("title",this.options.label)},_updateIcon:function(e,i){var s="iconPosition"!==e,n=s?this.options.iconPosition:i,o="top"===n||"bottom"===n;this.icon?s&&this._removeClass(this.icon,null,this.options.icon):(this.icon=t("<span>"),this._addClass(this.icon,"ui-button-icon","ui-icon"),this.options.showLabel||this._addClass("ui-button-icon-only")),s&&this._addClass(this.icon,null,i),this._attachIcon(n),o?(this._addClass(this.icon,null,"ui-widget-icon-block"),this.iconSpace&&this.iconSpace.remove()):(this.iconSpace||(this.iconSpace=t("<span> </span>"),this._addClass(this.iconSpace,"ui-button-icon-space")),this._removeClass(this.icon,null,"ui-wiget-icon-block"),this._attachIconSpace(n))},_destroy:function(){this.element.removeAttr("role"),this.icon&&this.icon.remove(),this.iconSpace&&this.iconSpace.remove(),this.hasTitle||this.element.removeAttr("title")},_attachIconSpace:function(t){this.icon[/^(?:end|bottom)/.test(t)?"before":"after"](this.iconSpace)},_attachIcon:function(t){this.element[/^(?:end|bottom)/.test(t)?"append":"prepend"](this.icon)},_setOptions:function(t){var e=void 0===t.showLabel?this.options.showLabel:t.showLabel,i=void 0===t.icon?this.options.icon:t.icon;e||i||(t.showLabel=!0),this._super(t)},_setOption:function(t,e){"icon"===t&&(e?this._updateIcon(t,e):this.icon&&(this.icon.remove(),this.iconSpace&&this.iconSpace.remove())),"iconPosition"===t&&this._updateIcon(t,e),"showLabel"===t&&(this._toggleClass("ui-button-icon-only",null,!e),this._updateTooltip()),"label"===t&&(this.isInput?this.element.val(e):(this.element.html(e),this.icon&&(this._attachIcon(this.options.iconPosition),this._attachIconSpace(this.options.iconPosition)))),this._super(t,e),"disabled"===t&&(this._toggleClass(null,"ui-state-disabled",e),this.element[0].disabled=e,e&&this.element.blur())},refresh:function(){var t=this.element.is("input, button")?this.element[0].disabled:this.element.hasClass("ui-button-disabled");t!==this.options.disabled&&this._setOptions({disabled:t}),this._updateTooltip()}}),t.uiBackCompat!==!1&&(t.widget("ui.button",t.ui.button,{options:{text:!0,icons:{primary:null,secondary:null}},_create:function(){this.options.showLabel&&!this.options.text&&(this.options.showLabel=this.options.text),!this.options.showLabel&&this.options.text&&(this.options.text=this.options.showLabel),this.options.icon||!this.options.icons.primary&&!this.options.icons.secondary?this.options.icon&&(this.options.icons.primary=this.options.icon):this.options.icons.primary?this.options.icon=this.options.icons.primary:(this.options.icon=this.options.icons.secondary,this.options.iconPosition="end"),this._super()},_setOption:function(t,e){return"text"===t?(this._super("showLabel",e),void 0):("showLabel"===t&&(this.options.text=e),"icon"===t&&(this.options.icons.primary=e),"icons"===t&&(e.primary?(this._super("icon",e.primary),this._super("iconPosition","beginning")):e.secondary&&(this._super("icon",e.secondary),this._super("iconPosition","end"))),this._superApply(arguments),void 0)}}),t.fn.button=function(e){return function(){return!this.length||this.length&&"INPUT"!==this[0].tagName||this.length&&"INPUT"===this[0].tagName&&"checkbox"!==this.attr("type")&&"radio"!==this.attr("type")?e.apply(this,arguments):(t.ui.checkboxradio||t.error("Checkboxradio widget missing"),0===arguments.length?this.checkboxradio({icon:!1}):this.checkboxradio.apply(this,arguments))}}(t.fn.button),t.fn.buttonset=function(){return t.ui.controlgroup||t.error("Controlgroup widget missing"),"option"===arguments[0]&&"items"===arguments[1]&&arguments[2]?this.controlgroup.apply(this,[arguments[0],"items.button",arguments[2]]):"option"===arguments[0]&&"items"===arguments[1]?this.controlgroup.apply(this,[arguments[0],"items.button"]):("object"==typeof arguments[0]&&arguments[0].items&&(arguments[0].items={button:arguments[0].items}),this.controlgroup.apply(this,arguments))}),t.ui.button,t.extend(t.ui,{datepicker:{version:"1.12.1"}});var m;t.extend(s.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(t){return a(this._defaults,t||{}),this},_attachDatepicker:function(e,i){var s,n,o;s=e.nodeName.toLowerCase(),n="div"===s||"span"===s,e.id||(this.uuid+=1,e.id="dp"+this.uuid),o=this._newInst(t(e),n),o.settings=t.extend({},i||{}),"input"===s?this._connectDatepicker(e,o):n&&this._inlineDatepicker(e,o)},_newInst:function(e,i){var s=e[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:s,input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:i,dpDiv:i?n(t("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(e,i){var s=t(e);i.append=t([]),i.trigger=t([]),s.hasClass(this.markerClassName)||(this._attachments(s,i),s.addClass(this.markerClassName).on("keydown",this._doKeyDown).on("keypress",this._doKeyPress).on("keyup",this._doKeyUp),this._autoSize(i),t.data(e,"datepicker",i),i.settings.disabled&&this._disableDatepicker(e))},_attachments:function(e,i){var s,n,o,a=this._get(i,"appendText"),r=this._get(i,"isRTL");i.append&&i.append.remove(),a&&(i.append=t("<span class='"+this._appendClass+"'>"+a+"</span>"),e[r?"before":"after"](i.append)),e.off("focus",this._showDatepicker),i.trigger&&i.trigger.remove(),s=this._get(i,"showOn"),("focus"===s||"both"===s)&&e.on("focus",this._showDatepicker),("button"===s||"both"===s)&&(n=this._get(i,"buttonText"),o=this._get(i,"buttonImage"),i.trigger=t(this._get(i,"buttonImageOnly")?t("<img/>").addClass(this._triggerClass).attr({src:o,alt:n,title:n}):t("<button type='button'></button>").addClass(this._triggerClass).html(o?t("<img/>").attr({src:o,alt:n,title:n}):n)),e[r?"before":"after"](i.trigger),i.trigger.on("click",function(){return t.datepicker._datepickerShowing&&t.datepicker._lastInput===e[0]?t.datepicker._hideDatepicker():t.datepicker._datepickerShowing&&t.datepicker._lastInput!==e[0]?(t.datepicker._hideDatepicker(),t.datepicker._showDatepicker(e[0])):t.datepicker._showDatepicker(e[0]),!1}))},_autoSize:function(t){if(this._get(t,"autoSize")&&!t.inline){var e,i,s,n,o=new Date(2009,11,20),a=this._get(t,"dateFormat");a.match(/[DM]/)&&(e=function(t){for(i=0,s=0,n=0;t.length>n;n++)t[n].length>i&&(i=t[n].length,s=n);return s},o.setMonth(e(this._get(t,a.match(/MM/)?"monthNames":"monthNamesShort"))),o.setDate(e(this._get(t,a.match(/DD/)?"dayNames":"dayNamesShort"))+20-o.getDay())),t.input.attr("size",this._formatDate(t,o).length)}},_inlineDatepicker:function(e,i){var s=t(e);s.hasClass(this.markerClassName)||(s.addClass(this.markerClassName).append(i.dpDiv),t.data(e,"datepicker",i),this._setDate(i,this._getDefaultDate(i),!0),this._updateDatepicker(i),this._updateAlternate(i),i.settings.disabled&&this._disableDatepicker(e),i.dpDiv.css("display","block"))},_dialogDatepicker:function(e,i,s,n,o){var r,h,l,c,u,d=this._dialogInst;return d||(this.uuid+=1,r="dp"+this.uuid,this._dialogInput=t("<input type='text' id='"+r+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.on("keydown",this._doKeyDown),t("body").append(this._dialogInput),d=this._dialogInst=this._newInst(this._dialogInput,!1),d.settings={},t.data(this._dialogInput[0],"datepicker",d)),a(d.settings,n||{}),i=i&&i.constructor===Date?this._formatDate(d,i):i,this._dialogInput.val(i),this._pos=o?o.length?o:[o.pageX,o.pageY]:null,this._pos||(h=document.documentElement.clientWidth,l=document.documentElement.clientHeight,c=document.documentElement.scrollLeft||document.body.scrollLeft,u=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[h/2-100+c,l/2-150+u]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),d.settings.onSelect=s,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),t.blockUI&&t.blockUI(this.dpDiv),t.data(this._dialogInput[0],"datepicker",d),this},_destroyDatepicker:function(e){var i,s=t(e),n=t.data(e,"datepicker");s.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),t.removeData(e,"datepicker"),"input"===i?(n.append.remove(),n.trigger.remove(),s.removeClass(this.markerClassName).off("focus",this._showDatepicker).off("keydown",this._doKeyDown).off("keypress",this._doKeyPress).off("keyup",this._doKeyUp)):("div"===i||"span"===i)&&s.removeClass(this.markerClassName).empty(),m===n&&(m=null))},_enableDatepicker:function(e){var i,s,n=t(e),o=t.data(e,"datepicker");n.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),"input"===i?(e.disabled=!1,o.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===i||"span"===i)&&(s=n.children("."+this._inlineClass),s.children().removeClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=t.map(this._disabledInputs,function(t){return t===e?null:t}))},_disableDatepicker:function(e){var i,s,n=t(e),o=t.data(e,"datepicker");n.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),"input"===i?(e.disabled=!0,o.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===i||"span"===i)&&(s=n.children("."+this._inlineClass),s.children().addClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=t.map(this._disabledInputs,function(t){return t===e?null:t}),this._disabledInputs[this._disabledInputs.length]=e)},_isDisabledDatepicker:function(t){if(!t)return!1;for(var e=0;this._disabledInputs.length>e;e++)if(this._disabledInputs[e]===t)return!0;return!1},_getInst:function(e){try{return t.data(e,"datepicker")}catch(i){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(e,i,s){var n,o,r,h,l=this._getInst(e);return 2===arguments.length&&"string"==typeof i?"defaults"===i?t.extend({},t.datepicker._defaults):l?"all"===i?t.extend({},l.settings):this._get(l,i):null:(n=i||{},"string"==typeof i&&(n={},n[i]=s),l&&(this._curInst===l&&this._hideDatepicker(),o=this._getDateDatepicker(e,!0),r=this._getMinMaxDate(l,"min"),h=this._getMinMaxDate(l,"max"),a(l.settings,n),null!==r&&void 0!==n.dateFormat&&void 0===n.minDate&&(l.settings.minDate=this._formatDate(l,r)),null!==h&&void 0!==n.dateFormat&&void 0===n.maxDate&&(l.settings.maxDate=this._formatDate(l,h)),"disabled"in n&&(n.disabled?this._disableDatepicker(e):this._enableDatepicker(e)),this._attachments(t(e),l),this._autoSize(l),this._setDate(l,o),this._updateAlternate(l),this._updateDatepicker(l)),void 0)},_changeDatepicker:function(t,e,i){this._optionDatepicker(t,e,i)},_refreshDatepicker:function(t){var e=this._getInst(t);e&&this._updateDatepicker(e)},_setDateDatepicker:function(t,e){var i=this._getInst(t);i&&(this._setDate(i,e),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(t,e){var i=this._getInst(t);return i&&!i.inline&&this._setDateFromField(i,e),i?this._getDate(i):null},_doKeyDown:function(e){var i,s,n,o=t.datepicker._getInst(e.target),a=!0,r=o.dpDiv.is(".ui-datepicker-rtl");if(o._keyEvent=!0,t.datepicker._datepickerShowing)switch(e.keyCode){case 9:t.datepicker._hideDatepicker(),a=!1;break;case 13:return n=t("td."+t.datepicker._dayOverClass+":not(."+t.datepicker._currentClass+")",o.dpDiv),n[0]&&t.datepicker._selectDay(e.target,o.selectedMonth,o.selectedYear,n[0]),i=t.datepicker._get(o,"onSelect"),i?(s=t.datepicker._formatDate(o),i.apply(o.input?o.input[0]:null,[s,o])):t.datepicker._hideDatepicker(),!1;case 27:t.datepicker._hideDatepicker();break;case 33:t.datepicker._adjustDate(e.target,e.ctrlKey?-t.datepicker._get(o,"stepBigMonths"):-t.datepicker._get(o,"stepMonths"),"M");break;case 34:t.datepicker._adjustDate(e.target,e.ctrlKey?+t.datepicker._get(o,"stepBigMonths"):+t.datepicker._get(o,"stepMonths"),"M");break;case 35:(e.ctrlKey||e.metaKey)&&t.datepicker._clearDate(e.target),a=e.ctrlKey||e.metaKey;break;case 36:(e.ctrlKey||e.metaKey)&&t.datepicker._gotoToday(e.target),a=e.ctrlKey||e.metaKey;break;case 37:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,r?1:-1,"D"),a=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&t.datepicker._adjustDate(e.target,e.ctrlKey?-t.datepicker._get(o,"stepBigMonths"):-t.datepicker._get(o,"stepMonths"),"M");break;case 38:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,-7,"D"),a=e.ctrlKey||e.metaKey;break;case 39:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,r?-1:1,"D"),a=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&t.datepicker._adjustDate(e.target,e.ctrlKey?+t.datepicker._get(o,"stepBigMonths"):+t.datepicker._get(o,"stepMonths"),"M");break;case 40:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,7,"D"),a=e.ctrlKey||e.metaKey;break;default:a=!1}else 36===e.keyCode&&e.ctrlKey?t.datepicker._showDatepicker(this):a=!1;a&&(e.preventDefault(),e.stopPropagation())},_doKeyPress:function(e){var i,s,n=t.datepicker._getInst(e.target);return t.datepicker._get(n,"constrainInput")?(i=t.datepicker._possibleChars(t.datepicker._get(n,"dateFormat")),s=String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),e.ctrlKey||e.metaKey||" ">s||!i||i.indexOf(s)>-1):void 0},_doKeyUp:function(e){var i,s=t.datepicker._getInst(e.target);if(s.input.val()!==s.lastVal)try{i=t.datepicker.parseDate(t.datepicker._get(s,"dateFormat"),s.input?s.input.val():null,t.datepicker._getFormatConfig(s)),i&&(t.datepicker._setDateFromField(s),t.datepicker._updateAlternate(s),t.datepicker._updateDatepicker(s))}catch(n){}return!0},_showDatepicker:function(e){if(e=e.target||e,"input"!==e.nodeName.toLowerCase()&&(e=t("input",e.parentNode)[0]),!t.datepicker._isDisabledDatepicker(e)&&t.datepicker._lastInput!==e){var s,n,o,r,h,l,c;s=t.datepicker._getInst(e),t.datepicker._curInst&&t.datepicker._curInst!==s&&(t.datepicker._curInst.dpDiv.stop(!0,!0),s&&t.datepicker._datepickerShowing&&t.datepicker._hideDatepicker(t.datepicker._curInst.input[0])),n=t.datepicker._get(s,"beforeShow"),o=n?n.apply(e,[e,s]):{},o!==!1&&(a(s.settings,o),s.lastVal=null,t.datepicker._lastInput=e,t.datepicker._setDateFromField(s),t.datepicker._inDialog&&(e.value=""),t.datepicker._pos||(t.datepicker._pos=t.datepicker._findPos(e),t.datepicker._pos[1]+=e.offsetHeight),r=!1,t(e).parents().each(function(){return r|="fixed"===t(this).css("position"),!r}),h={left:t.datepicker._pos[0],top:t.datepicker._pos[1]},t.datepicker._pos=null,s.dpDiv.empty(),s.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),t.datepicker._updateDatepicker(s),h=t.datepicker._checkOffset(s,h,r),s.dpDiv.css({position:t.datepicker._inDialog&&t.blockUI?"static":r?"fixed":"absolute",display:"none",left:h.left+"px",top:h.top+"px"}),s.inline||(l=t.datepicker._get(s,"showAnim"),c=t.datepicker._get(s,"duration"),s.dpDiv.css("z-index",i(t(e))+1),t.datepicker._datepickerShowing=!0,t.effects&&t.effects.effect[l]?s.dpDiv.show(l,t.datepicker._get(s,"showOptions"),c):s.dpDiv[l||"show"](l?c:null),t.datepicker._shouldFocusInput(s)&&s.input.trigger("focus"),t.datepicker._curInst=s))
}},_updateDatepicker:function(e){this.maxRows=4,m=e,e.dpDiv.empty().append(this._generateHTML(e)),this._attachHandlers(e);var i,s=this._getNumberOfMonths(e),n=s[1],a=17,r=e.dpDiv.find("."+this._dayOverClass+" a");r.length>0&&o.apply(r.get(0)),e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),n>1&&e.dpDiv.addClass("ui-datepicker-multi-"+n).css("width",a*n+"em"),e.dpDiv[(1!==s[0]||1!==s[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),e.dpDiv[(this._get(e,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),e===t.datepicker._curInst&&t.datepicker._datepickerShowing&&t.datepicker._shouldFocusInput(e)&&e.input.trigger("focus"),e.yearshtml&&(i=e.yearshtml,setTimeout(function(){i===e.yearshtml&&e.yearshtml&&e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml),i=e.yearshtml=null},0))},_shouldFocusInput:function(t){return t.input&&t.input.is(":visible")&&!t.input.is(":disabled")&&!t.input.is(":focus")},_checkOffset:function(e,i,s){var n=e.dpDiv.outerWidth(),o=e.dpDiv.outerHeight(),a=e.input?e.input.outerWidth():0,r=e.input?e.input.outerHeight():0,h=document.documentElement.clientWidth+(s?0:t(document).scrollLeft()),l=document.documentElement.clientHeight+(s?0:t(document).scrollTop());return i.left-=this._get(e,"isRTL")?n-a:0,i.left-=s&&i.left===e.input.offset().left?t(document).scrollLeft():0,i.top-=s&&i.top===e.input.offset().top+r?t(document).scrollTop():0,i.left-=Math.min(i.left,i.left+n>h&&h>n?Math.abs(i.left+n-h):0),i.top-=Math.min(i.top,i.top+o>l&&l>o?Math.abs(o+r):0),i},_findPos:function(e){for(var i,s=this._getInst(e),n=this._get(s,"isRTL");e&&("hidden"===e.type||1!==e.nodeType||t.expr.filters.hidden(e));)e=e[n?"previousSibling":"nextSibling"];return i=t(e).offset(),[i.left,i.top]},_hideDatepicker:function(e){var i,s,n,o,a=this._curInst;!a||e&&a!==t.data(e,"datepicker")||this._datepickerShowing&&(i=this._get(a,"showAnim"),s=this._get(a,"duration"),n=function(){t.datepicker._tidyDialog(a)},t.effects&&(t.effects.effect[i]||t.effects[i])?a.dpDiv.hide(i,t.datepicker._get(a,"showOptions"),s,n):a.dpDiv["slideDown"===i?"slideUp":"fadeIn"===i?"fadeOut":"hide"](i?s:null,n),i||n(),this._datepickerShowing=!1,o=this._get(a,"onClose"),o&&o.apply(a.input?a.input[0]:null,[a.input?a.input.val():"",a]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),t.blockUI&&(t.unblockUI(),t("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(t){t.dpDiv.removeClass(this._dialogClass).off(".ui-datepicker-calendar")},_checkExternalClick:function(e){if(t.datepicker._curInst){var i=t(e.target),s=t.datepicker._getInst(i[0]);(i[0].id!==t.datepicker._mainDivId&&0===i.parents("#"+t.datepicker._mainDivId).length&&!i.hasClass(t.datepicker.markerClassName)&&!i.closest("."+t.datepicker._triggerClass).length&&t.datepicker._datepickerShowing&&(!t.datepicker._inDialog||!t.blockUI)||i.hasClass(t.datepicker.markerClassName)&&t.datepicker._curInst!==s)&&t.datepicker._hideDatepicker()}},_adjustDate:function(e,i,s){var n=t(e),o=this._getInst(n[0]);this._isDisabledDatepicker(n[0])||(this._adjustInstDate(o,i+("M"===s?this._get(o,"showCurrentAtPos"):0),s),this._updateDatepicker(o))},_gotoToday:function(e){var i,s=t(e),n=this._getInst(s[0]);this._get(n,"gotoCurrent")&&n.currentDay?(n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear):(i=new Date,n.selectedDay=i.getDate(),n.drawMonth=n.selectedMonth=i.getMonth(),n.drawYear=n.selectedYear=i.getFullYear()),this._notifyChange(n),this._adjustDate(s)},_selectMonthYear:function(e,i,s){var n=t(e),o=this._getInst(n[0]);o["selected"+("M"===s?"Month":"Year")]=o["draw"+("M"===s?"Month":"Year")]=parseInt(i.options[i.selectedIndex].value,10),this._notifyChange(o),this._adjustDate(n)},_selectDay:function(e,i,s,n){var o,a=t(e);t(n).hasClass(this._unselectableClass)||this._isDisabledDatepicker(a[0])||(o=this._getInst(a[0]),o.selectedDay=o.currentDay=t("a",n).html(),o.selectedMonth=o.currentMonth=i,o.selectedYear=o.currentYear=s,this._selectDate(e,this._formatDate(o,o.currentDay,o.currentMonth,o.currentYear)))},_clearDate:function(e){var i=t(e);this._selectDate(i,"")},_selectDate:function(e,i){var s,n=t(e),o=this._getInst(n[0]);i=null!=i?i:this._formatDate(o),o.input&&o.input.val(i),this._updateAlternate(o),s=this._get(o,"onSelect"),s?s.apply(o.input?o.input[0]:null,[i,o]):o.input&&o.input.trigger("change"),o.inline?this._updateDatepicker(o):(this._hideDatepicker(),this._lastInput=o.input[0],"object"!=typeof o.input[0]&&o.input.trigger("focus"),this._lastInput=null)},_updateAlternate:function(e){var i,s,n,o=this._get(e,"altField");o&&(i=this._get(e,"altFormat")||this._get(e,"dateFormat"),s=this._getDate(e),n=this.formatDate(i,s,this._getFormatConfig(e)),t(o).val(n))},noWeekends:function(t){var e=t.getDay();return[e>0&&6>e,""]},iso8601Week:function(t){var e,i=new Date(t.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),e=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((e-i)/864e5)/7)+1},parseDate:function(e,i,s){if(null==e||null==i)throw"Invalid arguments";if(i="object"==typeof i?""+i:i+"",""===i)return null;var n,o,a,r,h=0,l=(s?s.shortYearCutoff:null)||this._defaults.shortYearCutoff,c="string"!=typeof l?l:(new Date).getFullYear()%100+parseInt(l,10),u=(s?s.dayNamesShort:null)||this._defaults.dayNamesShort,d=(s?s.dayNames:null)||this._defaults.dayNames,p=(s?s.monthNamesShort:null)||this._defaults.monthNamesShort,f=(s?s.monthNames:null)||this._defaults.monthNames,g=-1,m=-1,_=-1,v=-1,b=!1,y=function(t){var i=e.length>n+1&&e.charAt(n+1)===t;return i&&n++,i},w=function(t){var e=y(t),s="@"===t?14:"!"===t?20:"y"===t&&e?4:"o"===t?3:2,n="y"===t?s:1,o=RegExp("^\\d{"+n+","+s+"}"),a=i.substring(h).match(o);if(!a)throw"Missing number at position "+h;return h+=a[0].length,parseInt(a[0],10)},k=function(e,s,n){var o=-1,a=t.map(y(e)?n:s,function(t,e){return[[e,t]]}).sort(function(t,e){return-(t[1].length-e[1].length)});if(t.each(a,function(t,e){var s=e[1];return i.substr(h,s.length).toLowerCase()===s.toLowerCase()?(o=e[0],h+=s.length,!1):void 0}),-1!==o)return o+1;throw"Unknown name at position "+h},x=function(){if(i.charAt(h)!==e.charAt(n))throw"Unexpected literal at position "+h;h++};for(n=0;e.length>n;n++)if(b)"'"!==e.charAt(n)||y("'")?x():b=!1;else switch(e.charAt(n)){case"d":_=w("d");break;case"D":k("D",u,d);break;case"o":v=w("o");break;case"m":m=w("m");break;case"M":m=k("M",p,f);break;case"y":g=w("y");break;case"@":r=new Date(w("@")),g=r.getFullYear(),m=r.getMonth()+1,_=r.getDate();break;case"!":r=new Date((w("!")-this._ticksTo1970)/1e4),g=r.getFullYear(),m=r.getMonth()+1,_=r.getDate();break;case"'":y("'")?x():b=!0;break;default:x()}if(i.length>h&&(a=i.substr(h),!/^\s+/.test(a)))throw"Extra/unparsed characters found in date: "+a;if(-1===g?g=(new Date).getFullYear():100>g&&(g+=(new Date).getFullYear()-(new Date).getFullYear()%100+(c>=g?0:-100)),v>-1)for(m=1,_=v;;){if(o=this._getDaysInMonth(g,m-1),o>=_)break;m++,_-=o}if(r=this._daylightSavingAdjust(new Date(g,m-1,_)),r.getFullYear()!==g||r.getMonth()+1!==m||r.getDate()!==_)throw"Invalid date";return r},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:1e7*60*60*24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(t,e,i){if(!e)return"";var s,n=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,o=(i?i.dayNames:null)||this._defaults.dayNames,a=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,r=(i?i.monthNames:null)||this._defaults.monthNames,h=function(e){var i=t.length>s+1&&t.charAt(s+1)===e;return i&&s++,i},l=function(t,e,i){var s=""+e;if(h(t))for(;i>s.length;)s="0"+s;return s},c=function(t,e,i,s){return h(t)?s[e]:i[e]},u="",d=!1;if(e)for(s=0;t.length>s;s++)if(d)"'"!==t.charAt(s)||h("'")?u+=t.charAt(s):d=!1;else switch(t.charAt(s)){case"d":u+=l("d",e.getDate(),2);break;case"D":u+=c("D",e.getDay(),n,o);break;case"o":u+=l("o",Math.round((new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()-new Date(e.getFullYear(),0,0).getTime())/864e5),3);break;case"m":u+=l("m",e.getMonth()+1,2);break;case"M":u+=c("M",e.getMonth(),a,r);break;case"y":u+=h("y")?e.getFullYear():(10>e.getFullYear()%100?"0":"")+e.getFullYear()%100;break;case"@":u+=e.getTime();break;case"!":u+=1e4*e.getTime()+this._ticksTo1970;break;case"'":h("'")?u+="'":d=!0;break;default:u+=t.charAt(s)}return u},_possibleChars:function(t){var e,i="",s=!1,n=function(i){var s=t.length>e+1&&t.charAt(e+1)===i;return s&&e++,s};for(e=0;t.length>e;e++)if(s)"'"!==t.charAt(e)||n("'")?i+=t.charAt(e):s=!1;else switch(t.charAt(e)){case"d":case"m":case"y":case"@":i+="0123456789";break;case"D":case"M":return null;case"'":n("'")?i+="'":s=!0;break;default:i+=t.charAt(e)}return i},_get:function(t,e){return void 0!==t.settings[e]?t.settings[e]:this._defaults[e]},_setDateFromField:function(t,e){if(t.input.val()!==t.lastVal){var i=this._get(t,"dateFormat"),s=t.lastVal=t.input?t.input.val():null,n=this._getDefaultDate(t),o=n,a=this._getFormatConfig(t);try{o=this.parseDate(i,s,a)||n}catch(r){s=e?"":s}t.selectedDay=o.getDate(),t.drawMonth=t.selectedMonth=o.getMonth(),t.drawYear=t.selectedYear=o.getFullYear(),t.currentDay=s?o.getDate():0,t.currentMonth=s?o.getMonth():0,t.currentYear=s?o.getFullYear():0,this._adjustInstDate(t)}},_getDefaultDate:function(t){return this._restrictMinMax(t,this._determineDate(t,this._get(t,"defaultDate"),new Date))},_determineDate:function(e,i,s){var n=function(t){var e=new Date;return e.setDate(e.getDate()+t),e},o=function(i){try{return t.datepicker.parseDate(t.datepicker._get(e,"dateFormat"),i,t.datepicker._getFormatConfig(e))}catch(s){}for(var n=(i.toLowerCase().match(/^c/)?t.datepicker._getDate(e):null)||new Date,o=n.getFullYear(),a=n.getMonth(),r=n.getDate(),h=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,l=h.exec(i);l;){switch(l[2]||"d"){case"d":case"D":r+=parseInt(l[1],10);break;case"w":case"W":r+=7*parseInt(l[1],10);break;case"m":case"M":a+=parseInt(l[1],10),r=Math.min(r,t.datepicker._getDaysInMonth(o,a));break;case"y":case"Y":o+=parseInt(l[1],10),r=Math.min(r,t.datepicker._getDaysInMonth(o,a))}l=h.exec(i)}return new Date(o,a,r)},a=null==i||""===i?s:"string"==typeof i?o(i):"number"==typeof i?isNaN(i)?s:n(i):new Date(i.getTime());return a=a&&"Invalid Date"==""+a?s:a,a&&(a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0)),this._daylightSavingAdjust(a)},_daylightSavingAdjust:function(t){return t?(t.setHours(t.getHours()>12?t.getHours()+2:0),t):null},_setDate:function(t,e,i){var s=!e,n=t.selectedMonth,o=t.selectedYear,a=this._restrictMinMax(t,this._determineDate(t,e,new Date));t.selectedDay=t.currentDay=a.getDate(),t.drawMonth=t.selectedMonth=t.currentMonth=a.getMonth(),t.drawYear=t.selectedYear=t.currentYear=a.getFullYear(),n===t.selectedMonth&&o===t.selectedYear||i||this._notifyChange(t),this._adjustInstDate(t),t.input&&t.input.val(s?"":this._formatDate(t))},_getDate:function(t){var e=!t.currentYear||t.input&&""===t.input.val()?null:this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return e},_attachHandlers:function(e){var i=this._get(e,"stepMonths"),s="#"+e.id.replace(/\\\\/g,"\\");e.dpDiv.find("[data-handler]").map(function(){var e={prev:function(){t.datepicker._adjustDate(s,-i,"M")},next:function(){t.datepicker._adjustDate(s,+i,"M")},hide:function(){t.datepicker._hideDatepicker()},today:function(){t.datepicker._gotoToday(s)},selectDay:function(){return t.datepicker._selectDay(s,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return t.datepicker._selectMonthYear(s,this,"M"),!1},selectYear:function(){return t.datepicker._selectMonthYear(s,this,"Y"),!1}};t(this).on(this.getAttribute("data-event"),e[this.getAttribute("data-handler")])})},_generateHTML:function(t){var e,i,s,n,o,a,r,h,l,c,u,d,p,f,g,m,_,v,b,y,w,k,x,C,D,I,T,P,M,S,H,z,O,A,N,W,E,F,L,R=new Date,B=this._daylightSavingAdjust(new Date(R.getFullYear(),R.getMonth(),R.getDate())),Y=this._get(t,"isRTL"),j=this._get(t,"showButtonPanel"),q=this._get(t,"hideIfNoPrevNext"),K=this._get(t,"navigationAsDateFormat"),U=this._getNumberOfMonths(t),V=this._get(t,"showCurrentAtPos"),$=this._get(t,"stepMonths"),X=1!==U[0]||1!==U[1],G=this._daylightSavingAdjust(t.currentDay?new Date(t.currentYear,t.currentMonth,t.currentDay):new Date(9999,9,9)),Q=this._getMinMaxDate(t,"min"),J=this._getMinMaxDate(t,"max"),Z=t.drawMonth-V,te=t.drawYear;if(0>Z&&(Z+=12,te--),J)for(e=this._daylightSavingAdjust(new Date(J.getFullYear(),J.getMonth()-U[0]*U[1]+1,J.getDate())),e=Q&&Q>e?Q:e;this._daylightSavingAdjust(new Date(te,Z,1))>e;)Z--,0>Z&&(Z=11,te--);for(t.drawMonth=Z,t.drawYear=te,i=this._get(t,"prevText"),i=K?this.formatDate(i,this._daylightSavingAdjust(new Date(te,Z-$,1)),this._getFormatConfig(t)):i,s=this._canAdjustMonth(t,-1,te,Z)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"e":"w")+"'>"+i+"</span></a>":q?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"e":"w")+"'>"+i+"</span></a>",n=this._get(t,"nextText"),n=K?this.formatDate(n,this._daylightSavingAdjust(new Date(te,Z+$,1)),this._getFormatConfig(t)):n,o=this._canAdjustMonth(t,1,te,Z)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"w":"e")+"'>"+n+"</span></a>":q?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"w":"e")+"'>"+n+"</span></a>",a=this._get(t,"currentText"),r=this._get(t,"gotoCurrent")&&t.currentDay?G:B,a=K?this.formatDate(a,r,this._getFormatConfig(t)):a,h=t.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(t,"closeText")+"</button>",l=j?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(Y?h:"")+(this._isInRange(t,r)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+a+"</button>":"")+(Y?"":h)+"</div>":"",c=parseInt(this._get(t,"firstDay"),10),c=isNaN(c)?0:c,u=this._get(t,"showWeek"),d=this._get(t,"dayNames"),p=this._get(t,"dayNamesMin"),f=this._get(t,"monthNames"),g=this._get(t,"monthNamesShort"),m=this._get(t,"beforeShowDay"),_=this._get(t,"showOtherMonths"),v=this._get(t,"selectOtherMonths"),b=this._getDefaultDate(t),y="",k=0;U[0]>k;k++){for(x="",this.maxRows=4,C=0;U[1]>C;C++){if(D=this._daylightSavingAdjust(new Date(te,Z,t.selectedDay)),I=" ui-corner-all",T="",X){if(T+="<div class='ui-datepicker-group",U[1]>1)switch(C){case 0:T+=" ui-datepicker-group-first",I=" ui-corner-"+(Y?"right":"left");break;case U[1]-1:T+=" ui-datepicker-group-last",I=" ui-corner-"+(Y?"left":"right");break;default:T+=" ui-datepicker-group-middle",I=""}T+="'>"}for(T+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+I+"'>"+(/all|left/.test(I)&&0===k?Y?o:s:"")+(/all|right/.test(I)&&0===k?Y?s:o:"")+this._generateMonthYearHeader(t,Z,te,Q,J,k>0||C>0,f,g)+"</div><table class='ui-datepicker-calendar'><thead>"+"<tr>",P=u?"<th class='ui-datepicker-week-col'>"+this._get(t,"weekHeader")+"</th>":"",w=0;7>w;w++)M=(w+c)%7,P+="<th scope='col'"+((w+c+6)%7>=5?" class='ui-datepicker-week-end'":"")+">"+"<span title='"+d[M]+"'>"+p[M]+"</span></th>";for(T+=P+"</tr></thead><tbody>",S=this._getDaysInMonth(te,Z),te===t.selectedYear&&Z===t.selectedMonth&&(t.selectedDay=Math.min(t.selectedDay,S)),H=(this._getFirstDayOfMonth(te,Z)-c+7)%7,z=Math.ceil((H+S)/7),O=X?this.maxRows>z?this.maxRows:z:z,this.maxRows=O,A=this._daylightSavingAdjust(new Date(te,Z,1-H)),N=0;O>N;N++){for(T+="<tr>",W=u?"<td class='ui-datepicker-week-col'>"+this._get(t,"calculateWeek")(A)+"</td>":"",w=0;7>w;w++)E=m?m.apply(t.input?t.input[0]:null,[A]):[!0,""],F=A.getMonth()!==Z,L=F&&!v||!E[0]||Q&&Q>A||J&&A>J,W+="<td class='"+((w+c+6)%7>=5?" ui-datepicker-week-end":"")+(F?" ui-datepicker-other-month":"")+(A.getTime()===D.getTime()&&Z===t.selectedMonth&&t._keyEvent||b.getTime()===A.getTime()&&b.getTime()===D.getTime()?" "+this._dayOverClass:"")+(L?" "+this._unselectableClass+" ui-state-disabled":"")+(F&&!_?"":" "+E[1]+(A.getTime()===G.getTime()?" "+this._currentClass:"")+(A.getTime()===B.getTime()?" ui-datepicker-today":""))+"'"+(F&&!_||!E[2]?"":" title='"+E[2].replace(/'/g,"&#39;")+"'")+(L?"":" data-handler='selectDay' data-event='click' data-month='"+A.getMonth()+"' data-year='"+A.getFullYear()+"'")+">"+(F&&!_?"&#xa0;":L?"<span class='ui-state-default'>"+A.getDate()+"</span>":"<a class='ui-state-default"+(A.getTime()===B.getTime()?" ui-state-highlight":"")+(A.getTime()===G.getTime()?" ui-state-active":"")+(F?" ui-priority-secondary":"")+"' href='#'>"+A.getDate()+"</a>")+"</td>",A.setDate(A.getDate()+1),A=this._daylightSavingAdjust(A);T+=W+"</tr>"}Z++,Z>11&&(Z=0,te++),T+="</tbody></table>"+(X?"</div>"+(U[0]>0&&C===U[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),x+=T}y+=x}return y+=l,t._keyEvent=!1,y},_generateMonthYearHeader:function(t,e,i,s,n,o,a,r){var h,l,c,u,d,p,f,g,m=this._get(t,"changeMonth"),_=this._get(t,"changeYear"),v=this._get(t,"showMonthAfterYear"),b="<div class='ui-datepicker-title'>",y="";if(o||!m)y+="<span class='ui-datepicker-month'>"+a[e]+"</span>";else{for(h=s&&s.getFullYear()===i,l=n&&n.getFullYear()===i,y+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",c=0;12>c;c++)(!h||c>=s.getMonth())&&(!l||n.getMonth()>=c)&&(y+="<option value='"+c+"'"+(c===e?" selected='selected'":"")+">"+r[c]+"</option>");y+="</select>"}if(v||(b+=y+(!o&&m&&_?"":"&#xa0;")),!t.yearshtml)if(t.yearshtml="",o||!_)b+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(u=this._get(t,"yearRange").split(":"),d=(new Date).getFullYear(),p=function(t){var e=t.match(/c[+\-].*/)?i+parseInt(t.substring(1),10):t.match(/[+\-].*/)?d+parseInt(t,10):parseInt(t,10);return isNaN(e)?d:e},f=p(u[0]),g=Math.max(f,p(u[1]||"")),f=s?Math.max(f,s.getFullYear()):f,g=n?Math.min(g,n.getFullYear()):g,t.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";g>=f;f++)t.yearshtml+="<option value='"+f+"'"+(f===i?" selected='selected'":"")+">"+f+"</option>";t.yearshtml+="</select>",b+=t.yearshtml,t.yearshtml=null}return b+=this._get(t,"yearSuffix"),v&&(b+=(!o&&m&&_?"":"&#xa0;")+y),b+="</div>"},_adjustInstDate:function(t,e,i){var s=t.selectedYear+("Y"===i?e:0),n=t.selectedMonth+("M"===i?e:0),o=Math.min(t.selectedDay,this._getDaysInMonth(s,n))+("D"===i?e:0),a=this._restrictMinMax(t,this._daylightSavingAdjust(new Date(s,n,o)));t.selectedDay=a.getDate(),t.drawMonth=t.selectedMonth=a.getMonth(),t.drawYear=t.selectedYear=a.getFullYear(),("M"===i||"Y"===i)&&this._notifyChange(t)},_restrictMinMax:function(t,e){var i=this._getMinMaxDate(t,"min"),s=this._getMinMaxDate(t,"max"),n=i&&i>e?i:e;return s&&n>s?s:n},_notifyChange:function(t){var e=this._get(t,"onChangeMonthYear");e&&e.apply(t.input?t.input[0]:null,[t.selectedYear,t.selectedMonth+1,t])},_getNumberOfMonths:function(t){var e=this._get(t,"numberOfMonths");return null==e?[1,1]:"number"==typeof e?[1,e]:e},_getMinMaxDate:function(t,e){return this._determineDate(t,this._get(t,e+"Date"),null)},_getDaysInMonth:function(t,e){return 32-this._daylightSavingAdjust(new Date(t,e,32)).getDate()},_getFirstDayOfMonth:function(t,e){return new Date(t,e,1).getDay()},_canAdjustMonth:function(t,e,i,s){var n=this._getNumberOfMonths(t),o=this._daylightSavingAdjust(new Date(i,s+(0>e?e:n[0]*n[1]),1));return 0>e&&o.setDate(this._getDaysInMonth(o.getFullYear(),o.getMonth())),this._isInRange(t,o)},_isInRange:function(t,e){var i,s,n=this._getMinMaxDate(t,"min"),o=this._getMinMaxDate(t,"max"),a=null,r=null,h=this._get(t,"yearRange");return h&&(i=h.split(":"),s=(new Date).getFullYear(),a=parseInt(i[0],10),r=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(a+=s),i[1].match(/[+\-].*/)&&(r+=s)),(!n||e.getTime()>=n.getTime())&&(!o||e.getTime()<=o.getTime())&&(!a||e.getFullYear()>=a)&&(!r||r>=e.getFullYear())},_getFormatConfig:function(t){var e=this._get(t,"shortYearCutoff");return e="string"!=typeof e?e:(new Date).getFullYear()%100+parseInt(e,10),{shortYearCutoff:e,dayNamesShort:this._get(t,"dayNamesShort"),dayNames:this._get(t,"dayNames"),monthNamesShort:this._get(t,"monthNamesShort"),monthNames:this._get(t,"monthNames")}},_formatDate:function(t,e,i,s){e||(t.currentDay=t.selectedDay,t.currentMonth=t.selectedMonth,t.currentYear=t.selectedYear);var n=e?"object"==typeof e?e:this._daylightSavingAdjust(new Date(s,i,e)):this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return this.formatDate(this._get(t,"dateFormat"),n,this._getFormatConfig(t))}}),t.fn.datepicker=function(e){if(!this.length)return this;t.datepicker.initialized||(t(document).on("mousedown",t.datepicker._checkExternalClick),t.datepicker.initialized=!0),0===t("#"+t.datepicker._mainDivId).length&&t("body").append(t.datepicker.dpDiv);var i=Array.prototype.slice.call(arguments,1);return"string"!=typeof e||"isDisabled"!==e&&"getDate"!==e&&"widget"!==e?"option"===e&&2===arguments.length&&"string"==typeof arguments[1]?t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this[0]].concat(i)):this.each(function(){"string"==typeof e?t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this].concat(i)):t.datepicker._attachDatepicker(this,e)}):t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this[0]].concat(i))},t.datepicker=new s,t.datepicker.initialized=!1,t.datepicker.uuid=(new Date).getTime(),t.datepicker.version="1.12.1",t.datepicker,t.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());var _=!1;t(document).on("mouseup",function(){_=!1}),t.widget("ui.mouse",{version:"1.12.1",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.on("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).on("click."+this.widgetName,function(i){return!0===t.data(i.target,e.widgetName+".preventClickEvent")?(t.removeData(i.target,e.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.off("."+this.widgetName),this._mouseMoveDelegate&&this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(e){if(!_){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(e),this._mouseDownEvent=e;var i=this,s=1===e.which,n="string"==typeof this.options.cancel&&e.target.nodeName?t(e.target).closest(this.options.cancel).length:!1;return s&&!n&&this._mouseCapture(e)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(e)!==!1,!this._mouseStarted)?(e.preventDefault(),!0):(!0===t.data(e.target,this.widgetName+".preventClickEvent")&&t.removeData(e.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return i._mouseMove(t)},this._mouseUpDelegate=function(t){return i._mouseUp(t)},this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate),e.preventDefault(),_=!0,!0)):!0}},_mouseMove:function(e){if(this._mouseMoved){if(t.ui.ie&&(!document.documentMode||9>document.documentMode)&&!e.button)return this._mouseUp(e);if(!e.which)if(e.originalEvent.altKey||e.originalEvent.ctrlKey||e.originalEvent.metaKey||e.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(e)}return(e.which||e.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,e)!==!1,this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(e){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&t.data(e.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(e)),this._mouseDelayTimer&&(clearTimeout(this._mouseDelayTimer),delete this._mouseDelayTimer),this.ignoreMissingWhich=!1,_=!1,e.preventDefault()},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),t.ui.plugin={add:function(e,i,s){var n,o=t.ui[e].prototype;for(n in s)o.plugins[n]=o.plugins[n]||[],o.plugins[n].push([i,s[n]])},call:function(t,e,i,s){var n,o=t.plugins[e];if(o&&(s||t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType))for(n=0;o.length>n;n++)t.options[o[n][0]]&&o[n][1].apply(t.element,i)}},t.ui.safeBlur=function(e){e&&"body"!==e.nodeName.toLowerCase()&&t(e).trigger("blur")},t.widget("ui.draggable",t.ui.mouse,{version:"1.12.1",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this._addClass("ui-draggable"),this._setHandleClassName(),this._mouseInit()},_setOption:function(t,e){this._super(t,e),"handle"===t&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?(this.destroyOnClear=!0,void 0):(this._removeHandleClassName(),this._mouseDestroy(),void 0)},_mouseCapture:function(e){var i=this.options;return this.helper||i.disabled||t(e.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(e),this.handle?(this._blurActiveElement(e),this._blockFrames(i.iframeFix===!0?"iframe":i.iframeFix),!0):!1)},_blockFrames:function(e){this.iframeBlocks=this.document.find(e).map(function(){var e=t(this);return t("<div>").css("position","absolute").appendTo(e.parent()).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).offset(e.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(e){var i=t.ui.safeActiveElement(this.document[0]),s=t(e.target);s.closest(i).length||t.ui.safeBlur(i)},_mouseStart:function(e){var i=this.options;return this.helper=this._createHelper(e),this._addClass(this.helper,"ui-draggable-dragging"),this._cacheHelperProportions(),t.ui.ddmanager&&(t.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===t(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(e),this.originalPosition=this.position=this._generatePosition(e,!1),this.originalPageX=e.pageX,this.originalPageY=e.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger("start",e)===!1?(this._clear(),!1):(this._cacheHelperProportions(),t.ui.ddmanager&&!i.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this._mouseDrag(e,!0),t.ui.ddmanager&&t.ui.ddmanager.dragStart(this,e),!0)},_refreshOffsets:function(t){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:t.pageX-this.offset.left,top:t.pageY-this.offset.top}},_mouseDrag:function(e,i){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(e,!0),this.positionAbs=this._convertPositionTo("absolute"),!i){var s=this._uiHash();if(this._trigger("drag",e,s)===!1)return this._mouseUp(new t.Event("mouseup",e)),!1;this.position=s.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var i=this,s=!1;return t.ui.ddmanager&&!this.options.dropBehaviour&&(s=t.ui.ddmanager.drop(this,e)),this.dropped&&(s=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!s||"valid"===this.options.revert&&s||this.options.revert===!0||t.isFunction(this.options.revert)&&this.options.revert.call(this.element,s)?t(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger("stop",e)!==!1&&i._clear()}):this._trigger("stop",e)!==!1&&this._clear(),!1},_mouseUp:function(e){return this._unblockFrames(),t.ui.ddmanager&&t.ui.ddmanager.dragStop(this,e),this.handleElement.is(e.target)&&this.element.trigger("focus"),t.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp(new t.Event("mouseup",{target:this.element[0]})):this._clear(),this},_getHandle:function(e){return this.options.handle?!!t(e.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this._addClass(this.handleElement,"ui-draggable-handle")},_removeHandleClassName:function(){this._removeClass(this.handleElement,"ui-draggable-handle")},_createHelper:function(e){var i=this.options,s=t.isFunction(i.helper),n=s?t(i.helper.apply(this.element[0],[e])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return n.parents("body").length||n.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),s&&n[0]===this.element[0]&&this._setPositionRelative(),n[0]===this.element[0]||/(fixed|absolute)/.test(n.css("position"))||n.css("position","absolute"),n},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_isRootNode:function(t){return/(html|body)/i.test(t.tagName)||t===this.document[0]},_getParentOffset:function(){var e=this.offsetParent.offset(),i=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==i&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var t=this.element.position(),e=this._isRootNode(this.scrollParent[0]);return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+(e?0:this.scrollParent.scrollTop()),left:t.left-(parseInt(this.helper.css("left"),10)||0)+(e?0:this.scrollParent.scrollLeft())}
},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,s,n=this.options,o=this.document[0];return this.relativeContainer=null,n.containment?"window"===n.containment?(this.containment=[t(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,t(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,t(window).scrollLeft()+t(window).width()-this.helperProportions.width-this.margins.left,t(window).scrollTop()+(t(window).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):"document"===n.containment?(this.containment=[0,0,t(o).width()-this.helperProportions.width-this.margins.left,(t(o).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):n.containment.constructor===Array?(this.containment=n.containment,void 0):("parent"===n.containment&&(n.containment=this.helper[0].parentNode),i=t(n.containment),s=i[0],s&&(e=/(scroll|auto)/.test(i.css("overflow")),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(e?Math.max(s.scrollWidth,s.offsetWidth):s.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(s.scrollHeight,s.offsetHeight):s.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=i),void 0):(this.containment=null,void 0)},_convertPositionTo:function(t,e){e||(e=this.position);var i="absolute"===t?1:-1,s=this._isRootNode(this.scrollParent[0]);return{top:e.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:s?0:this.offset.scroll.top)*i,left:e.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:s?0:this.offset.scroll.left)*i}},_generatePosition:function(t,e){var i,s,n,o,a=this.options,r=this._isRootNode(this.scrollParent[0]),h=t.pageX,l=t.pageY;return r&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),e&&(this.containment&&(this.relativeContainer?(s=this.relativeContainer.offset(),i=[this.containment[0]+s.left,this.containment[1]+s.top,this.containment[2]+s.left,this.containment[3]+s.top]):i=this.containment,t.pageX-this.offset.click.left<i[0]&&(h=i[0]+this.offset.click.left),t.pageY-this.offset.click.top<i[1]&&(l=i[1]+this.offset.click.top),t.pageX-this.offset.click.left>i[2]&&(h=i[2]+this.offset.click.left),t.pageY-this.offset.click.top>i[3]&&(l=i[3]+this.offset.click.top)),a.grid&&(n=a.grid[1]?this.originalPageY+Math.round((l-this.originalPageY)/a.grid[1])*a.grid[1]:this.originalPageY,l=i?n-this.offset.click.top>=i[1]||n-this.offset.click.top>i[3]?n:n-this.offset.click.top>=i[1]?n-a.grid[1]:n+a.grid[1]:n,o=a.grid[0]?this.originalPageX+Math.round((h-this.originalPageX)/a.grid[0])*a.grid[0]:this.originalPageX,h=i?o-this.offset.click.left>=i[0]||o-this.offset.click.left>i[2]?o:o-this.offset.click.left>=i[0]?o-a.grid[0]:o+a.grid[0]:o),"y"===a.axis&&(h=this.originalPageX),"x"===a.axis&&(l=this.originalPageY)),{top:l-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:r?0:this.offset.scroll.top),left:h-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:r?0:this.offset.scroll.left)}},_clear:function(){this._removeClass(this.helper,"ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_trigger:function(e,i,s){return s=s||this._uiHash(),t.ui.plugin.call(this,e,[i,s,this],!0),/^(drag|start|stop)/.test(e)&&(this.positionAbs=this._convertPositionTo("absolute"),s.offset=this.positionAbs),t.Widget.prototype._trigger.call(this,e,i,s)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),t.ui.plugin.add("draggable","connectToSortable",{start:function(e,i,s){var n=t.extend({},i,{item:s.element});s.sortables=[],t(s.options.connectToSortable).each(function(){var i=t(this).sortable("instance");i&&!i.options.disabled&&(s.sortables.push(i),i.refreshPositions(),i._trigger("activate",e,n))})},stop:function(e,i,s){var n=t.extend({},i,{item:s.element});s.cancelHelperRemoval=!1,t.each(s.sortables,function(){var t=this;t.isOver?(t.isOver=0,s.cancelHelperRemoval=!0,t.cancelHelperRemoval=!1,t._storedCSS={position:t.placeholder.css("position"),top:t.placeholder.css("top"),left:t.placeholder.css("left")},t._mouseStop(e),t.options.helper=t.options._helper):(t.cancelHelperRemoval=!0,t._trigger("deactivate",e,n))})},drag:function(e,i,s){t.each(s.sortables,function(){var n=!1,o=this;o.positionAbs=s.positionAbs,o.helperProportions=s.helperProportions,o.offset.click=s.offset.click,o._intersectsWith(o.containerCache)&&(n=!0,t.each(s.sortables,function(){return this.positionAbs=s.positionAbs,this.helperProportions=s.helperProportions,this.offset.click=s.offset.click,this!==o&&this._intersectsWith(this.containerCache)&&t.contains(o.element[0],this.element[0])&&(n=!1),n})),n?(o.isOver||(o.isOver=1,s._parent=i.helper.parent(),o.currentItem=i.helper.appendTo(o.element).data("ui-sortable-item",!0),o.options._helper=o.options.helper,o.options.helper=function(){return i.helper[0]},e.target=o.currentItem[0],o._mouseCapture(e,!0),o._mouseStart(e,!0,!0),o.offset.click.top=s.offset.click.top,o.offset.click.left=s.offset.click.left,o.offset.parent.left-=s.offset.parent.left-o.offset.parent.left,o.offset.parent.top-=s.offset.parent.top-o.offset.parent.top,s._trigger("toSortable",e),s.dropped=o.element,t.each(s.sortables,function(){this.refreshPositions()}),s.currentItem=s.element,o.fromOutside=s),o.currentItem&&(o._mouseDrag(e),i.position=o.position)):o.isOver&&(o.isOver=0,o.cancelHelperRemoval=!0,o.options._revert=o.options.revert,o.options.revert=!1,o._trigger("out",e,o._uiHash(o)),o._mouseStop(e,!0),o.options.revert=o.options._revert,o.options.helper=o.options._helper,o.placeholder&&o.placeholder.remove(),i.helper.appendTo(s._parent),s._refreshOffsets(e),i.position=s._generatePosition(e,!0),s._trigger("fromSortable",e),s.dropped=!1,t.each(s.sortables,function(){this.refreshPositions()}))})}}),t.ui.plugin.add("draggable","cursor",{start:function(e,i,s){var n=t("body"),o=s.options;n.css("cursor")&&(o._cursor=n.css("cursor")),n.css("cursor",o.cursor)},stop:function(e,i,s){var n=s.options;n._cursor&&t("body").css("cursor",n._cursor)}}),t.ui.plugin.add("draggable","opacity",{start:function(e,i,s){var n=t(i.helper),o=s.options;n.css("opacity")&&(o._opacity=n.css("opacity")),n.css("opacity",o.opacity)},stop:function(e,i,s){var n=s.options;n._opacity&&t(i.helper).css("opacity",n._opacity)}}),t.ui.plugin.add("draggable","scroll",{start:function(t,e,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(e,i,s){var n=s.options,o=!1,a=s.scrollParentNotHidden[0],r=s.document[0];a!==r&&"HTML"!==a.tagName?(n.axis&&"x"===n.axis||(s.overflowOffset.top+a.offsetHeight-e.pageY<n.scrollSensitivity?a.scrollTop=o=a.scrollTop+n.scrollSpeed:e.pageY-s.overflowOffset.top<n.scrollSensitivity&&(a.scrollTop=o=a.scrollTop-n.scrollSpeed)),n.axis&&"y"===n.axis||(s.overflowOffset.left+a.offsetWidth-e.pageX<n.scrollSensitivity?a.scrollLeft=o=a.scrollLeft+n.scrollSpeed:e.pageX-s.overflowOffset.left<n.scrollSensitivity&&(a.scrollLeft=o=a.scrollLeft-n.scrollSpeed))):(n.axis&&"x"===n.axis||(e.pageY-t(r).scrollTop()<n.scrollSensitivity?o=t(r).scrollTop(t(r).scrollTop()-n.scrollSpeed):t(window).height()-(e.pageY-t(r).scrollTop())<n.scrollSensitivity&&(o=t(r).scrollTop(t(r).scrollTop()+n.scrollSpeed))),n.axis&&"y"===n.axis||(e.pageX-t(r).scrollLeft()<n.scrollSensitivity?o=t(r).scrollLeft(t(r).scrollLeft()-n.scrollSpeed):t(window).width()-(e.pageX-t(r).scrollLeft())<n.scrollSensitivity&&(o=t(r).scrollLeft(t(r).scrollLeft()+n.scrollSpeed)))),o!==!1&&t.ui.ddmanager&&!n.dropBehaviour&&t.ui.ddmanager.prepareOffsets(s,e)}}),t.ui.plugin.add("draggable","snap",{start:function(e,i,s){var n=s.options;s.snapElements=[],t(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var e=t(this),i=e.offset();this!==s.element[0]&&s.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:i.top,left:i.left})})},drag:function(e,i,s){var n,o,a,r,h,l,c,u,d,p,f=s.options,g=f.snapTolerance,m=i.offset.left,_=m+s.helperProportions.width,v=i.offset.top,b=v+s.helperProportions.height;for(d=s.snapElements.length-1;d>=0;d--)h=s.snapElements[d].left-s.margins.left,l=h+s.snapElements[d].width,c=s.snapElements[d].top-s.margins.top,u=c+s.snapElements[d].height,h-g>_||m>l+g||c-g>b||v>u+g||!t.contains(s.snapElements[d].item.ownerDocument,s.snapElements[d].item)?(s.snapElements[d].snapping&&s.options.snap.release&&s.options.snap.release.call(s.element,e,t.extend(s._uiHash(),{snapItem:s.snapElements[d].item})),s.snapElements[d].snapping=!1):("inner"!==f.snapMode&&(n=g>=Math.abs(c-b),o=g>=Math.abs(u-v),a=g>=Math.abs(h-_),r=g>=Math.abs(l-m),n&&(i.position.top=s._convertPositionTo("relative",{top:c-s.helperProportions.height,left:0}).top),o&&(i.position.top=s._convertPositionTo("relative",{top:u,left:0}).top),a&&(i.position.left=s._convertPositionTo("relative",{top:0,left:h-s.helperProportions.width}).left),r&&(i.position.left=s._convertPositionTo("relative",{top:0,left:l}).left)),p=n||o||a||r,"outer"!==f.snapMode&&(n=g>=Math.abs(c-v),o=g>=Math.abs(u-b),a=g>=Math.abs(h-m),r=g>=Math.abs(l-_),n&&(i.position.top=s._convertPositionTo("relative",{top:c,left:0}).top),o&&(i.position.top=s._convertPositionTo("relative",{top:u-s.helperProportions.height,left:0}).top),a&&(i.position.left=s._convertPositionTo("relative",{top:0,left:h}).left),r&&(i.position.left=s._convertPositionTo("relative",{top:0,left:l-s.helperProportions.width}).left)),!s.snapElements[d].snapping&&(n||o||a||r||p)&&s.options.snap.snap&&s.options.snap.snap.call(s.element,e,t.extend(s._uiHash(),{snapItem:s.snapElements[d].item})),s.snapElements[d].snapping=n||o||a||r||p)}}),t.ui.plugin.add("draggable","stack",{start:function(e,i,s){var n,o=s.options,a=t.makeArray(t(o.stack)).sort(function(e,i){return(parseInt(t(e).css("zIndex"),10)||0)-(parseInt(t(i).css("zIndex"),10)||0)});a.length&&(n=parseInt(t(a[0]).css("zIndex"),10)||0,t(a).each(function(e){t(this).css("zIndex",n+e)}),this.css("zIndex",n+a.length))}}),t.ui.plugin.add("draggable","zIndex",{start:function(e,i,s){var n=t(i.helper),o=s.options;n.css("zIndex")&&(o._zIndex=n.css("zIndex")),n.css("zIndex",o.zIndex)},stop:function(e,i,s){var n=s.options;n._zIndex&&t(i.helper).css("zIndex",n._zIndex)}}),t.ui.draggable,t.widget("ui.resizable",t.ui.mouse,{version:"1.12.1",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,classes:{"ui-resizable-se":"ui-icon ui-icon-gripsmall-diagonal-se"},containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(t){return parseFloat(t)||0},_isNumber:function(t){return!isNaN(parseFloat(t))},_hasScroll:function(e,i){if("hidden"===t(e).css("overflow"))return!1;var s=i&&"left"===i?"scrollLeft":"scrollTop",n=!1;return e[s]>0?!0:(e[s]=1,n=e[s]>0,e[s]=0,n)},_create:function(){var e,i=this.options,s=this;this._addClass("ui-resizable"),t.extend(this,{_aspectRatio:!!i.aspectRatio,aspectRatio:i.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:i.helper||i.ghost||i.animate?i.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap(t("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,e={marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom"),marginLeft:this.originalElement.css("marginLeft")},this.element.css(e),this.originalElement.css("margin",0),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css(e),this._proportionallyResize()),this._setupHandles(),i.autoHide&&t(this.element).on("mouseenter",function(){i.disabled||(s._removeClass("ui-resizable-autohide"),s._handles.show())}).on("mouseleave",function(){i.disabled||s.resizing||(s._addClass("ui-resizable-autohide"),s._handles.hide())}),this._mouseInit()},_destroy:function(){this._mouseDestroy();var e,i=function(e){t(e).removeData("resizable").removeData("ui-resizable").off(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(i(this.element),e=this.element,this.originalElement.css({position:e.css("position"),width:e.outerWidth(),height:e.outerHeight(),top:e.css("top"),left:e.css("left")}).insertAfter(e),e.remove()),this.originalElement.css("resize",this.originalResizeStyle),i(this.originalElement),this},_setOption:function(t,e){switch(this._super(t,e),t){case"handles":this._removeHandles(),this._setupHandles();break;default:}},_setupHandles:function(){var e,i,s,n,o,a=this.options,r=this;if(this.handles=a.handles||(t(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=t(),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),s=this.handles.split(","),this.handles={},i=0;s.length>i;i++)e=t.trim(s[i]),n="ui-resizable-"+e,o=t("<div>"),this._addClass(o,"ui-resizable-handle "+n),o.css({zIndex:a.zIndex}),this.handles[e]=".ui-resizable-"+e,this.element.append(o);this._renderAxis=function(e){var i,s,n,o;e=e||this.element;for(i in this.handles)this.handles[i].constructor===String?this.handles[i]=this.element.children(this.handles[i]).first().show():(this.handles[i].jquery||this.handles[i].nodeType)&&(this.handles[i]=t(this.handles[i]),this._on(this.handles[i],{mousedown:r._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(s=t(this.handles[i],this.element),o=/sw|ne|nw|se|n|s/.test(i)?s.outerHeight():s.outerWidth(),n=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join(""),e.css(n,o),this._proportionallyResize()),this._handles=this._handles.add(this.handles[i])},this._renderAxis(this.element),this._handles=this._handles.add(this.element.find(".ui-resizable-handle")),this._handles.disableSelection(),this._handles.on("mouseover",function(){r.resizing||(this.className&&(o=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),r.axis=o&&o[1]?o[1]:"se")}),a.autoHide&&(this._handles.hide(),this._addClass("ui-resizable-autohide"))},_removeHandles:function(){this._handles.remove()},_mouseCapture:function(e){var i,s,n=!1;for(i in this.handles)s=t(this.handles[i])[0],(s===e.target||t.contains(s,e.target))&&(n=!0);return!this.options.disabled&&n},_mouseStart:function(e){var i,s,n,o=this.options,a=this.element;return this.resizing=!0,this._renderProxy(),i=this._num(this.helper.css("left")),s=this._num(this.helper.css("top")),o.containment&&(i+=t(o.containment).scrollLeft()||0,s+=t(o.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:i,top:s},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:a.width(),height:a.height()},this.originalSize=this._helper?{width:a.outerWidth(),height:a.outerHeight()}:{width:a.width(),height:a.height()},this.sizeDiff={width:a.outerWidth()-a.width(),height:a.outerHeight()-a.height()},this.originalPosition={left:i,top:s},this.originalMousePosition={left:e.pageX,top:e.pageY},this.aspectRatio="number"==typeof o.aspectRatio?o.aspectRatio:this.originalSize.width/this.originalSize.height||1,n=t(".ui-resizable-"+this.axis).css("cursor"),t("body").css("cursor","auto"===n?this.axis+"-resize":n),this._addClass("ui-resizable-resizing"),this._propagate("start",e),!0},_mouseDrag:function(e){var i,s,n=this.originalMousePosition,o=this.axis,a=e.pageX-n.left||0,r=e.pageY-n.top||0,h=this._change[o];return this._updatePrevProperties(),h?(i=h.apply(this,[e,a,r]),this._updateVirtualBoundaries(e.shiftKey),(this._aspectRatio||e.shiftKey)&&(i=this._updateRatio(i,e)),i=this._respectSize(i,e),this._updateCache(i),this._propagate("resize",e),s=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),t.isEmptyObject(s)||(this._updatePrevProperties(),this._trigger("resize",e,this.ui()),this._applyChanges()),!1):!1},_mouseStop:function(e){this.resizing=!1;var i,s,n,o,a,r,h,l=this.options,c=this;return this._helper&&(i=this._proportionallyResizeElements,s=i.length&&/textarea/i.test(i[0].nodeName),n=s&&this._hasScroll(i[0],"left")?0:c.sizeDiff.height,o=s?0:c.sizeDiff.width,a={width:c.helper.width()-o,height:c.helper.height()-n},r=parseFloat(c.element.css("left"))+(c.position.left-c.originalPosition.left)||null,h=parseFloat(c.element.css("top"))+(c.position.top-c.originalPosition.top)||null,l.animate||this.element.css(t.extend(a,{top:h,left:r})),c.helper.height(c.size.height),c.helper.width(c.size.width),this._helper&&!l.animate&&this._proportionallyResize()),t("body").css("cursor","auto"),this._removeClass("ui-resizable-resizing"),this._propagate("stop",e),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var t={};return this.position.top!==this.prevPosition.top&&(t.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(t.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(t.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(t.height=this.size.height+"px"),this.helper.css(t),t},_updateVirtualBoundaries:function(t){var e,i,s,n,o,a=this.options;o={minWidth:this._isNumber(a.minWidth)?a.minWidth:0,maxWidth:this._isNumber(a.maxWidth)?a.maxWidth:1/0,minHeight:this._isNumber(a.minHeight)?a.minHeight:0,maxHeight:this._isNumber(a.maxHeight)?a.maxHeight:1/0},(this._aspectRatio||t)&&(e=o.minHeight*this.aspectRatio,s=o.minWidth/this.aspectRatio,i=o.maxHeight*this.aspectRatio,n=o.maxWidth/this.aspectRatio,e>o.minWidth&&(o.minWidth=e),s>o.minHeight&&(o.minHeight=s),o.maxWidth>i&&(o.maxWidth=i),o.maxHeight>n&&(o.maxHeight=n)),this._vBoundaries=o},_updateCache:function(t){this.offset=this.helper.offset(),this._isNumber(t.left)&&(this.position.left=t.left),this._isNumber(t.top)&&(this.position.top=t.top),this._isNumber(t.height)&&(this.size.height=t.height),this._isNumber(t.width)&&(this.size.width=t.width)},_updateRatio:function(t){var e=this.position,i=this.size,s=this.axis;return this._isNumber(t.height)?t.width=t.height*this.aspectRatio:this._isNumber(t.width)&&(t.height=t.width/this.aspectRatio),"sw"===s&&(t.left=e.left+(i.width-t.width),t.top=null),"nw"===s&&(t.top=e.top+(i.height-t.height),t.left=e.left+(i.width-t.width)),t},_respectSize:function(t){var e=this._vBoundaries,i=this.axis,s=this._isNumber(t.width)&&e.maxWidth&&e.maxWidth<t.width,n=this._isNumber(t.height)&&e.maxHeight&&e.maxHeight<t.height,o=this._isNumber(t.width)&&e.minWidth&&e.minWidth>t.width,a=this._isNumber(t.height)&&e.minHeight&&e.minHeight>t.height,r=this.originalPosition.left+this.originalSize.width,h=this.originalPosition.top+this.originalSize.height,l=/sw|nw|w/.test(i),c=/nw|ne|n/.test(i);return o&&(t.width=e.minWidth),a&&(t.height=e.minHeight),s&&(t.width=e.maxWidth),n&&(t.height=e.maxHeight),o&&l&&(t.left=r-e.minWidth),s&&l&&(t.left=r-e.maxWidth),a&&c&&(t.top=h-e.minHeight),n&&c&&(t.top=h-e.maxHeight),t.width||t.height||t.left||!t.top?t.width||t.height||t.top||!t.left||(t.left=null):t.top=null,t},_getPaddingPlusBorderDimensions:function(t){for(var e=0,i=[],s=[t.css("borderTopWidth"),t.css("borderRightWidth"),t.css("borderBottomWidth"),t.css("borderLeftWidth")],n=[t.css("paddingTop"),t.css("paddingRight"),t.css("paddingBottom"),t.css("paddingLeft")];4>e;e++)i[e]=parseFloat(s[e])||0,i[e]+=parseFloat(n[e])||0;return{height:i[0]+i[2],width:i[1]+i[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var t,e=0,i=this.helper||this.element;this._proportionallyResizeElements.length>e;e++)t=this._proportionallyResizeElements[e],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(t)),t.css({height:i.height()-this.outerDimensions.height||0,width:i.width()-this.outerDimensions.width||0})},_renderProxy:function(){var e=this.element,i=this.options;this.elementOffset=e.offset(),this._helper?(this.helper=this.helper||t("<div style='overflow:hidden;'></div>"),this._addClass(this.helper,this._helper),this.helper.css({width:this.element.outerWidth(),height:this.element.outerHeight(),position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++i.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(t,e){return{width:this.originalSize.width+e}},w:function(t,e){var i=this.originalSize,s=this.originalPosition;return{left:s.left+e,width:i.width-e}},n:function(t,e,i){var s=this.originalSize,n=this.originalPosition;return{top:n.top+i,height:s.height-i}},s:function(t,e,i){return{height:this.originalSize.height+i}},se:function(e,i,s){return t.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[e,i,s]))},sw:function(e,i,s){return t.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[e,i,s]))},ne:function(e,i,s){return t.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[e,i,s]))},nw:function(e,i,s){return t.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[e,i,s]))}},_propagate:function(e,i){t.ui.plugin.call(this,e,[i,this.ui()]),"resize"!==e&&this._trigger(e,i,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),t.ui.plugin.add("resizable","animate",{stop:function(e){var i=t(this).resizable("instance"),s=i.options,n=i._proportionallyResizeElements,o=n.length&&/textarea/i.test(n[0].nodeName),a=o&&i._hasScroll(n[0],"left")?0:i.sizeDiff.height,r=o?0:i.sizeDiff.width,h={width:i.size.width-r,height:i.size.height-a},l=parseFloat(i.element.css("left"))+(i.position.left-i.originalPosition.left)||null,c=parseFloat(i.element.css("top"))+(i.position.top-i.originalPosition.top)||null;i.element.animate(t.extend(h,c&&l?{top:c,left:l}:{}),{duration:s.animateDuration,easing:s.animateEasing,step:function(){var s={width:parseFloat(i.element.css("width")),height:parseFloat(i.element.css("height")),top:parseFloat(i.element.css("top")),left:parseFloat(i.element.css("left"))};n&&n.length&&t(n[0]).css({width:s.width,height:s.height}),i._updateCache(s),i._propagate("resize",e)}})}}),t.ui.plugin.add("resizable","containment",{start:function(){var e,i,s,n,o,a,r,h=t(this).resizable("instance"),l=h.options,c=h.element,u=l.containment,d=u instanceof t?u.get(0):/parent/.test(u)?c.parent().get(0):u;d&&(h.containerElement=t(d),/document/.test(u)||u===document?(h.containerOffset={left:0,top:0},h.containerPosition={left:0,top:0},h.parentData={element:t(document),left:0,top:0,width:t(document).width(),height:t(document).height()||document.body.parentNode.scrollHeight}):(e=t(d),i=[],t(["Top","Right","Left","Bottom"]).each(function(t,s){i[t]=h._num(e.css("padding"+s))}),h.containerOffset=e.offset(),h.containerPosition=e.position(),h.containerSize={height:e.innerHeight()-i[3],width:e.innerWidth()-i[1]},s=h.containerOffset,n=h.containerSize.height,o=h.containerSize.width,a=h._hasScroll(d,"left")?d.scrollWidth:o,r=h._hasScroll(d)?d.scrollHeight:n,h.parentData={element:d,left:s.left,top:s.top,width:a,height:r}))},resize:function(e){var i,s,n,o,a=t(this).resizable("instance"),r=a.options,h=a.containerOffset,l=a.position,c=a._aspectRatio||e.shiftKey,u={top:0,left:0},d=a.containerElement,p=!0;d[0]!==document&&/static/.test(d.css("position"))&&(u=h),l.left<(a._helper?h.left:0)&&(a.size.width=a.size.width+(a._helper?a.position.left-h.left:a.position.left-u.left),c&&(a.size.height=a.size.width/a.aspectRatio,p=!1),a.position.left=r.helper?h.left:0),l.top<(a._helper?h.top:0)&&(a.size.height=a.size.height+(a._helper?a.position.top-h.top:a.position.top),c&&(a.size.width=a.size.height*a.aspectRatio,p=!1),a.position.top=a._helper?h.top:0),n=a.containerElement.get(0)===a.element.parent().get(0),o=/relative|absolute/.test(a.containerElement.css("position")),n&&o?(a.offset.left=a.parentData.left+a.position.left,a.offset.top=a.parentData.top+a.position.top):(a.offset.left=a.element.offset().left,a.offset.top=a.element.offset().top),i=Math.abs(a.sizeDiff.width+(a._helper?a.offset.left-u.left:a.offset.left-h.left)),s=Math.abs(a.sizeDiff.height+(a._helper?a.offset.top-u.top:a.offset.top-h.top)),i+a.size.width>=a.parentData.width&&(a.size.width=a.parentData.width-i,c&&(a.size.height=a.size.width/a.aspectRatio,p=!1)),s+a.size.height>=a.parentData.height&&(a.size.height=a.parentData.height-s,c&&(a.size.width=a.size.height*a.aspectRatio,p=!1)),p||(a.position.left=a.prevPosition.left,a.position.top=a.prevPosition.top,a.size.width=a.prevSize.width,a.size.height=a.prevSize.height)},stop:function(){var e=t(this).resizable("instance"),i=e.options,s=e.containerOffset,n=e.containerPosition,o=e.containerElement,a=t(e.helper),r=a.offset(),h=a.outerWidth()-e.sizeDiff.width,l=a.outerHeight()-e.sizeDiff.height;e._helper&&!i.animate&&/relative/.test(o.css("position"))&&t(this).css({left:r.left-n.left-s.left,width:h,height:l}),e._helper&&!i.animate&&/static/.test(o.css("position"))&&t(this).css({left:r.left-n.left-s.left,width:h,height:l})}}),t.ui.plugin.add("resizable","alsoResize",{start:function(){var e=t(this).resizable("instance"),i=e.options;t(i.alsoResize).each(function(){var e=t(this);e.data("ui-resizable-alsoresize",{width:parseFloat(e.width()),height:parseFloat(e.height()),left:parseFloat(e.css("left")),top:parseFloat(e.css("top"))})})},resize:function(e,i){var s=t(this).resizable("instance"),n=s.options,o=s.originalSize,a=s.originalPosition,r={height:s.size.height-o.height||0,width:s.size.width-o.width||0,top:s.position.top-a.top||0,left:s.position.left-a.left||0};t(n.alsoResize).each(function(){var e=t(this),s=t(this).data("ui-resizable-alsoresize"),n={},o=e.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];t.each(o,function(t,e){var i=(s[e]||0)+(r[e]||0);i&&i>=0&&(n[e]=i||null)}),e.css(n)})},stop:function(){t(this).removeData("ui-resizable-alsoresize")}}),t.ui.plugin.add("resizable","ghost",{start:function(){var e=t(this).resizable("instance"),i=e.size;e.ghost=e.originalElement.clone(),e.ghost.css({opacity:.25,display:"block",position:"relative",height:i.height,width:i.width,margin:0,left:0,top:0}),e._addClass(e.ghost,"ui-resizable-ghost"),t.uiBackCompat!==!1&&"string"==typeof e.options.ghost&&e.ghost.addClass(this.options.ghost),e.ghost.appendTo(e.helper)},resize:function(){var e=t(this).resizable("instance");e.ghost&&e.ghost.css({position:"relative",height:e.size.height,width:e.size.width})},stop:function(){var e=t(this).resizable("instance");e.ghost&&e.helper&&e.helper.get(0).removeChild(e.ghost.get(0))}}),t.ui.plugin.add("resizable","grid",{resize:function(){var e,i=t(this).resizable("instance"),s=i.options,n=i.size,o=i.originalSize,a=i.originalPosition,r=i.axis,h="number"==typeof s.grid?[s.grid,s.grid]:s.grid,l=h[0]||1,c=h[1]||1,u=Math.round((n.width-o.width)/l)*l,d=Math.round((n.height-o.height)/c)*c,p=o.width+u,f=o.height+d,g=s.maxWidth&&p>s.maxWidth,m=s.maxHeight&&f>s.maxHeight,_=s.minWidth&&s.minWidth>p,v=s.minHeight&&s.minHeight>f;s.grid=h,_&&(p+=l),v&&(f+=c),g&&(p-=l),m&&(f-=c),/^(se|s|e)$/.test(r)?(i.size.width=p,i.size.height=f):/^(ne)$/.test(r)?(i.size.width=p,i.size.height=f,i.position.top=a.top-d):/^(sw)$/.test(r)?(i.size.width=p,i.size.height=f,i.position.left=a.left-u):((0>=f-c||0>=p-l)&&(e=i._getPaddingPlusBorderDimensions(this)),f-c>0?(i.size.height=f,i.position.top=a.top-d):(f=c-e.height,i.size.height=f,i.position.top=a.top+o.height-f),p-l>0?(i.size.width=p,i.position.left=a.left-u):(p=l-e.width,i.size.width=p,i.position.left=a.left+o.width-p))}}),t.ui.resizable,t.widget("ui.dialog",{version:"1.12.1",options:{appendTo:"body",autoOpen:!0,buttons:[],classes:{"ui-dialog":"ui-corner-all","ui-dialog-titlebar":"ui-corner-all"},closeOnEscape:!0,closeText:"Close",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(e){var i=t(this).css(e).offset().top;0>i&&t(this).css("top",e.top-i)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),null==this.options.title&&null!=this.originalTitle&&(this.options.title=this.originalTitle),this.options.disabled&&(this.options.disabled=!1),this._createWrapper(),this.element.show().removeAttr("title").appendTo(this.uiDialog),this._addClass("ui-dialog-content","ui-widget-content"),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&t.fn.draggable&&this._makeDraggable(),this.options.resizable&&t.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var e=this.options.appendTo;return e&&(e.jquery||e.nodeType)?t(e):this.document.find(e||"body").eq(0)},_destroy:function(){var t,e=this.originalPosition;this._untrackInstance(),this._destroyOverlay(),this.element.removeUniqueId().css(this.originalCss).detach(),this.uiDialog.remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),t=e.parent.children().eq(e.index),t.length&&t[0]!==this.element[0]?t.before(this.element):e.parent.append(this.element)},widget:function(){return this.uiDialog
},disable:t.noop,enable:t.noop,close:function(e){var i=this;this._isOpen&&this._trigger("beforeClose",e)!==!1&&(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),this.opener.filter(":focusable").trigger("focus").length||t.ui.safeBlur(t.ui.safeActiveElement(this.document[0])),this._hide(this.uiDialog,this.options.hide,function(){i._trigger("close",e)}))},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(e,i){var s=!1,n=this.uiDialog.siblings(".ui-front:visible").map(function(){return+t(this).css("z-index")}).get(),o=Math.max.apply(null,n);return o>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",o+1),s=!0),s&&!i&&this._trigger("focus",e),s},open:function(){var e=this;return this._isOpen?(this._moveToTop()&&this._focusTabbable(),void 0):(this._isOpen=!0,this.opener=t(t.ui.safeActiveElement(this.document[0])),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,function(){e._focusTabbable(),e._trigger("focus")}),this._makeFocusTarget(),this._trigger("open"),void 0)},_focusTabbable:function(){var t=this._focusedElement;t||(t=this.element.find("[autofocus]")),t.length||(t=this.element.find(":tabbable")),t.length||(t=this.uiDialogButtonPane.find(":tabbable")),t.length||(t=this.uiDialogTitlebarClose.filter(":tabbable")),t.length||(t=this.uiDialog),t.eq(0).trigger("focus")},_keepFocus:function(e){function i(){var e=t.ui.safeActiveElement(this.document[0]),i=this.uiDialog[0]===e||t.contains(this.uiDialog[0],e);i||this._focusTabbable()}e.preventDefault(),i.call(this),this._delay(i)},_createWrapper:function(){this.uiDialog=t("<div>").hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._addClass(this.uiDialog,"ui-dialog","ui-widget ui-widget-content ui-front"),this._on(this.uiDialog,{keydown:function(e){if(this.options.closeOnEscape&&!e.isDefaultPrevented()&&e.keyCode&&e.keyCode===t.ui.keyCode.ESCAPE)return e.preventDefault(),this.close(e),void 0;if(e.keyCode===t.ui.keyCode.TAB&&!e.isDefaultPrevented()){var i=this.uiDialog.find(":tabbable"),s=i.filter(":first"),n=i.filter(":last");e.target!==n[0]&&e.target!==this.uiDialog[0]||e.shiftKey?e.target!==s[0]&&e.target!==this.uiDialog[0]||!e.shiftKey||(this._delay(function(){n.trigger("focus")}),e.preventDefault()):(this._delay(function(){s.trigger("focus")}),e.preventDefault())}},mousedown:function(t){this._moveToTop(t)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var e;this.uiDialogTitlebar=t("<div>"),this._addClass(this.uiDialogTitlebar,"ui-dialog-titlebar","ui-widget-header ui-helper-clearfix"),this._on(this.uiDialogTitlebar,{mousedown:function(e){t(e.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.trigger("focus")}}),this.uiDialogTitlebarClose=t("<button type='button'></button>").button({label:t("<a>").text(this.options.closeText).html(),icon:"ui-icon-closethick",showLabel:!1}).appendTo(this.uiDialogTitlebar),this._addClass(this.uiDialogTitlebarClose,"ui-dialog-titlebar-close"),this._on(this.uiDialogTitlebarClose,{click:function(t){t.preventDefault(),this.close(t)}}),e=t("<span>").uniqueId().prependTo(this.uiDialogTitlebar),this._addClass(e,"ui-dialog-title"),this._title(e),this.uiDialogTitlebar.prependTo(this.uiDialog),this.uiDialog.attr({"aria-labelledby":e.attr("id")})},_title:function(t){this.options.title?t.text(this.options.title):t.html("&#160;")},_createButtonPane:function(){this.uiDialogButtonPane=t("<div>"),this._addClass(this.uiDialogButtonPane,"ui-dialog-buttonpane","ui-widget-content ui-helper-clearfix"),this.uiButtonSet=t("<div>").appendTo(this.uiDialogButtonPane),this._addClass(this.uiButtonSet,"ui-dialog-buttonset"),this._createButtons()},_createButtons:function(){var e=this,i=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),t.isEmptyObject(i)||t.isArray(i)&&!i.length?(this._removeClass(this.uiDialog,"ui-dialog-buttons"),void 0):(t.each(i,function(i,s){var n,o;s=t.isFunction(s)?{click:s,text:i}:s,s=t.extend({type:"button"},s),n=s.click,o={icon:s.icon,iconPosition:s.iconPosition,showLabel:s.showLabel,icons:s.icons,text:s.text},delete s.click,delete s.icon,delete s.iconPosition,delete s.showLabel,delete s.icons,"boolean"==typeof s.text&&delete s.text,t("<button></button>",s).button(o).appendTo(e.uiButtonSet).on("click",function(){n.apply(e.element[0],arguments)})}),this._addClass(this.uiDialog,"ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog),void 0)},_makeDraggable:function(){function e(t){return{position:t.position,offset:t.offset}}var i=this,s=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(s,n){i._addClass(t(this),"ui-dialog-dragging"),i._blockFrames(),i._trigger("dragStart",s,e(n))},drag:function(t,s){i._trigger("drag",t,e(s))},stop:function(n,o){var a=o.offset.left-i.document.scrollLeft(),r=o.offset.top-i.document.scrollTop();s.position={my:"left top",at:"left"+(a>=0?"+":"")+a+" "+"top"+(r>=0?"+":"")+r,of:i.window},i._removeClass(t(this),"ui-dialog-dragging"),i._unblockFrames(),i._trigger("dragStop",n,e(o))}})},_makeResizable:function(){function e(t){return{originalPosition:t.originalPosition,originalSize:t.originalSize,position:t.position,size:t.size}}var i=this,s=this.options,n=s.resizable,o=this.uiDialog.css("position"),a="string"==typeof n?n:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:s.maxWidth,maxHeight:s.maxHeight,minWidth:s.minWidth,minHeight:this._minHeight(),handles:a,start:function(s,n){i._addClass(t(this),"ui-dialog-resizing"),i._blockFrames(),i._trigger("resizeStart",s,e(n))},resize:function(t,s){i._trigger("resize",t,e(s))},stop:function(n,o){var a=i.uiDialog.offset(),r=a.left-i.document.scrollLeft(),h=a.top-i.document.scrollTop();s.height=i.uiDialog.height(),s.width=i.uiDialog.width(),s.position={my:"left top",at:"left"+(r>=0?"+":"")+r+" "+"top"+(h>=0?"+":"")+h,of:i.window},i._removeClass(t(this),"ui-dialog-resizing"),i._unblockFrames(),i._trigger("resizeStop",n,e(o))}}).css("position",o)},_trackFocus:function(){this._on(this.widget(),{focusin:function(e){this._makeFocusTarget(),this._focusedElement=t(e.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var e=this._trackingInstances(),i=t.inArray(this,e);-1!==i&&e.splice(i,1)},_trackingInstances:function(){var t=this.document.data("ui-dialog-instances");return t||(t=[],this.document.data("ui-dialog-instances",t)),t},_minHeight:function(){var t=this.options;return"auto"===t.height?t.minHeight:Math.min(t.minHeight,t.height)},_position:function(){var t=this.uiDialog.is(":visible");t||this.uiDialog.show(),this.uiDialog.position(this.options.position),t||this.uiDialog.hide()},_setOptions:function(e){var i=this,s=!1,n={};t.each(e,function(t,e){i._setOption(t,e),t in i.sizeRelatedOptions&&(s=!0),t in i.resizableRelatedOptions&&(n[t]=e)}),s&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",n)},_setOption:function(e,i){var s,n,o=this.uiDialog;"disabled"!==e&&(this._super(e,i),"appendTo"===e&&this.uiDialog.appendTo(this._appendTo()),"buttons"===e&&this._createButtons(),"closeText"===e&&this.uiDialogTitlebarClose.button({label:t("<a>").text(""+this.options.closeText).html()}),"draggable"===e&&(s=o.is(":data(ui-draggable)"),s&&!i&&o.draggable("destroy"),!s&&i&&this._makeDraggable()),"position"===e&&this._position(),"resizable"===e&&(n=o.is(":data(ui-resizable)"),n&&!i&&o.resizable("destroy"),n&&"string"==typeof i&&o.resizable("option","handles",i),n||i===!1||this._makeResizable()),"title"===e&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var t,e,i,s=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),s.minWidth>s.width&&(s.width=s.minWidth),t=this.uiDialog.css({height:"auto",width:s.width}).outerHeight(),e=Math.max(0,s.minHeight-t),i="number"==typeof s.maxHeight?Math.max(0,s.maxHeight-t):"none","auto"===s.height?this.element.css({minHeight:e,maxHeight:i,height:"auto"}):this.element.height(Math.max(0,s.height-t)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var e=t(this);return t("<div>").css({position:"absolute",width:e.outerWidth(),height:e.outerHeight()}).appendTo(e.parent()).offset(e.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(e){return t(e.target).closest(".ui-dialog").length?!0:!!t(e.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var e=!0;this._delay(function(){e=!1}),this.document.data("ui-dialog-overlays")||this._on(this.document,{focusin:function(t){e||this._allowInteraction(t)||(t.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=t("<div>").appendTo(this._appendTo()),this._addClass(this.overlay,null,"ui-widget-overlay ui-front"),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var t=this.document.data("ui-dialog-overlays")-1;t?this.document.data("ui-dialog-overlays",t):(this._off(this.document,"focusin"),this.document.removeData("ui-dialog-overlays")),this.overlay.remove(),this.overlay=null}}}),t.uiBackCompat!==!1&&t.widget("ui.dialog",t.ui.dialog,{options:{dialogClass:""},_createWrapper:function(){this._super(),this.uiDialog.addClass(this.options.dialogClass)},_setOption:function(t,e){"dialogClass"===t&&this.uiDialog.removeClass(this.options.dialogClass).addClass(e),this._superApply(arguments)}}),t.ui.dialog,t.widget("ui.droppable",{version:"1.12.1",widgetEventPrefix:"drop",options:{accept:"*",addClasses:!0,greedy:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e,i=this.options,s=i.accept;this.isover=!1,this.isout=!0,this.accept=t.isFunction(s)?s:function(t){return t.is(s)},this.proportions=function(){return arguments.length?(e=arguments[0],void 0):e?e:e={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},this._addToManager(i.scope),i.addClasses&&this._addClass("ui-droppable")},_addToManager:function(e){t.ui.ddmanager.droppables[e]=t.ui.ddmanager.droppables[e]||[],t.ui.ddmanager.droppables[e].push(this)},_splice:function(t){for(var e=0;t.length>e;e++)t[e]===this&&t.splice(e,1)},_destroy:function(){var e=t.ui.ddmanager.droppables[this.options.scope];this._splice(e)},_setOption:function(e,i){if("accept"===e)this.accept=t.isFunction(i)?i:function(t){return t.is(i)};else if("scope"===e){var s=t.ui.ddmanager.droppables[this.options.scope];this._splice(s),this._addToManager(i)}this._super(e,i)},_activate:function(e){var i=t.ui.ddmanager.current;this._addActiveClass(),i&&this._trigger("activate",e,this.ui(i))},_deactivate:function(e){var i=t.ui.ddmanager.current;this._removeActiveClass(),i&&this._trigger("deactivate",e,this.ui(i))},_over:function(e){var i=t.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this._addHoverClass(),this._trigger("over",e,this.ui(i)))},_out:function(e){var i=t.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this._removeHoverClass(),this._trigger("out",e,this.ui(i)))},_drop:function(e,i){var s=i||t.ui.ddmanager.current,n=!1;return s&&(s.currentItem||s.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var i=t(this).droppable("instance");return i.options.greedy&&!i.options.disabled&&i.options.scope===s.options.scope&&i.accept.call(i.element[0],s.currentItem||s.element)&&v(s,t.extend(i,{offset:i.element.offset()}),i.options.tolerance,e)?(n=!0,!1):void 0}),n?!1:this.accept.call(this.element[0],s.currentItem||s.element)?(this._removeActiveClass(),this._removeHoverClass(),this._trigger("drop",e,this.ui(s)),this.element):!1):!1},ui:function(t){return{draggable:t.currentItem||t.element,helper:t.helper,position:t.position,offset:t.positionAbs}},_addHoverClass:function(){this._addClass("ui-droppable-hover")},_removeHoverClass:function(){this._removeClass("ui-droppable-hover")},_addActiveClass:function(){this._addClass("ui-droppable-active")},_removeActiveClass:function(){this._removeClass("ui-droppable-active")}});var v=t.ui.intersect=function(){function t(t,e,i){return t>=e&&e+i>t}return function(e,i,s,n){if(!i.offset)return!1;var o=(e.positionAbs||e.position.absolute).left+e.margins.left,a=(e.positionAbs||e.position.absolute).top+e.margins.top,r=o+e.helperProportions.width,h=a+e.helperProportions.height,l=i.offset.left,c=i.offset.top,u=l+i.proportions().width,d=c+i.proportions().height;switch(s){case"fit":return o>=l&&u>=r&&a>=c&&d>=h;case"intersect":return o+e.helperProportions.width/2>l&&u>r-e.helperProportions.width/2&&a+e.helperProportions.height/2>c&&d>h-e.helperProportions.height/2;case"pointer":return t(n.pageY,c,i.proportions().height)&&t(n.pageX,l,i.proportions().width);case"touch":return(a>=c&&d>=a||h>=c&&d>=h||c>a&&h>d)&&(o>=l&&u>=o||r>=l&&u>=r||l>o&&r>u);default:return!1}}}();t.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(e,i){var s,n,o=t.ui.ddmanager.droppables[e.options.scope]||[],a=i?i.type:null,r=(e.currentItem||e.element).find(":data(ui-droppable)").addBack();t:for(s=0;o.length>s;s++)if(!(o[s].options.disabled||e&&!o[s].accept.call(o[s].element[0],e.currentItem||e.element))){for(n=0;r.length>n;n++)if(r[n]===o[s].element[0]){o[s].proportions().height=0;continue t}o[s].visible="none"!==o[s].element.css("display"),o[s].visible&&("mousedown"===a&&o[s]._activate.call(o[s],i),o[s].offset=o[s].element.offset(),o[s].proportions({width:o[s].element[0].offsetWidth,height:o[s].element[0].offsetHeight}))}},drop:function(e,i){var s=!1;return t.each((t.ui.ddmanager.droppables[e.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&v(e,this,this.options.tolerance,i)&&(s=this._drop.call(this,i)||s),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,i)))}),s},dragStart:function(e,i){e.element.parentsUntil("body").on("scroll.droppable",function(){e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,i)})},drag:function(e,i){e.options.refreshPositions&&t.ui.ddmanager.prepareOffsets(e,i),t.each(t.ui.ddmanager.droppables[e.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var s,n,o,a=v(e,this,this.options.tolerance,i),r=!a&&this.isover?"isout":a&&!this.isover?"isover":null;r&&(this.options.greedy&&(n=this.options.scope,o=this.element.parents(":data(ui-droppable)").filter(function(){return t(this).droppable("instance").options.scope===n}),o.length&&(s=t(o[0]).droppable("instance"),s.greedyChild="isover"===r)),s&&"isover"===r&&(s.isover=!1,s.isout=!0,s._out.call(s,i)),this[r]=!0,this["isout"===r?"isover":"isout"]=!1,this["isover"===r?"_over":"_out"].call(this,i),s&&"isout"===r&&(s.isout=!1,s.isover=!0,s._over.call(s,i)))}})},dragStop:function(e,i){e.element.parentsUntil("body").off("scroll.droppable"),e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,i)}},t.uiBackCompat!==!1&&t.widget("ui.droppable",t.ui.droppable,{options:{hoverClass:!1,activeClass:!1},_addActiveClass:function(){this._super(),this.options.activeClass&&this.element.addClass(this.options.activeClass)},_removeActiveClass:function(){this._super(),this.options.activeClass&&this.element.removeClass(this.options.activeClass)},_addHoverClass:function(){this._super(),this.options.hoverClass&&this.element.addClass(this.options.hoverClass)},_removeHoverClass:function(){this._super(),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass)}}),t.ui.droppable,t.widget("ui.progressbar",{version:"1.12.1",options:{classes:{"ui-progressbar":"ui-corner-all","ui-progressbar-value":"ui-corner-left","ui-progressbar-complete":"ui-corner-right"},max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.attr({role:"progressbar","aria-valuemin":this.min}),this._addClass("ui-progressbar","ui-widget ui-widget-content"),this.valueDiv=t("<div>").appendTo(this.element),this._addClass(this.valueDiv,"ui-progressbar-value","ui-widget-header"),this._refreshValue()},_destroy:function(){this.element.removeAttr("role aria-valuemin aria-valuemax aria-valuenow"),this.valueDiv.remove()},value:function(t){return void 0===t?this.options.value:(this.options.value=this._constrainedValue(t),this._refreshValue(),void 0)},_constrainedValue:function(t){return void 0===t&&(t=this.options.value),this.indeterminate=t===!1,"number"!=typeof t&&(t=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,t))},_setOptions:function(t){var e=t.value;delete t.value,this._super(t),this.options.value=this._constrainedValue(e),this._refreshValue()},_setOption:function(t,e){"max"===t&&(e=Math.max(this.min,e)),this._super(t,e)},_setOptionDisabled:function(t){this._super(t),this.element.attr("aria-disabled",t),this._toggleClass(null,"ui-state-disabled",!!t)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var e=this.options.value,i=this._percentage();this.valueDiv.toggle(this.indeterminate||e>this.min).width(i.toFixed(0)+"%"),this._toggleClass(this.valueDiv,"ui-progressbar-complete",null,e===this.options.max)._toggleClass("ui-progressbar-indeterminate",null,this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=t("<div>").appendTo(this.valueDiv),this._addClass(this.overlayDiv,"ui-progressbar-overlay"))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":e}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==e&&(this.oldValue=e,this._trigger("change")),e===this.options.max&&this._trigger("complete")}}),t.widget("ui.selectable",t.ui.mouse,{version:"1.12.1",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var e=this;this._addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){e.elementPos=t(e.element[0]).offset(),e.selectees=t(e.options.filter,e.element[0]),e._addClass(e.selectees,"ui-selectee"),e.selectees.each(function(){var i=t(this),s=i.offset(),n={left:s.left-e.elementPos.left,top:s.top-e.elementPos.top};t.data(this,"selectable-item",{element:this,$element:i,left:n.left,top:n.top,right:n.left+i.outerWidth(),bottom:n.top+i.outerHeight(),startselected:!1,selected:i.hasClass("ui-selected"),selecting:i.hasClass("ui-selecting"),unselecting:i.hasClass("ui-unselecting")})})},this.refresh(),this._mouseInit(),this.helper=t("<div>"),this._addClass(this.helper,"ui-selectable-helper")},_destroy:function(){this.selectees.removeData("selectable-item"),this._mouseDestroy()},_mouseStart:function(e){var i=this,s=this.options;this.opos=[e.pageX,e.pageY],this.elementPos=t(this.element[0]).offset(),this.options.disabled||(this.selectees=t(s.filter,this.element[0]),this._trigger("start",e),t(s.appendTo).append(this.helper),this.helper.css({left:e.pageX,top:e.pageY,width:0,height:0}),s.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var s=t.data(this,"selectable-item");s.startselected=!0,e.metaKey||e.ctrlKey||(i._removeClass(s.$element,"ui-selected"),s.selected=!1,i._addClass(s.$element,"ui-unselecting"),s.unselecting=!0,i._trigger("unselecting",e,{unselecting:s.element}))}),t(e.target).parents().addBack().each(function(){var s,n=t.data(this,"selectable-item");return n?(s=!e.metaKey&&!e.ctrlKey||!n.$element.hasClass("ui-selected"),i._removeClass(n.$element,s?"ui-unselecting":"ui-selected")._addClass(n.$element,s?"ui-selecting":"ui-unselecting"),n.unselecting=!s,n.selecting=s,n.selected=s,s?i._trigger("selecting",e,{selecting:n.element}):i._trigger("unselecting",e,{unselecting:n.element}),!1):void 0}))},_mouseDrag:function(e){if(this.dragged=!0,!this.options.disabled){var i,s=this,n=this.options,o=this.opos[0],a=this.opos[1],r=e.pageX,h=e.pageY;return o>r&&(i=r,r=o,o=i),a>h&&(i=h,h=a,a=i),this.helper.css({left:o,top:a,width:r-o,height:h-a}),this.selectees.each(function(){var i=t.data(this,"selectable-item"),l=!1,c={};i&&i.element!==s.element[0]&&(c.left=i.left+s.elementPos.left,c.right=i.right+s.elementPos.left,c.top=i.top+s.elementPos.top,c.bottom=i.bottom+s.elementPos.top,"touch"===n.tolerance?l=!(c.left>r||o>c.right||c.top>h||a>c.bottom):"fit"===n.tolerance&&(l=c.left>o&&r>c.right&&c.top>a&&h>c.bottom),l?(i.selected&&(s._removeClass(i.$element,"ui-selected"),i.selected=!1),i.unselecting&&(s._removeClass(i.$element,"ui-unselecting"),i.unselecting=!1),i.selecting||(s._addClass(i.$element,"ui-selecting"),i.selecting=!0,s._trigger("selecting",e,{selecting:i.element}))):(i.selecting&&((e.metaKey||e.ctrlKey)&&i.startselected?(s._removeClass(i.$element,"ui-selecting"),i.selecting=!1,s._addClass(i.$element,"ui-selected"),i.selected=!0):(s._removeClass(i.$element,"ui-selecting"),i.selecting=!1,i.startselected&&(s._addClass(i.$element,"ui-unselecting"),i.unselecting=!0),s._trigger("unselecting",e,{unselecting:i.element}))),i.selected&&(e.metaKey||e.ctrlKey||i.startselected||(s._removeClass(i.$element,"ui-selected"),i.selected=!1,s._addClass(i.$element,"ui-unselecting"),i.unselecting=!0,s._trigger("unselecting",e,{unselecting:i.element})))))}),!1}},_mouseStop:function(e){var i=this;return this.dragged=!1,t(".ui-unselecting",this.element[0]).each(function(){var s=t.data(this,"selectable-item");i._removeClass(s.$element,"ui-unselecting"),s.unselecting=!1,s.startselected=!1,i._trigger("unselected",e,{unselected:s.element})}),t(".ui-selecting",this.element[0]).each(function(){var s=t.data(this,"selectable-item");i._removeClass(s.$element,"ui-selecting")._addClass(s.$element,"ui-selected"),s.selecting=!1,s.selected=!0,s.startselected=!0,i._trigger("selected",e,{selected:s.element})}),this._trigger("stop",e),this.helper.remove(),!1}}),t.widget("ui.selectmenu",[t.ui.formResetMixin,{version:"1.12.1",defaultElement:"<select>",options:{appendTo:null,classes:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"},disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:!1,change:null,close:null,focus:null,open:null,select:null},_create:function(){var e=this.element.uniqueId().attr("id");this.ids={element:e,button:e+"-button",menu:e+"-menu"},this._drawButton(),this._drawMenu(),this._bindFormResetHandler(),this._rendered=!1,this.menuItems=t()},_drawButton:function(){var e,i=this,s=this._parseOption(this.element.find("option:selected"),this.element[0].selectedIndex);this.labels=this.element.labels().attr("for",this.ids.button),this._on(this.labels,{click:function(t){this.button.focus(),t.preventDefault()}}),this.element.hide(),this.button=t("<span>",{tabindex:this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true",title:this.element.attr("title")}).insertAfter(this.element),this._addClass(this.button,"ui-selectmenu-button ui-selectmenu-button-closed","ui-button ui-widget"),e=t("<span>").appendTo(this.button),this._addClass(e,"ui-selectmenu-icon","ui-icon "+this.options.icons.button),this.buttonItem=this._renderButtonItem(s).appendTo(this.button),this.options.width!==!1&&this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){i._rendered||i._refreshMenu()})},_drawMenu:function(){var e=this;this.menu=t("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=t("<div>").append(this.menu),this._addClass(this.menuWrap,"ui-selectmenu-menu","ui-front"),this.menuWrap.appendTo(this._appendTo()),this.menuInstance=this.menu.menu({classes:{"ui-menu":"ui-corner-bottom"},role:"listbox",select:function(t,i){t.preventDefault(),e._setSelection(),e._select(i.item.data("ui-selectmenu-item"),t)},focus:function(t,i){var s=i.item.data("ui-selectmenu-item");null!=e.focusIndex&&s.index!==e.focusIndex&&(e._trigger("focus",t,{item:s}),e.isOpen||e._select(s,t)),e.focusIndex=s.index,e.button.attr("aria-activedescendant",e.menuItems.eq(s.index).attr("id"))}}).menu("instance"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(this._getSelectedItem().data("ui-selectmenu-item")||{})),null===this.options.width&&this._resizeButton()},_refreshMenu:function(){var t,e=this.element.find("option");this.menu.empty(),this._parseOptions(e),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup").find(".ui-menu-item-wrapper"),this._rendered=!0,e.length&&(t=this._getSelectedItem(),this.menuInstance.focus(null,t),this._setAria(t.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(t){this.options.disabled||(this._rendered?(this._removeClass(this.menu.find(".ui-state-active"),null,"ui-state-active"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.menuItems.length&&(this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",t)))},_position:function(){this.menuWrap.position(t.extend({of:this.button},this.options.position))},close:function(t){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",t))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderButtonItem:function(e){var i=t("<span>");return this._setText(i,e.label),this._addClass(i,"ui-selectmenu-text"),i},_renderMenu:function(e,i){var s=this,n="";t.each(i,function(i,o){var a;o.optgroup!==n&&(a=t("<li>",{text:o.optgroup}),s._addClass(a,"ui-selectmenu-optgroup","ui-menu-divider"+(o.element.parent("optgroup").prop("disabled")?" ui-state-disabled":"")),a.appendTo(e),n=o.optgroup),s._renderItemData(e,o)})},_renderItemData:function(t,e){return this._renderItem(t,e).data("ui-selectmenu-item",e)},_renderItem:function(e,i){var s=t("<li>"),n=t("<div>",{title:i.element.attr("title")});return i.disabled&&this._addClass(s,null,"ui-state-disabled"),this._setText(n,i.label),s.append(n).appendTo(e)},_setText:function(t,e){e?t.text(e):t.html("&#160;")},_move:function(t,e){var i,s,n=".ui-menu-item";this.isOpen?i=this.menuItems.eq(this.focusIndex).parent("li"):(i=this.menuItems.eq(this.element[0].selectedIndex).parent("li"),n+=":not(.ui-state-disabled)"),s="first"===t||"last"===t?i["first"===t?"prevAll":"nextAll"](n).eq(-1):i[t+"All"](n).eq(0),s.length&&this.menuInstance.focus(e,s)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex).parent("li")},_toggle:function(t){this[this.isOpen?"close":"open"](t)},_setSelection:function(){var t;this.range&&(window.getSelection?(t=window.getSelection(),t.removeAllRanges(),t.addRange(this.range)):this.range.select(),this.button.focus())},_documentClick:{mousedown:function(e){this.isOpen&&(t(e.target).closest(".ui-selectmenu-menu, #"+t.ui.escapeSelector(this.ids.button)).length||this.close(e))}},_buttonEvents:{mousedown:function(){var t;window.getSelection?(t=window.getSelection(),t.rangeCount&&(this.range=t.getRangeAt(0))):this.range=document.selection.createRange()},click:function(t){this._setSelection(),this._toggle(t)},keydown:function(e){var i=!0;switch(e.keyCode){case t.ui.keyCode.TAB:case t.ui.keyCode.ESCAPE:this.close(e),i=!1;break;case t.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(e);break;case t.ui.keyCode.UP:e.altKey?this._toggle(e):this._move("prev",e);break;case t.ui.keyCode.DOWN:e.altKey?this._toggle(e):this._move("next",e);break;case t.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(e):this._toggle(e);break;case t.ui.keyCode.LEFT:this._move("prev",e);break;case t.ui.keyCode.RIGHT:this._move("next",e);break;case t.ui.keyCode.HOME:case t.ui.keyCode.PAGE_UP:this._move("first",e);break;case t.ui.keyCode.END:case t.ui.keyCode.PAGE_DOWN:this._move("last",e);break;default:this.menu.trigger(e),i=!1}i&&e.preventDefault()}},_selectFocusedItem:function(t){var e=this.menuItems.eq(this.focusIndex).parent("li");e.hasClass("ui-state-disabled")||this._select(e.data("ui-selectmenu-item"),t)},_select:function(t,e){var i=this.element[0].selectedIndex;this.element[0].selectedIndex=t.index,this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(t)),this._setAria(t),this._trigger("select",e,{item:t}),t.index!==i&&this._trigger("change",e,{item:t}),this.close(e)},_setAria:function(t){var e=this.menuItems.eq(t.index).attr("id");this.button.attr({"aria-labelledby":e,"aria-activedescendant":e}),this.menu.attr("aria-activedescendant",e)},_setOption:function(t,e){if("icons"===t){var i=this.button.find("span.ui-icon");this._removeClass(i,null,this.options.icons.button)._addClass(i,null,e.button)}this._super(t,e),"appendTo"===t&&this.menuWrap.appendTo(this._appendTo()),"width"===t&&this._resizeButton()},_setOptionDisabled:function(t){this._super(t),this.menuInstance.option("disabled",t),this.button.attr("aria-disabled",t),this._toggleClass(this.button,null,"ui-state-disabled",t),this.element.prop("disabled",t),t?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)},_appendTo:function(){var e=this.options.appendTo;return e&&(e=e.jquery||e.nodeType?t(e):this.document.find(e).eq(0)),e&&e[0]||(e=this.element.closest(".ui-front, dialog")),e.length||(e=this.document[0].body),e},_toggleAttr:function(){this.button.attr("aria-expanded",this.isOpen),this._removeClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"closed":"open"))._addClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"open":"closed"))._toggleClass(this.menuWrap,"ui-selectmenu-open",null,this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var t=this.options.width;return t===!1?(this.button.css("width",""),void 0):(null===t&&(t=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(t),void 0)},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){var t=this._super();return t.disabled=this.element.prop("disabled"),t},_parseOptions:function(e){var i=this,s=[];e.each(function(e,n){s.push(i._parseOption(t(n),e))}),this.items=s},_parseOption:function(t,e){var i=t.parent("optgroup");return{element:t,index:e,value:t.val(),label:t.text(),optgroup:i.attr("label")||"",disabled:i.prop("disabled")||t.prop("disabled")}},_destroy:function(){this._unbindFormResetHandler(),this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.labels.attr("for",this.ids.element)}}]),t.widget("ui.slider",t.ui.mouse,{version:"1.12.1",widgetEventPrefix:"slide",options:{animate:!1,classes:{"ui-slider":"ui-corner-all","ui-slider-handle":"ui-corner-all","ui-slider-range":"ui-corner-all ui-widget-header"},distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this._addClass("ui-slider ui-slider-"+this.orientation,"ui-widget ui-widget-content"),this._refresh(),this._animateOff=!1
},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var e,i,s=this.options,n=this.element.find(".ui-slider-handle"),o="<span tabindex='0'></span>",a=[];for(i=s.values&&s.values.length||1,n.length>i&&(n.slice(i).remove(),n=n.slice(0,i)),e=n.length;i>e;e++)a.push(o);this.handles=n.add(t(a.join("")).appendTo(this.element)),this._addClass(this.handles,"ui-slider-handle","ui-state-default"),this.handle=this.handles.eq(0),this.handles.each(function(e){t(this).data("ui-slider-handle-index",e).attr("tabIndex",0)})},_createRange:function(){var e=this.options;e.range?(e.range===!0&&(e.values?e.values.length&&2!==e.values.length?e.values=[e.values[0],e.values[0]]:t.isArray(e.values)&&(e.values=e.values.slice(0)):e.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?(this._removeClass(this.range,"ui-slider-range-min ui-slider-range-max"),this.range.css({left:"",bottom:""})):(this.range=t("<div>").appendTo(this.element),this._addClass(this.range,"ui-slider-range")),("min"===e.range||"max"===e.range)&&this._addClass(this.range,"ui-slider-range-"+e.range)):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this._mouseDestroy()},_mouseCapture:function(e){var i,s,n,o,a,r,h,l,c=this,u=this.options;return u.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),i={x:e.pageX,y:e.pageY},s=this._normValueFromMouse(i),n=this._valueMax()-this._valueMin()+1,this.handles.each(function(e){var i=Math.abs(s-c.values(e));(n>i||n===i&&(e===c._lastChangedValue||c.values(e)===u.min))&&(n=i,o=t(this),a=e)}),r=this._start(e,a),r===!1?!1:(this._mouseSliding=!0,this._handleIndex=a,this._addClass(o,null,"ui-state-active"),o.trigger("focus"),h=o.offset(),l=!t(e.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=l?{left:0,top:0}:{left:e.pageX-h.left-o.width()/2,top:e.pageY-h.top-o.height()/2-(parseInt(o.css("borderTopWidth"),10)||0)-(parseInt(o.css("borderBottomWidth"),10)||0)+(parseInt(o.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(e,a,s),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(t){var e={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(e);return this._slide(t,this._handleIndex,i),!1},_mouseStop:function(t){return this._removeClass(this.handles,null,"ui-state-active"),this._mouseSliding=!1,this._stop(t,this._handleIndex),this._change(t,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(t){var e,i,s,n,o;return"horizontal"===this.orientation?(e=this.elementSize.width,i=t.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(e=this.elementSize.height,i=t.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),s=i/e,s>1&&(s=1),0>s&&(s=0),"vertical"===this.orientation&&(s=1-s),n=this._valueMax()-this._valueMin(),o=this._valueMin()+s*n,this._trimAlignValue(o)},_uiHash:function(t,e,i){var s={handle:this.handles[t],handleIndex:t,value:void 0!==e?e:this.value()};return this._hasMultipleValues()&&(s.value=void 0!==e?e:this.values(t),s.values=i||this.values()),s},_hasMultipleValues:function(){return this.options.values&&this.options.values.length},_start:function(t,e){return this._trigger("start",t,this._uiHash(e))},_slide:function(t,e,i){var s,n,o=this.value(),a=this.values();this._hasMultipleValues()&&(n=this.values(e?0:1),o=this.values(e),2===this.options.values.length&&this.options.range===!0&&(i=0===e?Math.min(n,i):Math.max(n,i)),a[e]=i),i!==o&&(s=this._trigger("slide",t,this._uiHash(e,i,a)),s!==!1&&(this._hasMultipleValues()?this.values(e,i):this.value(i)))},_stop:function(t,e){this._trigger("stop",t,this._uiHash(e))},_change:function(t,e){this._keySliding||this._mouseSliding||(this._lastChangedValue=e,this._trigger("change",t,this._uiHash(e)))},value:function(t){return arguments.length?(this.options.value=this._trimAlignValue(t),this._refreshValue(),this._change(null,0),void 0):this._value()},values:function(e,i){var s,n,o;if(arguments.length>1)return this.options.values[e]=this._trimAlignValue(i),this._refreshValue(),this._change(null,e),void 0;if(!arguments.length)return this._values();if(!t.isArray(arguments[0]))return this._hasMultipleValues()?this._values(e):this.value();for(s=this.options.values,n=arguments[0],o=0;s.length>o;o+=1)s[o]=this._trimAlignValue(n[o]),this._change(null,o);this._refreshValue()},_setOption:function(e,i){var s,n=0;switch("range"===e&&this.options.range===!0&&("min"===i?(this.options.value=this._values(0),this.options.values=null):"max"===i&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),t.isArray(this.options.values)&&(n=this.options.values.length),this._super(e,i),e){case"orientation":this._detectOrientation(),this._removeClass("ui-slider-horizontal ui-slider-vertical")._addClass("ui-slider-"+this.orientation),this._refreshValue(),this.options.range&&this._refreshRange(i),this.handles.css("horizontal"===i?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),s=n-1;s>=0;s--)this._change(null,s);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_setOptionDisabled:function(t){this._super(t),this._toggleClass(null,"ui-state-disabled",!!t)},_value:function(){var t=this.options.value;return t=this._trimAlignValue(t)},_values:function(t){var e,i,s;if(arguments.length)return e=this.options.values[t],e=this._trimAlignValue(e);if(this._hasMultipleValues()){for(i=this.options.values.slice(),s=0;i.length>s;s+=1)i[s]=this._trimAlignValue(i[s]);return i}return[]},_trimAlignValue:function(t){if(this._valueMin()>=t)return this._valueMin();if(t>=this._valueMax())return this._valueMax();var e=this.options.step>0?this.options.step:1,i=(t-this._valueMin())%e,s=t-i;return 2*Math.abs(i)>=e&&(s+=i>0?e:-e),parseFloat(s.toFixed(5))},_calculateNewMax:function(){var t=this.options.max,e=this._valueMin(),i=this.options.step,s=Math.round((t-e)/i)*i;t=s+e,t>this.options.max&&(t-=i),this.max=parseFloat(t.toFixed(this._precision()))},_precision:function(){var t=this._precisionOf(this.options.step);return null!==this.options.min&&(t=Math.max(t,this._precisionOf(this.options.min))),t},_precisionOf:function(t){var e=""+t,i=e.indexOf(".");return-1===i?0:e.length-i-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshRange:function(t){"vertical"===t&&this.range.css({width:"",left:""}),"horizontal"===t&&this.range.css({height:"",bottom:""})},_refreshValue:function(){var e,i,s,n,o,a=this.options.range,r=this.options,h=this,l=this._animateOff?!1:r.animate,c={};this._hasMultipleValues()?this.handles.each(function(s){i=100*((h.values(s)-h._valueMin())/(h._valueMax()-h._valueMin())),c["horizontal"===h.orientation?"left":"bottom"]=i+"%",t(this).stop(1,1)[l?"animate":"css"](c,r.animate),h.options.range===!0&&("horizontal"===h.orientation?(0===s&&h.range.stop(1,1)[l?"animate":"css"]({left:i+"%"},r.animate),1===s&&h.range[l?"animate":"css"]({width:i-e+"%"},{queue:!1,duration:r.animate})):(0===s&&h.range.stop(1,1)[l?"animate":"css"]({bottom:i+"%"},r.animate),1===s&&h.range[l?"animate":"css"]({height:i-e+"%"},{queue:!1,duration:r.animate}))),e=i}):(s=this.value(),n=this._valueMin(),o=this._valueMax(),i=o!==n?100*((s-n)/(o-n)):0,c["horizontal"===this.orientation?"left":"bottom"]=i+"%",this.handle.stop(1,1)[l?"animate":"css"](c,r.animate),"min"===a&&"horizontal"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({width:i+"%"},r.animate),"max"===a&&"horizontal"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({width:100-i+"%"},r.animate),"min"===a&&"vertical"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({height:i+"%"},r.animate),"max"===a&&"vertical"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({height:100-i+"%"},r.animate))},_handleEvents:{keydown:function(e){var i,s,n,o,a=t(e.target).data("ui-slider-handle-index");switch(e.keyCode){case t.ui.keyCode.HOME:case t.ui.keyCode.END:case t.ui.keyCode.PAGE_UP:case t.ui.keyCode.PAGE_DOWN:case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(e.preventDefault(),!this._keySliding&&(this._keySliding=!0,this._addClass(t(e.target),null,"ui-state-active"),i=this._start(e,a),i===!1))return}switch(o=this.options.step,s=n=this._hasMultipleValues()?this.values(a):this.value(),e.keyCode){case t.ui.keyCode.HOME:n=this._valueMin();break;case t.ui.keyCode.END:n=this._valueMax();break;case t.ui.keyCode.PAGE_UP:n=this._trimAlignValue(s+(this._valueMax()-this._valueMin())/this.numPages);break;case t.ui.keyCode.PAGE_DOWN:n=this._trimAlignValue(s-(this._valueMax()-this._valueMin())/this.numPages);break;case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:if(s===this._valueMax())return;n=this._trimAlignValue(s+o);break;case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(s===this._valueMin())return;n=this._trimAlignValue(s-o)}this._slide(e,a,n)},keyup:function(e){var i=t(e.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(e,i),this._change(e,i),this._removeClass(t(e.target),null,"ui-state-active"))}}}),t.widget("ui.sortable",t.ui.mouse,{version:"1.12.1",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(t,e,i){return t>=e&&e+i>t},_isFloating:function(t){return/left|right/.test(t.css("float"))||/inline|table-cell/.test(t.css("display"))},_create:function(){this.containerCache={},this._addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(t,e){this._super(t,e),"handle"===t&&this._setHandleClassName()},_setHandleClassName:function(){var e=this;this._removeClass(this.element.find(".ui-sortable-handle"),"ui-sortable-handle"),t.each(this.items,function(){e._addClass(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item,"ui-sortable-handle")})},_destroy:function(){this._mouseDestroy();for(var t=this.items.length-1;t>=0;t--)this.items[t].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(e,i){var s=null,n=!1,o=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(e),t(e.target).parents().each(function(){return t.data(this,o.widgetName+"-item")===o?(s=t(this),!1):void 0}),t.data(e.target,o.widgetName+"-item")===o&&(s=t(e.target)),s?!this.options.handle||i||(t(this.options.handle,s).find("*").addBack().each(function(){this===e.target&&(n=!0)}),n)?(this.currentItem=s,this._removeCurrentsFromItems(),!0):!1:!1)},_mouseStart:function(e,i,s){var n,o,a=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(e),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,a.cursorAt&&this._adjustOffsetFromHelper(a.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),a.containment&&this._setContainment(),a.cursor&&"auto"!==a.cursor&&(o=this.document.find("body"),this.storedCursor=o.css("cursor"),o.css("cursor",a.cursor),this.storedStylesheet=t("<style>*{ cursor: "+a.cursor+" !important; }</style>").appendTo(o)),a.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",a.opacity)),a.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",a.zIndex)),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",e,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!s)for(n=this.containers.length-1;n>=0;n--)this.containers[n]._trigger("activate",e,this._uiHash(this));return t.ui.ddmanager&&(t.ui.ddmanager.current=this),t.ui.ddmanager&&!a.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this.dragging=!0,this._addClass(this.helper,"ui-sortable-helper"),this._mouseDrag(e),!0},_mouseDrag:function(e){var i,s,n,o,a=this.options,r=!1;for(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<a.scrollSensitivity?this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop+a.scrollSpeed:e.pageY-this.overflowOffset.top<a.scrollSensitivity&&(this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop-a.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<a.scrollSensitivity?this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft+a.scrollSpeed:e.pageX-this.overflowOffset.left<a.scrollSensitivity&&(this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft-a.scrollSpeed)):(e.pageY-this.document.scrollTop()<a.scrollSensitivity?r=this.document.scrollTop(this.document.scrollTop()-a.scrollSpeed):this.window.height()-(e.pageY-this.document.scrollTop())<a.scrollSensitivity&&(r=this.document.scrollTop(this.document.scrollTop()+a.scrollSpeed)),e.pageX-this.document.scrollLeft()<a.scrollSensitivity?r=this.document.scrollLeft(this.document.scrollLeft()-a.scrollSpeed):this.window.width()-(e.pageX-this.document.scrollLeft())<a.scrollSensitivity&&(r=this.document.scrollLeft(this.document.scrollLeft()+a.scrollSpeed))),r!==!1&&t.ui.ddmanager&&!a.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(s=this.items[i],n=s.item[0],o=this._intersectsWithPointer(s),o&&s.instance===this.currentContainer&&n!==this.currentItem[0]&&this.placeholder[1===o?"next":"prev"]()[0]!==n&&!t.contains(this.placeholder[0],n)&&("semi-dynamic"===this.options.type?!t.contains(this.element[0],n):!0)){if(this.direction=1===o?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(s))break;this._rearrange(e,s),this._trigger("change",e,this._uiHash());break}return this._contactContainers(e),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),this._trigger("sort",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(e,i){if(e){if(t.ui.ddmanager&&!this.options.dropBehaviour&&t.ui.ddmanager.drop(this,e),this.options.revert){var s=this,n=this.placeholder.offset(),o=this.options.axis,a={};o&&"x"!==o||(a.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),o&&"y"!==o||(a.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,t(this.helper).animate(a,parseInt(this.options.revert,10)||500,function(){s._clear(e)})}else this._clear(e,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp(new t.Event("mouseup",{target:null})),"original"===this.options.helper?(this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")):this.currentItem.show();for(var e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("deactivate",null,this._uiHash(this)),this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",null,this._uiHash(this)),this.containers[e].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),t.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?t(this.domPosition.prev).after(this.currentItem):t(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var i=this._getItemsAsjQuery(e&&e.connected),s=[];return e=e||{},t(i).each(function(){var i=(t(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[\-=_](.+)/);i&&s.push((e.key||i[1]+"[]")+"="+(e.key&&e.expression?i[1]:i[2]))}),!s.length&&e.key&&s.push(e.key+"="),s.join("&")},toArray:function(e){var i=this._getItemsAsjQuery(e&&e.connected),s=[];return e=e||{},i.each(function(){s.push(t(e.item||this).attr(e.attribute||"id")||"")}),s},_intersectsWith:function(t){var e=this.positionAbs.left,i=e+this.helperProportions.width,s=this.positionAbs.top,n=s+this.helperProportions.height,o=t.left,a=o+t.width,r=t.top,h=r+t.height,l=this.offset.click.top,c=this.offset.click.left,u="x"===this.options.axis||s+l>r&&h>s+l,d="y"===this.options.axis||e+c>o&&a>e+c,p=u&&d;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>t[this.floating?"width":"height"]?p:e+this.helperProportions.width/2>o&&a>i-this.helperProportions.width/2&&s+this.helperProportions.height/2>r&&h>n-this.helperProportions.height/2},_intersectsWithPointer:function(t){var e,i,s="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top,t.height),n="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left,t.width),o=s&&n;return o?(e=this._getDragVerticalDirection(),i=this._getDragHorizontalDirection(),this.floating?"right"===i||"down"===e?2:1:e&&("down"===e?2:1)):!1},_intersectsWithSides:function(t){var e=this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),s=this._getDragVerticalDirection(),n=this._getDragHorizontalDirection();return this.floating&&n?"right"===n&&i||"left"===n&&!i:s&&("down"===s&&e||"up"===s&&!e)},_getDragVerticalDirection:function(){var t=this.positionAbs.top-this.lastPositionAbs.top;return 0!==t&&(t>0?"down":"up")},_getDragHorizontalDirection:function(){var t=this.positionAbs.left-this.lastPositionAbs.left;return 0!==t&&(t>0?"right":"left")},refresh:function(t){return this._refreshItems(t),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var t=this.options;return t.connectWith.constructor===String?[t.connectWith]:t.connectWith},_getItemsAsjQuery:function(e){function i(){r.push(this)}var s,n,o,a,r=[],h=[],l=this._connectWith();if(l&&e)for(s=l.length-1;s>=0;s--)for(o=t(l[s],this.document[0]),n=o.length-1;n>=0;n--)a=t.data(o[n],this.widgetFullName),a&&a!==this&&!a.options.disabled&&h.push([t.isFunction(a.options.items)?a.options.items.call(a.element):t(a.options.items,a.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),a]);for(h.push([t.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):t(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),s=h.length-1;s>=0;s--)h[s][0].each(i);return t(r)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=t.grep(this.items,function(t){for(var i=0;e.length>i;i++)if(e[i]===t.item[0])return!1;return!0})},_refreshItems:function(e){this.items=[],this.containers=[this];var i,s,n,o,a,r,h,l,c=this.items,u=[[t.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):t(this.options.items,this.element),this]],d=this._connectWith();if(d&&this.ready)for(i=d.length-1;i>=0;i--)for(n=t(d[i],this.document[0]),s=n.length-1;s>=0;s--)o=t.data(n[s],this.widgetFullName),o&&o!==this&&!o.options.disabled&&(u.push([t.isFunction(o.options.items)?o.options.items.call(o.element[0],e,{item:this.currentItem}):t(o.options.items,o.element),o]),this.containers.push(o));for(i=u.length-1;i>=0;i--)for(a=u[i][1],r=u[i][0],s=0,l=r.length;l>s;s++)h=t(r[s]),h.data(this.widgetName+"-item",a),c.push({item:h,instance:a,width:0,height:0,left:0,top:0})},refreshPositions:function(e){this.floating=this.items.length?"x"===this.options.axis||this._isFloating(this.items[0].item):!1,this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,s,n,o;for(i=this.items.length-1;i>=0;i--)s=this.items[i],s.instance!==this.currentContainer&&this.currentContainer&&s.item[0]!==this.currentItem[0]||(n=this.options.toleranceElement?t(this.options.toleranceElement,s.item):s.item,e||(s.width=n.outerWidth(),s.height=n.outerHeight()),o=n.offset(),s.left=o.left,s.top=o.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)o=this.containers[i].element.offset(),this.containers[i].containerCache.left=o.left,this.containers[i].containerCache.top=o.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(e){e=e||this;var i,s=e.options;s.placeholder&&s.placeholder.constructor!==String||(i=s.placeholder,s.placeholder={element:function(){var s=e.currentItem[0].nodeName.toLowerCase(),n=t("<"+s+">",e.document[0]);return e._addClass(n,"ui-sortable-placeholder",i||e.currentItem[0].className)._removeClass(n,"ui-sortable-helper"),"tbody"===s?e._createTrPlaceholder(e.currentItem.find("tr").eq(0),t("<tr>",e.document[0]).appendTo(n)):"tr"===s?e._createTrPlaceholder(e.currentItem,n):"img"===s&&n.attr("src",e.currentItem.attr("src")),i||n.css("visibility","hidden"),n},update:function(t,n){(!i||s.forcePlaceholderSize)&&(n.height()||n.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css("paddingTop")||0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10)),n.width()||n.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10)))}}),e.placeholder=t(s.placeholder.element.call(e.element,e.currentItem)),e.currentItem.after(e.placeholder),s.placeholder.update(e,e.placeholder)},_createTrPlaceholder:function(e,i){var s=this;e.children().each(function(){t("<td>&#160;</td>",s.document[0]).attr("colspan",t(this).attr("colspan")||1).appendTo(i)})},_contactContainers:function(e){var i,s,n,o,a,r,h,l,c,u,d=null,p=null;for(i=this.containers.length-1;i>=0;i--)if(!t.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(d&&t.contains(this.containers[i].element[0],d.element[0]))continue;d=this.containers[i],p=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",e,this._uiHash(this)),this.containers[i].containerCache.over=0);if(d)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",e,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(n=1e4,o=null,c=d.floating||this._isFloating(this.currentItem),a=c?"left":"top",r=c?"width":"height",u=c?"pageX":"pageY",s=this.items.length-1;s>=0;s--)t.contains(this.containers[p].element[0],this.items[s].item[0])&&this.items[s].item[0]!==this.currentItem[0]&&(h=this.items[s].item.offset()[a],l=!1,e[u]-h>this.items[s][r]/2&&(l=!0),n>Math.abs(e[u]-h)&&(n=Math.abs(e[u]-h),o=this.items[s],this.direction=l?"up":"down"));if(!o&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return this.currentContainer.containerCache.over||(this.containers[p]._trigger("over",e,this._uiHash()),this.currentContainer.containerCache.over=1),void 0;o?this._rearrange(e,o,null,!0):this._rearrange(e,null,this.containers[p].element,!0),this._trigger("change",e,this._uiHash()),this.containers[p]._trigger("change",e,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",e,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(e){var i=this.options,s=t.isFunction(i.helper)?t(i.helper.apply(this.element[0],[e,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return s.parents("body").length||t("parent"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(s[0]),s[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!s[0].style.width||i.forceHelperSize)&&s.width(this.currentItem.width()),(!s[0].style.height||i.forceHelperSize)&&s.height(this.currentItem.height()),s},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&t.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var t=this.currentItem.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,s,n=this.options;"parent"===n.containment&&(n.containment=this.helper[0].parentNode),("document"===n.containment||"window"===n.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===n.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===n.containment?this.document.height()||document.body.parentNode.scrollHeight:this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(n.containment)||(e=t(n.containment)[0],i=t(n.containment).offset(),s="hidden"!==t(e).css("overflow"),this.containment=[i.left+(parseInt(t(e).css("borderLeftWidth"),10)||0)+(parseInt(t(e).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(t(e).css("borderTopWidth"),10)||0)+(parseInt(t(e).css("paddingTop"),10)||0)-this.margins.top,i.left+(s?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(t(e).css("borderLeftWidth"),10)||0)-(parseInt(t(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(s?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(t(e).css("borderTopWidth"),10)||0)-(parseInt(t(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(e,i){i||(i=this.position);var s="absolute"===e?1:-1,n="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(n[0].tagName);return{top:i.top+this.offset.relative.top*s+this.offset.parent.top*s-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():o?0:n.scrollTop())*s,left:i.left+this.offset.relative.left*s+this.offset.parent.left*s-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():o?0:n.scrollLeft())*s}},_generatePosition:function(e){var i,s,n=this.options,o=e.pageX,a=e.pageY,r="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,h=/(html|body)/i.test(r[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(o=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(a=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(o=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(a=this.containment[3]+this.offset.click.top)),n.grid&&(i=this.originalPageY+Math.round((a-this.originalPageY)/n.grid[1])*n.grid[1],a=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-n.grid[1]:i+n.grid[1]:i,s=this.originalPageX+Math.round((o-this.originalPageX)/n.grid[0])*n.grid[0],o=this.containment?s-this.offset.click.left>=this.containment[0]&&s-this.offset.click.left<=this.containment[2]?s:s-this.offset.click.left>=this.containment[0]?s-n.grid[0]:s+n.grid[0]:s)),{top:a-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():h?0:r.scrollTop()),left:o-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():h?0:r.scrollLeft())}},_rearrange:function(t,e,i,s){i?i[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?e.item[0]:e.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var n=this.counter;
this._delay(function(){n===this.counter&&this.refreshPositions(!s)})},_clear:function(t,e){function i(t,e,i){return function(s){i._trigger(t,s,e._uiHash(e))}}this.reverting=!1;var s,n=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(s in this._storedCSS)("auto"===this._storedCSS[s]||"static"===this._storedCSS[s])&&(this._storedCSS[s]="");this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!e&&n.push(function(t){this._trigger("receive",t,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||e||n.push(function(t){this._trigger("update",t,this._uiHash())}),this!==this.currentContainer&&(e||(n.push(function(t){this._trigger("remove",t,this._uiHash())}),n.push(function(t){return function(e){t._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer)),n.push(function(t){return function(e){t._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer)))),s=this.containers.length-1;s>=0;s--)e||n.push(i("deactivate",this,this.containers[s])),this.containers[s].containerCache.over&&(n.push(i("out",this,this.containers[s])),this.containers[s].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,e||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!e){for(s=0;n.length>s;s++)n[s].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){t.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(e){var i=e||this;return{helper:i.helper,placeholder:i.placeholder||t([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:e?e.element:null}}}),t.widget("ui.spinner",{version:"1.12.1",defaultElement:"<input>",widgetEventPrefix:"spin",options:{classes:{"ui-spinner":"ui-corner-all","ui-spinner-down":"ui-corner-br","ui-spinner-up":"ui-corner-tr"},culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var e=this._super(),i=this.element;return t.each(["min","max","step"],function(t,s){var n=i.attr(s);null!=n&&n.length&&(e[s]=n)}),e},_events:{keydown:function(t){this._start(t)&&this._keydown(t)&&t.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(t){return this.cancelBlur?(delete this.cancelBlur,void 0):(this._stop(),this._refresh(),this.previous!==this.element.val()&&this._trigger("change",t),void 0)},mousewheel:function(t,e){if(e){if(!this.spinning&&!this._start(t))return!1;this._spin((e>0?1:-1)*this.options.step,t),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(t)},100),t.preventDefault()}},"mousedown .ui-spinner-button":function(e){function i(){var e=this.element[0]===t.ui.safeActiveElement(this.document[0]);e||(this.element.trigger("focus"),this.previous=s,this._delay(function(){this.previous=s}))}var s;s=this.element[0]===t.ui.safeActiveElement(this.document[0])?this.previous:this.element.val(),e.preventDefault(),i.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,i.call(this)}),this._start(e)!==!1&&this._repeat(null,t(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(e){return t(e.currentTarget).hasClass("ui-state-active")?this._start(e)===!1?!1:(this._repeat(null,t(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e),void 0):void 0},"mouseleave .ui-spinner-button":"_stop"},_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap("<span>").parent().append("<a></a><a></a>")},_draw:function(){this._enhance(),this._addClass(this.uiSpinner,"ui-spinner","ui-widget ui-widget-content"),this._addClass("ui-spinner-input"),this.element.attr("role","spinbutton"),this.buttons=this.uiSpinner.children("a").attr("tabIndex",-1).attr("aria-hidden",!0).button({classes:{"ui-button":""}}),this._removeClass(this.buttons,"ui-corner-all"),this._addClass(this.buttons.first(),"ui-spinner-button ui-spinner-up"),this._addClass(this.buttons.last(),"ui-spinner-button ui-spinner-down"),this.buttons.first().button({icon:this.options.icons.up,showLabel:!1}),this.buttons.last().button({icon:this.options.icons.down,showLabel:!1}),this.buttons.height()>Math.ceil(.5*this.uiSpinner.height())&&this.uiSpinner.height()>0&&this.uiSpinner.height(this.uiSpinner.height())},_keydown:function(e){var i=this.options,s=t.ui.keyCode;switch(e.keyCode){case s.UP:return this._repeat(null,1,e),!0;case s.DOWN:return this._repeat(null,-1,e),!0;case s.PAGE_UP:return this._repeat(null,i.page,e),!0;case s.PAGE_DOWN:return this._repeat(null,-i.page,e),!0}return!1},_start:function(t){return this.spinning||this._trigger("start",t)!==!1?(this.counter||(this.counter=1),this.spinning=!0,!0):!1},_repeat:function(t,e,i){t=t||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,e,i)},t),this._spin(e*this.options.step,i)},_spin:function(t,e){var i=this.value()||0;this.counter||(this.counter=1),i=this._adjustValue(i+t*this._increment(this.counter)),this.spinning&&this._trigger("spin",e,{value:i})===!1||(this._value(i),this.counter++)},_increment:function(e){var i=this.options.incremental;return i?t.isFunction(i)?i(e):Math.floor(e*e*e/5e4-e*e/500+17*e/200+1):1},_precision:function(){var t=this._precisionOf(this.options.step);return null!==this.options.min&&(t=Math.max(t,this._precisionOf(this.options.min))),t},_precisionOf:function(t){var e=""+t,i=e.indexOf(".");return-1===i?0:e.length-i-1},_adjustValue:function(t){var e,i,s=this.options;return e=null!==s.min?s.min:0,i=t-e,i=Math.round(i/s.step)*s.step,t=e+i,t=parseFloat(t.toFixed(this._precision())),null!==s.max&&t>s.max?s.max:null!==s.min&&s.min>t?s.min:t},_stop:function(t){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",t))},_setOption:function(t,e){var i,s,n;return"culture"===t||"numberFormat"===t?(i=this._parse(this.element.val()),this.options[t]=e,this.element.val(this._format(i)),void 0):(("max"===t||"min"===t||"step"===t)&&"string"==typeof e&&(e=this._parse(e)),"icons"===t&&(s=this.buttons.first().find(".ui-icon"),this._removeClass(s,null,this.options.icons.up),this._addClass(s,null,e.up),n=this.buttons.last().find(".ui-icon"),this._removeClass(n,null,this.options.icons.down),this._addClass(n,null,e.down)),this._super(t,e),void 0)},_setOptionDisabled:function(t){this._super(t),this._toggleClass(this.uiSpinner,null,"ui-state-disabled",!!t),this.element.prop("disabled",!!t),this.buttons.button(t?"disable":"enable")},_setOptions:r(function(t){this._super(t)}),_parse:function(t){return"string"==typeof t&&""!==t&&(t=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(t,10,this.options.culture):+t),""===t||isNaN(t)?null:t},_format:function(t){return""===t?"":window.Globalize&&this.options.numberFormat?Globalize.format(t,this.options.numberFormat,this.options.culture):t},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var t=this.value();return null===t?!1:t===this._adjustValue(t)},_value:function(t,e){var i;""!==t&&(i=this._parse(t),null!==i&&(e||(i=this._adjustValue(i)),t=this._format(i))),this.element.val(t),this._refresh()},_destroy:function(){this.element.prop("disabled",!1).removeAttr("autocomplete role aria-valuemin aria-valuemax aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:r(function(t){this._stepUp(t)}),_stepUp:function(t){this._start()&&(this._spin((t||1)*this.options.step),this._stop())},stepDown:r(function(t){this._stepDown(t)}),_stepDown:function(t){this._start()&&(this._spin((t||1)*-this.options.step),this._stop())},pageUp:r(function(t){this._stepUp((t||1)*this.options.page)}),pageDown:r(function(t){this._stepDown((t||1)*this.options.page)}),value:function(t){return arguments.length?(r(this._value).call(this,t),void 0):this._parse(this.element.val())},widget:function(){return this.uiSpinner}}),t.uiBackCompat!==!1&&t.widget("ui.spinner",t.ui.spinner,{_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml())},_uiSpinnerHtml:function(){return"<span>"},_buttonHtml:function(){return"<a></a><a></a>"}}),t.ui.spinner,t.widget("ui.tabs",{version:"1.12.1",delay:300,options:{active:null,classes:{"ui-tabs":"ui-corner-all","ui-tabs-nav":"ui-corner-all","ui-tabs-panel":"ui-corner-bottom","ui-tabs-tab":"ui-corner-top"},collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:function(){var t=/#.*$/;return function(e){var i,s;i=e.href.replace(t,""),s=location.href.replace(t,"");try{i=decodeURIComponent(i)}catch(n){}try{s=decodeURIComponent(s)}catch(n){}return e.hash.length>1&&i===s}}(),_create:function(){var e=this,i=this.options;this.running=!1,this._addClass("ui-tabs","ui-widget ui-widget-content"),this._toggleClass("ui-tabs-collapsible",null,i.collapsible),this._processTabs(),i.active=this._initialActive(),t.isArray(i.disabled)&&(i.disabled=t.unique(i.disabled.concat(t.map(this.tabs.filter(".ui-state-disabled"),function(t){return e.tabs.index(t)}))).sort()),this.active=this.options.active!==!1&&this.anchors.length?this._findActive(i.active):t(),this._refresh(),this.active.length&&this.load(i.active)},_initialActive:function(){var e=this.options.active,i=this.options.collapsible,s=location.hash.substring(1);return null===e&&(s&&this.tabs.each(function(i,n){return t(n).attr("aria-controls")===s?(e=i,!1):void 0}),null===e&&(e=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===e||-1===e)&&(e=this.tabs.length?0:!1)),e!==!1&&(e=this.tabs.index(this.tabs.eq(e)),-1===e&&(e=i?!1:0)),!i&&e===!1&&this.anchors.length&&(e=0),e},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):t()}},_tabKeydown:function(e){var i=t(t.ui.safeActiveElement(this.document[0])).closest("li"),s=this.tabs.index(i),n=!0;if(!this._handlePageNav(e)){switch(e.keyCode){case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:s++;break;case t.ui.keyCode.UP:case t.ui.keyCode.LEFT:n=!1,s--;break;case t.ui.keyCode.END:s=this.anchors.length-1;break;case t.ui.keyCode.HOME:s=0;break;case t.ui.keyCode.SPACE:return e.preventDefault(),clearTimeout(this.activating),this._activate(s),void 0;case t.ui.keyCode.ENTER:return e.preventDefault(),clearTimeout(this.activating),this._activate(s===this.options.active?!1:s),void 0;default:return}e.preventDefault(),clearTimeout(this.activating),s=this._focusNextTab(s,n),e.ctrlKey||e.metaKey||(i.attr("aria-selected","false"),this.tabs.eq(s).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",s)},this.delay))}},_panelKeydown:function(e){this._handlePageNav(e)||e.ctrlKey&&e.keyCode===t.ui.keyCode.UP&&(e.preventDefault(),this.active.trigger("focus"))},_handlePageNav:function(e){return e.altKey&&e.keyCode===t.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):e.altKey&&e.keyCode===t.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(e,i){function s(){return e>n&&(e=0),0>e&&(e=n),e}for(var n=this.tabs.length-1;-1!==t.inArray(s(),this.options.disabled);)e=i?e+1:e-1;return e},_focusNextTab:function(t,e){return t=this._findNextTab(t,e),this.tabs.eq(t).trigger("focus"),t},_setOption:function(t,e){return"active"===t?(this._activate(e),void 0):(this._super(t,e),"collapsible"===t&&(this._toggleClass("ui-tabs-collapsible",null,e),e||this.options.active!==!1||this._activate(0)),"event"===t&&this._setupEvents(e),"heightStyle"===t&&this._setupHeightStyle(e),void 0)},_sanitizeSelector:function(t){return t?t.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var e=this.options,i=this.tablist.children(":has(a[href])");e.disabled=t.map(i.filter(".ui-state-disabled"),function(t){return i.index(t)}),this._processTabs(),e.active!==!1&&this.anchors.length?this.active.length&&!t.contains(this.tablist[0],this.active[0])?this.tabs.length===e.disabled.length?(e.active=!1,this.active=t()):this._activate(this._findNextTab(Math.max(0,e.active-1),!1)):e.active=this.tabs.index(this.active):(e.active=!1,this.active=t()),this._refresh()},_refresh:function(){this._setOptionDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._addClass(this.active,"ui-tabs-active","ui-state-active"),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var e=this,i=this.tabs,s=this.anchors,n=this.panels;this.tablist=this._getList().attr("role","tablist"),this._addClass(this.tablist,"ui-tabs-nav","ui-helper-reset ui-helper-clearfix ui-widget-header"),this.tablist.on("mousedown"+this.eventNamespace,"> li",function(e){t(this).is(".ui-state-disabled")&&e.preventDefault()}).on("focus"+this.eventNamespace,".ui-tabs-anchor",function(){t(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this.tabs=this.tablist.find("> li:has(a[href])").attr({role:"tab",tabIndex:-1}),this._addClass(this.tabs,"ui-tabs-tab","ui-state-default"),this.anchors=this.tabs.map(function(){return t("a",this)[0]}).attr({role:"presentation",tabIndex:-1}),this._addClass(this.anchors,"ui-tabs-anchor"),this.panels=t(),this.anchors.each(function(i,s){var n,o,a,r=t(s).uniqueId().attr("id"),h=t(s).closest("li"),l=h.attr("aria-controls");e._isLocal(s)?(n=s.hash,a=n.substring(1),o=e.element.find(e._sanitizeSelector(n))):(a=h.attr("aria-controls")||t({}).uniqueId()[0].id,n="#"+a,o=e.element.find(n),o.length||(o=e._createPanel(a),o.insertAfter(e.panels[i-1]||e.tablist)),o.attr("aria-live","polite")),o.length&&(e.panels=e.panels.add(o)),l&&h.data("ui-tabs-aria-controls",l),h.attr({"aria-controls":a,"aria-labelledby":r}),o.attr("aria-labelledby",r)}),this.panels.attr("role","tabpanel"),this._addClass(this.panels,"ui-tabs-panel","ui-widget-content"),i&&(this._off(i.not(this.tabs)),this._off(s.not(this.anchors)),this._off(n.not(this.panels)))},_getList:function(){return this.tablist||this.element.find("ol, ul").eq(0)},_createPanel:function(e){return t("<div>").attr("id",e).data("ui-tabs-destroy",!0)},_setOptionDisabled:function(e){var i,s,n;for(t.isArray(e)&&(e.length?e.length===this.anchors.length&&(e=!0):e=!1),n=0;s=this.tabs[n];n++)i=t(s),e===!0||-1!==t.inArray(n,e)?(i.attr("aria-disabled","true"),this._addClass(i,null,"ui-state-disabled")):(i.removeAttr("aria-disabled"),this._removeClass(i,null,"ui-state-disabled"));this.options.disabled=e,this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,e===!0)},_setupEvents:function(e){var i={};e&&t.each(e.split(" "),function(t,e){i[e]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(t){t.preventDefault()}}),this._on(this.anchors,i),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(e){var i,s=this.element.parent();"fill"===e?(i=s.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var e=t(this),s=e.css("position");"absolute"!==s&&"fixed"!==s&&(i-=e.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){i-=t(this).outerHeight(!0)}),this.panels.each(function(){t(this).height(Math.max(0,i-t(this).innerHeight()+t(this).height()))}).css("overflow","auto")):"auto"===e&&(i=0,this.panels.each(function(){i=Math.max(i,t(this).height("").height())}).height(i))},_eventHandler:function(e){var i=this.options,s=this.active,n=t(e.currentTarget),o=n.closest("li"),a=o[0]===s[0],r=a&&i.collapsible,h=r?t():this._getPanelForTab(o),l=s.length?this._getPanelForTab(s):t(),c={oldTab:s,oldPanel:l,newTab:r?t():o,newPanel:h};e.preventDefault(),o.hasClass("ui-state-disabled")||o.hasClass("ui-tabs-loading")||this.running||a&&!i.collapsible||this._trigger("beforeActivate",e,c)===!1||(i.active=r?!1:this.tabs.index(o),this.active=a?t():o,this.xhr&&this.xhr.abort(),l.length||h.length||t.error("jQuery UI Tabs: Mismatching fragment identifier."),h.length&&this.load(this.tabs.index(o),e),this._toggle(e,c))},_toggle:function(e,i){function s(){o.running=!1,o._trigger("activate",e,i)}function n(){o._addClass(i.newTab.closest("li"),"ui-tabs-active","ui-state-active"),a.length&&o.options.show?o._show(a,o.options.show,s):(a.show(),s())}var o=this,a=i.newPanel,r=i.oldPanel;this.running=!0,r.length&&this.options.hide?this._hide(r,this.options.hide,function(){o._removeClass(i.oldTab.closest("li"),"ui-tabs-active","ui-state-active"),n()}):(this._removeClass(i.oldTab.closest("li"),"ui-tabs-active","ui-state-active"),r.hide(),n()),r.attr("aria-hidden","true"),i.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),a.length&&r.length?i.oldTab.attr("tabIndex",-1):a.length&&this.tabs.filter(function(){return 0===t(this).attr("tabIndex")}).attr("tabIndex",-1),a.attr("aria-hidden","false"),i.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(e){var i,s=this._findActive(e);s[0]!==this.active[0]&&(s.length||(s=this.active),i=s.find(".ui-tabs-anchor")[0],this._eventHandler({target:i,currentTarget:i,preventDefault:t.noop}))},_findActive:function(e){return e===!1?t():this.tabs.eq(e)},_getIndex:function(e){return"string"==typeof e&&(e=this.anchors.index(this.anchors.filter("[href$='"+t.ui.escapeSelector(e)+"']"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.tablist.removeAttr("role").off(this.eventNamespace),this.anchors.removeAttr("role tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){t.data(this,"ui-tabs-destroy")?t(this).remove():t(this).removeAttr("role tabIndex aria-live aria-busy aria-selected aria-labelledby aria-hidden aria-expanded")}),this.tabs.each(function(){var e=t(this),i=e.data("ui-tabs-aria-controls");i?e.attr("aria-controls",i).removeData("ui-tabs-aria-controls"):e.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(e){var i=this.options.disabled;i!==!1&&(void 0===e?i=!1:(e=this._getIndex(e),i=t.isArray(i)?t.map(i,function(t){return t!==e?t:null}):t.map(this.tabs,function(t,i){return i!==e?i:null})),this._setOptionDisabled(i))},disable:function(e){var i=this.options.disabled;if(i!==!0){if(void 0===e)i=!0;else{if(e=this._getIndex(e),-1!==t.inArray(e,i))return;i=t.isArray(i)?t.merge([e],i).sort():[e]}this._setOptionDisabled(i)}},load:function(e,i){e=this._getIndex(e);var s=this,n=this.tabs.eq(e),o=n.find(".ui-tabs-anchor"),a=this._getPanelForTab(n),r={tab:n,panel:a},h=function(t,e){"abort"===e&&s.panels.stop(!1,!0),s._removeClass(n,"ui-tabs-loading"),a.removeAttr("aria-busy"),t===s.xhr&&delete s.xhr};this._isLocal(o[0])||(this.xhr=t.ajax(this._ajaxSettings(o,i,r)),this.xhr&&"canceled"!==this.xhr.statusText&&(this._addClass(n,"ui-tabs-loading"),a.attr("aria-busy","true"),this.xhr.done(function(t,e,n){setTimeout(function(){a.html(t),s._trigger("load",i,r),h(n,e)},1)}).fail(function(t,e){setTimeout(function(){h(t,e)},1)})))},_ajaxSettings:function(e,i,s){var n=this;return{url:e.attr("href").replace(/#.*$/,""),beforeSend:function(e,o){return n._trigger("beforeLoad",i,t.extend({jqXHR:e,ajaxSettings:o},s))}}},_getPanelForTab:function(e){var i=t(e).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+i))}}),t.uiBackCompat!==!1&&t.widget("ui.tabs",t.ui.tabs,{_processTabs:function(){this._superApply(arguments),this._addClass(this.tabs,"ui-tab")}}),t.ui.tabs,t.widget("ui.tooltip",{version:"1.12.1",options:{classes:{"ui-tooltip":"ui-corner-all ui-widget-shadow"},content:function(){var e=t(this).attr("title")||"";return t("<a>").text(e).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,track:!1,close:null,open:null},_addDescribedBy:function(e,i){var s=(e.attr("aria-describedby")||"").split(/\s+/);s.push(i),e.data("ui-tooltip-id",i).attr("aria-describedby",t.trim(s.join(" ")))},_removeDescribedBy:function(e){var i=e.data("ui-tooltip-id"),s=(e.attr("aria-describedby")||"").split(/\s+/),n=t.inArray(i,s);-1!==n&&s.splice(n,1),e.removeData("ui-tooltip-id"),s=t.trim(s.join(" ")),s?e.attr("aria-describedby",s):e.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.liveRegion=t("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body),this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible"),this.disabledTitles=t([])},_setOption:function(e,i){var s=this;this._super(e,i),"content"===e&&t.each(this.tooltips,function(t,e){s._updateContent(e.element)})},_setOptionDisabled:function(t){this[t?"_disable":"_enable"]()},_disable:function(){var e=this;t.each(this.tooltips,function(i,s){var n=t.Event("blur");n.target=n.currentTarget=s.element[0],e.close(n,!0)}),this.disabledTitles=this.disabledTitles.add(this.element.find(this.options.items).addBack().filter(function(){var e=t(this);return e.is("[title]")?e.data("ui-tooltip-title",e.attr("title")).removeAttr("title"):void 0}))},_enable:function(){this.disabledTitles.each(function(){var e=t(this);e.data("ui-tooltip-title")&&e.attr("title",e.data("ui-tooltip-title"))}),this.disabledTitles=t([])},open:function(e){var i=this,s=t(e?e.target:this.element).closest(this.options.items);s.length&&!s.data("ui-tooltip-id")&&(s.attr("title")&&s.data("ui-tooltip-title",s.attr("title")),s.data("ui-tooltip-open",!0),e&&"mouseover"===e.type&&s.parents().each(function(){var e,s=t(this);s.data("ui-tooltip-open")&&(e=t.Event("blur"),e.target=e.currentTarget=this,i.close(e,!0)),s.attr("title")&&(s.uniqueId(),i.parents[this.id]={element:this,title:s.attr("title")},s.attr("title",""))}),this._registerCloseHandlers(e,s),this._updateContent(s,e))},_updateContent:function(t,e){var i,s=this.options.content,n=this,o=e?e.type:null;return"string"==typeof s||s.nodeType||s.jquery?this._open(e,t,s):(i=s.call(t[0],function(i){n._delay(function(){t.data("ui-tooltip-open")&&(e&&(e.type=o),this._open(e,t,i))})}),i&&this._open(e,t,i),void 0)},_open:function(e,i,s){function n(t){l.of=t,a.is(":hidden")||a.position(l)}var o,a,r,h,l=t.extend({},this.options.position);if(s){if(o=this._find(i))return o.tooltip.find(".ui-tooltip-content").html(s),void 0;i.is("[title]")&&(e&&"mouseover"===e.type?i.attr("title",""):i.removeAttr("title")),o=this._tooltip(i),a=o.tooltip,this._addDescribedBy(i,a.attr("id")),a.find(".ui-tooltip-content").html(s),this.liveRegion.children().hide(),h=t("<div>").html(a.find(".ui-tooltip-content").html()),h.removeAttr("name").find("[name]").removeAttr("name"),h.removeAttr("id").find("[id]").removeAttr("id"),h.appendTo(this.liveRegion),this.options.track&&e&&/^mouse/.test(e.type)?(this._on(this.document,{mousemove:n}),n(e)):a.position(t.extend({of:i},this.options.position)),a.hide(),this._show(a,this.options.show),this.options.track&&this.options.show&&this.options.show.delay&&(r=this.delayedShow=setInterval(function(){a.is(":visible")&&(n(l.of),clearInterval(r))},t.fx.interval)),this._trigger("open",e,{tooltip:a})}},_registerCloseHandlers:function(e,i){var s={keyup:function(e){if(e.keyCode===t.ui.keyCode.ESCAPE){var s=t.Event(e);s.currentTarget=i[0],this.close(s,!0)}}};i[0]!==this.element[0]&&(s.remove=function(){this._removeTooltip(this._find(i).tooltip)}),e&&"mouseover"!==e.type||(s.mouseleave="close"),e&&"focusin"!==e.type||(s.focusout="close"),this._on(!0,i,s)},close:function(e){var i,s=this,n=t(e?e.currentTarget:this.element),o=this._find(n);return o?(i=o.tooltip,o.closing||(clearInterval(this.delayedShow),n.data("ui-tooltip-title")&&!n.attr("title")&&n.attr("title",n.data("ui-tooltip-title")),this._removeDescribedBy(n),o.hiding=!0,i.stop(!0),this._hide(i,this.options.hide,function(){s._removeTooltip(t(this))}),n.removeData("ui-tooltip-open"),this._off(n,"mouseleave focusout keyup"),n[0]!==this.element[0]&&this._off(n,"remove"),this._off(this.document,"mousemove"),e&&"mouseleave"===e.type&&t.each(this.parents,function(e,i){t(i.element).attr("title",i.title),delete s.parents[e]}),o.closing=!0,this._trigger("close",e,{tooltip:i}),o.hiding||(o.closing=!1)),void 0):(n.removeData("ui-tooltip-open"),void 0)},_tooltip:function(e){var i=t("<div>").attr("role","tooltip"),s=t("<div>").appendTo(i),n=i.uniqueId().attr("id");return this._addClass(s,"ui-tooltip-content"),this._addClass(i,"ui-tooltip","ui-widget ui-widget-content"),i.appendTo(this._appendTo(e)),this.tooltips[n]={element:e,tooltip:i}},_find:function(t){var e=t.data("ui-tooltip-id");return e?this.tooltips[e]:null},_removeTooltip:function(t){t.remove(),delete this.tooltips[t.attr("id")]},_appendTo:function(t){var e=t.closest(".ui-front, dialog");return e.length||(e=this.document[0].body),e},_destroy:function(){var e=this;t.each(this.tooltips,function(i,s){var n=t.Event("blur"),o=s.element;n.target=n.currentTarget=o[0],e.close(n,!0),t("#"+i).remove(),o.data("ui-tooltip-title")&&(o.attr("title")||o.attr("title",o.data("ui-tooltip-title")),o.removeData("ui-tooltip-title"))}),this.liveRegion.remove()}}),t.uiBackCompat!==!1&&t.widget("ui.tooltip",t.ui.tooltip,{options:{tooltipClass:null},_tooltip:function(){var t=this._superApply(arguments);return this.options.tooltipClass&&t.tooltip.addClass(this.options.tooltipClass),t}}),t.ui.tooltip});
/** javascripts/UtilityFunctions.js **/
function reloadPage() {
   location.reload();
}

function CheckAll(id, idTable) {
	CheckAllWithIdToSelect(id, idTable, 'chkSelect');
}

function CheckAllWithIdToSelect(id, idTable, idToSelect) {

	// Get the table
	var table = $('#' + idTable);
	
	// Get the selector checkbox
	var selector = $(table).find('#' + id);
	
	// Get the selector value
	var selectorValue = selector.is(':checked');

	// Toggle every checkbox in a visible row
	$(table).find('tbody tr').each(function() {
		if ($(this).is(':visible')) {
			// Check if element is visible
			var slct = $(this).find('#' + idToSelect);
			if (slct.is(':visible') && !isElementDisabled(slct)) {
				slct.prop('checked', selectorValue);
				var onchange = slct.attr("onchange");
				if (!isStringEmpty(onchange)) {
					slct.closest("td").each(function () {
						eval(onchange);
					});
				}
			}
    	}
    });
}

function populateSelectedOptions(slctElementId, hdnElementId, optValueCommaReplacer, optValuePercentageReplacer) {
	// Build a string of selected a list
	var selectedOptions = "";

	$('#' + slctElementId + ' :selected').each(function(i, selected) {
		var value = $(selected).val();
		if (optValueCommaReplacer != undefined) {
			value = replaceAll(value, ",", optValueCommaReplacer);
		}
		if (optValuePercentageReplacer != undefined) {
			value = replaceAll(value, "%", optValuePercentageReplacer);
		}
		selectedOptions = selectedOptions + value + ','; 
	}); 

	if (selectedOptions.length > 0) {
		selectedOptions = selectedOptions.substring(0, selectedOptions.length - 1);
	}

	var element;
	if (hdnElementId instanceof jQuery) {
		element = hdnElementId;
	} else {
		element = $('#' + hdnElementId);
	}
	element.val(selectedOptions);
}

function ToggleElementVisibility(parentElementId, elementId) {

	// Get the CSS class of the element
	var elementClass = '' + $('#' + parentElementId).find('#' + elementId).attr('class');
	
	var visible = false;
	if (elementClass.indexOf("inactive") == -1) {		
		$('#' + parentElementId).find('#' + elementId).addClass('inactive');
		visible = false;
	} else {
		$('#' + parentElementId).find('#' + elementId).removeClass('inactive');
		visible = true;
	}
	
	return visible;
}

function getSelectedElementValuesAsArray(tableId, elementIdToExtract, showHidden) {

	if (showHidden == undefined) {
		showHidden = false;
	}
	
	var selectedElementValues = new Array();

	$('#' + tableId + " [id='chkSlct']").each(function() {
		var bVisible = $(this).is(':visible');
		var bSelected = $(this).find("input[type='checkbox']").prop('checked');
		if ((bVisible || showHidden) && bSelected)  {
			var elementValue = $(this).find('#' + elementIdToExtract).val();

			selectedElementValues.push(elementValue);
		}
	});

	return selectedElementValues;
}

function getSelectedAttributeValuesAsArray(tableId, attributeIdToExtract) {

	var selectedAttributeValues = new Array();

	$('#' + tableId + ' tbody tr').each(function() {
		var bVisible = $(this).is(':visible');
		var bSelected = $(this).find('#chkSelect').is(':checked');
		if (bVisible && bSelected)  {
			var attrValue = $(this).attr(attributeIdToExtract);

			selectedAttributeValues.push(attrValue);
		}
	});

	return selectedAttributeValues;
}

function GetSelectedIDs(idTable) {

	var vSelectedIDs = "";
	
	$('#' + idTable + ' tr').each(function()
	{
		var bVisible = $(this).is(':visible');
		var bSelected = $(this).find('#chkSelect').is(':checked');
		if (bVisible == true && bSelected == true) 
		{
			var vID = $(this).find('#hdnID').val();
			
			vSelectedIDs += (vID + ",");
		}
	});
	
	return vSelectedIDs;
}

function getHowManyRowsAreSelected(tableId, checkColumnId) {

	var numberOfSelectedItems = 0;
	
	$('#' + tableId + ' tbody tr').each(function() {
		// Iterate over the rows and find out if checked
		var isSelected = $(this).find('#' + checkColumnId).is(':checked');
		if (isSelected)
		{
			numberOfSelectedItems++;
		}
	});
	
	return numberOfSelectedItems;
}

function getValueFromElement(element)  {
	var element = $(element);

	if (element.is("select")) {
		if (element.is("[multiple]")) {
			return element.val();
		}

		// Autocomplete combobox
		var nextToSelect = element.next();
		if (nextToSelect.is("span")) {
			var input = nextToSelect.find(".custom-combobox-input");
			if (input.length > 0) {
				return input.val();
			}
		}

		// No other value set for autocomplete combobox
		var selectedOption = element.find('option:selected');
		if (selectedOption.length == 0) {
			return "";
		} else {
			return selectedOption.val();
		}
	} else if (element.is("input[type='checkbox']")) {
		return element.prop('checked');
	} else if (element.is("input[type='file']")) {
		return getFileNameFromFileInput($(element));
	} else if (element.is("input[type='radio']")) {
		return $('input[name="' + element.prop('name') + '"]:checked').val();
	} else if (element.is("label")) {
		return element.text();
	} else {
		return element.val();
	}	
}

function getTextFromElement(element) {

	// Get the element ID
	var elementId = $(element).attr('id');
	
	// The text to return
	var text = "";
	
	if (elementId.indexOf("slct") === 0) {
	
		text = $(element).find('option:selected').text();
		
	} else {
	
		text = $(element).text();
	}	
	
	return text;
}

function getAttrValueFromSelected(element, attrName) {
	var selectedOption = $(element).find('option:selected');
	
	return selectedOption.attr(attrName);
}

function setValueOfElement(element, value) {
	if (undefined == element) {
		return;
	}
	
	// Get the element ID
	var elementId = $(element).attr('id');
	
	if (elementId.indexOf("slct") === 0) {
		$(element).val(value);
	} else if (elementId.indexOf("chk") === 0) {
		// Parse string value (true/false)
		if (typeof value == 'string') {
			value = (value == 'true');
		}
		$(element).prop('checked', value);
	} else if (elementId.indexOf("lbl") === 0) {
		$(element).html(value);
	} else {
		$(element).val(value);
	}	
}
		
function getValueFromRadioButtonGroup(groupName) {

	return $('input[name=' + groupName + ']:checked').val()
}		

function getSelectedRows(table) {

	// An array for the selected rows
	var selectedRows = new Array();
	
	// Get the ID's of selected rows
	$(table).find('tbody tr').each(function() {
	
		// Get the visibility and selected state of the row
		var chkSelect = $(this).find('#chkSelect');
		var isSelected = chkSelect.is(':checked');
		var isVisible = chkSelect.is(':visible');
		
		// If the row is both visible and selected
		if (isVisible && isSelected) {
	
			// Add the row to the array
			selectedRows.push(this);
		}
	});
	
	return selectedRows;
}

function getContainingTableSelectedRows(callingElement) {

	// Get the table of the containing element
	var table = $(callingElement).parents('table:eq(0)');
	
	// Get the selected rows
	return getSelectedRows(table);
}

function getContainingTableSelectedRowsDifferentFromCallingElement(callingElement) {

	// Get the un-filter rows
	var rows = getContainingTableSelectedRows(callingElement);
	
	// Perform the filter
	return filterRows(rows, function(element) {
		var elemInRow = $(element).find('#' + callingElement.id);
		var isElemEnabled = elemInRow.is(':enabled')
		return getValueFromElement(elemInRow) != getValueFromElement(callingElement) && isElemEnabled;
	});
}

function getAttributeValueFromEachRowAsString(rows, attributeName) {

	// Get the attributes as array
	var attributeValueFromEachRowAsArray = getAttributeValueFromEachRow(rows, attributeName);
	
	// Convert to string
	var attributeValueFromEachRowAsString = convertArrayOfIdsToString(attributeValueFromEachRowAsArray);
	
	return attributeValueFromEachRowAsString;
}

function getAttributeValueFromEachRow(rows, attributeName) {

	var attributeValues = new Array();
	for (var rowIndex = 0; rowIndex < rows.length; rowIndex++) {
	
		// Get the row
		var row = rows[rowIndex];
		
		// Get the attribute value
		attributeValue = $(row).attr(attributeName);
		 
		// Insert into the array
		attributeValues.push(attributeValue);
	}
	return attributeValues;
}

function getRowsByOptionalAttributeValues(table, attributeName, attributeOptionalValues) {

	var selectedRows = new Array();
	
	$(table).find('tbody tr').each(function() {
	
		// Get the attribute from the row
		var attributeValue = $(this).attr(attributeName);
	
		// If the value of the attribute is in the array of optional values
		if ($.inArray(attributeValue, attributeOptionalValues) >= 0) {
		
			// Add the row to the row array
			selectedRows.push(this);
		}
	});
	
	return selectedRows;
}

function setCellTextInEachRow(table, attributeName, attributeOptionalValues, cellName, cellValue) {
	
	$(table).find('tbody tr').each(function() {
	
		// Get the attribute from the row
		var attributeValue = $(this).attr(attributeName);
		
		// If the value of the attribute is in the array of optional values
		if ($.inArray(attributeValue, attributeOptionalValues) >= 0) {
			
			// Get the cell
			var cell = $(this).find('#' + cellName);
			
			// Set the cell value
			$(cell).html(cellValue);
		}			
	});
}

function setElementValueInEachRow(rows, elementIdToUpdate, elementValueToUpdate) {
	
	// Go over the rows, and set the value to the element
	for (var rowIndex in rows) {
	
		// Get the row
		var row = rows[rowIndex];
		
		// Get the element
		var element = $(row).find('#' + elementIdToUpdate);
		
		// Set the value
		setValueOfElement(element, elementValueToUpdate);
	}
}

function getRowsByOptionalAttributeValuesAndSetElementValueInEachRow(
	table,
	attributeName,
	attributeOptionalValues,
	elementIdToUpdate,
	elementValueToUpdate) {
	
	var rows = getRowsByOptionalAttributeValues(table, attributeName, attributeOptionalValues);
	
	setElementValueInEachRow(rows, elementIdToUpdate, elementValueToUpdate);
}

function addOptionsToSelectElement(selectElement, options) {

	for (var optionIndex in options) {
	
		$(selectElement).append('<option value="' + options[optionIndex] + '">' + options[optionIndex] + '</option>')	
	}
}

function clearSelectOptions(selectElementId) {
	$('#' + selectElementId).find('option').remove();
}

function calculateTextareaRows(textareaCols, text) {
	// Textarea cols value actually contains a little more than the specified number of characters
	var textareaRows = Math.floor(text.length / textareaCols / 1.25 + 1);
	return textareaRows;
}

/**
 * Sends a POST request to the given URL with the given JSON data object supplied.
 * 
 * data		Each key will be a different form parameter passed to the new window.
 * 			In case of nested objects, the value of each key (of the main JSON object) will be a stringified version of it.
 * 			If undefined, no data will be passed along.
 * 
 * target	The target window to open in. If undefined, a fresh page will open.
 * 			If you'd like the contents to replace your current page, use "_self" as target.
 */
function PostJsonToNewWindow(url, data, target, optIsMultipart) {
	var form = document.createElement("form");
	form.action = url;
	form.method = "POST";
	form.target = target || "_blank";
	if (optIsMultipart) {
		form.enctype = "multipart/form-data";
	}
	if (data) {
		for (var key in data) {
			var input = document.createElement("textarea");
			input.name = key;
			input.value = typeof data[key] === "object" ? JSON.stringify(data[key]) : data[key];
			form.appendChild(input);
		}
	}
	form.style.display = 'none';
	document.body.appendChild(form);
	if (form.target != "_blank" && form.target != "_self") {
		var newWindow = window.open(undefined, form.target);
		newWindow.focus();
	}
	form.submit();
}

function Post(link, isAsynch)
{
	xmlhttp = new XMLHttpRequest();
	xmlhttp.open("POST", link, isAsynch);
	xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
	xmlhttp.send();
	
	return xmlhttp;
}

function PostWithFeedback(link, functionNameToInvokeOnSuccess, functionNameToInvokeOnFailure, argument) {
	
	pageLoading();
	var xmlhttp = Post(link, true);
	xmlhttp.onreadystatechange=function() {
		if (xmlhttp.readyState == 4) {
			pageFinishedLoading();
			if (xmlhttp.status == 200) {
				invokeFunction(functionNameToInvokeOnSuccess, argument);
			} else {
				invokeFunction(functionNameToInvokeOnFailure, argument);
			}
		}
	};
}

function PostJson(link, isAsynch, json) {

	var jsonAsString = JSON.stringify(json);
	
	return PostJsonString(link, isAsynch, jsonAsString);
}

function PostJsonString(link, isAsynch, jsonAsString) {
	xmlhttp = new XMLHttpRequest();
	xmlhttp.open("POST", link, isAsynch);
	xmlhttp.setRequestHeader("Content-type", "application/json; charset=UTF-8");
	xmlhttp.send(jsonAsString);
	
	return xmlhttp;
}

function PostJsonWithTextFeedbackFuncs(link, jsonRequest, functionToInvokeOnSuccess, functionToInvokeOnFailure, optKeepLoadingUI) {
	pageLoading();
	var xmlhttp = PostJson(link, true, JSON.stringify(jsonRequest));
	xmlhttp.onreadystatechange=function() {
		if (xmlhttp.readyState == 4) {
			if (!optKeepLoadingUI) {
				pageFinishedLoading();
			}
			if (xmlhttp.status == 200) {
				if (functionToInvokeOnSuccess == undefined) {
					// No success callback
					return;
				}

				functionToInvokeOnSuccess(xmlhttp.responseText);
			} else {
				var responseText = xmlhttp.responseText;
				if (functionToInvokeOnFailure == undefined) {
					// No failure callback
					UIUtility_showAlert(responseText, "Error");
				} else {
					functionToInvokeOnFailure(responseText);
				}
			}
			
			xmlhttp.onreadystatechange = undefined;
		}
	};
}

/**
 * Post JSON and call feedback functions with the result.
 * It's a replacement for the old PostJsonWithJsonFeedback which is unsafe, and has less features.
 * This version supports undefined as functions for not doing anything, and also supports empty responses.
 * This version also supports showing an error dialog if the failure function is undefined.
 */
function PostJsonWithJsonFeedbackFuncs(link, isAsync, jsonRequest, functionToInvokeOnSuccess, functionToInvokeOnFailure, optKeepLoadingUI) {
	pageLoading();
	var xmlhttp = PostJson(link, isAsync, JSON.stringify(jsonRequest));
	xmlhttp.onreadystatechange=function() {
		if (xmlhttp.readyState == 4) {
			if (!optKeepLoadingUI) {
				pageFinishedLoading();
			}
			if (xmlhttp.status == 200) {
				if (functionToInvokeOnSuccess == undefined) {
					// No success callback
					return;
				}

				var jsonResponse = undefined;
				if (!isStringEmpty(xmlhttp.responseText)) {
					// Try parsing as JSON
					try {
						jsonResponse = JSON.parse(xmlhttp.responseText);
					} catch (ex) {
						console.error("Can't parse: " + xmlhttp.responseText);
						return;
					}
				}
				functionToInvokeOnSuccess(jsonResponse);
			} else {
				var responseText = xmlhttp.responseText;
				if (functionToInvokeOnFailure == undefined) {
					// No failure callback
					UIUtility_showAlert(responseText, "Error");
				} else {
					functionToInvokeOnFailure(responseText);
				}
			}
			
			xmlhttp.onreadystatechange = undefined;
		}
	};
	if (!isAsync) {
		if (xmlhttp.onreadystatechange != undefined) {
			// If synchronous, the PostJson call returns only after the result has already been received
			// Therefore, the onreadystatechange function might have not been called at all, so we'll call it ourselves
			xmlhttp.onreadystatechange();
		}
	}
}

function deleteRequest(link, successFunc, failureFunc) {
	pageLoading();

	var xmlhttp = new XMLHttpRequest();
	xmlhttp.open("DELETE", link, true);
	xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
	xmlhttp.send();

	xmlhttp.onreadystatechange = function() {
		if (xmlhttp.readyState == 4) {
			if (xmlhttp.status == 200) {
				pageFinishedLoading();
				successFunc(xmlhttp.responseText);
			} else {
				pageFinishedLoading();
				failureFunc(xmlhttp.responseText);
			}
		}
	};

	return xmlhttp;
}

function GetWithFeedbackFuncs(link, successFunc, failureFunc) {
	pageLoading();
	Get(link,
		function (res) {
			pageFinishedLoading();
			successFunc(res);
		}, function (res) {
			pageFinishedLoading();
			failureFunc(res);
		});
}

function Get(link, optionalSuccessFunc, optionalFailureFunc) {
	var xmlhttp = new XMLHttpRequest();
	xmlhttp.open("GET", link, true);
	xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
	xmlhttp.send();

	if (optionalSuccessFunc != undefined || optionalFailureFunc != undefined) {
		xmlhttp.onreadystatechange = function() {
			if (xmlhttp.readyState == 4) {
				if (xmlhttp.status == 200) {
					if (optionalSuccessFunc != undefined) {
						optionalSuccessFunc(xmlhttp.responseText);
					}
				} else {
					if (optionalFailureFunc != undefined) {
						optionalFailureFunc(xmlhttp.responseText);
					}
				}
			}
		};
	}

	return xmlhttp;
}

function OpenNewTab(url) {
	window.open(url,'_blank');
}

function closeTab() {
	window.close();
}

function Random() {
	return Math.floor(
        Math.random() * 0x10000 /* 65536 */
    );
}

function GUID() {
    var S4 = function () {
        return Math.floor(
            Math.random() * 0x10000 /* 65536 */
        ).toString(16);
    };

    return (
        S4() + S4() + "_" +
        S4() + "_" +
        S4() + "_" +
        S4() + "_" +
        S4() + S4() + S4()
    );
}

function doesValueExistInFilter(tableId, columnName, value) {
  	var filterCell = $('#' + tableId + ' > thead > #trColumnNames > #th' + columnName);
  	var filterOptions = $(filterCell).data('filterOptions');
  	return $.inArray(value, filterOptions) != -1;
}

function resetFilters(tableId) {
	var table = $("#" + tableId);
	table.data('filtersInfo', null);
	prepareTableFiltersExt(tableId, false);
}

function prepareColumnFilter(table, th) {
	// If the cell doesn't have a filter type attribute don't do anything
	if (!th.is('[data-filter-enabled]')) {
		return;
	}

	// Get the cell ID and extract the column name
	var cellId = th.attr('id');
	if (isStringEmpty(cellId)) {
		return;
	}
	var columnName = cellId.substring(2);

	// Create an options array and get the collect filter options function
	var filterOptions = new Array();
	if (!th.is('[data-filter-refresh-on-open]') || th.data('isRefreshing')) {
		var collectValuesFunctionName = "filterCollectValues_CellText";
		var customCollectValuesFunctionName = th.attr('data-filter-collect-values-function');
		if (!isStringEmpty(customCollectValuesFunctionName)) {
			collectValuesFunctionName = customCollectValuesFunctionName;
		}
		var collectValuesFunction = window[collectValuesFunctionName];

		// Collect filter options
		// If there are finite optional values, take them from a single location
		if (th.is('[data-filter-finite-values]')) {
			collectValuesFunction(th, filterOptions);
		} else {
			table.find(' > tbody > tr > [id="td' + columnName + '"]').each(function() {
				collectValuesFunction($(this), filterOptions);
			});
		}

	 	// Sort the options
	 	if (!th.is('[data-filter-with-no-sort]')) {
	 		var dataType = 'String';
	 		if (th.attr('data-filter-values-data-type') == 'int') {
	 			dataType = "int";
	 		}
	 		var sortOrder = 'asc';
	 		if (th.attr('data-filter-values-sort-order') == 'desc') {
	 			sortOrder = 'desc';
	 		}
			SortArray(filterOptions, dataType, sortOrder);
	 	}
	}

	// Check if we should show and sort by count
	var customCollectValuesFunctionName = th.attr('data-filter-collect-values-function');
	var isShowAndSortByCount = false;
	if (customCollectValuesFunctionName != undefined) {
		isShowAndSortByCount = customCollectValuesFunctionName.indexOf("filterCollectValues_AddInstancesCount_") == 0;
	}
	if (isShowAndSortByCount) {
		// Sort by the count
		filterOptions.sort(function (a, b) {
			aValue = parseInt(a.substring(1, a.indexOf(")")));
			bValue = parseInt(b.substring(1, b.indexOf(")")));
			return bValue - aValue;
		})
	}

	// Prepare the column options HTML
	var filterOptionsHtml = "";
	for (var valueIndex in filterOptions) {
		var option = filterOptions[valueIndex];
		option = replaceAll(option, "<", "&lt;");
		option = replaceAll(option, ">", "&gt;");
		var value = option;
		if (isShowAndSortByCount) {
			value = value.substring(value.indexOf(")") + 2);
		}
		filterOptionsHtml += '<option value="' + value + '">' + option + '</option>';  	
	}

 	// Get the filter cell
 	var filterCell = table.find(' > thead > #trColumnNames > [id="th' + columnName + '"]');
 	var filterCellDisplay = filterCell.css('display');
 	if (filterCellDisplay == undefined) {
 		filterCellDisplay = "";
 	}

	var elem = filterCell.find("select");
 	if (elem.length > 0) {
 		// There's already a select box there, lets just replace it, and call the refresh function of the multiple select plugin
 		elem.html(filterOptionsHtml);
 		elem.multipleSelect("refresh");
 	} else {
 		// Make sure filter cell has no filters
 		filterCell.find("select, .ms-parent").remove();

 		var textRows = 0;
 		if (filterCell.find(".text-wrapper").length == 0) {
 			var html = filterCell.html().trim();
 			if (html == "") {
 				filterCell.addClass("EmptyContent");
 			} else {
 				filterCell.empty();
 				filterCell.append("<span class='text-wrapper'><span class='text'>" + html + "</span></span>");
 				textRows = html.indexOf("<br>") != -1 ? 1 : 0;
 			}
 		}

 		// Add checkbox for and relation instead of or if we need to
 		if (th.is('[data-filter-allow-and-relation]')) {
 			var andElem = $("<input data-and-relation-checkbox type='checkbox' id='chkAnd" + columnName +
 					"' title='Select this to perform and instead of or logic in the filter' onchange='$(this).parent().find(\"select\").change();' />" +
 					"<label for='chkAnd" + columnName + "' style='font-weight: normal;'>&nbsp;Logical And&nbsp;</label><br/>");
 			filterCell.append(andElem);
 		}

 		// There's no select box, let's set it and create the multiple select
	 	elem = $('<select multiple="multiple" id="slct' + columnName + '" name="slct' + columnName + '"'
	 		+ 'onchange="' + th.attr('data-filter-function') + '(\'' + table.attr('id') + '\', \'' + columnName + '\')"'
	 		+ 'style="width: 19px;">' + filterOptionsHtml + '</select>');
 		filterCell.append(elem);

 		// Prepare parameters by set attributes
 		var params = new Object();

 		// Make popup to open on the right if the width of the drop is beyond the table's location (left wise)
 		var marginHandler = function () {
			var msDrop = filterCell.find(".ms-drop");

			// If all the way to the left, don't touch the margin
			if (msDrop.offset().left > 0) {
				msDrop.css('margin-left', (-1 * (msDrop.width() - 17)) + "px");
			} else {
				msDrop.css('margin-left', "0px");
			}
 		};
 		params.onOpen = marginHandler;

 		if (th.is('[data-filter-search]')) {
 			params.filter = true;
 		}

 		if (th.is('[data-filter-refresh-on-open]')) {
 			var oldOnOpen = params.onOpen;
 			params.onOpen = function () {
 				// Call main on open
 				oldOnOpen();

 				// When calling multiple select's refresh method, it will reopen the filter and call this
 				// So if refreshing already, set back to not refreshing and exit function
 				if (th.data('isRefreshing')) {
 					th.data('isRefreshing', false);
 				} else {
 					// Set refreshing before opening
 					th.data('isRefreshing', true);

 					// Refresh data in filter
 					updateColumnFilter(table.attr('id'), th.attr('id'));
 				}
 			};
 		}

		// Set color to filter button if we're filtering and clear it otherwise
		var colorFilter = function () {
			marginHandler();

			var selectedCount = elem.multipleSelect('getSelects').length;
			if (selectedCount == 0 || selectedCount == elem.find("option").length) {
				filterCell.removeClass("FilteredColumnCell");
			} else {
				filterCell.addClass("FilteredColumnCell");
			}
		};
		params.onClick = colorFilter;
		params.onCheckAll = colorFilter;
		params.onUncheckAll = colorFilter;

		elem.multipleSelect(params);

 		// Stupid bug with the plugin setting the display to table-cell somehow, and messes with hiding columns for views
 		filterCell.css('display', filterCellDisplay);

		if (textRows > 0) {
 			var msParent = filterCell.find(".ms-parent");
 	 		msParent.attr('style', msParent.attr('style') + ' margin-top: ' + (2 + 25 * textRows) + "px !important;");
 		}
 	}

 	// Save filter options in the filter cell
 	filterCell.data('filterOptions', filterOptions);
}

function updateColumnFilter(tableId, thId) {
	// Get current filter information's clone (before it's recreated)
	var table = $("#" + tableId);
	var filtersInfo = $.extend({}, table.data('filtersInfo'));

	// Create filter
	var th = table.find(" > thead > #trColumnNames > [id='" + thId + "']");
	prepareColumnFilter(table, th);

	// Check if there's a previous saved filter values
	var filterName = thId.replace("th", "");
	if (filtersInfo != undefined && filtersInfo[filterName] != undefined) {
		// Get select box
		var selectBox = th.find('> select');
		if (selectBox.length > 0) {
			// Look for value in select box's values
			selectBox.multipleSelect('setSelects', filtersInfo[filterName]);
		}
	}

	// Refresh counters of selected/viewable/total
	filter_refreshNumberOfSelectedRows(table);
}

function prepareTableFiltersExt(tableId, zebraTable, resetFilters) {
	// Filter function
	var filterFunction = "FilterTable";
	if (zebraTable == true) {
		filterFunction = "FilterAndZebraTable";
	}

	// Prepare to work off-screen
	var table = $("#" + tableId);
	var ths = table.find(' > thead > #trColumnNames > th');
	var parent = table.parent();
	var index = table.index();
	table.detach();

	// Prepare column filters for all columns
	var columnIndex = 0;
	ths.each(function() {
		var th = $(this);

		// Set filter function
		th.attr('data-filter-function', filterFunction);

		// Prepare filter
		prepareColumnFilter(table, th);

		// Add an index to the column
  		th.attr('data-column-index', columnIndex);
  		columnIndex++;
  	});

	// Add filter bit array for each row which doesn't have it (new rows)
	table.find('> tbody > tr:not([data-filter-ignore])').each(function() {
		// Add the filter bit array
		var $this = $(this);
		if ($this.find("#hdnFilterBitArray").length == 0) {
			$this.append('<input type="hidden" id="hdnFilterBitArray" name="hdnFilterBitArray" />');

			// Create empty array and set in data
			var arr = [];
			for (var i = 0; i < $this.find("td").length; i++) {
				arr.push(0);
			}
			$this.find("#hdnFilterBitArray").data('data', arr).data('count', 0);
		}
  	});

	// Register to checkboxes if needed (new rows)
	var checkboxId = table.attr('data-filter-checkbox-id');
	var checkboxAllId = table.attr('data-filter-checkbox-all-id');
	var refreshFuncWrapper = function () { filter_refreshNumberOfSelectedRows(table); };
	if (checkboxAllId != undefined) {
		var checkbox = table.find("> thead #" + checkboxAllId);
		if (checkbox.data('refreshDefined') != true) {
			checkbox.click(refreshFuncWrapper);
			checkbox.data('refreshDefined', true);
		}
	}
	if (checkboxId != undefined) {
		var checkbox = table.find("> tbody #" + checkboxId);
		checkbox.click(refreshFuncWrapper);
		if (checkbox.data('refreshDefined') != true) {
			checkbox.click(refreshFuncWrapper);
			checkbox.data('refreshDefined', true);
		}
	}

	// Check if there's a previous saved filter values
	if (!resetFilters) {
		var filtersInfo = table.data('filtersInfo');
		if (filtersInfo != undefined) {
			var trColumnNames = table.find(' > thead > #trColumnNames');
			for (var filterName in filtersInfo) {
				// Get select box only if it's visible
				var selectBox = trColumnNames.find('[id="th' + filterName + '"] > select');
				if (selectBox.length > 0) {
					// Look for value in select box's values
					selectBox.multipleSelect('setSelects', filtersInfo[filterName]);
				}
			}
		}
	}

	// Refresh counters of selected/viewable/total
	filter_refreshNumberOfSelectedRows(table);

	// Add table back to screen
	if (index == 0){
        table.prependTo(parent)
    } else {
        table.insertAfter(parent.children().eq(index - 1));
    }
}

function filter_refreshNumberOfSelectedRows(table) {
	if (table.is('[data-filter-display-num-shown-rows]')) {
		// Find place to put counters
		var inId = table.attr('data-filter-display-num-shown-rows-in-id');
		var container;
		if (isStringEmpty(inId)) {
			container = table.find('> thead > #trColumnNames > th:first');
		} else {
			container = table.find("#" + inId);
			if (container.length == 0) {
				container = $("#" + inId);
			}
		}

		// Extract information
		var checkboxId = table.attr('data-filter-checkbox-id');

		// Find counters
		var rows = table.find('> tbody > tr');
		var visibleRows = rows.filter(function () {
			return $(this).css('display') != 'none';
		});
		var totalRows = rows.length;
		var viewableRowsCount = visibleRows.length;

		if (table.attr('data-filter-display-num-shown-rows-expanded') == "true") {
			if (checkboxId == undefined) {
				container.html("Viewing " + viewableRowsCount + " rows out of " + totalRows);
			} else {
				var checkedRows = visibleRows.find("#" + checkboxId + ":checked:visible").length;
				if (checkedRows == 0) {
					container.html("Viewing " + viewableRowsCount + " rows out of " + totalRows);
				} else {
					container.html("Selected " + checkedRows + " rows out of " + viewableRowsCount + " visible, " + totalRows + " total");
				}
			}
		} else {
			if (checkboxId == undefined) {
				container.html(viewableRowsCount + "/" + totalRows);
			} else {
				var checkedRows = visibleRows.find("#" + checkboxId + ":checked:visible").length;
				container.html(checkedRows + "/" + viewableRowsCount + " (" + totalRows + ")");
			}
		}
	} 
}

function filterCollectValues_CellText(td, filterOptions) {
	// Get the cell text
	var value = $(td).text().trim();

	// Add the value to the options array
	filterCollectValues_AddValueToOptionsArray(filterOptions, value);
}

function filterCollectValues_Attribute(td, filterOptions) {
	// Get the attribute value
	var value = $(td).attr('data-filter-value');

	// Add the value to the options array (if it's not empty)
	if (value) {
		filterCollectValues_AddValueToOptionsArray(filterOptions, value);
	}
}

function filterCollectValues_AddInstancesCount_Attribute(td, filterOptions) {
	// Get the attribute value
	var value = $(td).attr('data-filter-value');

	// Add the value to the options array (if it's not empty)
	if (value) {
		var found = false;
		for (var i = 0; i < filterOptions.length; i++) {
			var endIndex = filterOptions[i].indexOf(")");
			extracted = filterOptions[i].substring(endIndex + 2);
			if (extracted == value) {
				found = true;
				var num = parseInt(filterOptions[i].substring(1, endIndex));
				filterOptions[i] = "(" + (num + 1) + ") " + extracted;
				break;
			}
		}
		if (!found) {
			filterOptions.push("(1) " + value);
		}
	}
}

function filterCollectValues_MultipleValuesAttribute(td, filterOptions) {
	// Get the attribute value
	var valuesAsString = td.attr('data-filter-values');

	// Split the values
	var values = valuesAsString.split(';');

	for (var valueIndex in values) {
		// Get the current value, and add to the options array
		var value = values[valueIndex].trim();
		if (!isStringEmpty(value)) {
			filterCollectValues_AddValueToOptionsArray(filterOptions, value);
		}
	}
}

function filterCollectValues_MultipleCheckboxes(td, filterOptions) {
	// Go over the checked checkboxes
	$(td).find('input:checked').each(function() {

		// Get the checkbox value
		var value = $(this).val().trim();

		// Add the value to the options array
		filterCollectValues_AddValueToOptionsArray(filterOptions, value);
	}); 
}

function filterCollectValues_Select(td, filterOptions) {
	// Get the selected value
	var value = $(td).find('select').find('option:selected').text().trim();
	
	// Add the value to the options array
	filterCollectValues_AddValueToOptionsArray(filterOptions, value);
}

function filterCollectValues_Checkbox(td, filterOptions) {
	// Get the selected value
	var value = $(td).find('input:checkbox').is(':checked') + '';
	
	// Add the value to the options array
	filterCollectValues_AddValueToOptionsArray(filterOptions, value);
}

function filterCollectValues_InputText(td, filterOptions) {
	// Get the selected value
	var value = $(td).find('input:text').val() + '';
	
	// Add the value to the options array
	filterCollectValues_AddValueToOptionsArray(filterOptions, value);
}

function filterCollectValues_Textarea(td, filterOptions) {
	// Get the selected value
	var value = $(td).find('textarea').val() + '';
	
	// Add the value to the options array
	filterCollectValues_AddValueToOptionsArray(filterOptions, value);
}

function filterCollectValues_AddValueToOptionsArray(filterOptions, value) {
	// Add the value to the options array
	if ($.inArray(value, filterOptions) == -1) {
		filterOptions.push(value);	
	}
}

function FilterTable_AddRowFilterInfo(row) {
	// Add the filter bit array
	if (row.find("#hdnFilterBitArray").length == 0) {
		row.append('<input type="hidden" id="hdnFilterBitArray" name="hdnFilterBitArray" />');

		// Create empty array and set in data
		var arr = [];
		for (var i = 0; i < row.find("td").length; i++) {
			arr.push(0);
		}
		row.find("#hdnFilterBitArray").data('data', arr).data('count', 0);
	}
}

function FilterTable_RefreshRowAllColumns(table, row) {
	var tds = table.find('> thead > #trColumnNames > [data-filter-enabled]');
	tds.each(function () {
		FilterTable_RefreshRow(table, $(this).attr('id').substring(2), row, true);
	});
}

function FilterTable_RefreshRow(table, filterName, row, force) {
	// Don't do anything if filters are not dirty
	if (table.data('filters-dirty') != true && force != true) {
		return;
	}

	// Make sure the row has a filter bit array
	table.find('> tbody > tr:not([data-filter-ignore])').each(function() {
		// Add the filter bit array
		var $this = $(this);
		if ($this.find("#hdnFilterBitArray").length == 0) {
			$this.append('<input type="hidden" id="hdnFilterBitArray" name="hdnFilterBitArray" />');

			// Create empty array and set in data
			var arr = [];
			for (var i = 0; i < $this.find("td").length; i++) {
				arr.push(0);
			}
			$this.find("#hdnFilterBitArray").data('data', arr).data('count', 0);
		}
  	});

	// Get the cell of the filter
	var th = table.find('> thead > #trColumnNames > [id="th' + filterName + '"]');

	// Get the column index
	var columnIndex = th.attr('data-column-index');

	// Get the select element
	var select = table.find('> thead > #trColumnNames [id="slct' + filterName + '"]');

	// Get all the selected options, and build the regex string for the apply function
	// On the way check if the first option 'All' is selected
	var isAllOptionSelected = false;
	var selectedOptions = new Set();
	select.find("option:selected").each(function() {
		// Get the option value
		var currentSelectedValue = $(this).val().trim();

		// If no filter is applied
		if (currentSelectedValue == 'NoFilter') {
			isAllOptionSelected = true;
		}

		selectedOptions.push(currentSelectedValue);
	});
	if (selectedOptions.length == 0) {
		isAllOptionSelected = true;
	}

	// Get the filter bit array
	var filterBitArr = row.find('#hdnFilterBitArray');
	var vFilterBitArray = filterBitArr.data('data');
	var count = filterBitArr.data('count');

	// Apply if not all selected
	var applyResult;
	if (isAllOptionSelected) {
		applyResult = 1;
	} else {
		// Get the apply filter function name
		var applyFunctionName = "filterApply_CellText";
		if ($(th).is('[data-filter-apply-function]')) {
			applyFunctionName = $(th).attr('data-filter-apply-function');
		}

		// Get apply function
		var applyFunction = window[applyFunctionName];

		// Get the value cell
		var td = row.find('#td' + filterName);

		// Perform application
		var useAndRelation = false;
		if (th.is('[data-filter-allow-and-relation]')) {
			useAndRelation = select.parent().find("[data-and-relation-checkbox]").prop("checked");
		}
		applyResult = applyFunction(selectedOptions, td, useAndRelation);
	}

	// Update the filter bit array
	var didChange = false;
	if (isAllOptionSelected || applyResult == 1) {
		if (vFilterBitArray[columnIndex] == 1) {
			vFilterBitArray[columnIndex] = 0;
			didChange = true;
			count--;
			if (count < 0) {
				count = 0;
			}
		}
	} else {
		if (vFilterBitArray[columnIndex] == 0) {
			vFilterBitArray[columnIndex] = 1;
			didChange = true;
			count++;
		}
	}

	var inactiveClass = table.attr('data-filter-inactive-class');
	if (isStringEmpty(inactiveClass)) {
		inactiveClass = "inactive";
	}
	if (didChange) {
		// Update the value of the filter bit array
		filterBitArr.data('data', vFilterBitArray).data('count', count);

		didChange = false;
		var isVisibleBefore = row.is(":visible");
		if (count == 0) {
			if (!isVisibleBefore) {
				row.removeClass(inactiveClass);
				didChange = true;
			}
		} else {
			if (isVisibleBefore) {
				row.addClass(inactiveClass);
				didChange = true;
			}
		}
	
		if (didChange) {
			filter_refreshNumberOfSelectedRows(table);
		}
	}

	// Run the post filter function
	if (table.is('[data-filter-post-function]')) {
		var postFilterFunctionName = $(table).attr('data-filter-post-function');
		var postFilterFunction = window[postFilterFunctionName];
		postFilterFunction(table.attr('id'));
	}
}

function FilterTable_UpdateFiltersInfo(table, filterName, select, selectedOptions, isAllSelected) {
	// Store selection in table element in case we are preparing filters again
	var filtersInfo = table.data('filtersInfo');
	if (filtersInfo == undefined) {
		filtersInfo = new Object();
	}
	if (isAllSelected) {
		delete filtersInfo[filterName];
	} else {
		filtersInfo[filterName] = Array.from(selectedOptions);
	}
	if (Object.keys(filtersInfo).length == 0) {
		filtersInfo = undefined;
	}
	table.data('filtersInfo', filtersInfo);
}

function FilterTable(tableId, filterName) {
	// Get the table
	var table = $('#' + tableId);

	// Set dirty after first filtering
	table.data('filters-dirty', true);

	// Run the pre filter function
	if (table.is('[data-filter-pre-function]')) {
		var preFilterFunctionName = $(table).attr('data-filter-pre-function');
		var preFilterFunction = window[preFilterFunctionName];
		preFilterFunction(tableId);
	}

	// Get the cell of the filter
	var th = table.find('> thead > #trColumnNames > [id="th' + filterName + '"]');

	// Get the column index
	var columnIndex = th.attr('data-column-index');

	// Get the select element
	var select = table.find('> thead > #trColumnNames [id="slct' + filterName + '"]');

	// Check and relation
	var useAndRelation = false;
	if (th.is('[data-filter-allow-and-relation]')) {
		useAndRelation = select.parent().find("[data-and-relation-checkbox]").prop("checked");
	}

	// Get all the selected options, and build the regex string for the apply function
	// On the way check if the first option 'All' is selected
	var isAllOptionSelected = false;
	var selectedOptions = new Set();
	select.find("option:selected").each(function() {
		// Get the option value
		var currentSelectedValue = $(this).val().trim();

		// If no filter is applied
		if (currentSelectedValue == 'NoFilter') {
			isAllOptionSelected = true;
		}

		selectedOptions.add(currentSelectedValue);
	});
	if (selectedOptions.size == 0) {
		isAllOptionSelected = true;
	}

	// Update filters info
	FilterTable_UpdateFiltersInfo(table, filterName, select, selectedOptions, isAllOptionSelected);

	// Get the apply filter function name
	var applyFunctionName = "filterApply_CellText";
	if (th.is('[data-filter-apply-function]')) {
		applyFunctionName = $(th).attr('data-filter-apply-function');
	}

	// Get the apply function
	var applyFunction = window[applyFunctionName];

	// Filter
	var inactiveClass = table.attr('data-filter-inactive-class');
	if (isStringEmpty(inactiveClass)) {
		inactiveClass = "inactive";
	}
	table.find('> tbody > tr:not([data-filter-ignore])').each(function() {
		// Get the filter bit array
		var filterBitArr = $(this).find('#hdnFilterBitArray');
		var vFilterBitArray = filterBitArr.data('data');
		var count = filterBitArr.data('count');

		// Get the value cell
		var td = $(this).find('[id="td' + filterName + '"]');

		var applyResult = applyFunction(selectedOptions, td, useAndRelation);

		// Update the filter bit array
		if (isAllOptionSelected || applyResult == 1) {
			if (vFilterBitArray[columnIndex] == 1) {
				vFilterBitArray[columnIndex] = 0;
				count--;
				if (count < 0) {
					count = 0;
				}
			}
		} else {
			if (vFilterBitArray[columnIndex] == 0) {
				vFilterBitArray[columnIndex] = 1;
				count++;
			}
		}

		// Update the value of the filter bit array
		filterBitArr.data('data', vFilterBitArray).data('count', count);

		if (count == 0) {
			$(this).removeClass(inactiveClass);
		} else {
			$(this).addClass(inactiveClass);
		}
	});

	filter_refreshNumberOfSelectedRows(table);

	// Run the post filter function
	if (table.is('[data-filter-post-function]')) {
		var postFilterFunctionName = $(table).attr('data-filter-post-function');
		var postFilterFunction = window[postFilterFunctionName];
		postFilterFunction(tableId);
	}
}

function filterApply_CellText(selectedOptions, td) {
	var cellValue = $.trim(td.text());
	return filterApplyRegex(selectedOptions, [cellValue]);
}

function filterApply_Attribute(selectedOptions, td) {
	var value = $(td).attr('data-filter-value');
	var cellValue = (value == undefined ? "" : value.trim());
	return filterApplyRegex(selectedOptions, [cellValue]);
}

function filterApply_MultipleValuesAttribute(selectedOptions, td, useAndRelation) {
	var cellValue = $(td).attr('data-filter-values');
	return filterApplyRegex(selectedOptions, cellValue.split(";"), useAndRelation);
}

function filterApply_Select(selectedOptions, td) {
	var cellValue = $(td).find('select').find('option:selected').text().trim();
	return filterApplyRegex(selectedOptions, [cellValue]);
}

function filterApply_Checkbox(selectedOptions, td) {
	var cellValue = "" + $(td).find('input:checkbox').prop('checked');
	return filterApplyRegex(selectedOptions, [cellValue]);
}

function filterApply_InputText(selectedOptions, td) {
	var cellValue = $(td).find('input:text').val();
	return filterApplyRegex(selectedOptions, [cellValue]);
}

function filterApply_Textarea(selectedOptions, td) {
	var cellValue = $(td).find('textarea').val();
	return filterApplyRegex(selectedOptions, [cellValue]);
}

function filterApply_MultipleCheckboxes(selectedOptions, td, useAndRelation) {
	var cellValues = [];
	td.find('input:checked').each(function() {
		cellValues.push($(this).val().trim());
	}); 
	return filterApplyRegex(selectedOptions, cellValues, useAndRelation);
}

function filterApplyRegex(selectedOptions, cellValues, useAndRelation) {
	if (selectedOptions.size == 0) {
		return 1;
	}

	var count = 0;
	for (var i = 0; i < cellValues.length; i++) {
		if ((!useAndRelation || cellValues[i].length > 0) && selectedOptions.has(cellValues[i])) {
			if (!useAndRelation) {
				// Or, one match is enough
				return 1;
			}
			count++;
		}
	}
	if (useAndRelation) {
		// And, we need match for every option
		return count == selectedOptions.size;
	} else {
		return 0;
	}
}

var globalSortColumn = "";

function SortArray(arr, dataType, sortOrder) {

	// Set the order multiplier
  	var order = 1;
  	if (sortOrder == 'desc') {
  		order = -1;
  	}
  	
  	if (dataType == "String") {
  		SortStringArr(arr, order);
  	} else if (dataType == "int") {
  		SortIntArr(arr, order);
  	}
}

function SortStringArr(arr, order) {
	// Sort the array
  	arr.sort(function(a,b) {
      	return (a.localeCompare(b) * order);
  	});
}

function SortIntArr(arr, order) {
	// Sort the array
  	arr.sort(function(a,b) {
      	return ((a - b) * order);
  	});
}

function SortCharSeparatedString(arr, sortOrder, separator) {
	
	// Set the order multiplier
  	var order = 1;
  	if (sortOrder == 'desc') {
  		order = -1;
  	}
  	
	// Sort the array
	arr.sort(function(a,b) {
		return (function() {
			
			var result = 0;
			
			// Split
			var aArr = a.split(separator);
			var bArr = b.split(separator);
			 
			var minLength = Math.min(aArr.length, bArr.length);
			var strIndex = 0;
			for (strIndex = 0; strIndex < minLength; strIndex++) {
				
				// Get the currentValue
				var currentA = aArr[strIndex];
				var currentB = bArr[strIndex];
				
				// Check if the current values are numbers
				var aIsNum = !isNaN(currentA);
				var bIsNum = !isNaN(currentB);
				
				// Compate current values
				if (aIsNum && bIsNum) {
					var aAsInt = parseInt(currentA);
					var bAsInt = parseInt(currentB);
					result = (aAsInt - bAsInt) * order;
			  	} else if (dataType == "int") {
			  		result = currentA.localeCompare(currentB) * order;
			  	}
				if (result != 0) {
					break;
				}
			}
			
			// Compare by length if necessary
			if (result == 0) {
				result = aArr.length - bArr.length * order;
			}
			
			return result;
		});
	});
}

function sortTable_determineSortFunctionNameByDataType(dataType) {
	
	var sortFunctionName = 'sortRows_StringCellText';
	
	// To lower case
	var dataTypeLowerCase = dataType.toLowerCase();

	if (dataTypeLowerCase.indexOf('int') >= 0 || dataTypeLowerCase.indexOf('long') >= 0) {
		sortFunctionName = 'sortRows_IntCellText';
	} else if (dataTypeLowerCase.indexOf('date') >= 0) {
		// The developer has to make sure the cell has an attribute 'data-sort-value' that contains the date in milliseconds 
		sortFunctionName = 'sortRows_IntAttribute';
	}
	
	return sortFunctionName
}

function SortTable(tableId, sortColumn) {

	// Set the global sort column
	globalSortColumn = sortColumn;
	
	// Get the table
	var table = $('#' + tableId);

	// Run the pre sort function
	if (table.is('[data-sort-pre-function]')) {
		var preSortFunctionName = table.attr('data-sort-pre-function');
		var preSortFunction = window[preSortFunctionName];
		preSortFunction(tableId);
	}

	// Get the table tbody rows
	var rows = new Array();
	table.find(' > tbody tr').each(function() {	
  		// Insert the row to the row array
		rows.push(this);
	});
  
  	// Get the cell with the sort attributes
	var trColumnNames = table.find('> thead #trColumnNames');
  	var th = trColumnNames.find('#th' + sortColumn);
  
  	// Get the current sort order
  	var sortOrder = th.attr('data-sort-order');
  	
  	// Determine the new sort order
  	var newSortOrder = 'asc';
  	if (sortOrder == 'asc') {
  		newSortOrder = 'desc';
  	}
  	
  	// Set the order multiplier
  	var order = 1;
  	if (sortOrder == 'asc') {
  		order = -1;
  	}

	// Get the sort function 
	var sortFunctionName = "sortRows_StringCellText";
	if (th.is('[data-sort-function]')) {
		sortFunctionName = th.attr('data-sort-function'); 
	}

	// Call the sort function
	var sortFunction = window[sortFunctionName];
	sortFunction(sortColumn, rows, order);

  	for (var i = 0; i < rows.length; i++) {
      	// The tr ID
     	var trId = $(rows[i]).attr('id');

     	table.find('#' + trId).remove();
     	table.append(rows[i]);
  	}

  	// Set the new order
  	trColumnNames.find('[id="th' + sortColumn + '"]').attr('data-sort-order', newSortOrder);

	// Run the post sort function
	if (table.is('[data-sort-post-function]')) {
		var postSortFunctionName = table.attr('data-sort-post-function');
		var postSortFunction = window[postSortFunctionName];
		postSortFunction(tableId);
	}
}

function sortRows_DateText(sortColumn, rows, order) {
	var dateIndeciesAndSize = [
		{ index: 6, size: 4 },
		{ index: 3, size: 2 },
		{ index: 0, size: 2 },
		{ index: 11, size: 2 },
		{ index: 14, size: 2 },
		{ index: 17, size: 2 }
	];
	rows.sort(function(xRow, yRow) {
		// Regexes are slow, we can assume constant format: dd/MM/yyyy HH:mm:ss
	  	var x = $(xRow).find('#td' + sortColumn).text();
		var y = $(yRow).find('#td' + sortColumn).text();
		for (var i = 0; i < dateIndeciesAndSize.length; i++) {
			var index = dateIndeciesAndSize[i].index;
			var size = dateIndeciesAndSize[i].size;
			var xPart = parseInt(x.substring(index, index + size));
			var yPart = parseInt(y.substring(index, index + size));
			if (xPart != yPart) {
				return ((xPart < yPart) ? -1 : ((xPart > yPart) ?  1 : 0)) * order;
			}
		}
		return 0;
	});
}

function sortRows_IntAttribute(sortColumn, rows, order) {
	
	rows.sort(function(a,b) {
		
		var valueA = $(a).find('#td' + sortColumn).attr('data-sort-value'); 
		var valueB = $(b).find('#td' + sortColumn).attr('data-sort-value');
	
		return ((valueA - valueB) * order);
	});
}

function sortRows_StringCellText(sortColumn, rows, order) {

	rows.sort(function(a,b) {
	  	
	  	var valueA = $(a).find('#td' + sortColumn).text();
		var valueB = $(b).find('#td' + sortColumn).text();
		
      	return (valueA.localeCompare(valueB) * order);
  	
  	});
}

function sortRows_IPCellText(sortColumn, rows, order) {
	rows.sort(function(a,b) {
	  	var valueA = $(a).find('#td' + sortColumn).text().trim();
		var valueB = $(b).find('#td' + sortColumn).text().trim();

		var multiplier = order;
		if (order < 0) {
			// Reverse order, let's reverse only if IP is different
			var ipA = extractIPFromAgentName(valueA);
			var ipB = extractIPFromAgentName(valueB);
			if (ipA == ipB) {
				multiplier = 1;
			}
		}

		return (ipsComparator(valueA, valueB) * multiplier);
  	});
}

function sortRows_IntCellText(sortColumn, rows, order) {

	rows.sort(function(a,b) {
	
		var valueA = $(a).find('#td' + sortColumn).text();
		var valueB = $(b).find('#td' + sortColumn).text();
		
		return ((valueA - valueB) * order);
	});
}

function sortRows_charSeparatedString(sortColumn, rows, order) {
	
	// Sort the array
	rows.sort(function(rowA,rowB) {
		
		var result = 0;
		
		// Get the current cells
		var cellA = $(rowA).find('#td' + sortColumn);
		var cellB = $(rowB).find('#td' + sortColumn);
		
		// Get the values from the rows 
		var aAsString = '';
		if ($(cellA).is('[data-sort-value]')) {
			aAsString = $(cellA).attr('data-sort-value');
		} else {
			aAsString = $(cellA).text().trim();
		}
		var bAsString = '';
		if ($(cellB).is('[data-sort-value]')) {
			bAsString = $(cellB).attr('data-sort-value');
		} else {
			bAsString = $(cellB).text().trim();
		}
		
		// Get the separater from one of the cells
		var separator = $(cellA).attr('data-sort-value-separator');

		// Split
		var aArr = aAsString.split(separator);
		var bArr = bAsString.split(separator);

		var minLength = Math.min(aArr.length, bArr.length);
		var strIndex = 0;
		for (strIndex = 0; strIndex < minLength; strIndex++) {
			
			// Get the currentValue
			var currentA = aArr[strIndex];
			var currentB = bArr[strIndex];
			
			// Check if the current values are numbers (empty string is considered 0 so also check that)
			var aIsNum = !isStringEmpty(currentA) && !isNaN(currentA);
			var bIsNum = !isStringEmpty(currentB) && !isNaN(currentB);
			
			// Compate current values
			if (aIsNum && bIsNum) {
				var aAsInt = parseInt(currentA);
				var bAsInt = parseInt(currentB);
				result = (aAsInt - bAsInt) * order;
		  	} else {
		  		result = currentA.localeCompare(currentB) * order;
		  	}
			if (result != 0) {
				break;
			}
		}
		
		// Compare by length if necessary
		if (result == 0) {
			result = (aArr.length - bArr.length) * order;
		}
		
		return result;
	});
}

function ZebraTable(tableId, sortColumn) {

	// Set the global sort column
	globalSortColumn = sortColumn;

	// Initialize class name to empty
	var className = ZebraToggleClassName("");
	
	// Variable to remember the last cell value of the column by which the zebra coloring is created
	var lastValue = "";
	
	// Go over all the tbody rows in the table
	$('#' + tableId + ' > tbody > tr').each(function() {
	
		// Work only on visible rows
		var visible = $(this).is(':visible');
		var zebraIgnore = $(this).is('[data-zebra-ignore]');
		if (!visible || zebraIgnore) {
			return;
		}
	
		// Get the cell
		var currentCell = $(this).find('#td' + sortColumn);
		
		// Get the cell value of the column by which the table is sorted
		var currentValue = '';
		if ($(currentCell).is('[data-zebra-value]')) {
			currentValue = $(currentCell).attr('data-zebra-value');
		} else {
			currentValue = $(currentCell).text().trim();
		}
		
		// If the current value is not equal to the last value, toggle the row class
		if (currentValue != lastValue) {
			className = ZebraToggleClassName(className);
		}
		
		// Update the last value
		lastValue = currentValue; 

		// Color the row
		$(this).attr('class', className);
	});
}

function ZebraToggleClassName(currentClassName) {

	// Class name of altername row
	var alternateRowClassName = "AlternateRow";

	// Class name to return
	var newClassName = "";

	if (isStringEmpty(currentClassName)) {
	
		newClassName = alternateRowClassName;
	} 
	
	return newClassName;
}

function FilterAndZebraTable(tableId, filterName) {

	FilterTable(tableId, filterName);
	ZebraTable(tableId, globalSortColumn);
}

function SortAndZebraTable(tableId, sortColumn) {

	SortTable(tableId, sortColumn);
	ZebraTable(tableId, sortColumn);
}

function resetSelection(selectID) {
	var fullSelectedID = '#' + selectID;
	$(fullSelectedID).prop('selectedIndex', 0);
}

/**
 * @param optionalColumns - array of columns to export, if not specified, everything is exported.
 * @param optionalTransformer - given the th/td element, should return an array of result th/td elements.
 */
function exportTableToCsv(tableId, optionalColumns, optionalTransformer) {
	var csv = "";

	// Go over all the rows of the table, and prepare the CSV
	$('#' + tableId + ' tr').each(function() {
	 	if (!$(this).is('[data-csv-exclude]')) {
	 		var added = false;

	 		// Go over all the cells, and prepare a CSV line
			$(this).find('th, td').each(function() {
				// If there are specific columns specified, check that we're only exporting them
				var columnName = $(this).attr('id');
				if (optionalColumns != undefined && $.inArray(columnName, optionalColumns) == -1) {
					return;
				}

				if (!$(this).is('[data-csv-exclude]')) {
					if (optionalTransformer == undefined) {
						var txt = $(this).text().trim();
						if (txt.indexOf("\n") != -1 || txt.indexOf(",") != -1) {
							replaceAll(txt, '"', '""');
							csv += '"' + txt + '"';
						} else {
							csv += txt;
						}
						csv += ",";
					} else {
						var result = optionalTransformer($(this));
						for (var i = 0; i < result.length; i++) {
							// Get the text from the cell, trim, and remove line breaks
							var txt = result[i].trim();
							if (txt.indexOf("\n") != -1 || txt.indexOf(",") != -1) {
								replaceAll(txt, '"', '""');
								csv += '"' + txt + '"';
							} else {
								csv += txt;
							}
							csv += ",";
						}
					}

					added = true;
				}
			});

			if (added) {
				var lastCharIndex = csv.length - 1;
				if (csv.charAt(lastCharIndex) == ",") {
					csv = csv.substring(0, lastCharIndex);
				}
				csv += "\n"; 
			}
		}
	});

	// Best way to make all browsers recognize a download is with the appropriate headers that the server can generate
	PostJsonToNewWindow('/tasks/downloadFile', { data: csv, fileName: tableId + '.csv' }, '_self', true);
}

function applyView(tableId, attributeValue) {

	var attributeName = "data-view";

	// Get the table
	var table = $('#' + tableId);

	// Go over the columns names in the header section, and search for columns that should be hidden or shown
	$(table).find('thead').find('#trColumnNames th').each(function() {

		var thId = $(this).attr('id');
 		var columnName = thId.replace(/^th/, "");

		// If the header has the attribute
		if ($(this).is('[' + attributeName + ']')) {

			// Get the attribute value
			var dataView = $(this).attr(attributeName).split(",");

	 		// If the column's data view contains the passed attribute value, then show the entire column
	 		// Else hide the entire column
			var showColumn = false;
			for (var i = 0; i < dataView.length; i++) {
				if (attributeValue == dataView[i]) {
					showColumn = true;
					break;
				}
			}

	 		$(table).find('[id="th' + columnName + '"], [id="td' + columnName + '"]').each(function() {
	 			if (showColumn && $(this).hasClass('inactive')) {
	 				$(this).removeClass('inactive');
	 			} else if (!showColumn && !$(this).hasClass('inactive')) {
	 				$(this).addClass('inactive');
	 			} 
	 		});
		}
	});
}

function showConfirmAlert(message)
{
	var isConfirmed = confirm(message + '\nClick Ok to continue or Cancel to abort the whole operation.');
	
	return isConfirmed;
}

function getFileNameFromFileInput(fileInputElement)
{
	var fileName = fileInputElement.val();
	if (!isStringEmpty(fileName))
	{
		// Exclude the 'c://fakepath...'
		fileName = fileName.split('\\').pop();
	}
	
	return fileName;
}

function prepareViewFields(tableId, filtersRowExists, columnNamesRowId, viewFields) {

	var table = $('#' + tableId);

	// Get TH and TR tags
	var filterThs = [];
	if (filtersRowExists) {
		filterThs = $(table).find("#trColumnNames").find("th");
	}
	var nameThs = $(table).find('#' + columnNamesRowId).find("th[data-field-id]");
	var trs = table.find('> tbody > tr');

	// For every column name
	for (var columnIndex = 0; columnIndex < nameThs.length; columnIndex++) {

		var nameTh = nameThs.eq(columnIndex);
		var id = nameTh.attr("data-field-id");
		if (id in viewFields) {
		
			// Get display name or use ID if undefined
			var displayName = viewFields[id]["displayName"];
			if (displayName == undefined) {
				displayName = id;
			} else if (displayName == "") {
				displayName = nameTh.html();
			}

			// Check if should add sortAndZebra link
			var sortAndZebra = "";
			if (viewFields[id]['sortAndZebra']) {
				sortAndZebra = "<a href=\"javascript: void(0)\" onclick=\"SortAndZebraTable('" + tableId + "', '" + id + "')\">&uarr;&darr;</a>";
			}

			// Set HTML
			nameTh.html(displayName + " " + sortAndZebra);

		} else {

			// Hide column in headers and rows
			nameTh.css("display", "none");
			if (filtersRowExists) {
				filterThs.eq(columnIndex).css("display", "none");
			}

			var realColumnIndex = nameTh.index();
			for (var rowIndex = 0; rowIndex < trs.length; rowIndex++) {
				// Check whether to skip this row
				if (!(trs.eq(rowIndex).is('[data-field-ignore]'))) {
					var tds = trs.eq(rowIndex).find("> td");
					tds.eq(realColumnIndex).css("display", "none");
				}
			}
		}
	}
}

function isEven(value) {
	if (value%2 == 0)
		return true;
	else
		return false;
}

function replaceAll(str, search, replacement) {
	if (str.indexOf(search) < 0) {
		// If we can't find the search string don't waste time
		return str;
	}
	search = search.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
	return str.replace(new RegExp(search, 'g'), replacement);
}

function parseReplacers(str) {
	if (str == undefined) {
		return undefined;
	}
	str = replaceAll(str, "ASSIGNMENT_REPLACER", "=");
	str = replaceAll(str, "COLON_REPLACER", ":");
	str = replaceAll(str, "DOT_REPLACER", ".");
	str = replaceAll(str, "AT_REPLACER", "@");
	str = replaceAll(str, "PLUS_REPLACER", "+") // "+" cannot be used in a regex
	str = replaceAll(str, "HYPHEN_REPLACER", "-");
	str = replaceAll(str, "LEFT_BRACKET_REPLACER", "(");
	str = replaceAll(str, "RIGHT_BRACKET_REPLACER", ")");
	str = replaceAll(str, "START_TAG_REPLACER", "<");
	str = replaceAll(str, "END_TAG_REPLACER", ">");
	str = replaceAll(str, "SPACE_REPLACER", " ");
	str = replaceAll(str, "SLASH_REPLACER", "/");
	return str;
}

function insertReplacers(str) {
	if (str == undefined) {
		return undefined;
	}
	var replaceAll = function(str, search, replacement) {
		// Reverse order from parseReplacers
		while (str.indexOf(replacement) >= 0) {
			str = str.replace(replacement, search);
		}
		return str;
	}
	str = replaceAll(str, "ASSIGNMENT_REPLACER", "=");
	str = replaceAll(str, "COLON_REPLACER", ":");
	str = replaceAll(str, "DOT_REPLACER", ".");
	str = replaceAll(str, "AT_REPLACER", "@");
	str = replaceAll(str, "PLUS_REPLACER", "+") // "+" cannot be used in a regex
	str = replaceAll(str, "HYPHEN_REPLACER", "-");
	str = replaceAll(str, "LEFT_BRACKET_REPLACER", "(");
	str = replaceAll(str, "RIGHT_BRACKET_REPLACER", ")");
	str = replaceAll(str, "START_TAG_REPLACER", "<");
	str = replaceAll(str, "END_TAG_REPLACER", ">");
	str = replaceAll(str, "SPACE_REPLACER", " ");
	str = replaceAll(str, "SLASH_REPLACER", "/");
	return str;
}

hashCode = function(str){
    var hash = 0;
    if (str.length == 0) return hash;
    for (i = 0; i < str.length; i++) {
        char = str.charCodeAt(i);
        hash = ((hash<<5)-hash)+char;
        hash = hash & hash; // Convert to 32bit integer
    }
    return hash;
}

function getAttributeValuesFromCheckedCheckboxesInRow(row, attributeName) {
	var attributeValues = [];
	
	// Get the checkboxes
	var checkedCheckboxes = row.find('input[type="checkbox"]').filter(function() {
		return !isStringEmpty($(this).attr(attributeName)) && $(this).is(':checked');
	});
	
	checkedCheckboxes.each(function() {
		attributeValues.push($(this).attr(attributeName));
	});
	
	return attributeValues;
}

/**
 * Take arguments from GET requests.
 */
function getRequestParameters() {
	var a = window.location.search.substr(1).split('&');
	if (a == "") return {};
	var b = {};
	for (var i = 0; i < a.length; ++i) {
		var p=a[i].split('=');
		if (p.length != 2) continue;
		b[p[0]] = decodeURIComponent(p[1].replace(/\+/g, " "));
	}
	return b;
}

function generateUUID() {
    // http://www.ietf.org/rfc/rfc4122.txt
    var s = [];
    var hexDigits = "0123456789abcdef";
    for (var i = 0; i < 36; i++) {
        s[i] = hexDigits.substr(Math.floor(Math.random() * 0x10), 1);
    }
    s[14] = "4";  // bits 12-15 of the time_hi_and_version field to 0010
    s[19] = hexDigits.substr((s[19] & 0x3) | 0x8, 1);  // bits 6-7 of the clock_seq_hi_and_reserved to 01
    s[8] = s[13] = s[18] = s[23] = "_";

    var uuid = s.join("");
    return uuid;
}

// Cookie handling functions

function createCookie(name, value, days) {
    if (days) {
        var date = new Date();
        date.setTime(date.getTime() + (days*24*60*60*1000));
        var expires = "; expires=" + date.toGMTString();
    }
    else var expires = "";
    document.cookie = name+"="+value+expires+"; path=/; secure";
}

function readCookie(name) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for(var i=0;i < ca.length;i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1,c.length);
        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
    }
    return undefined;
}

function eraseCookie(name) {
    createCookie(name,"",-1);
}

// Autocomplete comboboxes functions

function AutocompleteCombobox_SetValue(selectElementSelector, value) {
	// Get select and input elements
	var selectElem = $(selectElementSelector);
	var inputElem = selectElem.next().find(".custom-combobox-input");

	// Go down one time to open the menu
	var keyEvent = $.Event("keydown");
	keyEvent.keyCode = $.ui.keyCode.DOWN;
	inputElem.trigger(keyEvent);

	// Go down until we find an exact match
	// Don't go more than the number of elemens in the select box
	for (var i = 0; i < selectElem.find("option").length; i++) {
		inputElem.trigger(keyEvent);
		if (inputElem.val() == value) {
			break;
		}
	}

	// Press enter to trigger selection
	keyEvent.keyCode = $.ui.keyCode.ENTER;
	inputElem.trigger(keyEvent);
}

/**
 * Adds a value to an autocomplete combobox while trying to retain selection.
 * If value already exists, doesn't do anything.
 * 
 * Optional:
 * - Use optionalIdAttr for an ID to an option, which will be stored in an attribute called data-id.
 * - Use optionalInitAction for specifying custom initialization actions (such as changing styles etc).
 */
function AutocompleteCombobox_AddValue(selectElementSelector, value, optionalIdAttr, optionalInitAction) {
	// Search for existing element
	var elem = $(selectElementSelector);
	var found = false;
	elem.find("option").each(function () {
		if ($(this).text() == value) {
			found = true;
		}
	});
	if (found) {
		return;
	}

	// Get current selection
	var selected = getValueFromElement(selectElementSelector);

	// Add element
	var html = "<option";
	if (optionalIdAttr != undefined) {
		html += " data-id='" + optionalIdAttr + "'";
	}
	html += ">" + value + "</option>";
	elem.append(html);

	// Reinitialize combobox
	elem.combobox();
	if (optionalInitAction != undefined) {
		optionalInitAction();
	}

	// Restore selection if there was any
	if (!isStringEmpty(selected)) {
		var inputElem = elem.next().find(".custom-combobox-input");
		inputElem.val(selected);
	}
}

function AutocompleteCombobox_FindOptionElement(selectElementSelector, value, checkIDAttr) {
	// Get current selection
	var selected = getValueFromElement(selectElementSelector);

	// Remove existing element
	var elem = $(selectElementSelector);
	var foundElem = undefined;
	elem.find("option").each(function () {
		var compareWith;
		if (checkIDAttr) {
			compareWith = $(this).attr('data-id');
		} else {
			compareWith = $(this).text();
		}

		if (value == compareWith) {
			// Remove selected if its the option that should be removed
			if ($(this).text() == selected) {
				selected = undefined;
			}

			foundElem = $(this);
		}
	});

	return foundElem;
}

/**
 * Removes a value from an autocomplete combobox while trying to retain selection (or selecting nothing if the selected value is the value removed).
 * If value doesn't exists, doesn't do anything.
 * 
 * Optional:
 * - Use checkIDAttr to specify whether to look for the text value, or the optional ID attribute which can be set in the AddValue function (data-id).
 * - Use optionalInitAction for specifying custom initialization actions (such as changing styles etc).
 * 
 * @return the removed option element (if removed).
 */
function AutocompleteCombobox_RemoveValue(selectElementSelector, value, checkIDAttr, optionalInitAction) {
	// Get current selection
	var selected = getValueFromElement(selectElementSelector);

	// Remove existing element
	var elem = $(selectElementSelector);
	var foundElem = AutocompleteCombobox_FindOptionElement(selectElementSelector, value, checkIDAttr);

	if (foundElem != undefined) {
		// Reinitialize combobox
		elem.combobox();
		if (optionalInitAction != undefined) {
			optionalInitAction();
		}

		// Restore selection if there was any and it wasn't the removed value
		var inputElem = elem.next().find(".custom-combobox-input");
		if (isStringEmpty(selected)) {
			inputElem.val("");
		} else {
			inputElem.val(selected);
		}
	}
	return foundElem;
}

function extractIPFromAgentName(agentName) {
	var colonIndex = agentName.indexOf(":");
	if (colonIndex != -1) {
		return agentName.substring(0, colonIndex);
	}
	return agentName;
}

function extractDeviceNameFromAgentName(agentName) {
	var colonIndex = agentName.indexOf(":");
	if (colonIndex != -1) {
		return agentName.substring(colonIndex + 1);
	}
	return "";
}

function openNewRadar() {
	var userData = getLoggedInData();
	if (userData == undefined) {
		return;
	}
	var user = userData.displayName;

	var messages = [
	                "<table><tr><td nowrap>Opened By:</td><td>" + user + "</td></tr>",
	                "<tr><td nowrap>Title:</td><td><input type='text' id='radarTitle' value='[" + document.title + "] ' style='width: 545px'></input></td></tr></table>",
	                "Description:",
	                "<textarea id='radarDescription' style='width: 650px; height: 180px'></textarea>",
	               ];
	UIUtility_showConfirmDialog(
			messages,
			"New Radar",
			function () {
				var radarTitle = $("#radarTitle").val();
				var radarDescription = $("#radarDescription").val();
				var version = $("#lmVersion").text();
				if (isStringEmpty(radarTitle) || isStringEmpty(radarDescription)) {
					UIUtility_showAlert("Missing information, please fill all fields", "Error");
				} else {
					// Add open by to description
					var originalDescription = radarDescription;
					radarDescription = "Opened By: " + user + "\nLink: " + document.URL + "\nVersion: " + version + "\n\n" + originalDescription;

					UIUtility_showAlert("Opening radar.<br /> Please wait ...", "New Radar");

					// Send request
					var lmComponentInfo = getLMComponentInfo();
					PostJsonWithJsonFeedbackFuncs(
							'/services/radar/create',
							true,
							{
								title: radarTitle,
								description: radarDescription,
								component: lmComponentInfo.component,
								version: lmComponentInfo.version,
								originator: userData.username,
								useInternalCredentials: true
							},
							function (result) {
								$("#alertDialog").dialog("close");
								var radarLink = "<a href='rdar://problem/" + result.id + "'>Radar #" + result.id + "</a>";
								UIUtility_showAlert(radarLink, "Radar Opened");
							},
							function (text) {
								$("#alertDialog").dialog("close");

								// Add original message to error text
								if (text == undefined) {
									text = "";
								}
								text += "<div class='LMVerticalInsetSection'>Title: " + radarTitle + "</div><div class='LMVerticalInsetSection'>Contents: " +
									replaceAll(originalDescription, "\n", "<br/>") + "</div>";

								UIUtility_showAlert(text, "Error");
							});
				}
			}, 700, 450);
}

/**
 * @returns current time in the format: DD/MM/YYYY HH:mm
 */
function getFormattedNow() {
	var date = new Date();
	var day = ensureStringMinLength("" + date.getDate(), 2, "0");
	var month = ensureStringMinLength("" + (date.getMonth() + 1), 2, "0");
	var hours = ensureStringMinLength("" + date.getHours(), 2, "0");
	var minutes = ensureStringMinLength("" + date.getMinutes(), 2, "0");
	return day + "/" + month + "/" + date.getFullYear() + " at " + hours + ":" + minutes;
}

function getLoggedInUsername() {
	var userData = getLoggedInData();
	return (userData == undefined ? undefined : userData.username);
}

function getLoggedInData() {
	var loginCookie = readCookie("LabManagerLogin");
	if (isStringEmpty(loginCookie)) {
		// No cookie, if we're not on the login page, logout
		if (location.href.indexOf("/displayLogin/") == -1 && !endsWith(location.href, "/logout") && !endsWith(location.href, "/login")) {
			logout();
		}
	} else {
		try {
			// We have some cookie, lets parse it
			loginCookie = atob(loginCookie);
			return JSON.parse(loginCookie);
		} catch (ex) {
			// Issue with the cookie, logout
			console.error(ex);
			console.error(loginCookie);
			logout();
		}
	}
	return undefined;
}

function logout() {
	eraseCookie("LabManagerLogin");
	location.href = "/logout";
}

function updateUserData(key, value, optionalSuccessCont) {
	PostJsonWithJsonFeedbackFuncs('/updateUserData', true, {
			key: key,
			value: value
		},
		function (result) {
			if (optionalSuccessCont != undefined) {
				optionalSuccessCont(result);
			}
		},
		function (text) {
			UIUtility_showAlert(text, "Error updating user configuration: " + text);
		});
}

function ArrayUtils_removeFromArray(arr, value) {
	// Find the index
	var index = arr.indexOf(value);

	// In case the value to remove was found, remove it
	if (index > -1) {
		arr.splice(index, 1);
	}
}

function BooleanUtilityFunctions_StringToBoolean(booleanAsString) {
	var boolean = false;
	if (booleanAsString == 'true' ||
		booleanAsString == '1' ||
		booleanAsString == 'on' ||
		booleanAsString == 'On' ||
		booleanAsString == 'ON') {
		boolean = true;
	}
	return boolean;
}

function calcPercentage(nominator, denominator) {
	var percentage = 100 * (nominator / denominator);
	if (percentage > 100) {
		// Limit to 100%
		percentage = 100;
	}
	return Number(percentage).toFixed(2);
}

function calcPercentageNotFixed(nominator, denominator) {
	// Get fixed
	var fixed = calcPercentage(nominator, denominator);

	// Remove trailing zeros and empty decimal dot
	var notFixed = fixed;
	if (notFixed.indexOf(".") != -1) {
		for (var i = notFixed.length - 1; i >= 0; i--) {
			var ch = notFixed.charAt(i);
			if (ch == "0" || ch == ".") {
				notFixed = notFixed.substring(0, i);
				if (ch == ".") {
					break;
				}
			} else {
				break;
			}
		}
	}

	return notFixed;
}

function applyCustomViewFromButton(button, table, optDefaultSizes) {
	var view = button.data('view');

	applyCustomView(table, view, optDefaultSizes);
}

/**
 * Custom views which include column ordering and not just show/hide.
 * @param view is a JSON object in the following formats:
 * 			[ { id: <Column ID>, sizeType: <default/small/medium/large/custom/fitToContent>,
 * 				customSize: <in pixels, if custom size was selected> }, ... ]
 * 			[ { type: <Column type (attribute data-type)>, sizeType: <same as above>, customSize: <same as above> }, ... ]
 */
function applyCustomView(table, view, optDefaultSizes) {
	// Prepare to work off-screen
	var parent = table.parent();
	var index = table.index();
	table.detach();

	// Hide all view related columns
	table.find(".DynamicSelectBox, th[data-custom-view], td[data-custom-view]").not(".inactive").addClass("inactive");

	// Find index of last viewable column
	var firstIndex = table.find("> thead > tr:last > [data-custom-view]:eq(0)").index();

	var handleColumn = function () {
		var elem = $(this);
		var row = elem.parent();
		var childAfter = $(row.children().eq(firstIndex - 1));
		elem.insertAfter(childAfter);
	};

	// Show columns
	var allRows = table.find("> tbody, > thead").find("> tr");
	for (var i = view.length - 1; i >= 0; i--) {
		// Get all rows, we'll go on finding columns afterwards according to view contents
		var elems = allRows;

		var id = view[i].id;

		if (id != undefined) {
			elems = elems.find("> [id='th" + id + "'], > [id='td" + id + "']");
		}

		var type = view[i].type;
		if (type == undefined) {
			// Call handler for each element
			if (elems != table) {
				elems.each(handleColumn).removeClass("inactive");
			}
		} else {
			// Take columns
			elems = elems.find("> [data-type='" + type + "']");

			// Sort alphabetically in an array
			var columns = [];
			elems.each(function (){
				columns.push($(this));
			});
			columns.sort(function (obj1, obj2) {
				// Remove td/th prefix
				var id1 = obj1.attr('id').trim().substring(2);
				var id2 = obj2.attr('id').trim().substring(2);
				return id2.localeCompare(id1);
			});

			// Call handler for each element
			for (var j = 0; j < columns.length; j++) {
				columns[j].each(handleColumn).removeClass("inactive");
			}
		}

		// If we have defaults, and the default size type is default, override with actual default
		// Otherwise, we'll not change the size at all
		var sizeTypeToCheck = (view[i].sizeType == undefined ? "default" : view[i].sizeType);
		var customSizeToCheck = view[i].customSize;
		var isShorten = view[i].shorten;
		if (sizeTypeToCheck == "default" && optDefaultSizes != undefined && optDefaultSizes[view[i].id] != undefined) {
			sizeTypeToCheck = optDefaultSizes[view[i].id].sizeType;
			customSizeToCheck = optDefaultSizes[view[i].id].customSize;
			isShorten = optDefaultSizes[view[i].id].shorten;
		}

		// Determine size in pixels
		var newSize = undefined;
		switch (sizeTypeToCheck) {
			case "custom":
				newSize = customSizeToCheck + "px";
				break;
			case "small":
				newSize = "50px";
				break;
			case "medium":
				newSize = "150px";
				break;
			case "large":
				newSize = "350px";
				break;
			case "default":
				// Add white space wrapping back (mainly for headers)
				elems.css('white-space', 'nowrap');
				break;
			default:
				break;
		}

		if (newSize != undefined) {
			// Check if we already set the width
			var currentMinWidth = elems.css('min-width');
			if (currentMinWidth != newSize) {
				// Set new width and remove wrapping
				elems.css({
					'min-width': newSize,
					'width': newSize,
					'word-wrap': 'break-word',
					'white-space': 'normal'
				});
				elems.attr('data-width', replaceAll(newSize, "px", ""));
			}
		}

		// In case there's a shorten plugin, reinit it with the content, otherwise make sure there's no shorten plugin
		elems.each(function () {
			var td = $(this);

			if (isShorten) {
				// Make sure it's marked as shortened
				if (!td.is(".shortened")) {
					td.addClass("shortened");
				}

				// We don't want to shorten headers, or empty fields (N/A is considered empty for performance reasons)
				var text = td.text();
				if (td.is("th") || isStringEmpty(text) || text == "N/A") {
					return;
				}

				// Get shorten span and wrap with one if doesn't already exist
				var shortenSpan = td.find("#shortenSpan");
				if (shortenSpan.length == 0) {
					td.html("<span id='shortenSpan'>" + td.html() + "</span>");
					shortenSpan = td.find("#shortenSpan");
				}

				// Set original text if shorten is already in affect
				var allContent = td.find(".allcontent");
				if (allContent.length > 0) {
					shortenSpan.html(allContent.html());
				}

				// Call plugin (force because it might have been called already)
				shortenSpan.shorten({ force: true });
			} else {
				// Get original text if shorten is already in affect and set it in the TD
				var allContent = td.find(".allcontent");
				if (allContent.length > 0) {
					td.html(allContent.html());
				}
			}
		});
	}

	// Add table back to screen
	if (index == 0){
        table.prependTo(parent)
    } else {
        table.insertAfter(parent.children().eq(index - 1));
    }

	// This will show the select boxes in the column's real size so they won't expand it
	// It has to be after we insert into the table, so widths will exist
	for (var i = view.length - 1; i >= 0; i--) {
		var id = view[i].id;
		var type = view[i].type;

		var selectBox;
		if (id != undefined) {
			selectBox = allRows.find("> [id='th" + id + "'] > .DynamicSelectBox");
		} else if (type != undefined) {
			selectBox = allRows.find("> [data-type='" + type + "'] > .DynamicSelectBox");
		}

		selectBox.each(function () {
			var selectBox = $(this);
			var width = selectBox.parent().width() + "px";
			if (newSize == undefined) {
				newSize = width;
			}
			selectBox.css({
				'min-width': width,
				'max-width': width,
				'width': newSize,
				'display': 'block'
			});
			selectBox.removeClass("inactive");
		});
	}
}

function createTestLogURL(agentName, testId, testName, hasAlt) {
	var funcName = "showLogViewerDialog";
	if (hasAlt) {
		funcName += "WithTestAlt";
	}
	var ip = extractIPFromAgentName(agentName);
	return 'javascript:' + funcName + '("' + ip + '", "' + agentName + ': ' + testName + '", "Test ' + agentName + ' ' + testId + '")';
}

function invokeFunctionFromElementAttribute(element, attrName)
{
	var functionName = element.attr(attrName);
	if (!isStringEmpty(functionName))
	{
		invokeFunction(functionName, element);
	}
}

function invokeFunction(functionName, arg)
{
	if (isStringEmpty(functionName)) {
		return;
	}
	
	// Prepare the function
	var fn = window[functionName];
 
	// Call the function
	fn(arg);
}

/**
 * @param count
 * 			use -1 for infinite. 0 will not do anything
 * @param period
 * 			in milliseconds
 */
function executePeriodic(runnable, count, period, optStartImmediately) {
	if (count == 0) {
		return;
	}

	if (optStartImmediately) {
		runnable();
		if (count > 0) {
			count--;
		}
		if (count == 0) {
			return;
		}
	}

	setTimeout(function() {
        if (runnable() == false) {
        	// Don't reschedule
        	return;
        }
        var newCount = (count == -1 ? -1 : count - 1);
        executePeriodic(runnable, newCount, period);
    }, period);
}

function removeClassesByPrefix(elem, classPrefix) {
	var cls = elem.attr("class");
	if (cls != null) {
		var classes = cls.split(" ");
		for (var i = 0; i < classes.length; i++) {
			if (classes[i].indexOf(classPrefix) == 0) {
				elem.removeClass(classes[i]);
			}
		}
	}
}

function warnAboutUnsavedChangesOnClose(isDirtyFunction) {
	window.onbeforeunload = function () {
		if (isDirtyFunction()) {
			return "You have unsaved changes.";
		} else {
			return null;
		}
	};
}

function setSectionToggle() {
	var header = $(this);
	var div = header.next();

	if (header.data('toggleInited') == undefined) {
		header.data('toggleInited', true);
		header.click(function () {
			div.toggle();
			$(this).each(setSectionToggle);
		});
	}

	var isVisible = div.css("display") != "none";
	var html = header.html().trim();

	// <kbd>...</kbd> assures that the widths of + and - will be the same
	var kbdExpand = '<kbd>+</kbd>';
	var kbdCollapse = '<kbd>-</kbd>';
	if (isVisible) {
		if (html.indexOf(kbdExpand) == 0) {
			header.html(kbdCollapse + ' ' + html.substring(13));
		} else if (html.indexOf("<kbd>") != 0) {
			header.html(kbdCollapse + ' ' + html);
		}
	} else {
		if (html.indexOf(kbdCollapse) == 0) {
			header.html(kbdExpand + ' ' + html.substring(13));
		} else if (html.indexOf("<kbd>") != 0) {
			header.html(kbdExpand + ' ' + html);
		}
	}
}

function generateAccessKey() {
	Get('/server/generateAccessKey',
			function (key) {
				UIUtility_showAlert("Your access key for this IP and user is:<div style='word-break: break-all; padding: 5px; font-size: 14px !important;' id='accessKey'>" + key + "</div>" +
						"<br/>Press CMD+C to copy to clipboard", "Access Key");

				// Select text
				var selection = window.getSelection();        
		        var range = document.createRange();
		        range.selectNodeContents($("#accessKey")[0]);
		        selection.removeAllRanges();
		        selection.addRange(range);
			}, function (error) {
				UIUtility_showAlert(error, "Error");
			});
}

function generateEncryptedCredentials() {
	var messages = [
	                "Encrypt the following credentials:",
	                "<table><tr><td>Username:&nbsp;</td><td><input type='text' id='txtUsername' /></td></tr>" +
	                "<tr><td>Password:&nbsp;</td><td><input type='text' id='txtPassword' /></td></tr></table>"
	               ];
	UIUtility_showConfirmDialog(messages, "Encrypt Credentials", function () {
		PostJsonWithTextFeedbackFuncs(
				'/services/encryptCredentials',
				{ username: $("#txtUsername").val(), password: $("#txtPassword").val() },
				function (key) {
					UIUtility_showAlert("Your encrypted user credentials are:<div style='word-break: break-all; padding: 5px; font-size: 14px !important;' id='encryptedCredentials'>" + key + "</div>" +
							"<br/>Press CMD+C to copy to clipboard", "Encrypted Credentials");

					// Select text
					var selection = window.getSelection();        
			        var range = document.createRange();
			        range.selectNodeContents($("#encryptedCredentials")[0]);
			        selection.removeAllRanges();
			        selection.addRange(range);
				}, function (error) {
					UIUtility_showAlert(error, "Error");
				});
	});
}

function attachEntityToTask(entityType, entityId) {
	PostJsonWithJsonFeedbackFuncs('/tasks/getOpenAndAttached/' + entityType + "/" + entityId,
			true,
			new Object(),
			function (result) {
				// Build already attached HTML
				var attachedHtml = "";
				for (var i = 0; i < result.attachedTasks.length; i++) {
					var task = result.attachedTasks[i];
					if (i == 0) {
						attachedHtml = "Already attached to:<ul style='margin-top: 3px; margin-bottom: 0px;'>";
					}
					attachedHtml += "<li><a href='/tasks/tasksViewer?taskId=" + task.id + "'>" + task.name + "</a></li>";
				}
				if (attachedHtml != "") {
					attachedHtml += "</ul>";
				}

				if (result.openTasks.length == 0) {
					UIUtility_showAlert("No open tasks to attach to.<br/><br/>" + attachedHtml, "Error");
					return;
				}

				var select = "<select id='slctAttachToTask' style='width: 100%;'>";
				for (var i = 0; i < result.openTasks.length; i++) {
					select += "<option value='" + result.openTasks[i].id + "'>" + result.openTasks[i].name + "</option>";
				}
				select += "</select>";

				UIUtility_showConfirmDialog([ "Choose task", select, attachedHtml ], "Attach To Task", function () {
					var taskId = $("#slctAttachToTask").val();
					if (taskId == undefined) {
						UIUtility_showAlert("You must select a task", "Error");
						return;
					}

					PostJsonWithJsonFeedbackFuncs('/relations/new/Task/' + taskId + "/" + entityType + "/" + entityId,
							true,
							new Object(),
							function (result) {
								UIUtility_showAlert("Attachment to task done successfully", "Attachment Done");
							},
							function (error) {
								UIUtility_showAlert(error, "Error");
							});
				});

				var attachToTask = $("#slctAttachToTask");
				attachToTask.closest(".ui-dialog-content").find("table, tr, td").css('width', '100%');
				attachToTask.selectize();
			},
			function (error) {
				UIUtility_showAlert(error, "Error");
			});
}

function resizeDivAccordingToLargestTable(container, divsToStretch, margin) {
	// Lets find the largest width table and set the container's minimum width to it
	var width = 0;
	container.find("table").each(function () {
		var curWidth = $(this).width();
		if (curWidth > width) {
			width = curWidth;
		}
	});
	if (width != 0) {
		// Add given margin pixels for insets of sections
		divsToStretch.css('min-width', (width + margin) + 'px');
	}
}

/**
 * Compares whether 2 objects have the same values for the same keys.
 * Checking the same values is done with == and not deep check.
 */
function compareObjects(o1, o2) {
	// Check first object contained in second
	for (var k1 in o1) {
		if (o1[k1] != o2[k1]) {
			return false;
		}
	}

	// Check second object contained in first
	for (var k2 in o2) {
		if (o1[k2] != o2[k2]) {
			return false;
		}
	}

	return true;
}

function escapeCSVValue(txt) {
	if (txt.indexOf("\n") != -1 || txt.indexOf(",") != -1) {
		txt = replaceAll(txt, '"', '""');
		return '"' + txt + '"';
	} else {
		return txt;
	}
}

MAX_INT_VALUE = Math.pow(2, 31) - 1;

/** javascripts/utilities/TableUtilityFunctions.js **/
/**
 * Clear all the table rows of the given table id that under 'tbody' section
 * @param tableId
 */
function removeAllTableRows(tableId)
{
	$("#" + tableId + " tbody").find("tr").remove();
}

function removeAllTableRowsExceptLast(tableId)
{
	$('#' + tableId + ' tbody tr').not(':last').remove();
}

function enableEntireTableRow(tableRow)
{
	// Make the row enabled
	tableRow.find('select, input, checkbox').each(function() {
		$(this).removeProp('disabled');
	});
}

function filterRows(rows, predicate)
{
    var result = new Array();

    for (var rowIndex = 0; rowIndex < rows.length; rowIndex++)
    {
        if(predicate(rows[rowIndex]))
        {
             result.push(rows[rowIndex]);
        }
    }

    return result;
}
/** javascripts/utilities/StringUtilityFunctions.js **/
function isStringEmpty(value)
{
	return (undefined == value) || !(typeof value == "string") || ("" == value.trim());
}

function convertArrayOfIdsToString(idsAsArray) {

	var idsAsString = "";
	
	for (var idIndex in idsAsArray) {
	
		var id = idsAsArray[idIndex];
	
		idsAsString = idsAsString + id + "|";
	}
	
	return idsAsString;
}

function arrToString(arr, delimiter, charToWrapTheValues) {
	if (arr == undefined) {
		return "";
	}

	var arrAsString = '';
	
	// Iterate over the array in put it in the string separated by the given delimiter
	for (var i = 0; i < arr.length; i++)
	{
		arrAsString += charToWrapTheValues + arr[i] + charToWrapTheValues + delimiter;
	}
	
	// Cut the last delimiter
	return cutLastChars(arrAsString, delimiter);
}

function stringContains(str, value) {
	var contains = false;
	
	if (!isStringEmpty(str))
	{
		contains = str.indexOf(value) != -1;
	}
	
	return contains;
}

function cutLastChars(value, lastChars)
{
	var cutValue = value;
	
	if (!isStringEmpty(cutValue))
	{
		if (endsWith(value, lastChars))
		{
			cutValue = value.substring(0, value.length - lastChars.length);
		}
	}
	
	return cutValue;
}

function endsWith(value, suffix) {
    var endsWith = false;
	
    // The start index to search from
	var startIndex = value.length - suffix.length;
    
	if (startIndex > 0)
	{
		endsWith = value.indexOf(suffix, startIndex) !== -1; 
	}
	
	return endsWith; 
}

/**
 * Use to cut common suffixes like file extension or milliseconds in a formatted time.
 */
function removeSuffix(string, suffixStartStr) {
	var index = string.lastIndexOf(suffixStartStr);
	if (index != -1) {
		return string.substring(0, index);
	}
	return string;
}

/**
 * Converts string to lower case except the first letter of every word.
 */
function firstLetterCapitalOnly(string) {
	var arr = string.split(" ");
	for (var i = 0; i < arr.length; i++) {
		var length = arr[i].length;
		var suffix = "";
		if (length > 1) {
			suffix = arr[i].substring(1, length).toLowerCase();
		}
		arr[i] = arr[i].substring(0, 1).toUpperCase() + suffix;
	}
	return arr.join(" ");
}

/**
 * @returns the number of times <sub> exists in <str>. Note that <sub> can also be an array of strings to be checked.
 */
function count(str, sub) {
	if (typeof sub == "string") {
		var index = 0;
		var cnt = 0;
		while ((index = str.indexOf(sub, index)) != -1) {
			index += sub.length;
			cnt++;
		}
		return cnt;
	} else {
		// Assume array and go over all substrings
		var sum = 0;
		for (var i = 0; i < sub.length; i++) {
			sum += count(str, sub[i]);
		}
		return sum;
	}
}

/**
 * @returns the index of the <occurrenceNumber> occurrence of <sub> string in <str>.
 */
function getOccurrenceIndex(str, sub, occurrenceNumber) {
	var index = 0;
	var cnt = 0;
	while ((index = str.indexOf(sub, index)) != -1) {
		if (cnt == occurrenceNumber) {
			return index;
		}
		index += sub.length;
		cnt++;
	}
	if (cnt == occurrenceNumber) {
		return index;
	}
	return -1;
}

/**
 * Adds the given chToAdd to the start of str as much as needed to reach requiredLength.
 * Useful to pad 1 digit numbers to be 2 digits by calling ensureStringMinLength("" + num, 2, "0").
 * 
 * @returns the resulted string.
 */
function ensureStringMinLength(str, requiredLength, chToAdd) {
	while (str.length < requiredLength) {
		str = chToAdd + str;
	}
	return str;
}

function formatETA(etaInSecs) {
	if (etaInSecs < 60) {
		var value = Math.round(etaInSecs);
		if (value == 1) {
			return value + " second";
		} else {
			return value + " seconds";
		}
	} else {
		var value = Math.round(etaInSecs / 60);
		if (value == 1) {
			return value + " minute";
		} else {
			return value + " minutes";
		}
	}
}

/**
 * Will split into words by change in capital letters, and will make each word start with a capital letter.
 * For example: myBeautifulNewString will turn into My Beautiful New String.
 */
function prettifyVarNameString(name) {
	var str = "";
	var lastWasLowercase = undefined;
	for (var i = 0; i < name.length; i++) {
		var ch = name.charAt(i);
		if (str == "") {
			str += ch.toUpperCase();
			continue;
		}

		if (ch == ch.toLowerCase()) {
			if (lastWasLowercase || lastWasLowercase == undefined) {
				str += ch;
				lastWasLowercase = true;
			} else {
				str += " " + ch.toLowerCase();
				lastWasLowercase = undefined;
			}
		} else if (ch == ch.toUpperCase()) {
			if (lastWasLowercase) {
				str += " " + ch.toUpperCase();
				lastWasLowercase = undefined;
			} else {
				str += ch;
				lastWasLowercase = false;
			}
		} else {
			str += ch;
		}
	}
	return str;
}

/**
 * Replaces <, >, & with HTML codes.
 */
function insertHTMLReplacers(value) {
	value = replaceAll(value, "<", "&lt;");
	value = replaceAll(value, ">", "&gt;");
	value = replaceAll(value, "&", "&amp;");
	return value;
}

// Polyfill for Safari 8 (Yosemite) or older
if (!String.prototype.startsWith) {
    String.prototype.startsWith = function(searchString, position){
      position = position || 0;
      return this.substr(position, searchString.length) === searchString;
  };
}
if (!String.prototype.endsWith) {
	  String.prototype.endsWith = function(searchString, position) {
	      var subjectString = this.toString();
	      if (typeof position !== 'number' || !isFinite(position) || Math.floor(position) !== position || position > subjectString.length) {
	        position = subjectString.length;
	      }
	      position -= searchString.length;
	      var lastIndex = subjectString.lastIndexOf(searchString, position);
	      return lastIndex !== -1 && lastIndex === position;
	  };
}

function validateEmail(sEmail) {
    var filter = /^([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/;

    if (!sEmail.endsWith("@apple.com") && !sEmail.endsWith("@group.apple.com")) {
    	return false;
    }

    if (filter.test(sEmail)) {
        return true;
    } else {
        return false;
    }
}

function validateMailingList(list) {
	var emails = list.split(";");
	for (var i = 0; i < emails.length; i++) {
		if (!validateEmail(emails[i])) {
			return emails[i];
		}
	}
	return true;
}

function formatDate(date) {
	// dd/MM/yyyy HH:mm:ss
	var day = ensureStringMinLength("" + date.getDate(), 2, '0');
	var month = ensureStringMinLength("" + (date.getMonth() + 1), 2, '0');
	var hours = ensureStringMinLength("" + date.getHours(), 2, '0');
	var minutes = ensureStringMinLength("" + date.getMinutes(), 2, '0');
	var seconds = ensureStringMinLength("" + date.getSeconds(), 2, '0');
	return day + "/" + month + "/" + date.getFullYear() + " " + hours + ":" + minutes + ":" + seconds
}

function escapeTextToHtml(text) {
	// Replace & first because others replace to it
	text = replaceAll(text, "&", "&amp;");
	text = replaceAll(text, "<", "&lt;");
	text = replaceAll(text, ">", "&gt;");
	text = replaceAll(text, "\n", "<br>");
	return text;
}

/**
 * Parses a date of the format: dd/MM/yyyy hh:mm:ss.
 */
function parseToTimeInMs(dateStr, isReversedDate) {
	var replaced = replaceAll(replaceAll(replaceAll(dateStr, "/", " "), ":", " "), "-", " ");
	var parts = replaced.split(" ");
	var day = parseInt(isReversedDate ? parts[2] : parts[0]);
	var month = parseInt(parts[1]);
	var year = parseInt(isReversedDate ? parts[0] : parts[2]);
	var hour = parseInt(parts[3]);
	var minute = parseInt(parts[4]);
	var second = parseInt(parts[5]);
	return new Date(year, month - 1, day, hour, minute, second).getTime();
}

function formatDuration(durationMs) {
	if (durationMs < 0) {
		return "-";
	}

	// Extract time parts
	durationMs = Math.floor(durationMs / 1000);
	var seconds = durationMs % 60;
	durationMs = Math.floor(durationMs / 60);
	var minutes = durationMs % 60;
	durationMs = Math.floor(durationMs / 60);
	var hours = durationMs % 24;
	var totalHours = durationMs;
	durationMs = Math.floor(durationMs / 24);

	if (seconds < 10) {
		seconds = "0" + seconds;
	}
	if (minutes < 10) {
		minutes = "0" + minutes;
	}
	if (hours < 10) {
		hours = "0" + hours;
	}
	if (totalHours < 10) {
		totalHours = "0" + totalHours;
	}

	return totalHours + ":" + minutes + ":" + seconds;
}

/** javascripts/utilities/SorterUtilityFunctions.js **/
function sortArrayOfNumbers(arrOfNums) {
	arrOfNums.sort(sortNumbers);
}

function sortNumbers(num1, num2)  {
    return num1 - num2;
}

function stringArrayComparator(arr1, arr2) {
	var length = (arr1.length > arr2.length ? arr2.length : arr1.length);
	for (var i = 0; i < length; i++) {
		if (arr1[i] < arr2[i]) {
			return -1;
		} else if (arr1[i] > arr2[i]) {
			return 1;
		}
	}

	// Pick shorter array
	if (arr2.length < arr1.length) {
		return 1;
	} else if (arr2.length == arr1.length) {
		return 0;
	} else {
		return -1;
	}
}

function ipsComparator(ip1, ip2) {
	var parsedIP1 = ip1.split(/[.:]/);
	var parsedIP2 = ip2.split(/[.:]/);
	return stringArrayComparator(parsedIP1, parsedIP2);
}

/** javascripts/utilities/UIUtilityFunctions.js **/
function UIUtility_initializeButton(btnId, iconName) {
	$("button[id=" + btnId + "]").button({ icon: iconName });

	// Makes the test unselectable
	$("button[id=" + btnId + "]").disableSelection();
}

function UIUtility_initializeButtonWithSelector(button, iconName) {
	if (button.is("button, a")) {
		button.button({ icon: iconName });
	} else {
		if (iconName == undefined) {
			button.checkboxradio({ icon: false });
		} else {
			UIUtility_initializeCheckboxWithIcon(button, iconName);
		}
	}

	// Makes the test unselectable
	button.disableSelection();
}

function UIUtility_buildButtonHtml(name, id, optIconName, optAttributes, optClass) {
	if (optAttributes == undefined) {
		optAttributes = "";
	}
	if (optClass == undefined) {
		optClass = "";
	}

	var html = '<button id="' + id + '" ' + optAttributes + ' class="ui-button ui-corner-all ui-widget ' + optClass + '">';
	if (optIconName != undefined) {
		html += '<span class="ui-button-icon ui-icon ' + optIconName + '"></span>';
		html += '<span class="ui-button-icon-space"> </span>';
	}
	html += name + '</button>';
	return html;
}

function UIUtility_initializeButtonWithRightIcon(btnId, iconName) {
	$("button[id=" + btnId + "]").button({
		icon: iconName,
		iconPosition: 'end'
	});

	// Makes the test unselectable
	$("button[id=" + btnId + "]").disableSelection();
}

function UIUtility_initializeCheckboxWithIcon(button, iconName) {
	var label = button.next();
	if (label.is("label")) {
		label.prepend('<span class="ui-icon ui-button-icon ' + iconName + '"></span> ');
	}
	button.checkboxradio({ icon: false });
	button.click(function () {
		var span = label.find("span:first");
		if (button.is(":checked")) {
			span.addClass("white-icons");
		} else {
			span.removeClass("white-icons");
		}
	});
}

function UIUtility_initializeToggleButton(btnId, iconName) {
	UIUtility_initializeToggleButtonWithSelector($('#' + btnId), iconName);
}

function UIUtility_initializeToggleButtonWithSelector(button, iconName) {
	if (iconName == undefined) {
		if (button.is("button, a")) {
			button.button();
		} else {
			button.checkboxradio({ icon: false });
		}
	} else {
		if (button.is("button, a")) {
			button.button({ icon: iconName });
		} else {
			UIUtility_initializeCheckboxWithIcon(button, iconName);
		}
	}

	// Makes the test unselectable
	button.disableSelection();
}

function isElementDisabled(elem) {
	return elem.attr('disabled') == 'disabled';
}

var restrictDialogMovementEventHandler = function (event, ui) {
	if (ui.position.top <= 33) {
		var $this = $(this);
		$(function () {
			$this.dialog("option", "position", {
				my: "left top",
				at: "left+" + ui.position.left + " top+33",
				of: $(window)
			});
		})
	}
};

/**
 * No need to create a div - it's done for you.
 * No need to call initializeAlertDialog - it's done for you.
 * 
 * @param alertMessage
 * 			the message to be displayed.
 * @param title
 * 			optional parameter to set a title.
 */
function UIUtility_showAlert(alertMessage, title, customWidth, customHeight, customCloseAction) {
	var alertDialog = $("#alertDialog");

	// If there's no alert dialog already, create one and add to body
	if (alertDialog.length == 0) {
		alertDialog = $("<div id='alertDialog'><label id='lblAlertMessage'></label></div>");
		$("body").eq(0).append(alertDialog);
	}
	UIUtility_initializeAlertDialog(customWidth, customHeight, customCloseAction);

	// Modify the message
	alertDialog.find('#lblAlertMessage').html(alertMessage);

	// Set title if not undefined
	if (title != undefined) {
		alertDialog.dialog({ title: title });
	}

	// Show the alert
	alertDialog.dialog("open");
} 

function UIUtility_initializeAlertDialog(customWidth, customHeight, customCloseAction) {
	if (customWidth == undefined) {
		customWidth = 550;
	}
	if (customHeight == undefined) {
		customHeight = 350;
	} else {
		if (("" + customHeight).indexOf("%") != -1) {
			// For some reason height in percentage isn't calculated correctly by the browser
			// So lets calculate it ourselves
			customHeight = customHeight.substring(0, customHeight.length - 1);
			customHeight = parseInt((customHeight / 100) * window.innerHeight);
		}
	}
	var alertDialog = $("#alertDialog");
	alertDialog.data('inited', true);
	if (customCloseAction != undefined) {
		$("#alertDialog").data('customCloseAction', customCloseAction);
	}
	alertDialog.dialog({
		dialogClass: "no-close",
		autoOpen: false,
		width: customWidth,
		height: customHeight,
		modal: true,
		closeOnEscape: (customCloseAction == undefined),
		drag: restrictDialogMovementEventHandler,
		buttons: {
	        "OK": function() {
		        	// Run custom close action if there is any
		        	var customCloseAction = $("#alertDialog").data('customCloseAction');
		        	if (customCloseAction != undefined) {
		        		customCloseAction();
		        	}

		        	// Destroy the dialog
		    	  	$(this).dialog("destroy").remove();
	        }
		}
	});
	$("[aria-describedby='alertDialog']").find(".ui-dialog-buttonset > button").addClass("LMMainButton");
}

function UIUtility_initConfirmDialog(divId, okActions, customWidth, customHeight, isModal) {
	// Set default width/height if not specified
	if (customWidth == undefined) {
		customWidth = 570;
	}
	if (customHeight == undefined) {
		customHeight = 340;
	} else {
		if (("" + customHeight).indexOf("%") != -1) {
			// For some reason height in percentage isn't calculated correctly by the browser
			// So lets calculate it ourselves
			customHeight = customHeight.substring(0, customHeight.length - 1);
			customHeight = parseInt((customHeight / 100) * window.innerHeight);
		}
	}

	// Default is to be modal
	if (isModal == undefined) {
		isModal = true;
	}

	// If received a single element, make it an array for the generic building to work
	if (jQuery.isFunction(okActions)) {
		okActions = { "OK": okActions };
	}

	// Build buttons array according to given OK actions
	var div = $("#" + divId);
	var buttons = new Array();
	var tabIndex = -1;
	for (name in okActions) {
		if (name == "Cancel") {
			continue;
		}
		buttons.push({
			id: "confirm_" + name,
			text: name,
			tabIndex: tabIndex,
			click: function (e) {
	    	  	$(this).dialog("close");
				var okAction = $(this).data('okActions')[$(e.target).text()];
				okAction(div);
			}
		});
		tabIndex--;
	}

	// Push default cancel button
	if (!(okActions["Cancel"] === null)) {
		buttons.push({
			id: "confirm_Cancel",
			text: "Cancel",
			tabIndex: 1,
			click: function() {
	    	  	$(this).dialog("close");
				var cancelAction = $(this).data('okActions')["Cancel"];
				if (cancelAction != undefined) {
					cancelAction();
				}
	        }
		});
	}

	div.html("<table style='overflow: scroll;'></table>");
	div.data('okActions', okActions);
	div.dialog({
		autoOpen: false,
		width: customWidth,
		height: customHeight,
		modal: isModal,
		buttons: buttons,
		drag: restrictDialogMovementEventHandler,
		closeText: undefined
	});
}

/**
 * No need to create a special div - it's done for you.
 * No need to call an initialization function - it's done for you.
 * You only need to call this function when you want to display the dialog.
 * 
 * @param messages
 * 			Either a single string message, or an array of string html to insert to the dialog. Each element will have a seperate row.
 * @param title (optional)
 * 			Dialog title, undefined will set a generic "Confirmation" title. Not in the end of the function for backward compatability.
 * @param actions
 * 			Either a function to call when a single OK button is clicked, or an object of action name string => function, for a few actions (cancel will be automatically added).
 * 			You can specify an action for "Cancel", and it'll be added to the cancel button.
 * @param customWidth (optional)
 * 			Width in pixels. Default is 570.
 * @param customHeight (optional)
 * 			Height in pixels. Default is 340.
 * @param isModal (optional)
 * 			Whether the dialog should be modal. Default is true.
 * 
 * @author omermorad
 */
function UIUtility_showConfirmDialog(messages, title, actions, customWidth, customHeight, isModal, noTable) {
	var div = $("#confirmDialogDiv");
	if (div.length == 0) {
		div = $("<div id='confirmDialogDiv'></div>");
		$("body").eq(0).append(div);
	}
	UIUtility_initConfirmDialog("confirmDialogDiv", actions, customWidth, customHeight, isModal, noTable);

	// Set title
	if (title == undefined) {
		title = "Confirmation";
	}
	div.dialog({ title: title });

	// Make messages array for generic code to work
	if (!(messages instanceof Array)) {
		messages = [ messages ];
	}

	if (noTable) {
		// Set contents directly without a table
		var html = "";
		messages.forEach(function (message) {
			if (html != "") {
				html += "<br/>";
			}
			html += message;
		});
		div.find("table").parent().html(html);
	} else {
		// Set contents table
		var tableHtml = "";
		messages.forEach(function (message) {
			tableHtml += "<tr><td>" + message + "</td></tr>";
		});
		div.find("table").eq(0).html(tableHtml);
	}

	// Open dialog
	div.dialog("open");
}


function UIUtility_initializeMultiSelect(theSelect) {
	theSelect.chosen({
    	search_contains : true
 
    });
}

function UIUtility_setButtonPadding(buttonId) {
	UIUtility_setSmallButtonPadding($("button[id=" + buttonId + "]"));
}

function UIUtility_setSmallButtonPadding(buttonSelector) {
	buttonSelector.each(function () {
		$(this).css({
			"padding-right": "7px",
			"padding-left": "11px",
			"padding-top": "2px",
			"padding-bottom": "2px"
		});
	});
}

function UIUtility_initializeToggleBehaviour(toggleBtnId, btnIcon, divIdToToggleFor, toggleButtons, toggleStates, callBack) {
	
	UIUtility_initializeToggleButton(toggleBtnId, btnIcon);
	
	toggleStates[toggleBtnId] = false;
	toggleButtons.push(toggleBtnId);
	
	// Set effects
	$('#' + toggleBtnId).click(function() {
		$('#' + divIdToToggleFor).toggle();

		// Search all other toggle that are different then the current one and toggle them
		toggleButtons.forEach(function(currentBtnToToggle) {
			if (currentBtnToToggle != toggleBtnId && toggleStates[currentBtnToToggle]) {
				// Trigger the current button - so it will collapse
				var theCurrentBtn = $('#' + currentBtnToToggle);
				theCurrentBtn.click();
			}
		});
		
		// Modify the current state
		toggleStates[toggleBtnId] = !toggleStates[toggleBtnId];

		if (toggleStates[toggleBtnId]) {
			invokeFunction(callBack, $(this));
		}
	});
}

function updateUIWithUserMessage(actionResultSummary, success, userMessage) {
	// Update the UI with the message
	var spanClass = getUserMessageClass(success);

	$(actionResultSummary).html('<span class="' + spanClass + '">' + userMessage + '</span>');
}

function getUserMessageClass(success) {
	var spanClass = "";
	
	if (undefined != success) {
		if (success) {
			spanClass = "UserMessageSuccess";
		} else {
			spanClass = "UserMessageError";
		}
	}
	
	return spanClass;
}

function createMenuButtonWithRightAction(span, name, normalAction, rightIcon, rightAction) {
	var normalButton = createMenuButton(name, normalAction);
	var row = (rightAction == undefined ? $("<tr><td colspan='2'></td></tr>") : $("<tr><td></td><td></td></tr>"));
	row.find("td:eq(0)").append(normalButton);

	if (rightAction != undefined) {
		var rightButton = createMenuButton("", rightAction);
		rightButton.css('width', normalButton.height() + "px");
		rightButton.css('border-left', '1px gray ridge');
		var invertIfNeeded = (isStringEmpty(rightIcon) ? "" : "filter: invert(100%);");
		rightButton.html("<span style='width: 16px; height: 16px; margin-left: -3px; " + invertIfNeeded + "' class='ui-icon " + rightIcon + "'></span>");
		row.find("td:eq(1)").append(rightButton);
	}

	return row;
}

function createMenuButton(name, action) {
	var style = "style='width: 100%; border: 0px; background-color: #5E5E5E !important; height: 27px;" +
		"font-size: 13px; color: white; cursor: pointer; text-align: left; padding-left: 10px; padding-right: 20px;'";
	var button = $("<button " + style + ">" + name + "</button>");
	button.hover(function () { $(this).css('background-color', '#aaa'); },
			 	 function () { $(this).css('background-color', '#5E5E5E'); });
	button.click(action);
	return button;
}

function createMenuToggle(openButtonId, div) {
	div.css('display', 'block');
	div.hide();
	div.css('z-index', '200');
	div.css('position', 'absolute');
	div.css('background-color', '#5E5E5E !important');
	div.css('border', '1px solid #ccc');
	div.css('box-shadow', '5px 5px 5px rgba(0,0,0,.4)');
	if (div.is(".mega-menu")) {
		div.css('padding-bottom', '10px');
	}
	div.addClass("popupMenu");

	var button = $("#" + openButtonId);

	button.change(function () {
		// Check if popup is already open
		var isVisible = !button.prop("checked");

		// Hide all popups
		$(".popupMenu").hide();

		if (!isVisible) {
			// Wasn't already open, open it
			div.show().position({
				my: "left top",
				at: "left bottom",
				of: this
			});
			div.css('top', (div.position().top + 28) + 'px');
			$(function () {
				$(document).one("click", function (e) {
					var target = $(e.target);
					if (!(target.is(button) || target.is(button.next()))) {
						// Check that it's not clicking the toggle
						button.click();
					}
				});
			});
		}
		return false;
	});

	UIUtility_initializeButtonWithSelector(button, 'ui-icon-triangle-1-s');
}

/**
 * Shows a file chooser and executes cont(fileName).
 */
function chooseFile(cont) {
	var fileChooser = $("<input type='file' id='genericFileChooser' style='display: none'></input>");
	$("body").append(fileChooser);
	fileChooser.change(function () {
		cont(this.files[0].name);
		$(this).remove();
	});
	fileChooser.click();
}



/**
 * Terminal dialog functions.
 */



function buildTerminalDialog(terminalDialog, width, height, optUI, title, terminalId) {
	terminalDialog.html("<table style='overflow: scroll'>" + (optUI == undefined ? "" : "<span id='optUI'>" + optUI + "</span>") + "</table>");
	terminalDialog.dialog({
		autoOpen: true,
		width: width,
		height: height,
		title: title,
		modal: false,
		closeOnEscape: false,
		closeText: undefined,
		drag: restrictDialogMovementEventHandler,
		beforeClose: function () {
			// Close socket
			var terminalDialog = $(this);
			var body = terminalDialog.find("iframe").contents().find("body");
			var socket = body.data('socket');
			if (socket != undefined) {
				socket.close();
			}

			// Destroy dialog and remove from page
			terminalDialog.dialog("destroy").remove();
		}
	});

	// Minimize button
	var renderedDialog = $("div[aria-describedby='" + terminalDialog.attr('id') + "']");
	var minButton = $("<button type='button'></button>").button({
		icons: {
			primary: "ui-icon-minus"
		},
		text: false
	});
	minButton.addClass("ui-dialog-titlebar-minimize");
	minButton.appendTo(renderedDialog.find(".ui-dialog-titlebar"));
	minButton.click(function () {
		minimizeTerminal(terminalDialog);
	});
}

function setTerminalDialogSize(width, height, iframe, optUI) {
	// Calculate inner width/height and fix height for row size
	var innerWidth = width - 25;
	var innerHeight = height - 47 - (optUI == undefined ? 0 : optUI.height());
	innerHeight = Math.floor(innerHeight / 14) * 14;

	// Set size to iframe
	if (iframe.data('width') != innerWidth || iframe.data('height') != innerHeight) {
		iframe.css("width", innerWidth + "px");
		iframe.css("height", innerHeight + "px");
		iframe.data('width', innerWidth);
		iframe.data('height', innerHeight);
	}

	return { width: innerWidth, height: innerHeight };
}

function handleTerminalSearch(body, terminal) {
	// Highlight search results for on screen lines
	var searchInput = body.find("#terminalSearch");
	var highlightSearchResults = function (searchResults) {
		var terminal = body.data('terminal');
		var text = searchResults.text;
		var changed = false;
		for (var i = 0; i < searchResults.searchResults.length; i++) {
			var row = searchResults.searchResults[i].row;
			var col = searchResults.searchResults[i].col;
			for (var j = 0; j < text.length; j++) {
				// Save previous color information. If already highlighted, don't do anything
				if (terminal.lines[row][col + j].length != 3) {
					terminal.lines[row][col + j].push(terminal.lines[row][col + j][0]);
				}

				// Clear first 18 bits and set them for some background and black foreground (0)
				terminal.lines[row][col + j][0] &= 0xFFF00000;

				if (row == searchResults.highlighted.row && col == searchResults.highlighted.col) {
					// Yellow background
					terminal.lines[row][col + j][0] |= 0x0B;
				} else {
					// White background
					terminal.lines[row][col + j][0] |= 0xFF;
				}

				changed = true;
			}
		}
		if (changed) {
			// Refresh the viewable section
			terminal.refresh(0, terminal.rows - 1);
		}
	};

	// Search a single line for text, and add results to the given array
	var searchLine = function (lineArr, row, text, searchResults) {
		// Find text end (so we won't copy spaces at the end and match them if search is for space)
		var end = lineArr.length - 1;
		while (end >= 0) {
			if (lineArr[end][1] == " ") {
				end--;
			} else {
				break;
			}
		}
		if (end == -1) {
			// Empty line, don't search
			return;
		}

		// Convert to a lowercased string line
		var lowercaseLine = "";
		for (var i = 0; i <= end; i++) {
			lowercaseLine += lineArr[i][1];
		}
		lowercaseLine = lowercaseLine.toLowerCase();

		// Search line
		var col = -1 * text.length;
		while ((col = lowercaseLine.indexOf(text, col + text.length)) != -1) {
			// Found, lets push row/column
			searchResults.push({ row: row, col: col });
		}
	};

	// Search viewable section and highlight if not highlighted already
	var searchViewable = function () {
		var text = searchInput.val().toLowerCase();

		// Search the currently viewable lines
		var terminal = searchInput.closest("body").data('terminal');
		var searchResults = new Array();
		for (var row = terminal.ydisp; row < terminal.lines.length && row < (terminal.ydisp + terminal.rows); row++) {
			searchLine(terminal.lines[row], row, text, searchResults);
		}

		// We'll highlight the last one if nothing was highlighted already
		if (searchResults.length != 0) {
			var highlighted = searchResults[searchResults.length - 1];
			var existing = searchInput.data('searchResults');
			if (existing != undefined && existing.text == text) {
				highlighted = existing.highlighted;
			}

			// Build final results object
			var finalResults = {
					text: text,
					searchResults: searchResults,
					highlighted: highlighted
			};
			searchInput.data('searchResults', finalResults);

			// Highlight in terminal
			highlightSearchResults(finalResults);
		}
	};

	// Direction = 1 for forward, -1 for backward
	var searchDirection = function (direction) {
		// Get search results
		var searchResults = searchInput.data('searchResults');
		if (searchResults != undefined) {
			// Save last direction
			searchInput.data('lastDirection', direction);

			// Check if existing highlight is viewable, if not - scroll to it
			var terminal = searchInput.closest("body").data('terminal');
			var highlighted = searchResults.highlighted;
			var searchResultsArr = searchResults.searchResults;
			if (highlighted.row < terminal.ydisp) {
				terminal.scrollDisp(highlighted.row - terminal.ydisp);
			} else if (highlighted.row > terminal.ydisp + terminal.rows - 1) {
				terminal.scrollDisp(highlighted.row - (terminal.ydisp + terminal.rows - 1));
			}

			// Check if we can go back/forward in the existing search results object
			var highlightedIsLast = false;
			if (direction == -1 && highlighted.row == searchResultsArr[0].row && highlighted.col == searchResultsArr[0].col) {
				highlightedIsLast = true;
			} else if (direction == 1 &&
					highlighted.row == searchResultsArr[searchResultsArr.length - 1].row &&
					highlighted.col == searchResultsArr[searchResultsArr.length - 1].col) {
				highlightedIsLast = true;
			}

			if (highlightedIsLast) {
				// According to direction, check if we have a result before/after the currently highlighted one
				var tempResults = new Array();
				for (var row = highlighted.row + direction; row >= 0 && row < terminal.lines.length; row += direction) {
					// Do search on current line
					searchLine(terminal.lines[row], row, searchResults.text, tempResults);
					if (tempResults.length > 0) {
						// Found, lets scroll to this position and search viewable
						if (direction == 1) {
							terminal.scrollDisp(row - (terminal.ydisp + terminal.rows - 1));
						} else {
							terminal.scrollDisp(row - terminal.ydisp);
						}
						searchViewable();

						// Set highlighted to last in first line or first in last line according to direction
						var searchResults = searchInput.data('searchResults');
						if (searchResults.searchResults.length > 0) {
							searchResults.highlighted = searchResults.searchResults[(direction == 1 ? searchResults.searchResults.length - 1 : 0)];
							if (direction == -1) {
								for (var i = 0; i < searchResults.searchResults.length &&
								searchResults.searchResults[i].row == searchResults.highlighted.row; i++) {
									searchResults.highlighted = searchResults.searchResults[i];
								}
							}
							searchInput.data('searchResults', searchResults);
							
							// Highlight
							highlightSearchResults(searchResults);
						}

						break;
					}
				}
			} else {
				// Find the index of highlighted
				var i;
				for (i = 0; i < searchResultsArr.length &&
					!(highlighted.row == searchResultsArr[i].row && highlighted.col == searchResultsArr[i].col); i++) {
				}

				if (i < searchResultsArr.length) {
					// Set the next/previous in the results object
					searchResults.highlighted = searchResultsArr[i + direction];
					searchInput.data('searchResults', searchResults);

					// Highlight
					highlightSearchResults(searchResults);
				}
			}
		}
	};
	body.find("#searchBack").click(function () { searchDirection(-1); });
	body.find("#searchForward").click(function () { searchDirection(1); });

	var cleanResults = function (input) {
		// Clean any existing results
		input.removeData('searchResults');

		// Remove highlighting where it exists
		var changed = false;
		for (var i = 0; i < terminal.lines.length; i++) {
			for (var j = 0; j < terminal.lines[i].length; j++) {
				if (terminal.lines[i][j].length == 3) {
					terminal.lines[i][j][0] = terminal.lines[i][j][2];
					terminal.lines[i][j].splice(2, 1);
					changed = true;
				}
			}
		}

		if (changed) {
			// Refresh the viewable section
			terminal.refresh(0, terminal.rows - 1);
		}
	};

	// Search from search field
	var doSearchByInputField = function (input, keyCode) {
		var text = input.val();

		if (text == "") {
			// Disable back/forward buttons
			input.parent().find("button").attr("disabled", "disabled");

			cleanResults(input);
		} else {
			// Check if there's an existing search results object for this text
			var existing = searchInput.data('searchResults');
			if (existing != undefined && existing.text == input.val().toLowerCase()) {
				// Search shouldn't change, if enter was pressed, let's search in direction
				if (keyCode == 13) {
					var lastDirection = searchInput.data('lastDirection');
					if (lastDirection == undefined) {
						// Default to back
						lastDirection = -1;
					}

					searchDirection(lastDirection);
				}
			} else {
				// Enable back/forward buttons
				input.parent().find("button").removeAttr("disabled");

				cleanResults(input);

				// Search viewable
				searchViewable();
			}
		}
	};

	// If clicking and is empty, and search results aren't, do search again to clean
	searchInput.click(function () {
		var input = $(this);
		if (input.val() == "" && input.data('searchResults') != undefined) {
			doSearchByInputField(input);
		}
	});

	// Search when pressing enter (not on key up because the terminal will receive focus after refresh)
	searchInput.change(function (event) { doSearchByInputField($(this), event.keyCode); });

	// When refreshing terminal content, refresh search highlighting
	terminal.on('refresh', function () {
		// This refresh was a result of a highlight call from this function, ignore it
		if (terminal.preHighlightRefresh == true) {
			return;
		}

		// If there are search results, highlight them
		var searchResults = searchInput.data('searchResults');
		if (searchResults != undefined) {
			terminal.preHighlightRefresh = true;
			searchViewable();
			terminal.preHighlightRefresh = false;
		}
	});
}

function showTerminalDialog(ip, title, optInitialCommand, optUI) {
	// By default use a big portion of the window, user can resize and new size will be saved in a cookie
	var width = window.innerWidth * 0.8;
	var height = window.innerHeight * 0.8;

	// Look for last terminal dimensions
	var lastDimCookie = readCookie("LMLastTermDimensions");
	if (lastDimCookie != undefined) {
		try {
			var parsedCookie = JSON.parse(lastDimCookie);
			width = parsedCookie.width;
			height = parsedCookie.height;
		} catch (ex) {
			// Don't count on cookie being perfect
			console.error(ex);
		}
	}

	// Build dialog
	var terminalId = getNewTerminalID();
	var divId = "terminal" + terminalId;
	$("body").append($("<div id='" + divId + "'></div>"));
	var terminalDialog = $("#" + divId);
	buildTerminalDialog(terminalDialog, width, height, optUI, title, terminalId);

	var getTerminalDimensions = function (width, height) {
		var iframeContents = terminalDialog.find("iframe").contents();
		var terminalHeight = height - iframeContents.find("#terminalSearch").closest("div").height();
		return { rows: Math.floor(terminalHeight / 14), cols: Math.floor(width / 7.25) };
	};

	// Add iframe to alert dialog
	var iframe = $('<iframe />');
	terminalDialog.append(iframe);

	// Find rendered optUI span
	optUI = terminalDialog.find("#optUI");
	if (optUI.length == 0) {
		optUI = undefined;
	}

	// Set iframe size and get inner dimensions
	var innerDimensions = setTerminalDialogSize(width, height, iframe, optUI);

	// Set styles
	var bar = iframe.contents();
	bar.find("head").append("<style>.terminal-cursor { color: #000; background: #f0f0f0; }</style>");
	var body = bar.find("body");
	body.css('margin', '0px');
	body.css('line-height', '1.2em');
	body.css('font-size', '12px');
	body.css('font-family', 'Monaco');
	body.css('background-color', 'black');

	// Resize terminal on dialog resize
	terminalDialog.on("dialogresize", function (event, ui) {
		// Resize UI
		var innerDimensions = setTerminalDialogSize(ui.size.width, ui.size.height, iframe, optUI);

		// Get new terminal dimensions
		var terminalDimensions = getTerminalDimensions(innerDimensions.width, innerDimensions.height);

		// Resize terminal and send command to server
		var terminal = body.data('terminal');
		terminal.resize(terminalDimensions.cols, terminalDimensions.rows);

		// Send resize to SSH session
		terminal.socket.send(JSON.stringify({
			commandType: "setSize",
			cols: terminalDimensions.cols,
			rows: terminalDimensions.rows
		}));

		// Save last size in cookie
		createCookie("LMLastTermDimensions", JSON.stringify({ width: ui.size.width, height: ui.size.height }));
	});

	// Create search bar (needs to be before terminal creation for correct sizing)
	var searchBar = $("<div style='width: 100%; background-color: white;'></div>");
	searchBar.append($("<table><tr style='width: 100%'><td style='width: 100%'><input id='terminalSearch' type='search' style='width: 100%' placeholder='Search'></input></td>"
			+ "<td><button id='searchBack'>&lt;</button></td><td><button id='searchForward'>&gt;</button></td>"));
	body.append(searchBar);

	// Create terminal
	var terminalDimensions = getTerminalDimensions(innerDimensions.width, innerDimensions.height);
	var terminal = new Terminal({
		cols: terminalDimensions.cols,
		rows: terminalDimensions.rows,
		termName: "xterm-256color",
		scrollback: 5000,
		cursorBlink: false
	});

	// Handle search
	handleTerminalSearch(body, terminal);

	// Handle commands on socket
	terminal.on('data', function (data) {
		this.socket.send(JSON.stringify({ commandType: "command", command: data }));
	});

	// Open on the dialog's body
	terminal.open(body[0]);

	// Save terminal reference in the body for programmatic access
	body.data('terminal', terminal);

	// Make sure the terminal starts as editable (for copy-paste behavior)
	$(terminal.element).attr('contenteditable', 'true');

	// Create websocket
	var WS = window['MozWebSocket'] ? MozWebSocket : WebSocket;
	var socket = new WS('wss://' + window.location.host + '/sshSessionWebSocket/' + ip + '/'
			+ terminal.termName + '/' + terminal.cols + '/' + terminal.rows + '/true');
	body.data('socket', socket);
	socket.onmessage = function (event) {
		// Parse data
		var data = JSON.parse(event.data);
		if (data.response == undefined) {
			return;
		}

		var binary = atob(data.response);
		terminal.write(binary);

		// On first time, send initial command if one was defined
		if (terminal.firstCommandStarted == undefined) {
			terminal.firstCommandStarted = true;
			if (optInitialCommand != undefined) {
				terminal.socket.send(JSON.stringify({
					commandType: "command",
					command: optInitialCommand
				}));
			}
		}
	};
	terminal.socket = socket;
	return terminal;
}

function showLogViewerDialogWithTestAlt(ip, title, logId) {
	// Allow user to choose
	var html = "Choose log file:<br/><table>";
	html += "<tr><td><input type='radio' id='radioDefaultLog' name='logFileGroup' checked></input>";
	html += "<label for='radioDefaultLog'>Default (stdout/stderr)</label>&nbsp;</td>";
	html += "<td>(<a href='/getLog/" + ip + "/" + logId + "'>Download</a>)</td></tr>";
	html += "<tr><td><input type='radio' id='radioRunnerLog' name='logFileGroup'></input><label for='radioRunnerLog'>Runner</label>&nbsp;</td>";
	html += "<td>(<a href='/getLog/" + ip + "/Runner" + logId + "'>Download</a>)</td>";
	html += "</tr></table>"
	UIUtility_showConfirmDialog([html], "Choose Log", function () {
		if ($("#radioRunnerLog").prop("checked")) {
			logId = "Runner" + logId;
		}
		showLogViewerDialog(ip, title, logId);
	});
}

function showLogViewerDialog(ip, title, logId) {
	// By default use a big portion of the window, user can resize and new size will be saved in a cookie
	var width = window.innerWidth * 0.8;
	var height = window.innerHeight * 0.8;

	// Look for last terminal dimensions
	var lastDimCookie = readCookie("LMLastTermDimensions");
	if (lastDimCookie != undefined) {
		try {
			var parsedCookie = JSON.parse(lastDimCookie);
			width = parsedCookie.width;
			height = parsedCookie.height;
		} catch (ex) {
			// Don't count on cookie being perfect
			console.error(ex);
		}
	}

	// Build dialog
	var terminalId = getNewTerminalID();
	var divId = "log" + terminalId;
	$("body").append($("<div id='" + divId + "'></div>"));
	var logDialog = $("#" + divId);
	buildTerminalDialog(logDialog, width, height, undefined, title, terminalId);

	// Add iframe to alert dialog
	var iframe = $('<iframe src="/tasks/followLog/' + ip + '/' + encodeURIComponent(logId) + '" style="width: 100%; height: 100%" />');
	logDialog.append(iframe);

	// Bug regarding iframe scrolling
	iframe.parent().css('overflow', 'visible');

	// Focus on iframe so the close button won't get the focus
	iframe.focus();

	// Save last size in cookie on resize
	logDialog.on("dialogresize", function (event, ui) {
		createCookie("LMLastTermDimensions", JSON.stringify({ width: ui.size.width, height: ui.size.height }));
	});
}

function getNewTerminalID() {
	var body = $("body");
	var nextTerminalId = body.data('nextTerminalId');
	if (nextTerminalId == undefined) {
		nextTerminalId = 1;
	}
	body.data('nextTerminalId', nextTerminalId + 1);
	return "" + nextTerminalId;
}

function minimizeTerminal(element) {
	// Create menu item
	var id = element.attr('id');
	var ul = $("<ul data-id='" + id + "' />");
	var renderedDialog = $("div[aria-describedby='" + id + "']");
	var title = renderedDialog.find(".ui-dialog-title").text();
	ul.append("<li><a href='javascript: showTerminal(\"" + id + "\");'>" + title + "</a></li>");

	// Set dialog dimensions in ul
	ul.data('position', renderedDialog.position());
	ul.data('width', renderedDialog.width());
	ul.data('height', renderedDialog.height());

	// Add menu item
	var terminalsMenu = $("#terminalsMenu");
	terminalsMenu.find("table td").append(ul);

	// Make sure menu is visible
	terminalsMenu.removeClass("inactive-force");

	// Animate minimization
	var terminalsMenuPos = terminalsMenu.position();
	var terminalsMenuHeight = terminalsMenu.height();
	renderedDialog.animate({
		top: terminalsMenuPos.top + terminalsMenuHeight / 2,
        height: terminalsMenuHeight + "px",
        left: terminalsMenuPos.left,
        width: terminalsMenu.width() + "px"
    }, 100, undefined, function () {
    	// After animation, hide the dialog
    	$(this).hide();
    });
}

function showTerminal(id) {
	var terminalsMenu = $("#terminalsMenu");
	var ul = terminalsMenu.find("ul[data-id='" + id + "']");

	// Show dialog with maximize animation
	var position = ul.data('position');
	$("div[aria-describedby='" + id + "']").show().animate({
		width: ul.data('width') + 'px',
        height: ul.data('height') + 'px',
        top: position.top,
        left: position.left
    }, 100);

	// Remove from menu (must be after finished using the ul's data)
	ul.remove();

	// If menu is empty, hide it
	if (terminalsMenu.find("ul").length == 0) {
		terminalsMenu.addClass("inactive-force");
	}
}

function relayoutStretchContainers() {
	$(".LMContainerStretch").each(function () {
		var container = $(this);
		if (container.is(".LMOverflowContainer")) {
			// Look for parents margins, not including direct container
			var margin = 12;
			var parent = container.parent().parent();
			while (parent.length > 0 && !parent.is(".content")) {
				var marginTop = parent.css('marginTop');
				if (marginTop != undefined) {
					var numericMarginTop = parseInt(replaceAll(marginTop, "px", ""));
					if (numericMarginTop > 10) {
						margin += numericMarginTop - 10;
					}
				}

				var marginBottom = parent.css('marginBottom');
				if (marginBottom != undefined) {
					var numericMarginBottom = parseInt(replaceAll(marginBottom, "px", ""));
					margin += numericMarginBottom;
				}

				parent = parent.parent();
			}

			var handler = function () {
				// Let other handlers work and do HTML changes first
				setTimeout(function () {
					// Add some pixels for constant header and top/bottom insets
					var removal = container.position().top + margin;
					if (removal < 0) {
						removal = 0;
					}
					var heightCss = 'calc(100vh - ' + removal + 'px)';
					if (container.css('height') != heightCss) {
						container.css('height', heightCss);
					}
				}, 1);
			};

			$(".HeightChangeTrigger").each(function () {
				var $this = $(this);
				if ($this.data('heightChangeTriggerSet') != true) {
					$this.click(handler);
					$this.data('heightChangeTriggerSet', true);
				}
			});

			handler();
		}
	});
}

function UIUtility_initializeSelectionTree(divTree, json, changeCallback, searchBox, disableSelection) {
	if (!disableSelection) {
		json["contextmenu"] = {
			"items": {
				"expandAll": {
					"label": "Expand All",
					"action": function (args) {
						divTree.jstree().open_all(args.reference);
					}
				},
				"collapseAll": {
					"label": "Collapse All",
					"action": function (args) {
						divTree.jstree().close_all(args.reference);
					}
				}
			}
		};

		// Set selection
		json["conditionalselect"] = function (args, e) {
			return (e.type != "contextmenu");
		};

		// Add plugins
		if (json["plugins"] == undefined) {
			json["plugins"] = new Array();
		}
		json["plugins"].push("conditionalselect");
		json["plugins"].push("checkbox");
		json["plugins"].push("contextmenu");
	}

	if (searchBox != undefined) {
		json.plugins.push("search");
	}
	divTree.jstree(json).on("changed.jstree", changeCallback);

	// Search functionality if relevant
	if (searchBox != undefined) {
		var to = false;
		var changeHandler = function () {
			if (to) {
				clearTimeout(to);
			}
			to = setTimeout(function () {
				var v = searchBox.val();
				divTree.jstree(true).search(v);
			}, 250);
		};
		searchBox.keyup(changeHandler);
		searchBox.mouseup(changeHandler);
	}

	if (disableSelection) {
        divTree.on('click', '.jstree-anchor', function (e) {
            $(this).jstree(true).toggle_node(e.target);
        })
	}
}

/** javascripts/utilities/ParserUtilityFunctions.js **/
/**
 * Parsing functions for common file names.
 * They either return the version (string), or undefined if it can't be parsed.
 */

function parseFWVersion(fileName) {
	var noExt = removeFileExtension(fileName);
	var parts = splitBy(noExt, ["_"]);
	if (parts.length <= 1) {
		return undefined;
	}

	// Remove 'v' character from start if exists
	var lastIndex = parts.length - 1;
	if (parts[lastIndex].indexOf("v") == 0) {
		parts[lastIndex] = parts[lastIndex].substring(1);
	}

	return parts[parts.length - 1];
}

function parseLMSVersion(fileName) {
	return parseFWVersion(fileName);
}

function parseDriverVersion(fileName) {
	var parts = splitBy(fileName, ["-"]);
	if (parts.length <= 1) {
		return undefined;
	} else if (parts.length == 2) {
		var part1 = parts[parts.length - 1];
		return ($.isNumeric(part1) ? part1 : undefined);
	} else {
		var part1 = parts[parts.length - 2];
		return ($.isNumeric(part1) ? part1 : undefined);
	}
}

function removeFileExtension(str) {
	var dotIndex = str.lastIndexOf(".");
	if (dotIndex != -1) {
		return str.substring(0, dotIndex);
	}
	return "";
}

function splitBy(str, chars) {
	var result = [];
	var lastIndex = 0;
	for (var strIndex = 0; strIndex < str.length; strIndex++) {
		for (var charIndex = 0; charIndex < chars.length; charIndex++) {
			if (str[strIndex] == chars[charIndex]) {
				result.push(str.substring(lastIndex, strIndex));
				lastIndex = strIndex + 1;
			}
		}
	}
	if (lastIndex <= str.length - 1) {
		result.push(str.substring(lastIndex, str.length));
	}
	return result;
}
/** javascripts/SetupParametersManagement.js **/
function SetupParametersManagement_setButtonPadding(buttonId)
{
	$("Button[id=" + buttonId + "]").each(function () {
		var textElem = $(this).find(".ui-button-text");
		textElem.css("padding-right", "20px");
		textElem.css("padding-left", "10px");
		textElem.css("padding-top", "10px");
		textElem.css("padding-bottom", "12px");
	});
}

function SetupParametersManagement_initializeSetupParameterButtons(id) 
{
	UIUtility_initializeButton('deleteSetupParameter' + id		, 'ui-icon-trash');
	UIUtility_initializeButton('editSetupParameter' + id		, 'ui-icon-zoomin');
	SetupParametersManagement_setButtonPadding('viewSetupParameter' + id);
	SetupParametersManagement_setButtonPadding('deleteSetupParameter' + id);
	SetupParametersManagement_setButtonPadding('editSetupParameter' + id);
}

function SetupParametersManagement_initializeSetupParameterValueButtons(id)
{
	UIUtility_initializeButton('editSetupParameterValue' + id	, 'ui-icon-pencil');
	UIUtility_initializeButton('deleteSetupParameterValue' + id	, 'ui-icon-trash');
	SetupParametersManagement_setButtonPadding('deleteSetupParameterValue' + id);
	SetupParametersManagement_setButtonPadding('editSetupParameterValue' + id);
}

function SetupParametersManagement_SelectParameter(vParameterID)
{
	$('#divValues').removeClass("inactive");
	$('#divValues table').each(function() {
		if ($(this).attr("id") == 'valuesSetupParameter' + vParameterID) {
			$(this).removeClass("inactive");
		} else {
			$(this).addClass("inactive");
		}
	});
}

function SetupParametersManagement_ExtractFirstColumn(tableId) {
	var result = [];
	$("#" + tableId + ' > tbody > tr').each(function () {
		if ($(this).attr("data-row")) {
			result.push($(this).find("td").eq(0).text());
		}
	});
	return result;
}

function SetupParametersManagement_AddSetupParameterRow(data) {
	var id = data.setupParameterId;
	var name = data.setupParameterName;
	var html = "<tr id='setupParameterRow" + id + "' data-row='true'><td>" + name + "</td>";
	html += "<td><button id='editSetupParameter" + id + "' onclick=\"SetupParametersManagement_SelectParameter('" + id + "');\"></button></td>";
	html += "<td><button id='deleteSetupParameter" + id + "' onclick=\"SetupParametersManagement_DeleteSetupParameter('" + id + "');\"></button></td>";
	html += "<td><input type='checkbox' id='chkManual" + id + "' onclick=\"SetupParametersManagement_ToggleManual('" + id + "');\" /></td></tr>";
	$('#divParameters').find('#emptySetupParameterRow').before(html);
	SetupParametersManagement_initializeSetupParameterButtons(id);
	if (data.isManual) {
		$("#chkManual" + id).prop("checked", true);
	}
}

function SetupParametersManagement_AddSetupParameterValueRow(setupParameterId, value) {
	var id = value['id'];
	var html = "<tr id='setupParameterValueRow" + id + "'><td>" + value['value'] + "</td>";
	html += "<td style='text-align: center'><button id='deleteSetupParameterValue" + id + "' onclick=\"SetupParametersManagement_DeleteSetupParameterValue('" + id + "');\"></button></td></tr>";
	$('#divValues').find("#valuesSetupParameter" + setupParameterId).find('#emptySetupParameterValueRow').before(html);
	SetupParametersManagement_initializeSetupParameterValueButtons(id);
}

function SetupParametersManagement_AddSetupParameterValuesTable(data) {
	var setupParameterId = data['setupParameterId'];
	var html = "<table class='inactive' id='valuesSetupParameter" + setupParameterId + "' style='border-spacing: 8px'><tbody>";
	html += "<tr id='emptySetupParameterValueRow' class='inactive AlwaysOnRow'></tr>";
	html += "<tr style='border-top: 2px solid; border-bottom: 0px;' class='AlwaysOnRow'><td>" +
			"<input type='text' style='bottom-border: 0px;' id='txtAddSetupParameterValue" + setupParameterId + "' /></td>";
	html += "<td style='text-align: center; border-bottom: 0px;'>";
	html += "<button id='addSetupParameterValue" + setupParameterId + "' onclick=\"SetupParametersManagement_AddSetupParameterValue('" + setupParameterId +
		"')\">Add</button></td></tr></tbody></table>";
	var valuesDiv = $('#divValues');
	valuesDiv.html(valuesDiv.html() + html);
	var values = data['values'];
	for (i = 0; i < values.length; i++) {
		SetupParametersManagement_AddSetupParameterValueRow(setupParameterId, values[i]);
	}
	UIUtility_initializeButton('addSetupParameterValue' + setupParameterId, 'ui-icon-document');
}

function SetupParametersManagement_AddSetupParameter() {

	var vNewValue = $('#divParameters').find('#txtAddSetupParameter').val();
	var existing = SetupParametersManagement_ExtractFirstColumn("setupParametersTable");
	if (vNewValue == "" || existing.indexOf(vNewValue) != -1) {
		UIUtility_showAlert("Please pick a unique and non empty name for the parameter");
	} else {
		
		// Prepare the JSON request
		var jsonRequest = {};
		jsonRequest.setupParameterName = vNewValue;
		jsonRequest.isManual = $("#chkManual").prop("checked");

		// Post
		var link = '/tasks/SetupParametersManagement_AddSetupParameter';
		var async = true;
		PostJsonWithJsonFeedbackFuncs(link, async, jsonRequest, SetupParametersManagement_AddSetupParameter_success, SetupParametersManagement_AddSetupParameter_failure);
	}	
}

function SetupParametersManagement_AddSetupParameter_success(jsonResponse) {

	SetupParametersManagement_AddSetupParameterRow(jsonResponse);

	// Add an empty row for the new parameter's values
	SetupParametersManagement_AddSetupParameterValuesTable({
		setupParameterId: jsonResponse.setupParameterId,
		values: []
	});
	
	// Clear the add setup parameter text box
	$('#divParameters').find('#txtAddSetupParameter').val('');
}

function SetupParametersManagement_AddSetupParameter_failure(responseText) {

	UIUtility_showAlert('Failed to add setup parameter: ' + responseText, 'Add Setup Parameter');
	
	// Clear the add setup parameter text box
	$('#divParameters').find('#txtAddSetupParameter').val('');
}

function SetupParametersManagement_DeleteSetupParameter(vSetupParameterID) {
	UIUtility_showConfirmDialog(["Are you sure you want to delete the setup parameter ?"],
		"Delete Setup Parameter",
		function () {
			var vValue = $('#divParameters').find('#setupParameterRow' + vSetupParameterID + ' td').eq(0).text();
			var link = '/tasks/SetupParametersManagement_DeleteSetupParameter';
			var async = true;
			var request = {};
			request.setupParameterId = vSetupParameterID;
			PostJsonWithJsonFeedbackFuncs(link, async, request,
				function (jsonResponse) {
					// Remove item
					$('#divParameters').find('#setupParameterRow' + vSetupParameterID).remove();
	
					// Remove the table of the deleted parameter's values
					var tableElem = $('#divValues').find('#valuesSetupParameter' + vSetupParameterID);
					if (!tableElem.hasClass('inactive')) {
						$('#divValues').addClass("inactive");
					}
					tableElem.remove();
				},
				function(textResponse) {
					UIUtility_showAlert('Failed to delete setup parameter: ' + textResponse, 'Delete');
				}
			);
		}
	);
}

function SetupParametersManagement_AddSetupParameterValue(vParameterID) {
	var vNewValue = $('#divValues').find('#txtAddSetupParameterValue' + vParameterID).val();
	var existing = SetupParametersManagement_ExtractFirstColumn("valuesSetupParameter" + vParameterID);
	if (existing.indexOf(vNewValue) != -1) {
		UIUtility_showAlert("Please pick a unique name for the parameter value");
	} else {
		var link = '/tasks/SetupParametersManagement_AddSetupParameterValue';
		var async = true;
		var request = {};
		request.setupParameterId = vParameterID;
		request.setupParameterValue = vNewValue;
		PostJsonWithJsonFeedbackFuncs(link, async, request,
			function (jsonResponse) {
				var vNewSetupParameterValueID = jsonResponse.setupParameterValueId;
				SetupParametersManagement_AddSetupParameterValueRow(vParameterID, {
					id: vNewSetupParameterValueID,
					value: vNewValue
				});
			},
			function(textResponse) {
				UIUtility_showAlert('Failed to add setup parameter value: ' + textResponse, 'Add');
			}
		);
	}
	$('#divValues').find('#txtAddSetupParameterValue' + vParameterID).val('');	
}

function SetupParametersManagement_DeleteSetupParameterValue(setupParameterValueId) {
	UIUtility_showConfirmDialog(["Are you sure you want to delete the setup parameter value?"],
		"Delete Setup Parameter Value",
		function () {
			var vValue = $('#divValues').find('#setupParameterValueRow' + setupParameterValueId + ' td').eq(0).text();

			// Prepare request
			var request = {};
			request.setupParameterValueId = setupParameterValueId;
			
			// Post
			var link = '/tasks/SetupParametersManagement_DeleteSetupParameterValue';
			var async = true;
			PostJsonWithJsonFeedbackFuncs(link, async, request,
				function (jsonResponse) {
					$('#divValues').find('#setupParameterValueRow' + setupParameterValueId).remove();
				},
				function(textResponse) {
					UIUtility_showAlert('Failed to delete setup parameter value: ' + textResponse, 'Delete');
				}
			);
		}
	);
}

function SetupParametersManagement_ToggleManual(setupParameterId) {
	var checkbox = $("#chkManual" + setupParameterId);
	var isManual = checkbox.is(":checked");
	var link = '/tasks/SetupParametersManagement_SetSetupParameterManual/' + setupParameterId + '/' + isManual;
	PostJsonWithJsonFeedbackFuncs(link, true, { },
		function (jsonResponse) { },
		function(textResponse) {
			// Revert
			checkbox.prop("checked", !isManual);

			// Show error message
			UIUtility_showAlert('Failed to change manual: ' + textResponse, 'Set manual');
		}
	);
}

/** javascripts/hostsmanagement/HostsManagementCommonHelper.js **/
var HostsManagement_toggleButtons = new Array();
var HostsManagement_toggleStates = {};

function HostsManagement_populateJsonWithSelectedAgentNames() {
	var selectedAgentNamesAsJson = {
			"agentNames": []
	}
	
	// Get the selected names
	var agentNames = HostsManagement_getSelectedAgentNames();
	agentNames.sort(ipsComparator);
	
	// Put the selected agent names in the json
	selectedAgentNamesAsJson.agentNames = agentNames;
	
	return selectedAgentNamesAsJson;
}

// This will return an array of agent names (host ip / agent name)
function HostsManagement_getSelectedAgentNames(optionalIncludeInvisible) {
	if (optionalIncludeInvisible == undefined) {
		optionalIncludeInvisible = false;
	}

	var agentNames = new Array();
	$('#tblHosts tbody tr').each(function() {
		var checkbox = $(this).find('#chkSelect');
		var selected = checkbox.is(':checked');
		var visible = (optionalIncludeInvisible ? true : checkbox.is(':visible'));
		if (selected && visible) {
			// Get the current agent name
			var agentName = $(this).attr('data-id');
			
			// Add to the array
			agentNames.push(agentName);
		}
	});

	return agentNames;
}

function HostsManagement_populateJsonWithDisplayedAgentNames() {
	var displayedAgentNamesAsJson = {
			"agentNames": []
	}
	
	// Get the displayed names
	var agentNames = HostsManagement_getDisplayedAgentNames();
	
	// Put the selected agent names in the json
	displayedAgentNamesAsJson.agentNames = agentNames;
	
	return displayedAgentNamesAsJson;
}

//This will return an array of agent names (host ip / agent name)
function HostsManagement_getDisplayedAgentNames() {
	
	var agentNames = new Array();
	$('#tblHosts tbody tr').each(function() {
		var visible = $(this).is(':visible');
		if (visible) { 
			// Get the current agent name
			var agentName = $(this).attr('data-id');
	
			// Add to the array
			agentNames.push(agentName);
		}
	});

	return agentNames;
}

function HostManagement_extractSelectedRowsWithAvailabilityStatus() {
	// The json to include the results
	var selectedRowsWithStatusAsJson = {
			"FoundStatuses": [],
			"In Use": [],
			"Locked (LM)": [],
			"Locked (User)": [],
			"Locked (WF)": [],
			"Idle": [],
			"Free": [],
			"All": []
	}

	// Maintain found statues
	var foundStatuses = new Array();
	
	var hostsTable = $('#tblHosts');
	
	// Get the selected rows
	var selectedRows = getSelectedRows(hostsTable);
	
	// Check if found non 'Idle' row amongst the selected rows
	var foundNonIdle = false;
	
	// Iterate over the selected rows
	selectedRows.forEach(function(selectedRow) {
		// Extract the availability status
		var availabilityStatus = $(selectedRow).find('#tdAgentAvailabilityStatus').text();
		if (isStringEmpty(availabilityStatus)) {
			return;
		}

		// Add to the array in the json
		var selectedRowElem = $(selectedRow);
		selectedRowsWithStatusAsJson[availabilityStatus].push(selectedRowElem);
		selectedRowsWithStatusAsJson["All"].push(selectedRowElem);

		// Add the found status
		if ($.inArray(availabilityStatus, foundStatuses) < 0) {
			foundStatuses.push(availabilityStatus);
		}
	});
	
	// Attach the found statuses to the json
	selectedRowsWithStatusAsJson.FoundStatuses = foundStatuses;
	
	return selectedRowsWithStatusAsJson;
}

function HostManagement_OpenStandaloneDialog(action, preselected) {
	var width = Math.round(window.innerWidth * (3 / 4));
	var height = Math.round(window.innerHeight * (3 / 4));
	UIUtility_showConfirmDialog(
			[
			 "Please select agents:",
			 "<iframe id='hostManagementContainer' src='/ui/displayHostManagement?minimalUI=true' style='width: " +
			 	(width - 40) + "px; height: " + (height - 200) + "px'></iframe>"
			],
			"Select Agents",
			{
				"OK": function () {
					var result = { agentNames: [] };
					var checked = $("#hostManagementContainer").contents().find("#chkSelect:checked");
					for (var i = 0; i < checked.length; i++) {
						var chk = $(checked[i]);
						if (chk.is(":visible")) {
							var row = chk.closest("tr[data-id]");
							var agentName = row.attr('data-id');
							result.agentNames.push(agentName);
							result[agentName] = row.find("#tdAgentAvailabilityStatus").text().trim();
						}
					}
					$("#hostManagementContainer").remove();
					action(result);
				},
				"Cancel": function () {
					$("#hostManagementContainer").remove();
				}
			},
			width,
			height);

	var container = $("#hostManagementContainer");
	container.on("load", function() {
		var contents = container.contents();

		// Set background
		contents.find("body, .content, tr").css('background-color', 'transparent');

		// Preselected agents
		if (preselected != undefined) {
			for (var i = 0; i < preselected.length; i++) {
				contents.find("tr[data-id='" + preselected[i] + "'] #chkSelect").prop("checked", true);
			}
		}
	});
}

/** javascripts/hostsmanagement/HostsManagementEventsHelper.js **/
function HostManagement_offerUnlockAgents(cont, allowSkip) {
	// Get the selected rows with the availability status
	var selectedRowsWithStatusAsJson = HostManagement_extractSelectedRowsWithAvailabilityStatus();

	// Iterate over the selected rows to extract the agent ids
	var lockedAgentIds = new Array();
	selectedRowsWithStatusAsJson["Locked (LM)"].forEach(function(selectedRow) {
		lockedAgentIds.push(selectedRow.attr('data-id'));
	});
	selectedRowsWithStatusAsJson["Locked (User)"].forEach(function(selectedRow) {
		lockedAgentIds.push(selectedRow.attr('data-id'));
	});
	selectedRowsWithStatusAsJson["Locked (WF)"].forEach(function(selectedRow) {
		lockedAgentIds.push(selectedRow.attr('data-id'));
	});

	// Offer to unlock
	if (lockedAgentIds.length > 0) {
		var buttons = {
			"Unlock": function () {
				var xmlhttp = HostsManagement_SendAgentsAction(lockedAgentIds, "Unlock");
				xmlhttp.onreadystatechange = function () {
					if (xmlhttp.readyState == 4) {
						if (xmlhttp.status == 200) {
							// We finished the request, we should receive the free event very soon (or we already got it)
							// We'll try for 5 seconds
							executePeriodic(function () {
								var isAnythingLocked = false;
								for (var i = 0; i < lockedAgentIds.length; i++) {
									var tdAvailStatus = $("#tblHosts tr[data-id='" + lockedAgentIds[i] + "'] #tdAgentAvailabilityStatus");
									if (tdAvailStatus.text().indexOf("Locked") == 0) {
										isAnythingLocked = true;
										break;
									}
								}
								if (isAnythingLocked) {
									return true;
								} else {
									// Close existing alert
									$("#alertDialog").dialog("close");
	
									// Open new alert
									UIUtility_showConfirmDialog(["Unlocked successfully"], "Unlocking", { "Continue": cont });
									return false;
								}
							}, 25, 250, true);
						} else {
							UIUtility_showAlert("Can't unlock agents", "Error");
						}
					}
				};
				UIUtility_showConfirmDialog(["Unlocking, please wait ..."], "Unlocking", { "Cancel": null });
			}
		};
		if (allowSkip) {
			buttons["Skip"] = cont;
		}
		UIUtility_showConfirmDialog([ "Some agents are locked, would you like to unlock them?" ], "Locked Agents", buttons);
	} else {
		cont();
	}
}

function HostsManagement_onSendTestPlanToggle(button) {
	// Clear the previous status
	$('#showSendTestPlanFormEffect').find('#lblSendTestPlanStatus').html('');

	$("#tpExecutionName").val('');
	TestPlans_loadTestPlanNames(undefined, renderTestPlanNames);

	// Load TP executions
	var maxHours = getAddToExecutionHistoryLengthInHours();
	var xmlhttp = Get('/tasks/LoadBatchesHeader/false?includeQuickWFSupport=true&maxAgeHours=' + maxHours, true);
	xmlhttp.onreadystatechange = function() {
		if (xmlhttp.readyState == 4) {
			if (xmlhttp.status == 200) {
				$("select[id='slctTPExecution'] option").remove();
				var result = JSON.parse(xmlhttp.responseText);
				var html = "";
				if (result.batchIds != undefined) {
					for (var i = 0; i < result.batchIds.length; i++) {
						var id = result.batchIds[i];
						if (result[id].batchState != undefined) {
							// Attributes
							var attributes = "";
							if (result[id].attributes != undefined) {
								for (var attribute in result[id].attributes) {
									if (attributes != "") {
										attributes += ", ";
									}
									attributes += attribute + ": " + result[id].attributes[attribute];
								}
								if (attributes != "") {
									attributes = " [" + attributes + "]";
								}
							}

							// Initial name is TP execution name or test plan name if one isn't available
							var name = result[id].batchTPExecutionName;
							if (isStringEmpty(name)) {
								name = result[id].batchTestPlanName;
							}

							// Remove milliseconds from submit time for display
							var shorterSubmitTime = result[id].batchSubmitTime;
							var dotIndex = shorterSubmitTime.lastIndexOf(".");
							if (dotIndex >= 0) {
								shorterSubmitTime = shorterSubmitTime.substring(0, dotIndex);
							}

							// Add attributes and submission time to name
							// Submission name is a must to differentiating similar executions
							name += attributes + " at " + shorterSubmitTime;

							// Add state prefix
							name = "(" + (result[id].batchState == "InProgress" ? "IP" : "C") + ") " + name;

							html += "<option data-id='" + id + "' data-support-quick-add='" + result[id].supportQuickAddToExecution;
							html += "' data-choose-workflow='" + result[id].chooseWorkflow + "'>" + name + "</option>";
						}
					}
				}
				var slct = $("select[id='slctTPExecution']");
				slct.html(html);
				slct.combobox();

				// Make combobox wider
				var input = slct.parent().find('.ui-autocomplete-input');
				input.val("");
				input.css('min-width', '300px');
			} else {
				UIUtility_showAlert("Can't load TP executions because: " + xmlhttp.responseText);
			}
		}
	};
}

function HostsManagement_onAddAgent() {
	var dialogHtml = $("#addAgentTemplate").html();
	UIUtility_showConfirmDialog(dialogHtml, "New Agents", function (div) {
		// Get the agent name
		var agentNamesStr = div.find('#txtNewAgent').val();
		agentNamesStr = agentNamesStr.trim();

		// Validate agent name
		if (isStringEmpty(agentNamesStr)) {
			UIUtility_showAlert("New agent name cannot be empty", "Error");
			return;
		}

		// In case we have more than one line, spilt it and trim all agent names
		var agentNames = agentNamesStr.split("\n");
		for (var i = 0; i < agentNames.length; i++) {
			agentNames[i] = agentNames[i].trim();
			var toIndex = agentNames[i].indexOf("->");
			if (toIndex != -1) {
				var left = agentNames[i].substring(0, toIndex).trim();
				var right = agentNames[i].substring(toIndex + 2).trim();
				agentNames[i] = left;
	
				// Add up to right, assuming
				var leftNum = "";
				var rightNum = parseInt(right);
				for (var c = left.length - 1; c >= 0; c--) {
					var ch = left.charAt(c);
					if (ch >= '0' && ch <= '9') {
						leftNum = ch + leftNum;
					} else {
						break;
					}
				}
				if (leftNum != "") {
					var leftNoNum = left.substring(0, left.length - leftNum.length);
					leftNum = parseInt(leftNum);
					for (var j = leftNum + 1; j <= rightNum; j++) {
						agentNames.push(leftNoNum + j);
					}
				}
			}
		}

		// Get virtual lab ID
		var virtualLabSelector = div.find('#slctVirtualLab');
		var virtualLabId = getValueFromElement(virtualLabSelector);

		// Send a request to add the agent
		HostsManagement_sendRequestToAddAgents(agentNames, virtualLabId);
	});
}

function HostsManagement_onDeleteAgents() {
	// Populate a json with the selected agent names
	var selectedAgentNamesAsJson = HostManagement_extractSelectedRowsWithAvailabilityStatus();

	// Make sure that at least one agent was selected
	if (selectedAgentNamesAsJson["All"].length == 0) {
		UIUtility_showAlert("Please select agents", "Error");
		return;
	}

	var cont = function () {
		doAction('Delete Agents', 
				function() {
					HostsManagement_sendRequestToDeleteAgents(HostsManagement_populateJsonWithSelectedAgentNames());
				});
	};

	// Check if some agents are in use / idle
	if (selectedAgentNamesAsJson["In Use"].length > 0 || selectedAgentNamesAsJson["Idle"].length > 0) {
		UIUtility_showConfirmDialog(
				[
				 "Some of the selected agents are currently in use, and might be executing tests, or scheduled to execute tests.",
				 "If you continue, in progress tests will be lost, and the agent will be removed from all queued tests."
				], "Agents In Use", cont);
	} else {
		cont();
	}
}

function HostsManagement_onShutdownAgents() {
	// Populate a json with the selected agent names
	var selectedAgentNamesAsJson = HostManagement_extractSelectedRowsWithAvailabilityStatus();
	
	// Make sure that at least one agent was selected
	if (selectedAgentNamesAsJson["All"].length == 0) {
		UIUtility_showAlert("Please select agents", "Error");
		return;
	}
	
	var cont = function () {
		doAction('Shutdown Agents', 
				function() {
			HostsManagement_sendRequestToShutdownAgents(HostsManagement_populateJsonWithSelectedAgentNames());
		});
	};

	// Check if some agents are in use / idle
	if (selectedAgentNamesAsJson["In Use"].length > 0 || selectedAgentNamesAsJson["Idle"].length > 0) {
		UIUtility_showConfirmDialog(
				[
					"Some of the selected agents are currently in use, and might be executing tests, or scheduled to execute tests.",
					"If you continue, in progress tests will be lost, and the agent will be removed from all queued tests."
					], "Agents In Use", cont);
	} else {
		cont();
	}
}

function HostsManagement_onLockStations() {
	// Populate a json with the selected agent names
	var requestAsJson = HostsManagement_populateJsonWithSelectedAgentNames();

	// Make sure that at least one agent was selected
	if (requestAsJson.agentNames.length == 0) {
		UIUtility_showAlert("Please select agents", "No agent selected");
		return;
	}

	var messages = [
	                "<input type='checkbox' id='chkLockByUser'>&nbsp;Lock agent (remove from executions)</input>",
	                "<input type='checkbox' id='chkEnabledToOwner'>&nbsp;Lock exclusively for " + getLoggedInData().displayName +
	                	" <span title='Leaving this box unchecked will ensure that no user can perform any actions with the agents.<br/>Checking it will allow only you to use the agents.'>(?)</span></input>",
	                "Enter description:",
	                "<textarea id='txtLockStationDescription' style='width: 520px; height: 100px' />" ];
	UIUtility_showConfirmDialog(messages, "Lock Selection", function () {
		if ($("#chkLockByUser").prop("checked")) {
			HostsManagement_SendAgentsAction(requestAsJson.agentNames, "Lock");
		}

		// Make sure that the user name is not empty
		var description = getValueFromElement($('#txtLockStationDescription'));

		// Attach data to the request
		requestAsJson.description = description;
		requestAsJson.isEnabledToOwner = $("#chkEnabledToOwner").prop("checked");

		// Send a request to lock the stations
		HostsManagement_sendRequestToLockStations(requestAsJson);
	}, 570, 350);
}

function HostsManagement_onUnlockStationsMultiple() {
	// Fill temporary action span
	var spanTemporaryAction = $("#spanTemporaryAction");
	spanTemporaryAction.html('<label style="margin-left: 15px; font-size: 16px; font-weight: bold">Select agents to unlock&nbsp;</label>' +
			'<input type="button" id="doneSelectingButton" class="confirm" value="Done"></button>&nbsp;' +
			'<input type="button" id="cancelSelectingButton" class="confirm" value="Cancel"></button>');

	// Replace operations with temporary action span
	$("#spanHostOperations").addClass("inactive");
	spanTemporaryAction.removeClass("inactive");

	// Disable all set selection boxes
	$("#tblHosts #trActionOnSelected").find("input:not([data-not-setter]), select:not([data-not-setter])").prop("disabled", true);

	// Show all checkboxes
	var hiddenCheckboxes = [];
	$("#tblHosts #chkSelect").each(function () {
		var checkbox = $(this);
		if (!checkbox.is(":visible") && !checkbox.closest("tr").hasClass("inactive")) {
			checkbox.removeClass("inactive");
			hiddenCheckboxes.push(checkbox);
		}
	});

	// Add cancel action
	$("#cancelSelectingButton").click(function () {
		// Replace temporary action span with operations
		spanTemporaryAction.addClass("inactive");
		$("#spanHostOperations").removeClass("inactive");
		$("#tblHosts #trActionOnSelected").find("input, select").prop("disabled", false);

		// Hide checkboxes which were hidden (incase unlock fails)
		for (var i = 0; i < hiddenCheckboxes.length; i++) {
			hiddenCheckboxes[i].addClass("inactive");
		}
	});

	// Add done action
	$("#doneSelectingButton").click(function () {
		// Populate a json with the selected agent names
		var requestAsJson = HostsManagement_populateJsonWithSelectedAgentNames();

		// Make sure that at least one agent was selected
		if (requestAsJson.agentNames.length == 0) {
			UIUtility_showAlert("Please select agents", "No agent selected");
			return;
		}

		// Replace temporary action span with operations
		spanTemporaryAction.addClass("inactive");
		$("#spanHostOperations").removeClass("inactive");
		$("#tblHosts #trActionOnSelected").find("input, select").prop("disabled", false);

		// Hide checkboxes which were hidden (in case unlock fails)
		for (var i = 0; i < hiddenCheckboxes.length; i++) {
			hiddenCheckboxes[i].addClass("inactive");
		}

		// Perform unlock
		HostsManagement_onUnlockStationsConfirm(requestAsJson.agentNames);
	});
}

function HostsManagement_onAgentsAction(actionName, actionEnumName) {
	// Populate a json with the selected agent names
	var requestAsJson = HostsManagement_populateJsonWithSelectedAgentNames();

	// Make sure that at least one agent was selected
	if (requestAsJson.agentNames.length == 0) {
		UIUtility_showAlert("Please select agents", "No agents selected");
		return;
	}

	var messages = ["Are you sure you want to " + actionName + " selected agents?"];
	if (actionEnumName.indexOf("Abort") != -1) {
		messages.push("<input type='checkbox' id='chkLockAgent' checked>&nbsp;Lock agent</input>");
	}
	UIUtility_showConfirmDialog(messages, actionEnumName, function () {
		pageLoading(500);
		if (actionEnumName.indexOf("Abort") != -1 && $("#chkLockAgent").prop("checked")) {
			var xmlhttp = HostsManagement_SendAgentsAction(requestAsJson.agentNames, "Lock");
			xmlhttp.onreadystatechange = function() {
				if (xmlhttp.readyState == 4) {
					if (xmlhttp.status == 200) {
						var xmlhttp2 = HostsManagement_SendAgentsAction(requestAsJson.agentNames, actionEnumName);
						xmlhttp2.onreadystatechange = function() {
							if (xmlhttp2.readyState == 4) {
								pageFinishedLoading();
								if (xmlhttp2.status != 200) {
									UIUtility_showAlert("Failed to abort agents", "Error");
								}
							}
						};
					} else {
						UIUtility_showAlert("Failed to lock agent on abort, abort cancelled", "Error");
					}
				}
			};
		} else {
			var xmlhttp = HostsManagement_SendAgentsAction(requestAsJson.agentNames, actionEnumName);
			xmlhttp.onreadystatechange = function() {
				if (xmlhttp.readyState == 4) {
					pageFinishedLoading();
					if (xmlhttp.status != 200) {
						UIUtility_showAlert("Failed to perform " + actionEnumName + " on agents", "Error");
					}
				}
			};
		}
	});
}

function HostsManagement_onUnlockStations(theIconImage) {
	// Get station lock status
	var isLocked = $(theIconImage).attr("locked");

	if (isLocked == "false") {
		// It is already unlocked
		return;
	}

	// Extract description and add agent name to it
	var description = $(theIconImage).attr('lockDescription');
	var agentNameToUnlock = $(theIconImage).closest('tr').attr('data-id');
	var html = "<strong>Agent Name:</strong> " + agentNameToUnlock + "<br/>" + description;

	UIUtility_showConfirmDialog(
			'<input id="hdnAgentNameToUnlock" type="hidden" value="' + agentNameToUnlock + '" />' + html,
			"Selection Lock Details",
			{
				"Edit": function () {
					var innerDescIndex = description.indexOf("<strong>Description:");

					UIUtility_showConfirmDialog(
							'New description:<textarea id="newLockDesc" cols="56" rows="7"></textarea>',
							"Edit Lock Description",
							function () {
								// Description escaping must be done here, before adding all the HTML contents
								var newDesc = $("#newLockDesc").val();
								newDesc = escapeTextToHtml(newDesc);

								var beforeDescription = description.substring(0, innerDescIndex);
								beforeDescription += "<strong>Edited:</strong> " + formatDate(new Date()) + " (" + getLoggedInData().displayName + ")<br/>";
								beforeDescription += "<strong>Description:</strong> " + newDesc;
								HostManagement_sendRequestToModifySelectionLock(beforeDescription, agentNameToUnlock);
							});

					// Set existing description
					$("#newLockDesc").val(description.substring(innerDescIndex + "<strong>Description:</strong> ".length));
				},
				"Unlock": function () {
					HostsManagement_onUnlockStationsConfirm([ $('#hdnAgentNameToUnlock').val() ]);
				}
			}, 550, 350);
}

function HostsManagement_onUnlockStationsConfirm(agentNames) {
	// Post unlock request
	HostsManagement_sendRequestToUnlockStations({
		agentNames: agentNames
	}, function () {
	}, function () {
		UIUtility_showAlert("Failed to unlock selection the agents", "Error");
	});
}

function HostsManagement_onSendWorkflow(isLocal, workflowName, isQuick, isEnableRunningOnInactiveHost) {
	// Default to non local workflow
	if (isLocal == undefined) {
		isLocal = false;
	}

	// Populate a json with the selected agent names
	var requestAsJson = HostsManagement_populateJsonWithSelectedAgentNames();

	// Remove "(Local)" from name
	workflowName = replaceAll(workflowName, " (Local)", "");

	if (isLocal) {
		// Local, set local host as the only agent IP
		requestAsJson.agentNames = [ "127.0.0.1" ];
	} else if (requestAsJson.agentNames.length == 0) {
		// Make sure that at least one agent was selected if not local
		$('#showSendWorkflowCommand').find('#lblSendWorkflowStatus').html('Please select agents');
		$('#showSendWorkflowCommand').find('#lblSendWorkflowStatus').attr('class', 'statusFail');
		return;
	}

	// Extract the workflow id 
	var workflowId = WorkflowsMng_getWorkflowId(workflowName);

	// Make sure that the workflow exists
	if (undefined == workflowId || isStringEmpty(workflowId.toString())) {
		$('#showSendWorkflowCommand').find('#lblSendWorkflowStatus').html('The workflow does not exist...');
		$('#showSendWorkflowCommand').find('#lblSendWorkflowStatus').attr('class', 'statusFail');
		return;
	}

	// Clear the previous status
	$('#showSendWorkflowCommand').find('#lblLockStationsStatus').html('');
	
	// This is a regular workflow - turn off the auto deployment
	var autoDeployment = false;

	// Create an initial context
	var context = { agentIds: requestAsJson.agentNames, workflowId: workflowId, workflowName: workflowName };

	if (isQuick) {
		// Build quick run messages (we include the chkEnable text box but hide it, so the extraction of information will detect the default on/off for each step)
		var messages = [ "Quickly run the workflow, or open workflow management page" ];
		var tableHtml = '<table id="tblWorkflowSteps" disableZebra><thead><tr id="columnNames"><th id="thEnable" class="inactive"></th><th id="thArguments"></th></tr></thead>';
		tableHtml += '<tbody id="tbodyWorkflowSteps"></tbody></table>';
		tableHtml += '<table id="tblWorkflowStepsTemplate" class="inactive" style="cell-spacing">';
		tableHtml += '<tbody><tr><td id="tdEnable" class="inactive"><input type="checkbox" id="chkEnable" /></td><td id="tdArguments"></td></tr></tbody></table>';
		messages.push(tableHtml);

		// Load workflow content (will be rendered into the dialog after the continuation finishes)
		$("#hdnWorkflowId").val(workflowId);
		WorkflowMng_loadWorkflowContent(function (success) {
			if (success) {
				var content = WorkflowsMng_getWorkflowContent();
				var width = 600;
				var stepInputsCount = content.workflowSteps[content.workflowSteps.workflowStepIds[0]].inputs.inputIds.length;
				var height = 230 + stepInputsCount * 30;
				if (height < 350) {
					height = 350;
				}

				// Show dialog
				UIUtility_showConfirmDialog(
						messages,
						content.workflowName,
						{
							"Run": function () {
								var runRequest;
								if ($("#tbodyWorkflowSteps tr").length > 0) {
									// At least one input, validate and extract it
									runRequest = WorkflowsMng_validateAndPopulateRunWorkflowAsJson(false, false);
								} else {
									// No inputs, create a request with no steps information (it will automatically be filled by the system)
									var runRequest 	= {
										requestAsJson: { workflowId: workflowId }
									};
								}

								if (!runRequest.isValid) {
									UIUtility_showAlert(runRequest.errorDescription, "Error");
									return;
								}

								// In any case, the agent names should be set manually
								runRequest.requestAsJson.agentNames = requestAsJson.agentNames;

								// Not auto deployment
								runRequest.requestAsJson.isAutoDeployment = false;

								// Send run workflow request
								WorkflowsMng_sendRunWorkflow(runRequest.requestAsJson, false);
							},
							"Management": function () {
								// Send a request to load the workflow content
								WorkflowsMng_sendLoadWorkflow(workflowId, workflowName, autoDeployment, requestAsJson.agentNames, context);
							}
						}, width, height);
			} else {
				UIUtility_showAlert("Can't load workflow content");
			}
		}, function () {
			// Remove show hidden collapsible
			$("#tbodyWorkflowSteps [id='tblShowHidden']").remove();
		});
	} else {
		// Send a request to load the workflow content
		WorkflowsMng_sendLoadWorkflow(workflowId, workflowName, autoDeployment, requestAsJson.agentNames, context);
	}
}

function HostManagement_onPrepeareTestPlan() {
	// Extract the test plan id & name
	var slctElem = $("#startTestPlanTab #slctTestPlan");
	var testPlanId 		= slctElem.find('option:selected').val();
	var testPlanName 	= getTextFromElement(slctElem);

	// Support custom test plan
	if (testPlanId == -1) {
		HostManagement_showCustomHierarchyTPBuilder();
		return;
	}

	// Make sure that the test plan is not missing
	if (isStringEmpty(testPlanName)) {
		$('#showSendTestPlanFormEffect').find('#lblSendTestPlanStatus').html('The test plan is empty');
		$('#showSendTestPlanFormEffect').find('#lblSendTestPlanStatus').attr('class', 'statusFail');
		return;
	}

	// Make sure that the test plan exists
	if (isStringEmpty(testPlanId)) {
		$('#showSendTestPlanFormEffect').find('#lblSendTestPlanStatus').html('The test plan does not exist');
		$('#showSendTestPlanFormEffect').find('#lblSendTestPlanStatus').attr('class', 'statusFail');
		return;
	}

	// Get the selected rows with the availability status
	var selectedRowsWithStatusAsJson = HostManagement_extractSelectedRowsWithAvailabilityStatus();

	// Iterate over the selected rows to extract the agent ids
	var agentIds = new Array();
	selectedRowsWithStatusAsJson.All.forEach(function(selectedRow) {
		agentIds.push(selectedRow.attr('data-id'));
	});

	if (agentIds.length == 0) {
		$('#showSendTestPlanFormEffect').find('#lblSendTestPlanStatus').html('Please select agents');
		$('#showSendTestPlanFormEffect').find('#lblSendTestPlanStatus').attr('class', 'statusFail');
		return;
	}
	
	// Clear previous errors
	$('#showSendTestPlanFormEffect').find('#lblSendTestPlanStatus').html('');

	// Extract custom execution name if exists
	var customExecName = $("#tpExecutionName").val();
	if (customExecName == "") {
		customExecName = undefined;
	}

	if (hasCheckTestPlan()) {
		// Open a new window with 'Check TP'
		CheckTestPlan_sendRequestToDisplayCheckTestPlanPage(testPlanId, testPlanName, agentIds, customExecName);
	} else {
		if (hasAutoDeployment()) {
			// Open auto deployment page
			WorkflowsMng_sendLoadAutoDeploymentWorkflowFromTP(testPlanId, agentIds, {
				testPlanId: testPlanId,
				testPlanName: testPlanName,
				agentIds: agentIds,
				customExecutionName: customExecName
			});
		} else {
			// Open the validation window, no test suite ID, the default (from the test plan) will be used
			var enableSendTestPlan = true;
			var autoDeployment = false;
			var testSuiteId = undefined;
			sendRequestToDisplayTestPlanValidationPage(
					testPlanId, 
					testPlanName, 
					testSuiteId,
					enableSendTestPlan,
					agentIds,
					autoDeployment,
					undefined,
					customExecName);
		}
	}
}

function HostManagement_onAddAgentsToTestPlan() {
	var agentsJson = HostsManagement_populateJsonWithSelectedAgentNames();
	var selectElem = $("#addToTestPlanTab #slctTPExecution");
	var selectedName = getValueFromElement(selectElem);
	selectElem.find("option").each(function () {
		var $this = $(this);
		if ($this.text() == selectedName) {
			// No test plan or suite, should take from merged TP execution
			if (hasAutoDeployment()) {
				// Get auto deployment workflow
				var tpExecId = $this.attr('data-id');
				if ($this.attr('data-support-quick-add') == "true") {
					// Show dialog whether to run immediately or open auto deployment page
					UIUtility_showConfirmDialog(
							[ "Quickly add to execution, or open workflow management/validation pages" ],
							"Add To Execution",
							{
								"Run": function () {
									PostJsonWithJsonFeedbackFuncs(
											'/testExecutions/' + parseReplacers(tpExecId) + '/addAgents',
											true,
											{ agentNames: agentsJson.agentNames },
											function (res) {
												UIUtility_showAlert("Add to execution process initiated", "Add To Execution");
											},
											function (err) {
												UIUtility_showAlert(err, "Error");
											});
								},
								"Management": function () {
									// Open auto deployment page
									WorkflowsMng_sendLoadAutoDeploymentWorkflowFromTP(0, agentsJson.agentNames, {
										agentIds: agentsJson.agentNames
									}, tpExecId);
								}
							});
				} else {
					// If we should choose workflow, let the user choose
					if ($this.attr('data-choose-workflow') == "true") {
						// Let user choose a workflow
						var slctWorkflowHtml = "<select id='slctForcedWorkflow'>";
						var workflowsData = WorkflowsMng_getWorkflowsData();
						for (var key in workflowsData) {
							slctWorkflowHtml += "<option value='" + workflowsData[key] + "'>" + key + "</option>";
						}
						slctWorkflowHtml += "</select>";
						UIUtility_showConfirmDialog(
								[ "Choose the workflow you would like to execute", slctWorkflowHtml ],
								"Choose Workflow",
								{
									"OK": function () {
										// Open auto deployment page with forced workflow
										var workflowId = $("#slctForcedWorkflow").val();
										WorkflowsMng_sendLoadAutoDeploymentWorkflowFromTP(0, agentsJson.agentNames, {
											agentIds: agentsJson.agentNames
										}, tpExecId, undefined, workflowId);
									},
									"Cancel": function () {
									}
								});
						$("#slctForcedWorkflow").selectize();
					} else {
						// Open auto deployment page with default workflow
						WorkflowsMng_sendLoadAutoDeploymentWorkflowFromTP(0, agentsJson.agentNames, {
							agentIds: agentsJson.agentNames
						}, tpExecId);
					}
				}
			} else {
				sendRequestToDisplayTestPlanValidationPage(
					undefined, 
					undefined, 
					undefined,
					true,
					agentsJson.agentNames,
					false,
					$this.attr('data-id'));
			}
		}
	});
}

function HostManagement_onPrepeareFastRun() {
	var requestAsJson = HostsManagement_populateJsonWithSelectedAgentNames();
	PostJsonToNewWindow('/tasks/FastRunManagement', requestAsJson);
}

function HostsManagement_onSearchDisks() {
	// Extract the selected agent names as json
	var selectedAgentNamesAsJson = HostsManagement_populateJsonWithSelectedAgentNames();
	if (selectedAgentNamesAsJson.agentNames.length == 0) {
		UIUtility_showAlert("Please select hosts", "Error");
	}
	
	// Send a request to search for disks
	DisksManagement_sendRequestToSearchForDisks(selectedAgentNamesAsJson);
}

function HostsManagement_onSearchDisksOnViewableHosts() {
	// Extract the agent names as json
	var agentNames = [];
	$("#tblHosts > tbody > tr[data-agent-name]:visible").each(function () {
		agentNames.push($(this).attr('data-agent-name'));
	})
	if (agentNames.length == 0) {
		UIUtility_showAlert("No viewable hosts", "Error");
	}

	// Send a request to search for disks
	DisksManagement_sendRequestToSearchForDisks({ agentNames: agentNames });
}

function HostManagement_onSetAgentVirtualLab(runnerId) {
	// Populate a json with the selected agent names
	var selectedAgentNames = HostsManagement_getSelectedAgentNames();
	
	if (selectedAgentNames.length > 0) {
		// Preapre the request
		var agentVirtualLabId 	= $('#slctHostVirtualLab option:selected').val();
		var agentVirtualLabName = $('#slctHostVirtualLab option:selected').attr('data-vlab-name');
		var domainName			= $('#slctHostVirtualLab option:selected').attr('data-lm-domain-name');

		var messages = [ "You are about the change the agents virtual lab." ];
		if (domainName != getCurrentServerDomainName()) {
			messages.push("This virtual lab resides in another lab manager: " + domainName + ".");
		}
		messages.push("Are you sure?");
		UIUtility_showConfirmDialog(messages, "Set Virtual Lab", {
			"Cancel": function () {
	    	  	// Reset the virtual labs drop down list
	    		resetSelection('slctHostVirtualLab');
			},
			"OK": function () {
	    	  	HostsManagement_onConfirmSetAgentVirtualLab(agentVirtualLabId, agentVirtualLabName, selectedAgentNames, runnerId);
			}
		});
	} else {
		UIUtility_showAlert("Please select agents", "No Agents Selected");

		// Reset the virtual labs drop down list
		resetSelection('slctHostVirtualLab');
	}
}

function HostsManagement_onConfirmSetAgentVirtualLab(agentVirtualLabId, agentVirtualLabName, selectedAgentNames, runnerId) {
	// The link url
	var linkUrl = '/tasks/HostsManagement_SetAgentVirtualLabID';
	
	// Populate a json object
	var setAgentVirtualLabAsJson = {
			"runnerId": runnerId,
			"agentVirtualLabId": agentVirtualLabId,
			"agentNames" : selectedAgentNames
	}

	// Send the request and update the action result summary according to the response
	sendRequestUpdateUIAndActionResultSummary(
			"tblHosts",
			linkUrl, 
			"tdVirtualLab", 
			agentVirtualLabName, 
			setAgentVirtualLabAsJson);

	// Reset the virtual labs drop down list
	resetSelection('slctHostVirtualLab');
}

function HostsManagement_onVirtualLabCellChanged(callingElement, virtualLabName) {
	// Get the virtual lab id by name
	var virtualLabId = $('#tblHosts').find('#trActionOnSelected').find('#slctHostVirtualLab').find('option').filter(
			function () { return $(this).html() == virtualLabName; }).val()
	
	// Update the with the virtual lab id
	var virtualLabHdnAsHtml = '<input type="hidden" id="hdnHostVirtualLabId" name="hdnHostVirtualLabId" value="' + virtualLabId + '" />';
	var virtualLabLblAsHtml = '<label id="lblcolHostVirtualLabID">' + virtualLabName + '</label>';

	// Update the label
	callingElement.html(virtualLabHdnAsHtml + virtualLabLblAsHtml);
}

function HostsManagement_onViewCredentials() {
	// Populate a json with the selected agent names
	var selectedAgentNames = HostsManagement_getSelectedAgentNames();
	
	if (selectedAgentNames.length > 0) {
		UIUtility_showAlert("Please wait ...", "Host Credentials");
		PostJsonWithJsonFeedbackFuncs(
				'/tasks/HostManagement_getHostCredentials',
				true,
				{ agentNames: selectedAgentNames },
				function (result) {
					var html = "<table class='hor-minimalist-c' style='width: 100%'><thead><tr><th>IP</th><th>Username</th><th>Password</th><th>Custom</th><tbody>";
					for (var hostIp in result) {
						var custom = (result[hostIp].isDefault ? "No" : "Yes");
						html += "<tr><td>" + hostIp + "</td><td>" + result[hostIp].username + "</td><td>" + result[hostIp].password + "</td><td>" + custom + "</td></tr>";
					}
					html += "</tbody></table>";
					UIUtility_showAlert(html, "Custom Credentials", 700, 700);
				},
				function () {
					UIUtility_showAlert("Failed to retrieve credentials", "Error");
				});
	} else {
		UIUtility_showAlert("Please select agents", "No Agents Selected");
	}
}

function HostsManagement_onSetCustomCredentials() {
	var selectedAgentNames = HostsManagement_getSelectedAgentNames();

	if (selectedAgentNames.length > 0) {
		var messages =
			[
			 "Enter credentials or restore to default",
			 "<table><tr><td>Username:</td><td><input type='text' id='txtUsername'></input></td></tr>" +
			 "<tr><td>Password:</td><td><input type='password' id='txtPassword'></input></td></tr></table>",
			 "<input type='checkbox' id='chkRestore'>&nbsp;Restore to default</input>"
			];
		UIUtility_showConfirmDialog(messages, "Set Credentials", function () {
			PostJsonWithJsonFeedbackFuncs(
					'/tasks/HostManagement_setCustomCredentials',
					true,
					{
						agentNames: selectedAgentNames,
						username: $("#txtUsername").val(),
						password: $("#txtPassword").val(),
						'delete': $("#chkRestore").prop("checked")
					},
					function (result) { },
					function (error) {
						UIUtility_showAlert(error, "Error");
					});
		});
		$("#chkRestore").click(function () {
			var isChecked = $(this).prop("checked");
			$("#txtUsername").prop("disabled", isChecked);
			$("#txtPassword").prop("disabled", isChecked);
		});
	} else {
		UIUtility_showAlert("Please select agents", "No Agents Selected");
	}
}

function HostManagement_RefreshShowOnlyLocked(showOnlyLocked) {
	$("#tblHosts > tbody > tr").each(function () {
		var row = $(this);
		if (showOnlyLocked) {
			var isUnlocked = row.find("> td:first > #imgLock").hasClass("inactive-force");
			if (isUnlocked) {
				row.addClass("inactive-secondary");
			} else {
				if (row.hasClass("inactive-secondary")) {
					row.removeClass("inactive-secondary");
				}
			}
		} else {
			if (row.hasClass("inactive-secondary")) {
				row.removeClass("inactive-secondary");
			}
		}
	});
}

function HostManagement_clearTestFromAgents() {
	// Get agent names
	var rows = HostManagement_GetSelectedAgents();
	var agentNames = [];
	for (var i = 0; i < rows.length; i++) {
		agentNames.push($(rows[i]).attr('data-id'));
	}

	UIUtility_showConfirmDialog(["Are you sure you want to clean the test from the LM?",
	                             "This will leave behind an In Progress result, since it was not aborted correctly"],
	                            "Confirm",
	                            function () {
		PostJsonWithJsonFeedbackFuncs('/tasks/clearTestFromAgents',
				true,
				{ agentNames: agentNames },
				function () { },
				function (text) {
					UIUtility_showAlert(text, "Error");
				});
	});
}

function HostManagement_ToggleHostSelection(hostCheckbox) {
	var rows = HostManagement_GetVisibleHostRows(hostCheckbox.closest("tr[data-agent-name]"));

	// Set the opposite value and then click because we need the event fired when clicking
	rows.find("[id='chkSelect']:visible").prop("checked", !hostCheckbox.prop("checked")).click();
}

function HostManagement_ClickOnRow(event) {
	// Extract target from event
	var target = $(event.target);

	// Check span case
	if (target.is("span:visible")) {
		// If we have a text selection, ignore the event (not really a click)
		if (window.getSelection() != '') {
			return;
		}

		// Go back to a column
		target = target.closest("td:visible");
	}

	if (target.is("td.click-triggers-selection:visible, tr:visible")) {
		// Ensure target is the row
		var isTd = target.is("td:visible");
		var isHostIPCol = false;
		if (isTd) {
			isHostIPCol = target.is("#tdHostIP");
			target = target.closest("tr");
		}

		// If clicked the host IP column, check all host, otherwise check specific row only
		if (isHostIPCol) {
			target = target.find("#chkSelectHost");
		} else {
			target = target.find("#chkSelect");
		}

		// Do click on the checkbox if it's visible (for selection locked rows)
		if (target.is(":visible")) {
			target.click();
		}
	}
}

function HostManagement_UpdateAgentSelectFilterValue(td) {
	var values = (td.find("#imgLock").is(":visible") ? "Locked;" : "Unlocked;");
	values += (td.find("#chkSelect").prop("checked") ? "Selected;" : "Not Selected;");
	var color = td.css('background-color');
	if (!isStringEmpty(color) && (color.indexOf("#") == 0 || color.indexOf("rgb(") == 0)) {
		var colorIndex = _markColors.indexOf(color);
		values += _markColorNames[colorIndex] + ";";
	}
	td.attr('data-filter-values', values);
}

function HostManagement_ShowPartiallyFilteredHosts() {
	// Get viewable hosts
	var viewableHosts = new Set();
	var allHosts = new Set();
	var table = $("#tblHosts");
	table.find("> tbody > tr").each(function () {
		allHosts.add($(this).find("#spanHostIP").text());
	});
	table.find("> tbody > tr:visible > #tdHostIP").each(function () {
		viewableHosts.add($(this).find("#spanHostIP").text());
	});

	// Clear all filters
	var oldFiltersInfo = table.data('filtersInfo');
	$('#tblHosts').data('filtersInfo', new Object());
	var trColumnNames = $('#tblHosts > thead > #trColumnNames');
	var filterHandler = function (filterName) {
		// Get select box only if it's visible
		var selectBox = trColumnNames.find('[id="th' + filterName + '"] > select');
		if (selectBox.length > 0) {
			selectBox.multipleSelect('setSelects', []);
		}
	};
	for (var filterName in oldFiltersInfo) {
		filterHandler(filterName);
	}

	// Set specific filters only if we're not selecting all available hosts
	// (in which case leaving the filter empty is better)
	if (viewableHosts.size < allHosts.size) {
		// Apply host filter to previously viewable hosts
		trColumnNames.find("[id='thHostIP'] > select").multipleSelect('setSelects', Array.from(viewableHosts));
	}
}

function HostManagement_AskForAgentComment() {
	var html = 'Enter comment:<br/><input type="text" id="txtHostComment" name="txtHostComment" style="width: 100%;" />';
	UIUtility_showConfirmDialog(html, "Set Comment", function () {
		HostManagement_SetAgentComment('#tblHosts', 'txtHostComment');
	});
}

function HostManagement_SetAgentComment(htmlTableSelector, htmlElementIdOfValue) {
	// Get the selected agents
	var selectedIds = [];
	var parent = $(htmlTableSelector);
	var rows = [];
	if (parent.is("table")) {
		// Get all selected
		parent.find(' tbody tr').each(function() {
			var row = $(this);
			var selected = row.find('#chkSelect').is(':checked');
			if (selected == true) {
				rows.push(row);

				// Get the current ID
				var id = $(this).attr('data-id');
				
				// Add to the list of agents
				selectedIds.push(id);
			}
		});
	} else {
		// Single row
		selectedIds.push(parent.closest("tr").attr('data-id'));
	}

	if (selectedIds.length > 0) {
		var valueAsString = parent.find('[id="' + htmlElementIdOfValue + '"]').val();

		// Send request
		PostJsonWithJsonFeedbackFuncs("/tasks/HostManagement_setAgentComment", true, {
			agentNames: selectedIds,
			comment: valueAsString
		},
		function () {
			if (parent.is("table")) {
				// In case of multiple set, we need to set the value in the fields
				for (var i = 0; i < rows.length; i++) {
					rows[i].find("#" + htmlElementIdOfValue).val(valueAsString);
				}
			}

			UIUtility_showAlert("Comment set successfully", "Set Comment");
		},
		function (error) {
			UIUtility_showAlert(error, "Error");
		});
	}
} 

function HostManagement_SetHostOrDiskSetupParameter(callingElement, setupParameterType) {
	// Get the setup parameter ID / name and setup parameter value ID / value from the calling element
	callingElement = $(callingElement);
	var setupParameterId = callingElement.attr('data-setup-parameter-id');
	var setupParameterName = callingElement.attr('data-setup-parameter-name');
	var setupParameterValueId = callingElement.find('option:selected').val();
	var setupParameterValue = callingElement.find('option:selected').text();

	// Reset selection
	callingElement.get(0).selectedIndex = 0;

	// Show dialog
	HostManagement_CheckSpecificRequirements(function () {
		// Get the table containing the calling element
		var table = callingElement.parents('table:eq(0)');
		
		// Get the table ID
		var tableId = $(table).attr('id');
		
		// Get the selected rows
		var selectedRows = getSelectedRows(table);
		
		if (selectedRows.length > 0) {

			var agentNames = [];
			var diskSerialNumbers = [];
			if (setupParameterType == 'Host') {
				// Get the host ID's from the selected rows
				agentNames = getAttributeValueFromEachRow(selectedRows, 'data-id');
			} else if (setupParameterType == 'Disk') {
				// Get the host ID's from the selected rows
				agentNames = getAttributeValueFromEachRow(selectedRows, 'data-host-id');
				
				// Get the disk ID's from the selected rows
				diskSerialNumbers = getAttributeValueFromEachRow(selectedRows, 'data-id');
			}

			// Send request
			var linkUrl = "/tasks/HostManagement_SetHostOrDiskSetupParameter";

			sendRequestUpdateUIAndActionResultSummary(undefined, linkUrl, undefined, undefined, {
				agentNames: agentNames,
				diskSerialNumbers: diskSerialNumbers,
				setupParameterType:	setupParameterType,
				setupParameterId: setupParameterId,
				setupParameterValueId: setupParameterValueId,
				setupParameterValue: setupParameterValue,
				setupParameterName: setupParameterName,
				username: getLoggedInUsername()
			});
		}
	}, 'setSetupParameterRequirements');
}

function HostManagement_showCustomHierarchyTPBuilder() {
	GetWithFeedbackFuncs('/tasks/getScenarioCategoriesTree',
		function (res) {
			// Parse tree data
			var data = JSON.parse(res);

			// Prepare dialog HTML
			var html = 'Select the tests you would like to execute:<br/>';
			html += '<div style="margin-left: 10px; margin-top: 5px;">';
			html += '<form action="javascript:return false;">';
			html += 'Search:';
			html += '<input type="search" id="txtSearchCategories" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />';
			html += '</form>';
			html += '<div id="divCategoriesTree"></div>';
			html += '</div>';
			html += '<br/>';

			// Show confirmation dialog
			UIUtility_showConfirmDialog(html, "Custom Test Plan", function () {
				// Get selected tests
				var selected = $("#divCategoriesTree").jstree().get_bottom_selected();

				// Get the selected rows with the availability status
				var selectedRowsWithStatusAsJson = HostManagement_extractSelectedRowsWithAvailabilityStatus();

				// Iterate over the selected rows to extract the agent ids
				var agentNames = new Array();
				selectedRowsWithStatusAsJson.All.forEach(function(selectedRow) {
					agentNames.push(selectedRow.attr('data-id'));
				});

				// Post to new window
				PostJsonToNewWindow('/tasks/buildDynamicTestPlanAndValidate', { agentNames: agentNames, tests: selected });
			}, "80%", "80%");

			// Initialize tree UI
			UIUtility_initializeSelectionTree(
				$("#divCategoriesTree"),
				{ core: data },
				TestPlans_CategoriesTreeSelectionChanged,
				$("#txtSearchCategories"));
		}, function (res) {
			UIUtility_showAlert(res, "Error");
		});
}

function HostsManagement_ExpandAll(id) {
	$("#tblHosts #td" + id + " .morelink:not(.less)").click();
}

function HostsManagement_CollapseAll(id) {
	$("#tblHosts #td" + id + " .less").click();
}

/** javascripts/hostsmanagement/HostsManagementRenderHelper.js **/
function HostsManagement_initializeButtons() {
	HostsManagement_initializeToggleBehaviour('btnSendTestPlan', 'ui-icon-play', 'showSendTestPlanFormEffect'	, 'HostsManagement_onSendTestPlanToggle');

	UIUtility_initializeButton('btnPrepareTestPlan', 'ui-icon-wrench');
	UIUtility_initializeButton('btnAddToTestPlan', 'ui-icon-plus');
	UIUtility_initializeButton('btnSendFastRun', 'ui-icon-seek-next');

	// Show only locked toggle
	UIUtility_initializeToggleButton('toggleShowOnlyLocked', 'ui-icon-locked');
	var textElem = $('label[for="toggleShowOnlyLocked"]').find(".ui-button-text");
	textElem.css("padding-right", "15px");
	textElem.css("padding-left", "10px");
	textElem.css("padding-top", "0px");
	textElem.css("padding-bottom", "3px");

	// Locate the buttons on the right of the toggle (combo box)
	$('#btnPrepareTestPlan').addClass("ui-margin-combo-toggle");
	$('#btnAddToTestPlan').addClass("ui-margin-combo-toggle");
}

function HostsManagement_initializeTestPlanOptions() {
	var testPlanSelect = $("#testPlanOperationOptions");
	testPlanSelect.selectmenu({
		change: function(event, data) {
			if (getValueFromElement(testPlanSelect) == "Start Test Plan") {
				$("#addToTestPlanTab").addClass("inactive");
				$("#startTestPlanTab").removeClass("inactive");
			} else if (getValueFromElement(testPlanSelect) == "Add To Execution") {
				$("#startTestPlanTab").addClass("inactive");
				$("#addToTestPlanTab").removeClass("inactive");
			} else {
				$("#startTestPlanTab").addClass("inactive");
				$("#addToTestPlanTab").addClass("inactive");
			}
		}
	});
	$("#addToTestPlanTab").addClass("inactive");
	$("#startTestPlanTab").removeClass("inactive");
}

function HostsManagement_initializeToggleBehaviour(toggleBtnId, btnIcon, divIdToToggleFor, callBack) {
	UIUtility_initializeToggleBehaviour(
			toggleBtnId, btnIcon, divIdToToggleFor, HostsManagement_toggleButtons, HostsManagement_toggleStates, callBack);
}

function HostsManagement_addNewAgentRow(agentId, agentName, virtualLabId, virtualLabName) {
	// Extract the row template
	var theTemplateRowAsHtml = $('#tblHostRowTemplate > tbody > tr').html();

	// Get first row (if exists) for later use
	var firstRow = $('#tblHosts > tbody > tr:first');

	// Add the row to the first in the table
	$('<tr>' + theTemplateRowAsHtml + '</tr>').prependTo('#tblHosts > tbody');

	// Get a reference to the row
	var theAddedRow = $('#tblHosts > tbody > tr:first');
	
	// Set the attributes of the row
	theAddedRow.attr('data-id', agentName);
	theAddedRow.attr('data-agent-id', agentId);
	theAddedRow.attr('data-agent-name', agentName);
	theAddedRow.css('cursor', 'pointer');
	theAddedRow.attr('onclick', 'HostManagement_ClickOnRow(event);');

	// Add the agent name and link
	var deviceName = extractDeviceNameFromAgentName(agentName);
	if (deviceName == "") {
		deviceName = "Host";
	}
	var agentIdHtml = '<a href="/ui/displayHostInformation/' + agentName + '" target="_blank">' + deviceName + '</a>';

	// Set HTML and filter value
	theAddedRow.find('#tdAgentId').html(agentIdHtml);

	// Build VNC/RDP URL. Default to VNC, but check first agent in table (if exists) to see what's common
	var isVNC = true;
	if (firstRow.length > 0) {
		var href = firstRow.find("#tdAgentId > a:eq(1)").attr('href');
		isVNC = (href == undefined || href.indexOf("vnc://") == 0);
	}
	var defaultUsername = getValueFromElement($("#defaultHostUsername"));
	var defaultPassword = getValueFromElement($("#defaultHostPassword"));
	var url;
	var hostIp = extractIPFromAgentName(agentName);
	if (isVNC) {
		url = "vnc://" + defaultUsername + ":" + defaultPassword + "@" + hostIp + "/";
	} else {
		url = "rdp://full%20address=s:" + hostIp + "&username=s:" + defaultUsername + "&pocketcloud%20password=s:" + defaultPassword + "/";
	}

	// Set IP
	theAddedRow.find("#tdHostIP > #spanVNC").html(
			'<a href="' + url + '" title="Remote control" style="text-decoration: none !important" class="vnc-icon"></a>');
	theAddedRow.find("#tdHostIP > #spanSSH").html('<a href="javascript:openTerminal(\'' +
			hostIp + '\', \'' + agentName + '\');" title="SSH Terminal" style="text-decoration: none !important" class="terminal-icon"></a>');
	theAddedRow.find("#tdHostIP > #spanHostIP").html(hostIp);
	theAddedRow.find("#tdHostIP").attr('data-filter-value', hostIp);

	// Add the agent's virtual lab
	var virtualLabHtml = '';
	virtualLabHtml += '<input type="hidden" id="hdnHostVirtualLabId" name="hdnHostVirtualLabId" value="' + virtualLabId + '" />';
	virtualLabHtml += '<label id="lblcolHostVirtualLabID" style="white-space: nowrap">' + virtualLabName + '</label>';
	theAddedRow.find('#tdVirtualLab').html(virtualLabHtml);
	theAddedRow.find('#tdVirtualLab').attr('data-filter-value', virtualLabName);

	// Clear the text in the new agent form
	$('#txtNewAgent').val("");

	// Prepare the table
	prepareTableFiltersExt('tblHosts', false);

	// Trigger the current view again
	var selectedView = $("#tblViews").data('selected');
	selectedView.click();
	
	theAddedRow.addClass('highlighted').each(function (i) {
        setTimeout(function (tr) {
            tr.removeClass('highlighted');
        }, 3000, $(this));
    });

	// Initialize availability tooltip
	HostManagement_initAvailabilityTooltip(theAddedRow);

	// Initialize run status tooltip
	HostManagement_initRunStatusTooltip(theAddedRow);

	// Re-apply filters for row so the row will be hidden if it should be
	FilterTable_RefreshRowAllColumns($("#tblHosts"), theAddedRow);
}

function HostsManagement_onDeleteAgentsSuccess(response) {
	$('#showDeleteAgentsFormEffect').find('#lblDeleteAgentsStatus').html('The agents were deleted successfully...');
	$('#showDeleteAgentsFormEffect').find('#lblDeleteAgentsStatus').attr('class', 'statusSuccess');
	
	// Hide the loader
	$('#showDeleteAgentsFormEffect').find('#deleteAgentsLoader').attr('class', 'inactive');
}

function HostsManagement_onDeleteAgentsFailure() {
	$('#showDeleteAgentsFormEffect').find('#lblDeleteAgentsStatus').html('Failed to delete the agents...');
	$('#showDeleteAgentsFormEffect').find('#lblDeleteAgentsStatus').attr('class', 'statusFail');
	
	// Hide the loader
	$('#showDeleteAgentsFormEffect').find('#deleteAgentsLoader').attr('class', 'inactive');
}

function HostsManagement_onLockStationsFail(response) {
	UIUtility_showAlert("Failed to lock stations");
}

function HostManagement_newAutoDeployment(id, name) {
	var elem = $("select[id='slctAutoDeployment']");
	AutocompleteCombobox_AddValue(elem, name, id);
}

function HostManagement_removeAutoDeployment(id) {
	var elem = $("select[id='slctAutoDeployment']");
	AutocompleteCombobox_RemoveValue(elem, id, true);
}

function HostManagement_initAgentActionsMenu(canConfigure, canExecute, isLabAdmin) {
	var agentActions = $("#tblAgentActions");
	var tr = agentActions.find("tr");

	// Create menu toggle
	createMenuToggle("btnAgentActions", agentActions);

	// Main (add, delete and shutdown agent)
	var td = $("<td style='vertical-align: top;'></td>");
	td.append("<div style='font-size: 14px; font-weight: bold; color: #FFAE57; margin-left: 9px;'>Main</div>");
	if (canConfigure) {
		td.append(createMenuButton("New", HostsManagement_onAddAgent)).append("<br/>");
		var deleteButton = createMenuButton("Delete", function () {
			HostManagement_CheckSpecificRequirements(HostsManagement_onDeleteAgents, 'deleteAgentRequirements');
		});
		td.append(deleteButton);
	}
	tr.append(td);

	// Lock
	td = $("<td style='vertical-align: top;'></td>");
	td.append("<div style='font-size: 14px; font-weight: bold; color: #FFAE57; margin-left: 9px;'>Lock</div>");
	var lockAgentsButton = createMenuButton("Lock Agents", function () { HostsManagement_onAgentsAction('lock', 'Lock'); });
	var unlockAgentsButton = createMenuButton("Unlock Agents", function () { HostsManagement_onAgentsAction('unlock', 'Unlock'); });
	td.append(lockAgentsButton).append("<br/>").append(unlockAgentsButton).append("<br/>");
	var lockSelectionButton = createMenuButton("Lock Selection", HostsManagement_onLockStations);
	var unlockSelectionButton = createMenuButton("Unlock Selection", HostsManagement_onUnlockStationsMultiple);
	td.append(lockSelectionButton).append("<br/>").append(unlockSelectionButton);
	tr.append(td);

	// Abort
	td = $("<td style='vertical-align: top;'></td>");
	td.append("<div style='font-size: 14px; font-weight: bold; color: #FFAE57; margin-left: 9px;'>Abort</div>");
	var abortButton = createMenuButton("Abort Agents", function () {
		HostManagement_CheckSpecificRequirements(
			function () {
				HostsManagement_onAgentsAction('abort', 'Abort');
			},
			'abortAgentRequirements');
	});
	var forceAbortButton = createMenuButton("Force Abort Agents", function () {
		HostManagement_CheckSpecificRequirements(
			function () {
				HostsManagement_onAgentsAction('force abort', 'ForceAbort');
			},
			'abortAgentRequirements');
	});
	td.append(abortButton).append("<br/>").append(forceAbortButton);
	tr.append(td);

	td = $("<td style='vertical-align: top;'></td>");
	td.append("<div style='font-size: 14px; font-weight: bold; color: #FFAE57; margin-left: 9px; margin-right: 9px;'>Mark</div>");
	for (var i = 0; i < _markColors.length; i++) {
		var button = createMenuButton("", function () {
			var agentNames = [];
			var agentRows = HostManagement_GetSelectedAgents();
			for (var j = 0; j < agentRows.length; j++) {
				agentNames.push(agentRows[j].attr('data-agent-name'));
			}
			HostManagement_sendRequestToSetUIMarkColor(agentNames, $(this).attr('data-color'));
		});
		button.unbind('mouseenter').unbind('mouseleave');
		button.css('margin-top', '3px');
		button.css('margin-bottom', '3px');
		button.css('height', '20px');
		button.css('background-color', _markColors[i] + ' !important');
		button.attr('data-color', _markColors[i]);
		td.append(button).append("<br/>");
	}
	td.append(createMenuButton("Clear", function () {
		var agentNames = [];
		var agentRows = HostManagement_GetSelectedAgents();
		for (var j = 0; j < agentRows.length; j++) {
			agentNames.push(agentRows[j].attr('data-agent-name'));
		}
		HostManagement_sendRequestToSetUIMarkColor(agentNames);
	}));
	tr.append(td);

	td = $("<td style='vertical-align: top;'></td>");
	td.append("<div style='font-size: 14px; font-weight: bold; color: #FFAE57; margin-left: 9px;'>Advanced</div>");

	// If not windows, add connectivity test
	if (!isWindows()) {
		var testConnectivityButton = createMenuButton("Test Connectivity", function () {
			UIUtility_showAlert("Please wait while performing connectivity tests ...", "Connectivity Test");
			var selectedAgentNamesAsJson = HostsManagement_populateJsonWithSelectedAgentNames();
			PostJsonWithJsonFeedbackFuncs(
					'/tasks/HostManagement_testConnectivity',
					true,
					selectedAgentNamesAsJson,
					function (data) {
						if (data.failures.length == 0) {
							UIUtility_showAlert("All hosts passed communication tests", "Success");
						} else {
							var errorMsg = "Some hosts encountered errors:<br/><ul>";
							for (var i = 0; i < data.failures.length; i++) {
								errorMsg += "<li><strong>" + data.failures[i].hostIp + "</strong> - " + data.failures[i].error + "</li>";
							}
							errorMsg += "</ul>";
							UIUtility_showAlert(errorMsg, "Error");
						}
					},
					function (text) {
						UIUtility_showAlert(text, "Error");
					});
		});
		td.append(testConnectivityButton).append("<br/>");
	}

	// View and set custom host credentials
	if (canConfigure) {
		// Credentials
		var viewCredentialsButton = createMenuButton("View Host Credentials", HostsManagement_onViewCredentials);
		var setCredentialsButton = createMenuButton("Set Host Credentials", HostsManagement_onSetCustomCredentials);
		td.append(viewCredentialsButton).append("<br/>").append(setCredentialsButton).append("<br/>");

		// Setup parameter groups
		var setSetupParameterGroupButton = createMenuButton("Set Param. Group", hostManagement_setSetupParametersGroup);
		var manageSetupParameterGroupsButton = createMenuButton("Manage Param. Groups", hostManagement_manageSetupParametersGroup);
		td.append(setSetupParameterGroupButton).append("<br/>").append(manageSetupParameterGroupsButton).append("<br/>");
	}

	if (isLabAdmin) {
		var clearTestFromAgents = createMenuButton("Clear Tests", HostManagement_clearTestFromAgents);
		td.append(clearTestFromAgents).append("<br/>");
	}

	// Search for agent
	var searchAgent = createMenuButton("Search Agent", HostManagement_searchAgent);
	td.append(searchAgent).append("<br/>");

	// Shutdown agent
	var shutdownButton = createMenuButton("Shutdown", function () { HostManagement_CheckSpecificRequirements(HostsManagement_onShutdownAgents, 'deleteAgentRequirements'); });
	td.append(shutdownButton);

	// If there's advanced, add it
	if (td.children().length > 0) {
		tr.append(td);
	}
}

function HostManagement_addPreset(name) {
	var presetButton;
	if (name == "Default") {
		presetButton = createMenuButtonWithRightAction(
			$("#tblViews #presets"),
			name,
			function () {
				HostManagement_applyPreset($("#tblViews #presets").data('presets')[$(this).text()]);
			});
	} else {
		presetButton = createMenuButtonWithRightAction(
			$("#tblViews #presets"),
			name,
			function () {
				HostManagement_applyPreset($("#tblViews #presets").data('presets')[$(this).text()]);
			},
			"ui-icon-closethick",
			function () {
				// Get containing row
				var tr = $(this).closest("tr");

				// Update presets object
				var presetsHeader = $("#tblViews #presets");
				var presets = presetsHeader.data('presets');
				delete presets[tr.find("td:eq(0)").text()];
				presetsHeader.data('presets', presets);

				// Save in DB
				updateUserData("presets", presets);

				// Remove from UI
				tr.remove();
			});

		// Ensure that the right button will be after the line at which the Default button ends, so it'll be pretty
		presetButton.find("td:eq(0)").css('min-width', '65px');
	}
	var presetsTd = $("#tblViews #presets");
	var lastHr = presetsTd.find("hr:last");
	if (lastHr.length > 0) {
		lastHr.before(presetButton);
	} else {
		presetsTd.append(presetButton);
	}
}

function HostManagement_initPresetsMenu(userPresets, agentsSelection) {
	var presets = $("#tblViews #presets");

	// We add default manually, so delete it if it was saved
	if (userPresets["Default"] != undefined) {
		delete userPresets["Default"];
	}

	// Sort preset names
	var presetNames = [];
	for (var presetName in userPresets) {
		presetNames.push(presetName);
	}
	presetNames.sort();

	// Add/replace default preset
	userPresets["Default"] = { filtersInfo: { }, selectAll: false };

	// Load user presets
	presets.data('presets', userPresets);

	// Add preset buttons
	HostManagement_addPreset("Default");
	for (var i = 0; i < presetNames.length; i++) {
		HostManagement_addPreset(presetNames[i]);
	}

	// Separate actions
	presets.append("<hr style='width: 85%;' />");

	var newPresetButton = createMenuButton("Save Preset", function () {
		var messages = [
		                "Enter a name for the preset: <input id='txtPresetName'></input>",
		                "",
		                "<input type='checkbox' id='chkSelectAllOnApplyPreset'>&nbsp;When applying preset, select all filtered agents</input>"
		               ];
		UIUtility_showConfirmDialog(messages, "New Preset", function () {
			// Get name
			var name = getValueFromElement($("#txtPresetName"));

			// Make sure there's some name
			if (isStringEmpty(name)) {
				UIUtility_showAlert("No preset name entered", "Error");
				return;
			}

			// Make sure the name is not default
			if (name == "Default") {
				UIUtility_showAlert("Default is a reserved preset name", "Error");
				return;
			}

			var selectAll = $("#chkSelectAllOnApplyPreset").prop("checked");

			var cont = function () {
				var presetsHeader = $("#tblViews #management");

				// Get view
				var selectedView = $("#tblViews").data('selected').data('view');

				// Get filters info, default to empty object and not undefined, and make sure we have a cloned copy so changes won't affect it
				var filtersInfo = $("#tblHosts").data('filtersInfo');
				if (filtersInfo == undefined) {
					filtersInfo = new Object();
				} else {
					filtersInfo = $.extend(true, new Object(), filtersInfo);
				}

				// Get current presets and add the new one
				var presets = presetsHeader.data('presets');
				if (presets == undefined) {
					presets = new Object();
				}
				var isOverride = (presets[name] != undefined);
				presets[name] = {
					view: selectedView,
					filtersInfo: filtersInfo,
					selectAll: selectAll
				};
				presetsHeader.data('presets', presets);

				// Update in DB
				updateUserData("presets", presets);

				// Add preset to UI (if not overriding an existing one)
				if (!isOverride) {
					HostManagement_addPreset(name);
				}
			};

			// Show confirmation if overriding
			var presets = $("#tblViews #management").data('presets');
			if (presets != undefined && presets[name] != undefined) {
				UIUtility_showConfirmDialog("Preset with this name already exists, override?", "Preset Exists", cont);
			} else {
				cont();
			}
		});
	});
	presets.append(newPresetButton);

	// Save/restore selection
	if (agentsSelection != undefined) {
		presets.data('selection', agentsSelection);
	}
	presets.append("<br/>");
	presets.append(createMenuButton("Save Selection", function () {
		var selections = HostManagement_extractSelectedRowsWithAvailabilityStatus();
		var selectionsArr = [];
		for (var i = 0; i < selections.All.length; i++) {
			selectionsArr.push(selections.All[i].attr('data-id'));
		}
		var obj = { selectionsArr: selectionsArr };
		$("#tblViews #presets").data('selection', obj);

		// Persist
		updateUserData("agentsSelection", obj);
	}));
	presets.append("<br/>");
	presets.append(createMenuButton("Restore Selection", function () {
		var selections = $("#tblViews #presets").data('selection');
		if (selections != undefined) {
			var tbody = $("#tblHosts > tbody");

			// Deselect all
			tbody.find("[id='chkSelect']").prop("checked", false);

			// Select what we need
			var notSelected = [];
			for (var i = 0; i < selections.selectionsArr.length; i++) {
				var id = selections.selectionsArr[i];
				var row = tbody.find("tr[data-id='" + id + "']");
				if (row.length == 0 || !row.is(":visible")) {
					notSelected.push(id);
				} else {
					row.find("#chkSelect").prop("checked", true);
				}
			}

			// Check if there was a problem selecting
			if (notSelected.length > 0) {
				var errorMsg = "Some agents were not selected because they were removed or filtered out:<ul>";
				for (var i = 0; i < notSelected.length; i++) {
					errorMsg += "<li>" + notSelected[i] + "</li>";
				}
				errorMsg += "</ul>";
				UIUtility_showAlert(errorMsg, "Error");
			}
		}
	}));
}

function HostManagement_initSearchDisksMenu() {
	var spanSearchDisks = $("#spanSearchDisks");
	createMenuToggle("btnSearchDisks", spanSearchDisks);
	spanSearchDisks.append(createMenuButton("Selected", HostsManagement_onSearchDisks));
	spanSearchDisks.append("<br/>");
	spanSearchDisks.append(createMenuButton("Visible", HostsManagement_onSearchDisksOnViewableHosts));
}

function HostManagement_applyPreset(preset) {
	// Apply view from preset
	var table = $('#tblHosts');
	if (preset.view == undefined) {
		// Default to general view
		$("#tblViews button:contains('General View')").click();
	} else {
		applyCustomView(table, preset.view, HostManagement_GetDefaultColumnSizes());
	}

	// Remove all current filters and apply filters from preset
	var oldFiltersInfo = table.data('filtersInfo');
	$('#tblHosts').data('filtersInfo', $.extend(true, { }, preset.filtersInfo));
	var trColumnNames = $('#tblHosts > thead > #trColumnNames');
	var filterHandler = function (filterName) {
		// Get select box only if it's visible
		var selectBox = trColumnNames.find('[id="th' + filterName + '"] > select');
		if (selectBox.length > 0) {
			// Look for value in select box's values
			var values = preset.filtersInfo[filterName];
			if (values == undefined) {
				// No values for this filter, set with no values
				values = [];
			}
			selectBox.multipleSelect('setSelects', values);
		}
	};
	for (var filterName in preset.filtersInfo) {
		filterHandler(filterName);
	}
	for (var filterName in oldFiltersInfo) {
		filterHandler(filterName);
	}

	// If select all was chosen, click the select all checkbox
	if (preset.selectAll) {
		var selectAllCheckbox = $("#tblHosts > thead > #trColumnNames #chkSelectAllHosts");
		if (selectAllCheckbox.prop("checked")) {
			// Already checked, less uncheck and then check again later
			selectAllCheckbox.prop("checked", false);
		}
		selectAllCheckbox.click();
	}
}

function HostManagement_renderWorkflowsMenu() {
	var workflowsDataAsJson = WorkflowsMng_getWorkflowsData();
	var workflowsTable = $("#tblWorkflows");

	// Create menu toggle
	createMenuToggle("btnSendWorkflow", workflowsTable);

	var addForCategory = function (category, showCategory) {
		// Create buttons
		var agentsButtons = [];
		var localButtons = [];
		var lmTag = "<span style='padding-left: 3px; padding-right: 3px;' class='TestStatusMatched'>LM</span> ";
		workflowsDataAsJson.workflowNames.forEach(function (name) {
			var curCategory = workflowsDataAsJson.categories[name];
			if ((!isStringEmpty(curCategory) || category != "Other") && (curCategory != category)) {
				return;
			}

			// Create button
			var workflowButton = createMenuButton((workflowsDataAsJson.isLocal[name] ? lmTag : "") + name, function () {
				var $this = $(this);
				var name = $this.attr('name');
				var isLocal = ($this.attr('data-is-local') == "true");
				var isQuick = ($this.attr('data-is-quick') == "true");
				var isEnableRunningOnInactiveHost = ($this.attr('data-run-on-inactive-host') == "true");
				HostManagement_offerUnlockAgents(function () {
					if (workflowsDataAsJson.isLocal[name]) {
						HostsManagement_onSendWorkflow(true, name, isQuick, isEnableRunningOnInactiveHost);
					} else {
						HostManagement_CheckWorkflowRequirements(name, function () {
							HostsManagement_onSendWorkflow(false, name, isQuick, isEnableRunningOnInactiveHost);
						});
					}
				}, true);
			});
			workflowButton.attr('name', name);

			// Run on inactive hosts
			workflowButton.attr('data-run-on-inactive-host', '' + workflowsDataAsJson.isEnableRunningOnInactiveHost[name]);

			// Quick
			workflowButton.attr('data-is-quick', '' + workflowsDataAsJson.isQuick[name]);
	
			// Add to correct buttons array and set local flag
			if (workflowsDataAsJson.isLocal[name]) {
				localButtons.push(workflowButton);
				workflowButton.attr('data-is-local', 'true');
			} else {
				agentsButtons.push(workflowButton);
				workflowButton.attr('data-is-local', 'false');
			}
		});

		// Agent workflows
		var header = (showCategory ? "<div style='font-size: 14px; font-weight: bold; color: #FFAE57; margin-left: 9px;'>" + category + "</div>" : "");
		var td = $("<td style='vertical-align: top;'>" + header + "</td>");
		for (var i = 0; i < agentsButtons.length; i++) {
			if (i > 0) {
				td.append("<br/>");
			}
			td.append(agentsButtons[i]);
		}

		// LM workflows
		if (localButtons.length > 0) {
			for (var i = 0; i < localButtons.length; i++) {
				if (i > 0 || agentsButtons.length > 0) {
					td.append("<br/>");
				}
				td.append(localButtons[i]);
			}
		}
		workflowsTable.find("tr:last").append(td);
	};

	// Add for all categories
	var categories = workflowsDataAsJson.allCategories;
	var tbody = workflowsTable.find("tbody");
	for (var i = 0; i < categories.length; i++) {
		// Make new row every 4 categories, so it won't be too wide
		if (i > 0 && i % 4 == 0) {
			tbody.find("tr:last > td").css('padding-bottom', '15px');
			tbody.append("<tr></tr>");
		}

		addForCategory(categories[i], true);
	}
	addForCategory("Other", categories.length > 0);
}

function HostManagement_HoverHost(hostIpTd) {
	var rows = HostManagement_GetVisibleHostRows(hostIpTd.closest("tr[data-agent-name]"));
	rows.css('background-color', '#f5f5f5 !important');
	rows.find("#tdHostIP").removeClass("cell-white-no-hover").addClass("cell-gray-hover");
}

function HostManagement_UnhoverHost(hostIpTd) {
	var rows = HostManagement_GetVisibleHostRows(hostIpTd.closest("tr[data-agent-name]"));
	rows.css('background-color', 'inherit');
	rows.find("#tdHostIP").removeClass("cell-gray-hover").addClass("cell-white-no-hover");
}

function HostManagement_GroupAgentsOfSameHost() {
	var firstHostTd = undefined;
	var lastHostIp = undefined;
	var countOfLastHost = 0;

	// Go through each visible agent row
	$("#tblHosts > tbody > tr[data-agent-name]:not(.inactive,.inactive-force)").each(function () {
		// Extract some information
		var row = $(this);
		var agentName = row.attr('data-agent-name');
		var currentHostIp = extractIPFromAgentName(agentName);
		var isSameHost = lastHostIp == currentHostIp;

		// Lets make use of this chance to make sure we have a border in the top row
		// We can't do it in CSS3 since first-child and first-of-type only work on all children
		if (firstHostTd == undefined) {
			row.css('border-top', '1px solid #000000');
		} else {
			row.css('border-top', '');
		}

		if (firstHostTd == undefined || !isSameHost) {
			// First row of a host, make sure we see it and restart counting
			firstHostTd = row.find("> td:eq(0)");
			firstHostTd.removeClass("inactive-force").attr('rowspan', 1);
			countOfLastHost = 1;
		} else {
			// We are not in the first row of this host, hide ourselves
			row.find("> td:eq(0)").addClass("inactive-force").attr('rowspan', 1);

			// Increase rowspan of first row for this host
			countOfLastHost++;
			firstHostTd.attr('rowspan', countOfLastHost);
		}

		// Update last host IP encountered
		lastHostIp = currentHostIp;
	});
}

function HostManagement_initAvailabilityTooltip(selector) {
	selector.attr('title', '');
	selector.tooltip({
		// Build content
		content: function (next) {
			var agentName = $(this).closest('tr[data-agent-name]').attr('data-agent-name');
			var inUseBy = $("#tblHosts").data('inUseBy')[agentName];
			if (inUseBy == undefined) {
				return;
			}

			prettyString = "<table class='defaultStyle'><tr><th>Type</th><th>Name</th><th>Start Time</th><th></ht></tr>";
			var isSingle = inUseBy.length == 1;
			for (var i = 0; i < inUseBy.length; i++) {
				// Check which type this is
				var isTestPlan = (inUseBy[i].type.indexOf("TP") != -1);
				var isFastRun = (inUseBy[i].type.indexOf("Fast Run") != -1);
				var isWorkflow = (inUseBy[i].type.indexOf("Workflow") != -1);

				// Create link to TP execution or workflow pages
				var link = "";
				if (isTestPlan || isFastRun) {
					link = "<a href='/ui/displayBatchManagement/" + isFastRun + "?execId=" + insertReplacers(inUseBy[i].id) + "' style='color: inherit' target='_blank'>Open</a>";
				} else if (isWorkflow) {
					link = "<a href='/tasks/DisplayWorkflowRuns?workflowRunId=" + inUseBy[i].id + "' style='color: inherit' target='_blank'>Open</a>";
				}
				lastLink = link;

				// Build row string
				prettyString += "<tr><td style='border-bottom: none;'>" + inUseBy[i].type + "</td><td style='border-bottom: none;'>" + inUseBy[i].name +
					"</td><td style='border-bottom: none;'> " + inUseBy[i].startTime + "</td><td style='border-bottom: none;'>" + link + "</td></tr>";
			}
			prettyString += "</table>";
			next(prettyString);
		},

		// No animations
		show: false,
		hide: false,

		// Position directly under element
		position: {
			my: "left top",
			at: "left bottom"
		},

		// Don't close when hovering by adding the tooltip to the target element
		open: function (event, ui) {
            $(ui.tooltip).appendTo(this);
        }
	});
}

function HostManagement_initRunStatusTooltip(selector) {
	selector.attr('title', '');
	selector.tooltip({
		// Build content
		content: function (next) {
			var td = $(this);
			var activeStatus = td.parent().find("#tdActiveStatus").text();
			var runStatus = td.text();
			if (runStatus == "Unknown") {
				// If not running a test and not active, set run status to unknown
				var runningDescription = "If the test is not performing a reboot, use the activate agent workflow to continue from this state";
				if (activeStatus == "Inactive Host") {
					runningDescription += ". If the host is no longer connected, use Agent Actions -> Clear Tests to clear the current execution."
				}
				return runningDescription;
			}
		},

		// No animations
		show: false,
		hide: false
	});
}

function HostManagement_initGroupButtons() {
	var groupButtons = $("[data-group-name]");
	if (groupButtons.length > 0) {
		UIUtility_initializeToggleButtonWithSelector(groupButtons);

		// By default, the All button should be clicked
		$("#group0").click();

		// Get toggle buttons
		var allGroups = $("[data-group-name]");
		var allButton = allGroups.filter("[data-group-name='All']");

		// Special behaviour for all toggle
		allButton.next().click(function (e) {
			// If all button is checked, don't let someone manually uncheck it
			if (allButton.prop("checked")) {
				e.preventDefault();
				e.stopPropagation();
			}
		});

		// Handle toggles
		allGroups.click(function (e) {
			var button = $(this);

			// Take care of buttons states
			var nonAllButtons = allGroups.filter("[data-group-name!='All']:checked");
			if (button.is("[data-group-name='All']")) {
				// All button, uncheck all others
				nonAllButtons.click();
			} else {
				// Specific button, make sure All is unchecked
				allGroups.filter("[data-group-name='All']:checked").click();

				// Make sure all non All buttons except this one is unchecked
				nonAllButtons.filter(function () { return !($(this).is(button)); }).click();
			}

			// If all buttons are unchecked, check the all button
			if (allGroups.filter(":checked").length == 0) {
				allButton.click();
			}

			// Refresh shown agents
			HostManagement_RefreshAgentsByResourceGroups();
		});
	}
}

function HostManagement_RefreshAgentsByResourceGroups() {
	// Extract which virtual lab IDs or resource group IDs to show
	var isAllChecked = false;
	var virtualLabIdsToShow = new Set();
	var agentsToShow = new Set();
	$("[data-group-name]").filter(":checked").each(function () {
		var $this = $(this);
		if ($this.attr('data-group-name') == "All") {
			isAllChecked = true;
		} else {
			var groupId = $this.attr('data-group-id');
			if ($this.attr('data-group-type') == "ResourceGroup") {
				var resourceGroups = $("body").data('resourceGroups');
				if (resourceGroups != undefined && resourceGroups[groupId] != undefined) {
					var agentNames = resourceGroups[groupId].agentNames;
					for (var i = 0; i < agentNames.length; i++) {
						agentsToShow.add(agentNames[i]);
					}
				}
			} else {
				var group = globalGroups[groupId];
				for (var i = 0; i < group.virtualLabIds.length; i++) {
					virtualLabIdsToShow.add(group.virtualLabIds[i]);
				}
			}
		}
	});

	var table = $("#tblHosts");
	if (isAllChecked) {
		// All is checked, show all
		table.find("> tbody > tr.inactive-force").removeClass("inactive-force");
	} else {
		// All is not checked, hide anything not in the allowed virtual labs
		table.find("> tbody > tr").each(function () {
			var row = $(this);
			var virtualLabId = row.find("#tdVirtualLab > #hdnHostVirtualLabId").val();
			if (agentsToShow.has(row.attr('data-id')) || virtualLabIdsToShow.has(parseInt(virtualLabId))) {
				row.removeClass("inactive-force");
			} else {
				row.addClass("inactive-force");
			}
		});
	}

	// Group agents of the same host
	HostManagement_GroupAgentsOfSameHost();

	// Update the table statistics
	filter_refreshNumberOfSelectedRows(table);
}

/** javascripts/hostsmanagement/HostsManagementRequestDispatcherHelper.js **/
function HostsManagement_sendRequestToAddAgents(agentNames, virtualLabId) {
	// Send the request
	pageLoading();
	var xmlhttp = PostJson('/tasks/HostsManagement_AddAgents', true, { agentNames: agentNames, virtualLabId: virtualLabId });
	xmlhttp.onreadystatechange=function() {
		if (xmlhttp.readyState == 4) {
			var status 	= false;
			var message = '';

			pageFinishedLoading();
			if (xmlhttp.status == 200) {
				
				// Extract the response and parse it to json
				var resultAsJson = JSON.parse(xmlhttp.responseText);

				// Analyze the status
				var status = resultAsJson.status;
				if (!status) {
					message = resultAsJson.errorDescription;
				}
			} else {
				status = false;
				message = xmlhttp.responseText;
			} 

			// Show error message on failure
			if (!status) {
				UIUtility_showAlert(message, "Error");
			}
		}
	}
}

function HostsManagement_sendRequestToDeleteAgents(selectedAgentNamesAsJson) {
	// The url to send the delete request
	var linkUrl = '/tasks/HostsManagement_DeleteAgents';
	var isAsync = true;

	PostJsonWithJsonFeedbackFuncs(linkUrl, isAsync, selectedAgentNamesAsJson, function () { },
			function (error) { UIUtility_showAlert("Can't delete agents: " + error, "Error"); });
}

function HostsManagement_sendRequestToShutdownAgents(selectedAgentNamesAsJson) {
	// The url to send the delete request
	var linkUrl = '/ui/HostsManagement_ShutdownAgents';
	var isAsync = true;

	PostJsonWithJsonFeedbackFuncs(linkUrl, isAsync, selectedAgentNamesAsJson, function () { },
			function (error) { UIUtility_showAlert("Can't delete agents: " + error, "Error"); });
}

function HostsManagement_sendRequestToLockStations(requestAsJson) {
	// The url to send the delete request
	var linkUrl = '/tasks/HostsManagement_LockStations';
	var isAsync = true;

	PostJsonWithJsonFeedbackFuncs(linkUrl, isAsync, requestAsJson, function () { }, function (error) { UIUtility_showAlert(error, "Error"); });
}

function HostManagement_sendRequestToModifySelectionLock(description, agentName) {
	// The url to send the delete request
	var linkUrl = '/tasks/HostsManagement_modifySelectionLockDescription';
	var isAsync = true;

	PostJsonWithJsonFeedbackFuncs(linkUrl, isAsync, { description: description, agentName: agentName },
			function () { }, function (error) { UIUtility_showAlert(error, "Error"); });
}

function HostsManagement_sendRequestToUnlockStations(requestAsJson, functionNameToInvokeOnSuccess, functionNameToInvokeOnFailure) {
	// The url to send the delete request
	var linkUrl = '/tasks/HostsManagement_UnlockStations';
	var isAsync = true;
	
	PostJsonWithJsonFeedbackFuncs(linkUrl, isAsync, requestAsJson, functionNameToInvokeOnSuccess, functionNameToInvokeOnFailure);
}

function HostManagement_performAddAgentsToTestPlan(agentNames, batchId) {
	PostJsonWithJsonFeedbackFuncs("/tasks/HostsManagement_AddAgentsToTestPlan", true,
			{ agentIds: agentNames, tpExecId: batchId },
			function (data) {
			},
			function (error) {
				UIUtility_showAlert("Can't add all agents to TP execution because: " + error, "Error");
			});
}

function HostsManagement_SendAgentsAction(agentNames, actionEnumName) {
	var link = '/tasks/PerformActionOnHosts';
	var xmlhttp = PostJson(link, true, {
		action: actionEnumName,
		agentNames: agentNames
	});
	return xmlhttp;
}

function HostManagement_InsertOrUpdateEntityCustomizedAttributes(callingElement) {
	hostManagement_InsertOrUpdateAgentCustomizedAttributes(callingElement, 'data-agent-id');
}

function hostManagement_InsertOrUpdateAgentCustomizedAttributes(callingElement, idAttrName) {
	// Get the parent cell (where all the information about the customized attribute is)
	var cell = $(callingElement).parents('th:eq(0)');

	// Get the selected rows and from them the selected agent ID's
	var table = $(cell).parents('table:eq(0)');
	var selectedRows = getSelectedRows(table);
	var agentNames = getAttributeValueFromEachRow(selectedRows, 'data-id');
	var entityIds = getAttributeValueFromEachRow(selectedRows, idAttrName);

	// Get the customized attribute information
	var entityType = $(cell).attr('data-entity-type');
	var customizedAttributeId = $(cell).attr('data-customized-attribute-id');
	var customizedAttributeName = $(cell).attr('data-customized-attribute-name');
	var multipleChoiceAsString = $(cell).attr('data-multiple-choice');
	var multipleChoice = BooleanUtilityFunctions_StringToBoolean(multipleChoiceAsString);

	if (entityIds.length == 0) {
		UIUtility_showAlert("No agents were selected", "Error");
		return;
	}

	var cont = function (customizedAttributeValueId, customizedAttributeValue) {
		// Prepare the JSON object to post 
		var jsonRequest = new Object();
		jsonRequest['entityType'] = entityType;
		jsonRequest['customizedAttributeId'] = customizedAttributeId;
		jsonRequest['customizedAttributeName'] = customizedAttributeName;
		jsonRequest['multipleChoice'] = multipleChoice;
		jsonRequest['customizedAttributeValueId'] = customizedAttributeValueId;
		jsonRequest['customizedAttributeValue'] = customizedAttributeValue;
		jsonRequest['entityIds'] = entityIds;
		jsonRequest['agentNames'] = agentNames;
		jsonRequest['username'] = getLoggedInUsername();

		// Prepare the link and post
		var link = '/tasks/CustomizedAttributes_InsertOrUpdateEntityCustomizedAttributes';
		var asynch = true;
		PostJsonWithJsonFeedbackFuncs(link, asynch, jsonRequest);
	};

	// Get the customized attribute value ID and value
	var customizedAttributeValueId = 0;
	var customizedAttributeValue = "";
	if (multipleChoice) {
		// Get the value from the select element
		var slctElementName = 'slct' + customizedAttributeName;
		var slctElement = $(cell).find('#' + slctElementName);
		customizedAttributeValueId = getValueFromElement(slctElement);
		customizedAttributeValue = getTextFromElement(slctElement).trim();
	
		$(slctElement).get(0).selectedIndex = 0;

		cont(customizedAttributeValueId, customizedAttributeValue);
	} else {
		// Ask the user for a value
		UIUtility_showConfirmDialog(
			["Attribute: " + customizedAttributeName, "Enter new value: <input id='txtCustomizedAttributeValue'></input>"],
			"Set Attribute Value",
			function () {
				var value = $("#txtCustomizedAttributeValue").val();
				cont(0, value);
			}
		);
	}
}

function HostManagement_searchAgent() {
	UIUtility_showConfirmDialog(
			["Enter agent name:<br/>", "<input id='txtSearchAgent' style='width: 90%;'></input>"],
			"Search Agent",
			function () {
				var agentName = getValueFromElement($("#txtSearchAgent"));
				GetWithFeedbackFuncs('/agents/' + agentName + "/server",
					function (res) {
						// Try parsing as JSON
						try {
							jsonResponse = JSON.parse(xmlhttp.responseText);
							var serversHtml = "<ul>";
							for (var key in jsonResponse) {
								serversHtml += "<li>" + key + ": <a href='https://" + jsonResponse[key] + ":9000/'>" + jsonResponse[key] + "</a></li>";
							}
							serversHtml += "</ul>";
							UIUtility_showAlert("Agent/s are in server/s:<br/>" + serversHtml, "Search Agent");
						} catch (ex) {
							UIUtility_showAlert("Can't parse result: " + xmlhttp.responseText);
						}
					},
					function (err) {
						UIUtility_showAlert(err, "Error");
					})
			}
		);

	// Make table larger
	$("#txtSearchAgent").closest("table").css("width", "100%");
}

function HostManagement_sendRequestToSetUIMarkColor(agentNames, color) {
	var obj = { agentNames: agentNames };
	if (color != undefined) {
		obj['color'] = color;
	}
	PostJsonWithJsonFeedbackFuncs("/ui/HostsManagement_setUIMarkColor", true, obj,
			function () { }, function (error) { UIUtility_showAlert(error, "Error"); });
}

/** javascripts/hostsmanagement/HostsManagementViews.js **/
function HostManagement_GetDefaultColumnSizes() {
	return {
		"TestStartTime": { sizeType: "custom", customSize: "130" },
		"TestDuration": { sizeType: "custom", customSize: (getShowTestDurationPercentage() ? "96" : "75") },
		"TestName": { sizeType: "custom", customSize: "300", shorten: true },
		"TestMessages": { sizeType: "custom", customSize: "450", shorten: true }
	};
}

function HostManagement_ParseViewColumnType(type) {
	if (type == "setupParameter") {
		return "Setup Parameters";
	} else if (type == "customizedAttribute") {
		return "Agent Attributes";
	} else if (type == "hostCustomizedAttribute") {
		return "Host Attributes";
	}
}

function HostManagement_ParseRawColumnName(name) {
	return replaceAll(name, "(Expand All, Collapse All)", "");
}

function HostManagement_GetParsedViewColumnName(column) {
	var id = column.id;
	var type = column.type;
	if (id == undefined) {
		return "[ " + HostManagement_ParseViewColumnType(type) + " ]";
	} else {
		var column = $("#tblHosts > thead > #trColumnNames > [id='th" + id + "']");
		var textWrapper = column.find(".text-wrapper");
		if (textWrapper.length > 0) {
			column = textWrapper;
		}
		return HostManagement_ParseRawColumnName(column.text()).trim();
	}
}

function HostManagement_PopulateAllColumnsNotInView(view) {
	// Build object with column names in view
	var columnNamesInView = new Object();
	for (var i = 0; i < view.length; i++) {
		if (view[i].id != undefined) {
			columnNamesInView[view[i].id] = true;
		} else if (view[i].type != undefined) {
			columnNamesInView[HostManagement_ParseViewColumnType(view[i].type)] = true;
		}
	}

	// Create HTML for everything except column names added
	var allColumnsHtml = "";
	var ths = $("#tblHosts #trColumnNames th[data-custom-view]").each(function () {
		var column = $(this);
		var id = column.attr('id').substring(2);
		if (columnNamesInView[id] != true) {
			var textWrapper = column.find(".text-wrapper");
			if (textWrapper.length > 0) {
				column = textWrapper;
			}
			var columnText = HostManagement_ParseRawColumnName(column.text());
			if (!isStringEmpty(columnText)) {
				allColumnsHtml += "<tr data-descriptor='{\"id\": \"" + id + "\"}'><td>" + columnText + "</td></tr>";
			}
		}
	});

	// Special treatment for column groups
	if (columnNamesInView["Setup Parameters"] != true) {
		allColumnsHtml += "<tr data-descriptor='{\"type\": \"setupParameter\"}'><td>[ Setup Parameters ]</td></tr>";
	}
	if (columnNamesInView["Agent Attributes"] != true) {
		allColumnsHtml += "<tr data-descriptor='{\"type\": \"customizedAttribute\"}'><td>[ Agent Attributes ]</td></tr>";
	}
	if (columnNamesInView["Host Attributes"] != true) {
		allColumnsHtml += "<tr data-descriptor='{\"type\": \"hostCustomizedAttribute\"}'><td>[ Host Attributes ]</td></tr>";
	}

	// Set HTML
	$("#allColumns tbody").html(allColumnsHtml);
}

function HostManagement_SelectViewColumnSize(select) {
	// Get JQuery object
	select = $(select);

	// Show/hide input as needed
	var input = select.parent().parent().find("input");
	if (getValueFromElement(select) == "custom") {
		input.removeClass("inactive");
	} else if (!input.hasClass("inactive")) {
		input.addClass("inactive");
	}
}

function HostManagement_BuildSizeTDsHTML(view) {
	// What to select initially
	var sizeType = "default";
	var customSize = "";
	var shorten = "";

	// Check if we have some value in the view
	if (view != undefined && view.sizeType != undefined) {
		var defaultColSizes = HostManagement_GetDefaultColumnSizes();
		var isDefault = false;

		// Check if value is the same as the default value
		if (defaultColSizes[view.id] != undefined && view.sizeType == defaultColSizes[view.id].sizeType) {
			if (view.sizeType == "custom") {
				isDefault = (defaultColSizes[view.id].customSize == view.customSize);
			} else {
				isDefault = true;
			}
		}
		if (isDefault) {
			if (defaultColSizes[view.id].shorten == true) {
				shorten = " checked";
			}
		} else {
			// Check if we have some value in the view
			sizeType = view.sizeType;
			if (sizeType == "custom") {
				customSize = view.customSize;
			}
			if (view.shorten == true) {
				shorten = " checked";
			}
		}
	}

	var sizeOptions = [
	                   { name: "Default", id: "default" },
	                   { name: "Small", id: "small" },
	                   { name: "Medium", id: "medium" },
	                   { name: "Large", id: "large" },
	                   { name: "Custom (px)", id: "custom" }
	                  ];
	var optionsHtml = "";
	for (var i = 0; i < sizeOptions.length; i++) {
		optionsHtml += "<option value='" + sizeOptions[i].id + "'" + (sizeOptions[i].id == sizeType ? "selected" : "") + ">" +
			sizeOptions[i].name + "</option>";
	}
	return "<td><select onchange='HostManagement_SelectViewColumnSize(this)'>" + optionsHtml + "</select></td>" +
		"<td><input type='text' style='width: 40px; margin-left: 10px; font-size: 12px' " +
		(customSize == "" ? "class='inactive'" : "") + " value='" + customSize + "'></input></td>" +
		"<td><input type='checkbox'" + shorten + "></input></td>";
}

function HostManagement_PopulateVisibleColumns(view) {
	var allColumnsHtml = "";
	for (var i = 0; i < view.length; i++) {
		var name = HostManagement_GetParsedViewColumnName(view[i]);
		if (isStringEmpty(name)) {
			// This can happen for columns which are not available for this server
			continue;
		}

		var sizeTdsHtml = HostManagement_BuildSizeTDsHTML(view[i]);
		allColumnsHtml += "<tr data-descriptor='" + JSON.stringify(view[i]) + "'>" + "<td>" + name + "</td>" + sizeTdsHtml + "</tr>";
	}
	var tbody = $("#viewableColumns tbody");
	tbody.html(allColumnsHtml);
}

function HostManagement_ExtractEditedView() {
	var columns = [];
	$("#viewableColumns > tbody > tr").each(function () {
		var row = $(this);
		var descriptor = row.attr('data-descriptor');
		if (descriptor == undefined) {
			return;
		}

		var column = JSON.parse(descriptor);

		// Get size information
		column.sizeType = getValueFromElement(row.find("select"));
		if (column.sizeType == "custom") {
			column.customSize = getValueFromElement(row.find("input[type='text']"));
		}
		column.shorten = row.find("input[type='checkbox']").prop("checked");

		columns.push(column);
	});
	return columns;
}

function HostManagement_GetViewOption(name) {
	return $("#tblViews button:contains('" + name + "')");
}

function HostManagement_SetView(name, columns) {
	var button = HostManagement_GetViewOption(name);
	button.data('view', columns);
	button.click();
	return button;
}

function HostManagement_BuildCustomizedViewsObject() {
	var customizedViews = [];
	$("#tblViews button").each(function () {
		var button = $(this);
		if (button.data('isCustomized')) {
			customizedViews.push({
				name: button.text().trim(),
				columns: button.data('view')
			});
		}
	});
	return customizedViews;
}

function HostManagement_ValidateEditedView(viewName, isCurrent) {
	// Make sure view name is not empty
	if (isStringEmpty(viewName)) {
		UIUtility_showAlert("Please enter a valid view name");
		return false;
	}

	// Make sure new views have different names than existing
	if (!isCurrent && $("#tblViews button:contains('" + viewName + "')").length > 0) {
		UIUtility_showAlert("Please enter a unique name for the view");
		return false;
	}

	// Make sure there are no overlapping groups and columns
	var columns = HostManagement_ExtractEditedView();

	var addedTypeGroups = new Object();
	var addedColumnsType = new Object();
	for (var i = 0; i < columns.length; i++) {
		if (columns[i].type != undefined) {
			// Set group type to true
			addedTypeGroups[columns[i].type] = true;
		} else {
			// Get column data type if there is any
			var dataType = $("[id='" + columns[i].id + "']").attr('data-type');
			if (!isStringEmpty(dataType)) {
				addedColumnsType[dataType] = true;
			}
		}
	}

	for (var key in addedTypeGroups) {
		if (addedColumnsType[key] != undefined) {
			UIUtility_showAlert("Can't add group column and a specific column from within that group into the same view", "Error");
			return false;
		}
	}

	return true;
}

function HostManagement_RefreshViewListsEmpty() {
	// All columns
	var allColsTbody = $("#allColumns > tbody");
	var allColsCount = allColsTbody.find("tr").length;
	if (allColsCount == 0) {
		allColsTbody.append('<tr class="emptyRow"><td class="emptyRow">- No Columns -</td></tr>');
	} else if (allColsCount > 1) {
		allColsTbody.find(".emptyRow").remove();
	}

	// Viewable columns
	var viewableColsTbody = $("#viewableColumns > tbody");
	var viewableColsCount = viewableColsTbody.find("tr").length;
	if (viewableColsCount == 0) {
		viewableColsTbody.append('<tr class="emptyRow"><td class="emptyRow">- No Columns -</td><td></td><td></td></tr>');
	} else if (viewableColsCount > 1) {
		viewableColsTbody.find(".emptyRow").remove();
	}
}

function HostManagement_EditView(isCurrent) {
	var currentView = [];
	var isCustomized = true;
	var originalView = undefined;
	var isReadOnly = false;
	var extractViewName;
	if (isCurrent) {
		var selectedView = $("#tblViews").data('selected');
		currentView = selectedView.data('view');

		// Set view name span with the current view's name
		$("#viewNameSpan").html(selectedView.text());

		isCustomized = selectedView.data('isCustomized');
		if (isCustomized == undefined) {
			isCustomized = false;
		}
		originalView = selectedView.data('originalView');
		isReadOnly = selectedView.data('isReadOnly');

		extractViewName = function () {
			return $("#viewNameSpan").text();
		};
	} else {
		// Set view name span with a text field
		$("#viewNameSpan").html("<input type='text' id='txtViewName'></input>");

		extractViewName = function () {
			return $("#txtViewName").val();
		};
	}

	HostManagement_PopulateAllColumnsNotInView(currentView);
	HostManagement_PopulateVisibleColumns(currentView);

	// Refresh empty list row visibility
	HostManagement_RefreshViewListsEmpty();

	// Lets the user drag and drop rows between tables in inside the tables
	$(".sortable").sortable({
		connectWith: ".sortable",
		helper: function (event, ui) {
			return $("<tr></tr>").append(ui.find("td:first").clone());
		},
		items: "> *:not(.emptyRow)"
	}).droppable({
		drop: function (event, ui) {
			// Remove placeholder
			var tbody = $(this);
			tbody.find(".placeholder").remove();

			// Get element to add
			var element = ui.draggable;
			if (tbody.parent().attr('id') == "allColumns") {
				// Make sure there is only one column
				var tds = element.find("td");
				for (var i = 1; i < tds.length; i++) {
					tds.eq(i).remove();
				}
			} else {
				// Make sure the size columns exist
				if (element.find("td").length == 1) {
					element.append(HostManagement_BuildSizeTDsHTML());
				}
			}

			// Append element
			element.appendTo(this);

			// Refresh empty list row visibility (right after drop completes)
			setTimeout(HostManagement_RefreshViewListsEmpty, 1);
		}
	})

	// Create buttons
	var buttons = {
		"Save For Me": function() {
			var viewName = extractViewName();

			if (!HostManagement_ValidateEditedView(viewName, isCurrent)) {
    	  		return;
    	  	}

    	  	// Close the dialog
    	  	$(this).dialog("close");

    	  	// Update browser
    	  	var columns = HostManagement_ExtractEditedView();
    	  	if (isCurrent) {
    	  		var button = HostManagement_GetViewOption(viewName);
    	  		if (button.data('isCustomized') != true) {
    	  			// New customization, set original view
    	  			button.data('originalView', {
        	  			isCustomized: false,
        	  			name: viewName,
        	  			viewId: button.data('viewId'),
        	  			isReadOnly: button.data('isReadOnly'),
        	  			columns: button.data('view')
    	    	  	});
    	  		}
    	  	} else {
    	  		HostManagement_createViewElement({ name: viewName, columns: columns });
    	  	}
	  		var button = HostManagement_SetView(viewName, columns);
	  		button.data('isCustomized', true);

    	  	// Save in user data
    	  	updateUserData("customizedViews", HostManagement_BuildCustomizedViewsObject());
        }
	}

	if (isCustomized && originalView != undefined) {
		buttons["Restore Default"] = function() {
			// Close the dialog
    	  	$(this).dialog("close");

    	  	// Update browser
    	  	var button = HostManagement_SetView(originalView.name, originalView.columns);

    	  	// Uncustomize
    	  	button.data('isCustomized', false);
    	  	button.data('viewId', originalView.viewId);
    	 	updateUserData("customizedViews", HostManagement_BuildCustomizedViewsObject());
        };
	} else if (!isReadOnly && (!isCustomized || !isCurrent)) {
		buttons["Save As Default"] = function() {
			var viewName = extractViewName();

    	  	if (!HostManagement_ValidateEditedView(viewName, isCurrent)) {
    	  		return;
    	  	}

			// Close the dialog
    	  	$(this).dialog("close");

	  		HostManagement_saveView(viewName, isCurrent);
        };
	} else if (isCurrent && !isReadOnly) {
		buttons["Delete"] = function () {
			// Close the dialog
    	  	$(this).dialog("close");

    	  	HostManagement_deleteSelectedView();
		};
	}

	buttons["Cancel"] = function() {
    	// Close the dialog
	  	$(this).dialog("close");
    };

    var dialog = $("#editViewDialog");
	dialog.dialog({
		autoOpen: false,
		height: 700,
		width: 800,
		modal: true,
		buttons: buttons
	});
	dialog.dialog("open");

	// Set dialog background as white to provide a form look
	var dialog = $("[aria-describedby='editViewDialog']");
	dialog.css('background-color', '#ffffff');
	dialog.find(".ui-widget-content").css('background-color', '#ffffff');
}

function HostManagement_initViewMenu(slctView, views) {
	var tr = slctView.find("tr");
	var td = $("<td style='vertical-align: top;'></td>");
	var viewsTd = tr.find("#views");
	viewsTd.append("<div style='font-size: 14px; font-weight: bold; color: #FFAE57; margin-left: 9px;'>Views</div>");
	tr.find("#presets").append("<div style='font-size: 14px; font-weight: bold; color: #FFAE57; margin-left: 9px;'>Presets</div>");
	tr.find("#management").append("<div style='font-size: 14px; font-weight: bold; color: #FFAE57; margin-left: 9px;'>Other</div>");

	// Load views into select box
	for (var i = 0; i < views.length; i++) {
		// Parse string view description
		views[i] = JSON.parse(views[i]);

		// Create option element and set the columns in it
		var button = HostManagement_createViewElement(views[i]);

		var isReadOnly = false;
		if (views[i].isCustomized) {
			// Customized
			button.data('isCustomized', true);

			if (views[i].originalView != undefined) {
				// Overrides a system view
				button.data('originalView', views[i].originalView);
			}
		} else {
			// Not customized
			button.data('viewId', views[i].viewId);

			if (views[i].isReadOnly) {
				isReadOnly = true;
			}
		}
		button.data('isReadOnly', isReadOnly);
	}

	// Create view options
	viewsTd.append("<hr style='width: 85%;' />");
	HostManagement_createViewMenuElement("Edit Current View", function () { HostManagement_EditView(true); }, true);
	HostManagement_createViewMenuElement("New View", function () { HostManagement_EditView(false); }, true);
}

function HostManagement_createViewMenuElement(name, action, isControlButton) {
	var button = createMenuButton(name, action);
	var tblViews = $("#tblViews");
	var elem = tblViews.find("#views");
	var lastHr = elem.find("hr:last");
	if (lastHr.length > 0 && !isControlButton) {
		lastHr.before(button);
		lastHr.before("<br />");
	} else {
		elem.append(button);
		elem.append("<br />");
	}
	return button;
}

function HostManagement_createViewElement(view) {
	var button = HostManagement_createViewMenuElement(view.name, function () {
		var button = $(this);
		$("#tblViews").data("selected", button);
		applyCustomViewFromButton(button, $("#tblHosts"), HostManagement_GetDefaultColumnSizes());
	}, false);
	button.data('view', view.columns);
	return button;
}

function HostManagement_saveView(viewName, isCurrent) {
  	// Update browser
  	var columns = HostManagement_ExtractEditedView();
  	if (!isCurrent) {
  		HostManagement_createViewElement({ name: viewName, columns: columns });
  	}
	var viewOption = HostManagement_SetView(viewName, columns);

	var json = {
		view: {
			name: viewName,
			columns: columns
		}
	};
	var viewId = viewOption.data('viewId');
	if (viewId != undefined) {
		json.viewId = viewId;
	}
	PostJsonWithJsonFeedbackFuncs('/tasks/HostManagement_insertUpdateView', true, json,
		function (result) {
			// If it's a new view, set the ID in the option (in case we're editing again)
			if (result.viewId != undefined) {
				viewOption.data('viewId', result.viewId);
			}
		},
		function (text) {
			UIUtility_showAlert(text, "Error updating default view: " + text);
		});
}

function HostManagement_deleteSelectedView() {
	var selectedView = $("#tblViews").data('selected');
	var viewId = selectedView.data('viewId');
	if (viewId == undefined) {
		// Remove view from UI
		HostManagement_removeSelectedView();

		// Update customized views for user
   	 	updateUserData("customizedViews", HostManagement_BuildCustomizedViewsObject());
	} else {
		// Send request to delete view
  		PostJsonWithJsonFeedbackFuncs('/tasks/HostManagement_deleteView', true, json,
	  			function (result) {
    	  			HostManagement_removeSelectedView();
	  			},
	  			function (text) {
	  				UIUtility_showAlert(text, "Error updating default view: " + text);
	  			});
	}
}

function HostManagement_removeSelectedView() {
	var selectedView = $("#tblViews").data('selected');
	// Remove <br /> and button
	selectedView.next().remove();
	selectedView.remove();
	var newSelected = $("#tblViews button:eq(0)");
	newSelected.click();
}

/** javascripts/hostsmanagement/HostsManagement.js **/
function sendRequestUpdateUIAndActionResultSummary(tableId, linkUrl, columnNameToUpdate, valueToSet, jsonRequest) {
	// Send the request as json if the json request is not undefined
	var xmlhttp = undefined == jsonRequest ? Post(linkUrl, true) : PostJson(linkUrl, true, JSON.stringify(jsonRequest));

	xmlhttp.onreadystatechange = function() {
  		if (xmlhttp.readyState == 4) {
			// Used to store the user message
			var userMessage = undefined;

			// Everything is ok
			if (xmlhttp.status == 200 && xmlhttp.responseText == "") {
				// Update all selected hosts
				if (undefined != tableId) {
					$('#' + tableId + ' tbody tr').each(function() {
						var selected = $(this).find('#chkSelect').is(':checked');
						var visible = $(this).is(':visible');
						if (selected && visible) {
							$(this).find('[id="' + columnNameToUpdate + '"]').text(valueToSet);

							// Check if need to trigger an event
							var funcToInvokeOnChange = $(this).find('[id="' + columnNameToUpdate + '"]').attr('invoke-on-change');

							if (!isStringEmpty(funcToInvokeOnChange)) {
								// Prepare the function
								var fn = window[funcToInvokeOnChange];

								// Call the function
								fn($(this).find('[id="' + columnNameToUpdate + '"]'), valueToSet);
							}
						}
					});
				}
			} else if (xmlhttp.status == 200) {
				// Update only hosts that appear on the list of successed hosts
				// Parse the Jason
				var json = JSON.parse(xmlhttp.responseText);
				
				// Get the successed hosts
				var successedHostsArr = json.SuccessedHostIds;
				
				// Update all selected hosts
				$('#' + tableId + ' tr').each(function() {
					var selected = $(this).find('#chkSelect').is(':checked');
					var visible = $(this).is(':visible');
					if (selected && visible) {
						// Get the host ID
						var hostID = $(this).attr('data-id');
						
						// If this is in the list - update it
						if ($.inArray(hostID, successedHostsArr) > -1) {
							$(this).find('[id="' + columnNameToUpdate + '"]').text(valueToSet);
							
							// Check if need to trigger an event
							var funcToInvokeOnChange = $(this).find('[id="' + columnNameToUpdate + '"]').attr('invoke-on-change');

							if (!isStringEmpty(funcToInvokeOnChange)) {
								// Prepare the function
								var fn = window[funcToInvokeOnChange];

								// Call the function
								fn($(this).find('[id="' + columnNameToUpdate + '"]'), valueToSet);
							}
						}
					}
				});

				// Get the failed hosts
				var failedHostsArr = json.FailedHostIds;

				// Build the user message
				errorMessage = json.ErrorMessage;
				// Convert the list of failed host to one string
				var failedHostsAsString = "";
				for (var i = 0; i < failedHostsArr.length; i++) {
					failedHostsAsString += failedHostsArr[i] + "; "
				}
				
				userMessage = errorMessage + ": " + failedHostsAsString;
			} else  {
				// Get the error description and don't update anything
				userMessage = xmlhttp.responseText;
			}

			if (userMessage != undefined) {
				UIUtility_showAlert(userMessage, "Error");
			}
	   	}
  	}
}

/**
 * Function which determine how to render the host
 * according to its lock status
**/
function HostManagement_DetermineStationLockStatus(hostImg) {
	hostImg = $(hostImg);
	var isLocked = hostImg.attr("locked");

	// If host is unlocked
	if (isLocked == "false") {
		// Mark row as white
		hostImg.closest('tr').css('background','none');

		// Hide the lock icon
		hostImg.addClass("inactive-force");

		// Show the checkbox
		hostImg.closest('tr').find('#chkSelect').removeClass("inactive");
	} else {
		// Set the icon path
		hostImg.attr("src", $('#unlockIconPath').val());

		var username = getLoggedInUsername();
		if (isStringEmpty(username) || $(hostImg).attr('enableToUser') != username) {
			// Mark row as gray (locked) if not enabled for this user
			hostImg.closest('tr').css('background',' -webkit-linear-gradient(top, #F2F2F2, #D2D2D2)');	

			// Hide checkbox if not enabled for this user
			hostImg.closest('tr').find('#chkSelect').addClass("inactive").attr("checked", false);
		}

		// Show the lock icon
		hostImg.removeClass("inactive-force");
	}
}

function HostsManagement_RequestLockHosts()
{
	HostManagement_CloseActionResultSpan();

	// Show the dialog
	$("#lockStationDialog").dialog("open");
}

function onHostsManagementHostCommentClicked(tdHostComment)
{
	$(tdHostComment).closest('td').find('#btnSaveComment').attr('class', 'ui-button ui-widget ui-state-default ui-corner-all');
}

function onPostSaveHostComment(btnSaveHostComment)
{
	$(btnSaveHostComment).attr('class', 'inactive');
}

function HostsManagement_findAgentInDetailsJson(agentsJson, agentName) {
	for (testPlanName in agentsJson) {
		var arr = agentsJson[testPlanName];
		for (i = 0; i < arr.length; i++) {
			if (arr[i].name == agentName) {
				return { testPlanName: testPlanName, value: arr[i] };
			}
		}
	}
	return undefined;
}

function HostManagement_SetHostDiskSetupParameterMockup(callingElement) {
	// Extract the value from the calling element
	var callingElementVal = getValueFromElement($(callingElement));
	
	// Get the table containing the calling element
	var table = $(callingElement).parents('table:eq(0)');
	
	// Get the selected rows
	var selectedRows = getSelectedRows(table);
	
	// Extract the setup parameter name
	var setupParameterName = $(callingElement).attr('data-setup-parameter-name');
	
	// Iterate over the selected rows
	selectedRows.forEach(function(selectedRow) {
		$(selectedRow).find('#td' + setupParameterName).text(callingElementVal);
	});
}

function HostManagement_fillTD(row, tdName, value) {
	if (value != undefined) {
		var td = row.find("#" + tdName);
		if (td != undefined) {
			td.text(value);
		}
	}
}

function HostManagement_populateNewRow(agentName) {
	var xmlhttp = Post("/tasks/HostManagement_loadHostInfo/" + agentName, true);
	xmlhttp.onreadystatechange = function () {
  		if (xmlhttp.readyState == 4) {
			if (xmlhttp.status == 200) {
				var result = JSON.parse(xmlhttp.responseText);
				var row = $("#tblHosts").find("tbody tr[data-id='" + agentName + "']");
				HostManagement_fillTD(row, "hdnHostVirtualLabId", result["VirtualLabId"]);
				HostManagement_fillTD(row, "lblcolHostVirtualLabID", result["VirtualLabName"]);
				HostManagement_fillTD(row, "tdAgentActivationTime", result["ActivationTime"]);
				HostManagement_fillTD(row, "tdComment", result["Comment"]);
				for (key in result.setupParameters) {
					HostManagement_fillTD(row, "td" + key, result.setupParameters[key]);
				}
				for (key in result.agentCustomizedAttributes) {
					HostManagement_fillTD(row, "td" + key, result.agentCustomizedAttributes[key]);
				}
				for (key in result.hostCustomizedAttributes) {
					HostManagement_fillTD(row, "td" + key, result.hostCustomizedAttributes[key]);
				}

				// Prepare filters
				prepareTableFiltersExt('tblHosts', false);

				// Required to show new TDs and hide irrelevant ones
				var selectedView = $("#tblViews").data('selected');
				selectedView.click();

				HostManagement_GroupAgentsOfSameHost();
			}
  		}
	};
}

function HostsManagement_RemoveClassesByPrefix(elem, classPrefix) {
	var cls = elem.attr("class");
	if (cls != null) {
		var classes = cls.split(" ");
		for (var i = 0; i < classes.length; i++) {
			if (classes[i].indexOf(classPrefix) == 0) {
				elem.removeClass(classes[i]);
			}
		}
	}
}

/**
 * Generic method for changing a cell's value and managing filtering throughout it.
 */
function HostsManagement_SetCellValue(theAgentRow, columnName, value, optionalSetClassPrefix, optionalChangedColumns, optionalCallback) {
	if (value == undefined) {
		return;
	}

	var td = theAgentRow.find('#td' + columnName);
	if (td.length == 0) {
		return;
	}

	// If shorten, get all content to compare with
	var isShorten = td.hasClass("shortened");
	var currentValue = undefined;
	if (isShorten) {
		var allContent = td.find(".allcontent");
		if (allContent.length == 0) {
			currentValue = td.find("#shortenSpan").html();
		} else {
			currentValue = allContent.html();
		}
	}

	if (currentValue == undefined) {
		// Default to the HTML value of the column
		currentValue = td.html();
	}

	// If there's a tooltip, remove the HTML of it (assuming it's in the end)
	var tooltipIndex = currentValue.indexOf("<div role=\"tooltip\"");
	if (tooltipIndex != -1) {
		currentValue = currentValue.substring(0, tooltipIndex);
	}

	// Trim in any case
	currentValue = currentValue.trim();

	if (currentValue != value) {
		// Wrap value with shorten span
		if (isShorten) {
			value = "<span id=\"shortenSpan\">" + value + "</span>";
		}

		// Set new value
		td.html(value);

		if (optionalSetClassPrefix != undefined) {
			// Remove only classes with the given prefix
			HostsManagement_RemoveClassesByPrefix(td, optionalSetClassPrefix);

			// Add new class
			td.addClass(optionalSetClassPrefix + replaceAll(value, " ", ""));
		}

		if (isShorten) {
			var previousShortenExpanded = (isShorten && td.find("#shortenSpan").data('lastShortenStateExpanded') == true);

			// Make sure a shorten span exists and perform shorten
			var shortenSpan = td.find("#shortenSpan");
			shortenSpan.shorten({
				onMore: function (elem) {
					elem.data('lastShortenStateExpanded', true);
				},
				onLess: function (elem) {
					elem.data('lastShortenStateExpanded', false);
				}
			});
			shortenSpan.data('lastShortenStateExpanded', previousShortenExpanded);

			// Expand if was expanded before
			var moreLink = td.find(".morelink");
			if (previousShortenExpanded && td.find(".less").length == 0 && moreLink.length > 0) {
				moreLink.click();
			}
		}

		if (optionalChangedColumns != undefined) {
			optionalChangedColumns.push(columnName);
		}
	}

	if (optionalCallback != undefined) {
		optionalCallback(td);
	}
}

/**
 * Updates agent related fields.
 */
function HostManagement_agentUpdateHandler(data) {
	// Ignore anything related to 127.0.0.1 (lab manager workflows)
	if (data.id == "127.0.0.1" || data.id.indexOf("127.0.0.1:") == 0) {
		return;
	}

	// Extract the relevant row from the table
	var tblHosts = $('#tblHosts');
	var theAgentRow = tblHosts.find('> tbody > tr[data-id="' + data.id + '"]');
	if (theAgentRow.length == 0) {
		var virtualLabSelector = $("#addAgentTemplate #slctVirtualLab");
		var virtualLabId = -1;
		virtualLabSelector.find("option").each(function () {
			var option = $(this);
			if (option.text().trim() == data.VIRTUAL_LAB) {
				virtualLabId = option.attr('value');
			}
		});
		HostsManagement_addNewAgentRow(data.AGENT_INTERNAL_ID, data.id, virtualLabId, data.VIRTUAL_LAB);
		theAgentRow = tblHosts.find('tbody > tr[data-id="' + data.id + '"]');
		HostManagement_populateNewRow(data.id);
	}

	// Remove agent when needed
	if (data.ENTITY_EXISTANCE === null) {
		theAgentRow.remove();
		prepareTableFiltersExt('tblHosts', false);
		HostManagement_GroupAgentsOfSameHost();
		return;
	}

	var changedColumnNames = [];

	// If locked, set test status as locked. If was changed back to unlocked,
	// request all other data (for test status update) and do nothing until then
	if (data.LOCK_STATUS != undefined) {
		if (data.LOCK_STATUS != "Unlocked") {
			data.AVAILABILITY_STATUS = data.LOCK_STATUS;
		}
	}

	// Active status
	var activeStatus = data.ACTIVE_STATUS;
	if (data.ACTIVE_STATUS == "Inactive Agent") {
		activeStatus = "No Agent";
	}
	if (data.ACTIVE_STATUS == "Inactive Host") {
		activeStatus = "No Ping";
	}
	HostsManagement_SetCellValue(theAgentRow, "ActiveStatus", activeStatus, undefined, changedColumnNames, function (td) {
		// Set class
		HostsManagement_RemoveClassesByPrefix(td, "HostStatus");
		if (data.ACTIVE_STATUS == "Inactive Host" && data.HOST_UNREACHABLE_FOR_A_LONG_TIME == true) {
			td.addClass("HostStatusInactiveHostLongTime");
		} else {
			td.addClass("HostStatus" + replaceAll(data.ACTIVE_STATUS, " ", ""));
		}
	});

	// Run status. Initialize to undefined so we won't update the field for every update
	var runStatus = undefined;
	var runStatusClass = undefined;
	if (data.ACTIVE_STATUS != undefined) {
		// Workflow (detect using in use by because we don't want to switch between workflow/not running between steps)
		var isWorkflow = false;
		if (data.IN_USE_BY != undefined) {
			for (var i = 0; i < data.IN_USE_BY.length; i++) {
				if (data.IN_USE_BY[i].type.indexOf("Workflow") != -1) {
					isWorkflow = true;
					break;
				}
			}
		}
		if (isWorkflow) {
			runStatus = "Workflow";
			runStatusClass = "RunStatusRunningWorkflow";
		} else if (data.CURRENT_EXECUTING_TEST_ID != undefined) {
			// Test
			if (data.LAST_REPORTED_TEST_STATUS == "In Progress") {
				runStatus = "Running";
				runStatusClass = "RunStatusRunningTest";
			} else if (data.LAST_REPORTED_TEST_STATUS == "Stuck") {
				runStatus = "Stuck";
				runStatusClass = "RunStatusStuck";
			} else {
				runStatus = "Not Running";
				runStatusClass = "RunStatusNotRunning";
			}
		} else {
			runStatus = "Not Running";
			runStatusClass = "RunStatusNotRunning";
		}
		if ((runStatus == "Running" || runStatus == "Stuck") && data.ACTIVE_STATUS != "Active") {
			// If not running a test and not active, set run status to unknown
			runStatus = "Unknown";
			runStatusClass = "RunStatusUnknown";
		}
	}
	HostsManagement_SetCellValue(theAgentRow, "RunStatus", runStatus, undefined, changedColumnNames,
			function (td) {
				// Replace class
				HostsManagement_RemoveClassesByPrefix(td, "RunStatus");
				if (runStatusClass != undefined) {
					td.addClass(runStatusClass);
				}
			});

	// If availability changes, assume we have IN_USE_BY and update it in the global object
	if (data.AVAILABILITY_STATUS != undefined) {
		var inUseByObj = $("#tblHosts").data('inUseBy');
		if (inUseByObj == undefined) {
			inUseByObj = new Object();
		}
		inUseByObj[data.id] = data.IN_USE_BY;
		$("#tblHosts").data('inUseBy', inUseByObj);
	}

	var availStatusToSet = data.AVAILABILITY_STATUS;
	if (data.AVAILABILITY_STATUS == "In Use" || data.AVAILABILITY_STATUS == "Idle") {
		// Set link if in use by a single entity
		if (data.IN_USE_BY != undefined && data.IN_USE_BY.length == 1) {
			// Check which type this is
			var isTestPlan = (data.IN_USE_BY[0].type.indexOf("TP") != -1);
			var isFastRun = (data.IN_USE_BY[0].type.indexOf("Fast Run") != -1);
			var isWorkflow = (data.IN_USE_BY[0].type.indexOf("Workflow") != -1);

			// Create link to TP execution or workflow pages
			var link = "";
			if (isTestPlan || isFastRun) {
				link = "<a href=\"/ui/displayBatchManagement/" + isFastRun + "?execId=" + insertReplacers(data.IN_USE_BY[0].id) +
						"\" style=\"color: inherit\" target=\"_blank\">" + availStatusToSet + "</a>";
			} else if (isWorkflow) {
				link = "<a href=\"/tasks/DisplayWorkflowRuns?workflowRunId=" + data.IN_USE_BY[0].id +
						"\" style=\"color: inherit\" target=\"_blank\">" + availStatusToSet + "</a>";
			}

			availStatusToSet = link;
		}
	}
	HostsManagement_SetCellValue(theAgentRow, "AgentAvailabilityStatus", availStatusToSet, undefined, changedColumnNames,
			function (td) {
				HostsManagement_RemoveClassesByPrefix(td, "HostStatus");
				if (data.AVAILABILITY_STATUS == "Locked (User)") {
					td.addClass("HostStatusLockedByUser");
				} else if (data.AVAILABILITY_STATUS == "Locked (LM)") {
					td.addClass("HostStatusLockedByLabManager");
				} else if (data.AVAILABILITY_STATUS == "Locked (WF)") {
					td.addClass("HostStatusLockedByWorkflow");
				} else {
					td.addClass("HostStatus" + replaceAll(data.AVAILABILITY_STATUS, " ", ""));
				}
			});

	// Infinity pending tests
	data.PENDING_TESTS_COUNT = (data.PARTICIPATES_IN_ENDLESS_TP_EXEC == true ? "&infin;" : data.PENDING_TESTS_COUNT);

	// Empty start time if empty
	if (data.LAST_REPORTED_TEST_START_TIME != undefined && data.LAST_REPORTED_TEST_START_TIME.indexOf("01/01/1970") == 0) {
		data.LAST_REPORTED_TEST_START_TIME = "N/A";
	}

	// Empty duration for in queue
	if (data.LAST_REPORTED_TEST_STATUS == "In Queue") {
		data.LAST_REPORTED_TEST_DURATION = "N/A";
		data.LAST_REPORTED_TEST_STATUS = "N/A";
	}

	var testStatusHtml = data.LAST_REPORTED_TEST_STATUS;
	if (testStatusHtml != "N/A" && !isStringEmpty(testStatusHtml)) {
		var url = createTestLogURL(data.id, data.LAST_REPORTED_TEST_ID, data.LAST_REPORTED_TEST_NAME, !isStringEmpty(data.LAST_REPORTED_TEST_RUNNER_LOG_PATH));
		testStatusHtml = "<a href='" + url + "' style=\"color: inherit\" target=\"_blank\">" + testStatusHtml + "</a>";
	}
	HostsManagement_SetCellValue(theAgentRow, "TestStatus", testStatusHtml, undefined, changedColumnNames, function (td) {
		HostsManagement_RemoveClassesByPrefix(td, "TestStatus");
		td.addClass("TestStatus" + replaceAll(td.text().trim(), " ", "")); 
	});

	HostsManagement_SetCellValue(theAgentRow, "PendingTests", data.PENDING_TESTS_COUNT);
	HostsManagement_SetCellValue(theAgentRow, "RetriableTests", data.RETRIABLE_TESTS_COUNT);
	HostsManagement_SetCellValue(theAgentRow, "TestStartTime", data.LAST_REPORTED_TEST_START_TIME);
	HostsManagement_SetCellValue(theAgentRow, "TestDuration", data.LAST_REPORTED_TEST_DURATION);

	// Test name
	if (data.LAST_REPORTED_TEST_NAME == "") {
		data.LAST_REPORTED_TEST_NAME = "N/A";
	}
	HostsManagement_SetCellValue(theAgentRow, "TestName", data.LAST_REPORTED_TEST_NAME, undefined, changedColumnNames);
	theAgentRow.find("#tdTestName").attr('data-filter-value', data.LAST_REPORTED_TEST_NAME);

	// Messages
	if (data.LAST_REPORTED_TEST_MESSAGES != undefined) {
		HostsManagement_SetCellValue(theAgentRow, "TestMessages", data.LAST_REPORTED_TEST_MESSAGES, undefined, undefined, function (td) {
			td.attr('data-filter-value', getMessageSearchableString(data.LAST_REPORTED_TEST_MESSAGES));
		});
	}

	// Workflow information
	if (data.LAST_WORKFLOW_STEP_NAME != undefined) {
		var viewLogAction = "javascript: WorkflowsMonitoring_viewLog('" + data.id + "', " + data.LAST_WORKFLOW_RUN_ID + ", " + data.LAST_WORKFLOW_STEP_ID +
				", '" + data.LAST_WORKFLOW_STEP_NAME + "');";
		HostsManagement_SetCellValue(
				theAgentRow,
				"WorkflowStepName",
				"<a href=\"" + viewLogAction + "\" target=\"_blank\" style=\"color: inherit\">" + data.LAST_WORKFLOW_STEP_NAME + "</a>",
				undefined,
				undefined,
				function (td) {
					HostsManagement_RemoveClassesByPrefix(td, "WorkflowStatus");
					td.addClass("WorkflowStatus" + replaceAll(data.LAST_WORKFLOW_STEP_STATE, " ", "").toUpperCase());
				});
		HostsManagement_SetCellValue(
				theAgentRow,
				"LastWorkflow",
				"<a href=\"/tasks/DisplayWorkflowRuns?workflowRunId=" + data.LAST_WORKFLOW_RUN_ID + "\" target=\"_blank\" style=\"color: inherit\">" + data.LAST_WORKFLOW_NAME + "</a>",
				undefined,
				undefined,
				function (td) {
					HostsManagement_RemoveClassesByPrefix(td, "WorkflowStatus");
					td.addClass("WorkflowStatus" + replaceAll(data.LAST_WORKFLOW_STATE, " ", "").toUpperCase());
					td.attr('data-filter-value', data.LAST_WORKFLOW_NAME + " (" + data.LAST_WORKFLOW_STATE + ")");
				});

		// Set start time
		HostsManagement_SetCellValue(theAgentRow, "WorkflowStepStartTime", data.LAST_WORKFLOW_STEP_START_TIME);

		// Set last exit reason
		HostsManagement_SetCellValue(theAgentRow, "WorkflowStepExitReason", data.LAST_WORKFLOW_STEP_EXIT_REASON);

		// Duration is zero at the beginning
		if (data.LAST_WORKFLOW_STEP_DURATION == undefined && data.LAST_WORKFLOW_STEP_STATE == "In Progress") {
			data.LAST_WORKFLOW_STEP_DURATION = "00:00:00";
		}

		// Set user
		HostsManagement_SetCellValue(theAgentRow, "WorkflowUser", data.LAST_WORKFLOW_USER);
	}

	// Workflow step duration
	HostsManagement_SetCellValue(theAgentRow, "WorkflowStepDuration", data.LAST_WORKFLOW_STEP_DURATION);

	// Selection lock
	if (data.IS_SELECTION_LOCKED == true) {
		// Refresh always because lock details can change
		var theImgObj = theAgentRow.find('#imgLock');
		theImgObj.attr('locked', 'true');
		theImgObj.attr('title', data.SELECTION_LOCK_DESCRIPTION);
		theImgObj.attr('lockDescription', data.SELECTION_LOCK_DESCRIPTION);
		var username = getLoggedInUsername();
		if (isStringEmpty(username) || username != data.SELECTION_LOCK_OWNER || !data.IS_SELECTION_LOCK_ENABLED_TO_OWNER) {
			username = '';
		}
		theImgObj.attr('enableToUser', username);
		HostManagement_DetermineStationLockStatus(theImgObj);

		HostManagement_UpdateAgentSelectFilterValue(theAgentRow.find("#tdSelect"));
		changedColumnNames.push("Select");

		// This needs to be done because filter might not change in this case, but counters might
		filter_refreshNumberOfSelectedRows(tblHosts);
	} else if (data.IS_SELECTION_LOCKED == false) {
		var theImgObj = theAgentRow.find('#imgLock');
		if (theImgObj.attr("locked")) {
			theImgObj.attr('locked', 'false');
			theImgObj.removeAttr('title');
			theImgObj.attr('enableToUser', '');
			HostManagement_DetermineStationLockStatus(theImgObj);
		}

		HostManagement_UpdateAgentSelectFilterValue(theAgentRow.find("#tdSelect"));
		changedColumnNames.push("Select");

		// This needs to be done because filter might not change in this case, but counters might
		filter_refreshNumberOfSelectedRows(tblHosts);
	}

	// Activation time
	HostsManagement_SetCellValue(theAgentRow, "AgentActivationTime", data.ACTIVATION_TIME);

	// UI mark
	if (data.UI_MARK_COLOR === null) {
		theAgentRow.find("#tdSelect, #tdAgentId").css('background-color', 'inherit');
		HostManagement_UpdateAgentSelectFilterValue(theAgentRow.find("#tdSelect"));
	} else if (data.UI_MARK_COLOR != undefined) {
		theAgentRow.find("#tdSelect, #tdAgentId").css('background-color', data.UI_MARK_COLOR);
		HostManagement_UpdateAgentSelectFilterValue(theAgentRow.find("#tdSelect"));
	}

	// Refresh row in filter
	for (var i = 0; i < changedColumnNames.length; i++) {
		FilterTable_RefreshRow(tblHosts, changedColumnNames[i], theAgentRow);
	}
}

function HostManagement_attributeUpdateHandler(data) {
	// Agent / host attribute
	if (data.ENTITY_TYPE == "Agent" || data.ENTITY_TYPE == "Host") {
		// Look for attribute row
		var query;
		var parsedId = WebSockets_ParseGenericIdentifier(data.id);
		if (data.ENTITY_TYPE == "Host") {
			query = "data-id^='" + parsedId[0] + "'";
		} else if (data.ATTRIBUTE_TYPE == "CUSTOMIZED_ATTRIBUTE") {
			query = "data-agent-id='" + parsedId[0] + "'";
		} else {
			query = "data-id='" + parsedId[0] + "'";
		}
		var row = $("tr[" + query + "]");

		if (row != undefined && row.length > 0) {
			// Look for attribute column
			var td = row.find("[id='td" + data.ATTRIBUTE_NAME + "']");
			if (td != undefined && td.length > 0) {
				// Set value if there's a change (avoid rendering for nothing)
				if (td.text() != data.ATTRIBUTE_VALUE) {
					td.html(data.ATTRIBUTE_VALUE);
				}
			}
		}
	} else if (data.ENTITY_TYPE == "Device") {
		// Device attribute
		var parsedId = WebSockets_ParseGenericIdentifier(data.id);
		$("#tblDisks > tbody > tr[id='" + parsedId[0] + "'] > #td" + data.ATTRIBUTE_NAME).html(data.ATTRIBUTE_VALUE);
	}
}

function HostManagement_resourceGroupUpdateHandler(data) {
	var allGroup = $("input[data-group-name='All']");

	// Check if we have no groups to filter by
	if (allGroup.length == 0) {
		return;
	}

	// Only agent names updates are relevant
	if (data.AGENT_NAMES == undefined) {
		return;
	}

	// Update in data
	var $body = $("body");
	var resourceGroups = $body.data('resourceGroups');
	if (resourceGroups == undefined) {
		resourceGroups = new Object();
		$body.data('resourceGroups', resourceGroups);
	}
	resourceGroups[data.id] = { agentNames: data.AGENT_NAMES };

	// Refresh groups if not all is selected
	if (!(allGroup.prop("checked"))) {
		HostManagement_RefreshAgentsByResourceGroups();
	}
}

/**
 * Registers to receive updates about known agents.
 */
function HostManagement_registerAgents(socket, requestAllData) {
	WebSockets_ConnectFields(socket, [ "LAST_REPORTED_TEST_NAME", "LAST_REPORTED_TEST_STATUS", "LAST_WORKFLOW_STEP_STATE", "LAST_WORKFLOW_STATE", "ACTIVE_STATUS", "HOST_UNREACHABLE_FOR_A_LONG_TIME",
	                                   "LAST_WORKFLOW_NAME", "LAST_WORKFLOW_USER", "LAST_WORKFLOW_RUN_ID", "LAST_WORKFLOW_STEP_NAME", "LAST_WORKFLOW_STEP_ID", "LAST_WORKFLOW_STEP_EXIT_REASON",
	                                   "AVAILABILITY_STATUS", "LOCK_STATUS", "IN_USE_BY", "CURRENT_EXECUTING_TP_EXEC_ID", "CURRENT_EXECUTING_TP_EXEC_NAME",
	                                   "CURRENT_EXECUTING_TEST_ID", "LAST_REPORTED_TEST_ID", "LAST_REPORTED_TEST_RUNNER_LOG_PATH" ]);
	WebSockets_ConnectFields(socket, [ "PENDING_TESTS_COUNT", "PARTICIPATES_IN_ENDLESS_TP_EXEC" ]);
	WebSockets_ConnectFields(socket, [ "IS_SELECTION_LOCKED", "SELECTION_LOCK_OWNER", "SELECTION_LOCK_DESCRIPTION", "IS_SELECTION_LOCK_ENABLED_TO_OWNER" ]);
	WebSockets_ObserveEntities(socket, "AGENT", "*", 0, HostManagement_agentUpdateHandler, requestAllData);
}

function HostManagement_registerEntityAttributes(socket, requestAllData) {
	WebSockets_ConnectFields(socket, [ "ENTITY_TYPE", "ATTRIBUTE_NAME", "ATTRIBUTE_VALUE", "ATTRIBUTE_TYPE"]);

	// Only get updates in case of LMM, retrieve all data now because it won't be in DB
	WebSockets_ObserveEntities(socket, "ENTITY_ATTRIBUTE", "*", 0, HostManagement_attributeUpdateHandler, isLMM() || requestAllData);
}

function HostManagement_registerResourceGroup(socket, requestAllData) {
	WebSockets_ObserveEntities(socket, "RESOURCE_GROUP", "*", 0, HostManagement_resourceGroupUpdateHandler, requestAllData);
}

/**
 * Initializes a generic websocket for the page and registers to all agents.
 */
function HostManagement_initWebSocket() {
	var body = $("body");
	var socket = body.data("socket");
	if (socket == undefined) {
		socket = WebSockets_Open(function (event) {
			var timestamp = getDataTimestamp();
			var requestAllData = (timestamp == undefined);
			HostManagement_registerAgents(socket, requestAllData);
			HostManagement_registerEntityAttributes(socket, requestAllData);
			HostManagement_registerResourceGroup(socket, true);

			// Request data since the timestamp, but only if it's the first connection since the page opened
			if (!requestAllData) {
				WebSockets_RequestDataSinceTimestamp(socket, timestamp);
				getDataTimestamp = function () {
					return undefined;
				};
			}
		});
		body.data("socket", socket);
	}
	return socket;
}

/**
 * Generates the requirements of different actions according to configuration (closed loop/non closed loop).
 */
function HostManagement_GenerateRequirements() {
	var testPlanRequirements;
	var workflowRequirements;
	var fastRunRequirements;
	var ignoreAvailabilityRequirements = {
			ActiveStatus: "Active,No Agent",
			InUseBy: "TestPlan,FastRun",
			error: "Only unlocked active hosts which are not executing a workflow are allowed to run with no availability checks."
	};
	var ignoreAvailabilityRequirementsAndAllowInactiveHosts = {
			InUseBy: "TestPlan,FastRun",
			error: "Only unlocked active hosts which are not executing a workflow are allowed to run with no availability checks."
	};
	var deleteAgentRequirements = {
			InUseBy: "TestPlan,FastRun",
			error: "Only agents not in use by a workflow can be deleted."
		};
	var abortAgentRequirements = {
			ActiveStatus: "Active",
			error: "Only active agents are allowed to be aborted."
	};
	var setSetupParameterRequirements = { };

	if (allowMultipleTPExecs()) {
		testPlanRequirements = {
				ActiveStatus: "Active,No Agent",
				InUseBy: "TestPlan,FastRun",
				AgentAvailabilityStatus: "Free,Idle,In Use",
				error: "Only unlocked active hosts are allowed to run a test plan."
			};
	} else {
		testPlanRequirements = {
				ActiveStatus: "Active,No Agent",
				AgentAvailabilityStatus: "Free",
				error: "Only free and active hosts are allowed to run a test plan."
		};
	}

	workflowRequirements = {
			ActiveStatus: "Active,No Agent",
			AgentAvailabilityStatus: "Free",
			allowNoAgents: true,
			error: "Only free and active hosts are allowed to run a workflow."
		};

	if (isClosedLoop()) {
		fastRunRequirements = {
				ActiveStatus: "Active,No Agent",
				InUseBy: "FastRun",
				AgentAvailabilityStatus: "Free,Idle,In Use",
				error: "Only active hosts which aren't executing a workflow are allowed to run a fast run."
			};
		setSetupParameterRequirements = {
				AgentAvailabilityStatus: "Free,Locked (LM),Locked (User),Locked (WF)",
				error: "Only free or locked agents are allowed to change their setup parameters."
			};
	} else {
		fastRunRequirements = {
				ActiveStatus: "Active,No Agent",
				InUseBy: "TestPlan,FastRun",
				AgentAvailabilityStatus: "Free,Idle,In Use",
				error: "Only unlocked active hosts which aren't executing a workflow are allowed to run a fast run."
			};
	}

	return {
		testPlanRequirements: testPlanRequirements,
		workflowRequirements: workflowRequirements,
		fastRunRequirements: fastRunRequirements,
		ignoreAvailabilityRequirements: ignoreAvailabilityRequirements,
		ignoreAvailabilityRequirementsAndAllowInactiveHosts: ignoreAvailabilityRequirementsAndAllowInactiveHosts,
		deleteAgentRequirements: deleteAgentRequirements,
		abortAgentRequirements: abortAgentRequirements,
		setSetupParameterRequirements: setSetupParameterRequirements
	};
}

/**
 * Checks the requirement (according to definition in HostManagement_GenerateRequirements) against the given rows.
 * Returns an object with passed/failed rows, status and an error if exists.
 */
function HostManagement_CheckRequirements(rows, requirementName) {
	// Returns the an array of rows which passed the given validator
	var validateRows = function (rows, validator) {
		var passedRows = [];
		var failedRows = [];
		for (var i = 0; i < rows.length; i++) {
			var row = rows[i];
			if (validator(row)) {
				passedRows.push(row);
			} else {
				failedRows.push(row);
			}
		}
		return { passedRows: passedRows, failedRows: failedRows };
	};

	// Validation function which makes sure a column's value is in the given values array
	var arrayValidation = function (row, columnName, values) {
		var value = row.find("#td" + columnName).text();
		return ($.inArray(value, values) != -1);
	};

	// Get needed parameters
	var requirements = HostManagement_GenerateRequirements();
	var error = undefined;

	var requirement = requirements[requirementName];

	// Validate simple statuses
	var passedRows = rows;
	var failedRows = [];
	var columnNames = [ "ActiveStatus", "RunStatus", "AgentAvailabilityStatus" ];
	for (var j = 0; j < columnNames.length; j++) {
		var columnName = columnNames[j];
		if (requirement[columnName] != undefined) {
			var allowedValues = splitBy(requirement[columnName], ",");
			var result = validateRows(passedRows, function (row) {
				return arrayValidation(row, columnName, allowedValues)
			});
			passedRows = result.passedRows;
			failedRows = failedRows.concat(result.failedRows);
		}

		// No point in continuing
		if (passedRows.length == 0) {
			break;
		}
	}

	// Validate in use by
	if (requirement.InUseBy != undefined && passedRows.length > 0) {
		var result = validateRows(passedRows, function (row) {
			var availTd = row.find("#tdAgentAvailabilityStatus");
			if (availTd.text() == "In Use") {
				var inUseByArr = $("#tblHosts").data('inUseBy')[row.attr('data-agent-name')];
				if (inUseByArr != undefined) {
					var hasWorkflow = false;
					var hasTPExec = false;
					var hasFastRun = false;
					for (var i = 0; i < inUseByArr.length; i++) {
						var type = inUseByArr[i].type;
						if (type == "TP Execution" || type == "Endless TP Execution") {
							hasTPExec = true;
						} else if (type == "Fast Run" || type == "Endless Fast Run") {
							hasFastRun = true;
						} else if (type == "Workflow") {
							hasWorkflow = true;
						}
					}
					if (hasWorkflow && requirement.InUseBy.indexOf("Workflow") == -1) {
						return false;
					}
					if (hasTPExec && requirement.InUseBy.indexOf("TestPlan") == -1) {
						return false;
					}
					if (hasFastRun && requirement.InUseBy.indexOf("FastRun") == -1) {
						return false;
					}
				}
			}
			return true;
		});
		passedRows = result.passedRows;
		failedRows = failedRows.concat(result.failedRows);
	}

	if (failedRows.length > 0) {
		error = requirement.error;
	}

	return { status: (error == undefined), passedRows: passedRows, failedRows: failedRows, error: error };
}

/**
 * Given the result object (with passed/failed rows and error), show the relevant alerts and uncheck rows.
 */
function HostManagement_CheckRequirementsCallback(result, command) {
	if (result.passedRows.length == 0) {
		if (result.failedRows.length == 0) {
			// No agents selected at all
			UIUtility_showAlert("No agents selected", "Error");
		} else {
			UIUtility_showAlert(result.error, "Error");
		}
	} else if (result.failedRows.length == 0) {
		command();
	} else {
		// Action after the confirmation
		function okAction() {
			// Uncheck agents
			for (var i = 0; i < result.failedRows.length; i++) {
				var row = $('#tblHosts tbody tr[data-id="' + result.failedRows[i].attr('data-id') + '"]');
				row.find('#chkSelect').click();
			}

			// Call original command
			command();
		};

		// Build agents list html
		var agentsHtml = "<ul>";
		for (var i = 0; i < result.failedRows.length; i++) {
			agentsHtml += "<li>" + result.failedRows[i].attr('data-id') + "</li>";
		}
		agentsHtml += "</ul>";

		// Show confirmation dialog
		var messages = [ result.error, "If you confirm, the following selected agents will be unchecked:", agentsHtml];
		UIUtility_showConfirmDialog(messages, "Confirm Action", okAction);
	}
}

function HostManagement_CheckSpecificRequirements(command, requirementsName) {
	var rows = HostManagement_GetSelectedAgents();
	var result = HostManagement_CheckRequirements(rows, requirementsName);
	HostManagement_CheckRequirementsCallback(result, command);
}

function HostManagement_CheckWorkflowRequirements(workflowName, command) {
	var rows = HostManagement_GetSelectedAgents();
	var requirementsName = "workflowRequirements";
	var confirmation = undefined;
	var workflowsData = WorkflowsMng_getWorkflowsData();
	if (workflowsData.isIgnoreResourcesAvailability[workflowName] == true) {
		requirementsName = "ignoreAvailabilityRequirements";
	}
	if (workflowsData.isEnableRunningOnInactiveHost[workflowName] == true) {
		requirementsName = "ignoreAvailabilityRequirementsAndAllowInactiveHosts";
	}
	var result = HostManagement_CheckRequirements(rows, requirementsName);
	if (!result.status && workflowName == "Activate Agent") {
		// Check activate agent requirements (this is needed in case it wasn't set to ignore availability requirements in the workflow configuration)
		var activateResult = HostManagement_CheckRequirements(result.failedRows, "ignoreAvailabilityRequirements");

		// If activation result has no error, take error from general workflow result
		activateResult.error = result.error;

		if (activateResult.passedRows.length == 0) {
			// Nothing passed, no special confirmation required, continue with normal workflow
			HostManagement_CheckRequirementsCallback(result, command);
		} else {
			// Add passed hosts of general workflow requirements
			activateResult.passedRows = activateResult.passedRows.concat(result.passedRows);

			// Show confirmation for the unknown state agents
			var messages = [
			                "Some agents might be in use, and activating them will stop whatever they are currently doing.",
			                "Are you sure you want to continue?"
			                ];
			UIUtility_showConfirmDialog(messages, "Activate Agent", function () {
				HostManagement_CheckRequirementsCallback(activateResult, command);
			});
		}
	} else if (!result.status && workflowName == "Free Text") {
		// Check free text requirements (this is needed in case it wasn't set to ignore availability requirements in the workflow configuration)
		var freeTextResult = HostManagement_CheckRequirements(result.failedRows, "ignoreAvailabilityRequirements");

		// Merge results
		result.failedRows = freeTextResult.failedRows;
		result.error = freeTextResult.error;
		result.passedRows = result.passedRows.concat(freeTextResult.passedRows);

		// Continue
		HostManagement_CheckRequirementsCallback(result, command);
	} else {
		HostManagement_CheckRequirementsCallback(result, command);
	}
}

/**
 * @return the selected visible agent rows in the agents table.
 */
function HostManagement_GetSelectedAgents() {
	var agents = [];
	$('#tblHosts > tbody > tr').each(function() {
		var row = $(this);
		var chkSelect = row.find('#chkSelect');
		var selected = chkSelect.is(':checked');
		var visible = chkSelect.is(":visible");
		if (selected && visible) {
			agents.push(row);
		}
	});	
	return agents;
}

function HostManagement_ExportViewToExcel() {
	
	var jsonRequest = {}; 
	var excel = {};
	jsonRequest.excel = excel;

	// Create the workbook 
	var workbook = {};
	workbook.workbookName = 'hostManagementView';
	excel.workbook = workbook;

	// Create a sheet
	var sheets = [];
	workbook.sheets = sheets;
	var sheet = {};
	sheet.sheetName = 'Host Management';
	sheets.push(sheet);
	var rows = [];
	sheet.rows = rows;

	// Prepare the header row
	var headerRow = {};
	rows.push(headerRow);
	var headerValues = ["Agent Name"];
	headerRow.values = headerValues;
	$('#tblHosts > thead > tr:eq(2) th:visible').each(function () {
		if ($(this).is('[data-export-ignore]')) {
			return;
		}

		headerValues.push($(this).text().trim());
	});
	headerRow.values.push("Is Selection Locked");
	headerRow.values.push("Selection Lock Owner");
	headerRow.values.push("Selection Lock Time");
	headerRow.values.push("Selection Lock Description");

	// Get the table data
	$('#tblHosts > tbody > tr:visible').each(function () {

		// Add a row
		var dataRow = {};
		rows.push(dataRow);
		var row = $(this);
		var dataValues = [row.attr('data-agent-name')];
		dataRow.values = dataValues;
		
		// Get the data
		row.find('td:visible').each(function() {
			var $this = $(this);
			if ($this.is('[data-export-ignore]')) {
				return;
			}	

			// Get the current value
			var currentValue;
			var input = $this.find("input");
			if (input.length > 0 && !input.is("[type='hidden']")) {
				currentValue = getValueFromElement(input);
			} else {
				currentValue = $this.text().trim();
			}
			dataValues.push(currentValue);
		});

		// Add selection lock details
		var lockedSpan = row.find("span[locked='true']");
		var isSelectionLocked = "No"
		var selectionLockOwner = "";
		var selectionLockTime = "";
		var selectionLockDescription = "";
		if (lockedSpan.length > 0) {
			isSelectionLocked = "Yes";

			var desc = lockedSpan.attr('lockdescription');

			// Owner
			var ownerIndex = desc.indexOf("Locked by:");
			var ownerStartIndex = desc.indexOf(">", ownerIndex) + 1;
			var ownerEndIndex = desc.indexOf("<", ownerStartIndex);
			selectionLockOwner = desc.substring(ownerStartIndex, ownerEndIndex).trim();

			// Time
			var timeIndex = desc.indexOf("Time:");
			var timeStartIndex = desc.indexOf(">", timeIndex) + 1;
			var timeEndIndex = desc.indexOf("<", timeStartIndex);
			selectionLockTime = desc.substring(timeStartIndex, timeEndIndex).trim();

			// Description
			var descIndex = desc.indexOf("Description:");
			var descStartIndex = desc.indexOf(">", descIndex) + 1;
			selectionLockDescription = desc.substring(descStartIndex).trim();
		}
		dataRow.values.push(isSelectionLocked);
		dataRow.values.push(selectionLockOwner);
		dataRow.values.push(selectionLockTime);
		dataRow.values.push(selectionLockDescription);
	});

	// Export to excel
	var link = '/tasks/genericReports_exportToExcel';
	PostJsonToNewWindow(link, jsonRequest, '_self', true);
}

function hostManagement_setSetupParametersGroup() {
	
	// Get the selected rows
	var selectedRows = getSelectedRows($('#tblHosts'));
	
	// Validate
	if (selectedRows.length == 0) {
		UIUtility_showAlert('No agents were selected', 'Set');
		return;
	}
	
	// Get the agent names
	var agentNames = getAttributeValueFromEachRow(selectedRows, 'data-id');
	
	// Display a dialog to select the setup parameter group
	var setupParameterGroupsAsMap = {};
	var dialogHtml = '';
	dialogHtml += '<select id="slctSetupParameterGroup">';
	for (var groupIndex = 0; groupIndex < globalSetupParameterGroups.length; groupIndex++) {
		var currentGroup = globalSetupParameterGroups[groupIndex];
		setupParameterGroupsAsMap[currentGroup.setupParameterGroupName] = currentGroup;
		dialogHtml += '<option value="' + currentGroup.setupParameterGroupName + '">' + currentGroup.setupParameterGroupName + '</option>';
	}
	dialogHtml += '</select>';
	UIUtility_showConfirmDialog(dialogHtml, "Manage Setup Parameter Groups", function () {
		var request = {};
		request.agentNames = agentNames;
		var groupName = getValueFromElement($('#slctSetupParameterGroup'));
		var setupParameterGroup = setupParameterGroupsAsMap[groupName];
		request.setupParameterGroup = setupParameterGroup;
		// Post
		var link = '/tasks/setSetupParameterGroup';
		var async = true;
		PostJsonWithJsonFeedbackFuncs(link, async, request, 
			function (jsonResponse) {
				// Do nothing
			}, function (textResponse) {
				UIUtility_showAlert('Failed to set setup parameter group: [' + textResponse + ']');
			}
		);
	});
}

function hostManagement_manageSetupParametersGroup() {

	// Build the dialog HTML
	var dialogHtml = '';
	
	// Add an add button
	dialogHtml += '<input type="button" value="Add" onclick="hostManagement_addSetupParameterGroup();" />';
	
	// Create the setup parameter groups table
	dialogHtml += '<table class="hor-minimalist-c" id="tblSetupParameterGroups">';
	dialogHtml += '<thead>';
	dialogHtml += hostManegement_buildSetupParameterGroupHeaderRowHtml(globalSetupParameters);
	dialogHtml += '</thead>';
	dialogHtml += '<tbody>';
	for (var groupIndex = 0; groupIndex < globalSetupParameterGroups.length; groupIndex++) {
		var currentGroup = globalSetupParameterGroups[groupIndex];
		dialogHtml += hostManagement_buildSetupParameterGroupDataRowHtml(globalSetupParameters, currentGroup);
	}
	dialogHtml += '</tbody>';
	dialogHtml += '</table>';

	UIUtility_showConfirmDialog(dialogHtml, "Manage Setup Parameter Groups", function () {
		var request = {};
		var setupParameterGroups = [];
		request.setupParameterGroups = setupParameterGroups;
		$('#tblSetupParameterGroups > tbody tr').each(function() {
			var groupName = getValueFromElement($(this).find('#txtGroupName')).trim();
			if (isStringEmpty(groupName)) {
				return;
			}
			var currentGroup = {};
			setupParameterGroups.push(currentGroup);
			currentGroup.setupParameterGroupName = groupName;
			currentGroup.setupParameters = {};
			$(this).find('td[data-setup-parameter-id]').each(function() {
				var parameterId = $(this).attr('data-setup-parameter-id');
				var parameterName = $(this).attr('data-setup-parameter-name');
				var valueId = getValueFromElement($(this).find('select:first'));
				if (valueId == 0) {
					return;
				}
				var value = getTextFromElement($(this).find('select:first'));
				var currentParameter = {};
				currentGroup.setupParameters[parameterName] = currentParameter;
				currentParameter.setupParameterId = parameterId;
				currentParameter.setupParameterValueId = valueId;
				currentParameter.setupParameterValue = value;
			});
		});

		// Post
		var link = '/tasks/saveSetupParameterGroups';
		var async = true;
		PostJsonWithJsonFeedbackFuncs(link, async, request, 
			function (jsonResponse) {
				globalSetupParameterGroups = request.setupParameterGroups;
			}, function (textResponse) {
				UIUtility_showAlert('Failed to save setup parameter groups: [' + textResponse + ']');
			}
		);
	}, "80%", 400);
}

function hostManagement_addSetupParameterGroup() {
	
	var emptyGroup = {};
	emptyGroup.setupParameterGroupName = '';
	emptyGroup.setupParameters = {};
	
	var emptyGroupRowHtml = hostManagement_buildSetupParameterGroupDataRowHtml(globalSetupParameters, emptyGroup);
	
	$('#tblSetupParameterGroups > tbody').append(emptyGroupRowHtml)
}

function hostManagement_deleteSetupParameterGroup(callingElement) {
	var callingElementRow = $(callingElement).parents('tr:eq(0)');
	$(callingElementRow).remove();
}

function hostManegement_buildSetupParameterGroupHeaderRowHtml(setupParametersContainer) {
	
	var rowHtml = '';
	
	rowHtml += '<tr>';
	rowHtml += '<th id="thDelete"></th>';
	rowHtml += '<th id="thGroupName">Group Name</th>';
	for (var parameterIndex = 0; parameterIndex < setupParametersContainer.setupParameters.length; parameterIndex++) {
		var currentParameter = setupParametersContainer.setupParameters[parameterIndex];
		var parameterName = currentParameter.setupParameterName;
		rowHtml += '<th id="th' + parameterName + '">';
		rowHtml += parameterName;
		rowHtml += '</th>';
	}
	rowHtml += '</tr>';
	
	return rowHtml;
}

function hostManagement_buildSetupParameterGroupDataRowHtml(setupParametersContainer, setupParameterGroup) {
	
	var rowHtml = ''; 
	
	rowHtml += '<tr>';
	rowHtml += '<td id="tdDelete">';
	rowHtml += '<input type="button" value="Delete" onclick="hostManagement_deleteSetupParameterGroup(this);" />';
	rowHtml += '</td>';
	rowHtml += '<td id="tdGroupName">';
	rowHtml += '<input type="text" id="txtGroupName" ';
	rowHtml += 'value="' + setupParameterGroup.setupParameterGroupName + '"';
	rowHtml += '/>';
	rowHtml += '</td>';
	for (var parameterIndex = 0; parameterIndex < setupParametersContainer.setupParameters.length; parameterIndex++) {
		var currentParameter = setupParametersContainer.setupParameters[parameterIndex];
		var parameterId = currentParameter.setupParameterId;
		var parameterName = currentParameter.setupParameterName;
		var selectedValue = '';
		if (setupParameterGroup.setupParameters.hasOwnProperty(parameterName)) {
			selectedValue = setupParameterGroup.setupParameters[parameterName].setupParameterValue;
		}
		rowHtml += '<td id="td' + parameterName + '" data-setup-parameter-id="' + parameterId + '" data-setup-parameter-name="' + parameterName + '">';
		rowHtml += '<select id="slct' + parameterName + '">';
		rowHtml += '<option value="0"></option>';
		var parameterValues = currentParameter.setupParameterValues;
		for (var valueIndex = 0; valueIndex < parameterValues.length; valueIndex++) {
			var currentValue = parameterValues[valueIndex];
			var valueId = currentValue.setupParameterValueId;
			var value = currentValue.setupParameterValue;
			rowHtml += '<option value="' + valueId + '" ';
			if (value == selectedValue) {
				rowHtml += 'selected="selected"';
			}
			rowHtml += '>';
			rowHtml += value;
			rowHtml += '</option>';
		}
		rowHtml += '</select>'
		rowHtml += '</td>';
	} 
	
	rowHtml += '</tr>';
	
	return rowHtml;
}

function HostManagement_GetVisibleHostRows(row) {
	var hostIp = extractIPFromAgentName(row.attr('data-agent-name'));
	return row.parent().find("tr:visible").filter("[data-agent-name^='" + hostIp + ":'], [data-agent-name='" + hostIp + "']");
}

function getMessageSearchableString(messages) {
	if (!isStringEmpty(messages)) {
		messages = messages.trim();
		if (messages.indexOf("[") == 0) {
			var firstEndIndex = messages.indexOf("]");
			if (firstEndIndex > 0) {
				var rest = messages.substring(firstEndIndex + 1).trim();
				if (rest.startsWith("[")) {
					var secondEndIndex = messages.indexOf("]", firstEndIndex + 1);
					return messages.substring(0, secondEndIndex + 1);
				} else {
					return messages.substring(0, firstEndIndex + 1);
				}
			}
		}
	}
	return "";
}

/** javascripts/virtualcombinationsjs/VirtualCombinationsRenderHelper.js **/
var globalVirtualCombinations_toggleButtons = [];
var globalVirtualCombinations_toggleStates = {};

function virtualCombinations_initializeToggleBehaviour(toggleBtnId, btnIcon, divIdToToggleFor, callBack) {
	
	UIUtility_initializeToggleBehaviour(
			toggleBtnId, btnIcon, divIdToToggleFor, globalVirtualCombinations_toggleButtons, globalVirtualCombinations_toggleStates, callBack);
}

function VirtualCombinations_initializeButtons() {
	UIUtility_initializeButton('addVirtualCombination'	  , 'ui-icon-document');
	UIUtility_initializeButton('btnLoadVirtualCombination', 'ui-icon-folder-open');
	UIUtility_initializeButton('btnSaveVC'				  , 'ui-icon-disk');
	UIUtility_initializeButton('duplicateVCButton'		  , 'ui-icon-copy');
	UIUtility_initializeButton('deleteVCButton'		  	  , 'ui-icon-trash');
	UIUtility_initializeButton('renameVCButton'			  , 'ui-icon-pencil');
}

function virtualCombinations_renderVirtualCombinationNames() {

	var virtualCombinationNames = globalVirtualCombinationsContainer.virtualCombinationNames;

	var html = "";
	virtualCombinationNames.forEach(function (name) {
		html += "<option id='" + name + "'>" + name + "</option>";
	});
	$('#inputSelectVirtualCombination').html(html);
	$('#inputSelectVirtualCombination').combobox({});
	$('#inputSelectVirtualCombination').data('vcNames', virtualCombinationNames);
	$('#inputSelectVirtualCombination').combobox("setValue", "");
}

function showVirtualCombinationContent() {

	// Clear previous errors
	setValueInVirtualCombinationOperationError('');
	
	$('#divVirtualCombinationContent').removeClass('inactive');
}

function hideVirtualCombinationContent() {

	$('#divVirtualCombinationContent').addClass('inactive');
	
	clearVirtualCombinationValidationData(true);
}

function showVirtualCombinationsUsage() {
	$('#divVirtualCombinationsUsage').removeClass('inactive');
}

function hideVirtualCombinationsUsage() {
	$('#divVirtualCombinationsUsage').addClass('inactive');
}

function renderVirtualCombinationName(virtualCombinationName) {
	$('#lblVirtualCombinationName').html(virtualCombinationName);
}

function initializeNameExistsDialog() {
	$("#nameExistsDialog").css("display", "none");
	$("#nameExistsDialog").dialog({
		autoOpen: false,
		height: 250,
		width: 400,
		modal: true,
		buttons: {
	        "OK": function() {
	        	// Close the dialog
	    	  	$(this).dialog("close");
	        }
		},
	});
}

function initializeDuplicateVirtualCombinationDialog() {
	$("#duplicateVirtualCombinationDialog").dialog({
		autoOpen: false,
		height: 250,
		width: 350,
		modal: true,
		buttons: {
			"Confirm": function() {
				onDuplicateVirtualCombinationConfirm();
	        },
	        "Cancel": function() {
	        	// Close the dialog
	    	  	$(this).dialog("close");
	        }
		},
	});
}

function initializeRenameVirtualCombinationDialog() {
	$("#renameVirtualCombinationDialog").dialog({
		autoOpen: false,
		height: 250,
		width: 350,
		modal: true,
		buttons: {
			"Confirm": function() {
				onRenameVirtualCombinationConfirm();
	        },
	        "Cancel": function() {
	        	// Close the dialog
	    	  	$(this).dialog("close");
	        }
		},
	});
}

function initializeDeleteVirtualCombinationDialog() {
	$("#deleteVirtualCombinationDialog").dialog({
		autoOpen: false,
		height: 250,
		width: 350,
		modal: true,
		buttons: {
			"Confirm": onDeleteVirtualCombinationConfirm,
	        "Cancel": function() {
	        	// Close the dialog
	    	  	$(this).dialog("close");
	        }
		},
	});
}

function renderVirtualCombinationSetupParameters(vcSetupParameterValueIds, vcNoCoverageSetupParameterIds, hideAny, elementId) {

	// First clear the table content
	removeAllTableRows('tblVirtualCombinationSetupParameters');
	
	// Get the setup parameters names
	var setupParameters = globalSetupParametersContainer.setupParameters;

	// Iterate over the setup parameters
	for (var setupParameterIndex = 0; setupParameterIndex < setupParameters.length; setupParameterIndex++) {
	
		// The current setup parameter name
		var setupParameter = setupParameters[setupParameterIndex];
		
		// Render the setup parameter
		renderVirtualCombinationSetupParameter(setupParameter, vcSetupParameterValueIds, vcNoCoverageSetupParameterIds, hideAny, elementId);
	}
}

function renderVirtualCombinationSetupParameter(setupParameterObj, vcSetupParameterValueIds, vcNoCoverageSetupParameterIds, hideAny, elementId) {
	
	// Get the setup parameter id and name
	var setupParameterId = setupParameterObj.setupParameterId;
	var setupParameterName = setupParameterObj.setupParameterName;
	
	// Get the setup parameter values
	var setupParameterValues = setupParameterObj.setupParameterValues;
	
	// Populate the row
	var setupParameterAsRow = '<tr>';
	
	// Attach the name
	setupParameterAsRow += '<td id="setupParamID" data-setup-parameter-id="' + setupParameterId + '">' + setupParameterName + '</td>';
	
	// Attach the values
	setupParameterAsRow += '<td>';

	// Keep a flag that indicates if any setup parameter value was chosen
	var anySetupParameterValueWasChosen = false;
	for (var setupParameterValueIndex = 0; setupParameterValueIndex < setupParameterValues.length; setupParameterValueIndex++) {
	
		// Get the setup parameter value
		var setupParameterValueObj = setupParameterValues[setupParameterValueIndex];
		
		// Get the setup parameter value id and value
		var setupParameterValueId = setupParameterValueObj.setupParameterValueId;
		var setupParameterValue = setupParameterValueObj.setupParameterValue;
		
		// Determine if the setup parameter value is already checked in the virtual combination
		var setupParameterValueExist = $.inArray(setupParameterValueId, vcSetupParameterValueIds);
		
		// Attach the value into the row
		setupParameterAsRow += 
			'<input id="setupParameterValue" type="checkbox" ' + 
			'data-setup-parameter-value-id="' + setupParameterValueId + '"' +
			'value="' + setupParameterValue + '"'; 
		
		if (setupParameterValueExist >= 0) {
			setupParameterAsRow += ' checked="true"';
			anySetupParameterValueWasChosen = true;
		}
		
		setupParameterAsRow += '"/>  ' + setupParameterValue + '  ';
	}
	
	// Determine if the setup parameter id is already checked by the virtual combination (as no coverage)
	var noCoveragetupParameterIdExist = $.inArray(setupParameterId, vcNoCoverageSetupParameterIds);
	
	// Attach the any value
	if (!hideAny) {
		setupParameterAsRow += '<br>';
		setupParameterAsRow += 
			'<input id="anySetupParamValue" type="checkbox" ' + 
			'data-setup-parameter-value-id="any"' +
			'value="any"';
		if (noCoveragetupParameterIdExist >= 0 || !anySetupParameterValueWasChosen) {
			setupParameterAsRow += ' checked="true"';
		}
		setupParameterAsRow += '"/>  Any';
	}
	
	// Close the column that contains all setup parameter values
	setupParameterAsRow += '</td>';
	
	// Close the row
	setupParameterAsRow += '</tr>';
		
	// Add the row
	$("#tblVirtualCombinationSetupParameters tbody").append(setupParameterAsRow);
}

function setValueInVirtualCombinationOperationError(val) {
	$('#lblVirtualCombinationOperationError').html(val);
}

function renderVirtualCombinationTooltip(virtualCombinationName, projectName) {
	// Get the virtual combination
	var theVirtualCombinationAsJson = getVirtualCombination(getVirtualCombinationsAsJson(), virtualCombinationName);
	
	return renderVirtualCombinationJsonTooltip(theVirtualCombinationAsJson, projectName);
}

function renderVirtualCombinationJsonTooltip(virtualCombination, projectName) {
	
	var tooltipVal = '<table><tbody>';
	
	// Iterate over the setup parameter names
	var setupParameters = globalSetupParametersContainer.setupParameters;
	
	// Extract the project (if available)
	var allowedProjectSetupParameterValueIds = null;
	if (!isStringEmpty(projectName)) {
		allowedProjectSetupParameterValueIds = globalProjectData.virtualCombination.setupParameterValueIds;
	}
	
	for (var setupParameterIndex = 0; setupParameterIndex < setupParameters.length; setupParameterIndex++) {
	
		tooltipVal += '<tr>';
		
		// Attach the setup parameter name to the tooltip
		var setupParameter = setupParameters[setupParameterIndex];
		var setupParameterName = setupParameter.setupParameterName;
		tooltipVal += '<th class="TextAlignLeft">' + setupParameterName + ':</th>'
		
		// Iterate over the setup parameter values
		var setupParameterValuesAsStr = '';
		var setupParameterValues = setupParameter.setupParameterValues;
		for (var valueIndex = 0; valueIndex < setupParameterValues.length; valueIndex++) {
			var setupParameterValueObj = setupParameterValues[valueIndex];
			var setupParameterValueId = setupParameterValueObj.setupParameterValueId;
			var setupParameterValue = setupParameterValueObj.setupParameterValue;
			
			if ( ($.inArray(setupParameterValueId, virtualCombination.setupParameterValueIds) > -1) &&
			     (null == allowedProjectSetupParameterValueIds || $.inArray(setupParameterValueId, allowedProjectSetupParameterValueIds) > -1) ) {
				setupParameterValuesAsStr += setupParameterValue + '; '
			}
		}
		
		// Extract the setup parameter id
		var setupParameterId = setupParameter.setupParameterId;
		
		if ($.inArray(setupParameterId, virtualCombination.noCoverageSetupParameterIds) > -1) {
			setupParameterValuesAsStr += ' Any;';
		}
		
		tooltipVal += '<td>' + setupParameterValuesAsStr + '</td>'
		tooltipVal += '</tr>';
	}
	
	return tooltipVal;
}

function loadVirtualCombinationContent(virtualCombinationId, virtualCombinationName, setupParameterValueIds, noCoverageSetupParameterIds) {

	// Store the id in the hidden input
	$('#hdnVirtualCombinationId').val(virtualCombinationId);
	
	// Store the name in the hidden input
	$('#hdnOriginalVirtualCombinationName').val(virtualCombinationName);
	
	// Set the virtual combination name
	renderVirtualCombinationName(virtualCombinationName);
	
	// Render the virtual combination setup parameters
	renderVirtualCombinationSetupParameters(setupParameterValueIds, noCoverageSetupParameterIds, false, undefined);
}

function renderVirtualCombinationContent(virtualCombinationId, virtualCombinationName, setupParameterValueIds, noCoverageSetupParameterIds) {

	// Load data
	loadVirtualCombinationContent(virtualCombinationId, virtualCombinationName, setupParameterValueIds, noCoverageSetupParameterIds);
	
	// Show the virtual combination content
	showVirtualCombinationContent();
}

function renderVirtualLabsForValidateVirtualCombination() {
	renderVirtualLabs('slctVirtualLabs');
}

function populateRowWithVirtualCombinationPermutation(sortedSetupParameterNames, addedRow, hasAllowedPermutations, permutationNum, permutationId, permutationAsJson) {

	// Populate the row with the permutation content
	// The permutation number
	addedRow.find('#tdPermNum').html(permutationNum);
	
	// Attach the permutation number as the row id
	addedRow.attr('id', permutationNum);
	
	// Attach the permutation id
	addedRow.attr('permutation-id', permutationId);
	
	// Attach the permutation matching regex
	var matchingRegex = permutationAsJson.matchingRegex;
	addedRow.attr('data-matching-regex', matchingRegex);
	
	// The target setup
	var targetSetupAsHtml = '';
	for (var parameterIndex = 0; parameterIndex < sortedSetupParameterNames.length; parameterIndex++) {
		
		// Get the current setup parameter name
		var currentParameterName = sortedSetupParameterNames[parameterIndex];
	
		if (hasAllowedPermutations) {
			// Extract the setup parameter values
			var setupParamValues = permutationAsJson.targetSetup[currentParameterName];
			targetSetupAsHtml += '<td id="tdSetupParameter' + currentParameterName + '">' + setupParamValues + '</td>';
		} else {
			targetSetupAsHtml += '<td id="tdSetupParameter' + currentParameterName + '"></td>';
		}
	}
	addedRow.append(targetSetupAsHtml);
	
	// The matching agents
	var matchingAgents = arrToString(permutationAsJson.matchingAgents, '<br />', '');
	var matchingAgentsForFilter = arrToString(permutationAsJson.matchingAgents, ';', '') + ';';
	addedRow.find('#tdAgents').html(matchingAgents);
	addedRow.find('#tdAgents').attr('data-filter-values', matchingAgentsForFilter);
	
	// The number of matching agents
	addedRow.find('#tdNumOfAgents').html(permutationAsJson.numOfMatchingAgents);
	if (permutationAsJson.numOfMatchingAgents == 0) {
		addedRow.find('#tdNumOfAgents').attr('class', 'NoMatchingAgents');
	}
}

function renderVirtualCombinationWhyAgentNotMatch(parsedJsonObj) {
	renderVirtualCombinationWhyAgentNotMatchAgentSelect(parsedJsonObj);
	
	renderVirtualCombinationWhyAgentNotMatchPermutationSelect(parsedJsonObj);
}

function renderVirtualCombinationWhyAgentNotMatchAgentSelect(parsedJsonObj) {

	// Clear the agents select
	$('#slctAgent').html('');
	
	// Populate the agents select
	for (var agentIndex = 0; agentIndex < parsedJsonObj.agentsData.poolOfAgentIds.length; agentIndex++) {
	
		// Extract the agent id
		var agentId = parsedJsonObj.agentsData.poolOfAgentIds[agentIndex];
		
		// Add the option to the select
		var optionToAdd = '<option value="' + agentId + '">' + agentId + '</option>';
		$('#slctAgent').append(optionToAdd);
	}
}

function renderVirtualCombinationWhyAgentNotMatchPermutationSelect(parsedJsonObj) {

	// Clear the permutations select
	$('#slctPermutationNum').html('');
	
	// Extract the permutation ids
	var permutationIds = parsedJsonObj.permutationIds;
	
	// Sort the array
	sortArrayOfNumbers(permutationIds);

	// Populate the permutation select
	for (var permutationIndex = 0; permutationIndex < permutationIds.length; permutationIndex++) {
	
		var permutationId = permutationIds[permutationIndex];
		
		// Add the option to the select
		var optionToAdd = '<option value="' + permutationId + '">' + permutationId + '</option>';
		$('#slctPermutationNum').append(optionToAdd);
	}
}

function renderAgentMatchingKeysVsPermutation(agentId, permutationNum) {

	// Extract the virtual combination validation data as json
	var virtualCombinationValidationDataAsJson = getVirtualCombinationValidationAsJson();
	
	// Extract the target setup of the permutation
	var permutationTargetSetupTable = $('#tblMatchingAgents tr[id^="' + permutationNum + '"]').find('#tdTargetSetup');
	
	// Add this table as html to the results
	$('#divWhyAgentDoesntMatchResults').append(permutationTargetSetupTable.html());
	
	// Get a reference to the just added table
	var addedTable = $('#divWhyAgentDoesntMatchResults').find('#tblTargetSetup');
	
	// Iterate over the agent matching keys (can be more than one because of disks)
	var agentTargetSetupInformations = virtualCombinationValidationDataAsJson.agentsData[agentId];
	for (var agentTargetSetupInformationIndex = 0; agentTargetSetupInformationIndex < agentTargetSetupInformations.length; agentTargetSetupInformationIndex++) {
	
		// Get the target setup information
		var agentTargetSetupInformation = agentTargetSetupInformations[agentTargetSetupInformationIndex];
		
		// Go over the setup parameters
		addedTable.find('tr').each(function() {
			// The setup parameter name
			var setupParamName = this.id;
			
			// The permutation setup parameter value
			var permutationSetupParameterValue = $(this).find('td[id^="tdSetupParameterValues"]').html();
			
			// Extract the setup parameter value from the agent current matching key
			var agentSetupParamValue = agentTargetSetupInformation.targetSetup[setupParamName];
			
			// Class for the agent setup parameter
			var classForAgentSetupParameterValue = '';
			if (permutationSetupParameterValue.indexOf(agentSetupParamValue) == -1) {
				classForAgentSetupParameterValue = 'NoMatchingAgents';
			}
			
			// Add the value to the row
			$(this).append('<td class="' + classForAgentSetupParameterValue + '">' + agentSetupParamValue + '</td>');
		});
	}
}

function clearVirtualCombinationValidationData(isToHide) {

	$('#divSectionMatchingAgents').accordion("option", "active", false);
	$('#divSectionWhyAgentDoesntMatch').accordion("option", "active", false);
	$('#divSectionMatchingAgents').find('#tblMatchingAgents tbody').html('');
	$('#divWhyAgentDoesntMatchResults').html('');
	$('#divWhyAgentDoesntMatch').find('#slctPermutationNum').html('');
	$('#divWhyAgentDoesntMatch').find('#slctAgent').html('');
	
	if (isToHide) {
		$('#divVirtualCombinationValidation').attr('class', 'inactive');
	}
}
/** javascripts/virtualcombinationsjs/VirtualCombinationsCommonHelper.js **/
function isVirtualCombinationValidComparingProjectAllowedSetupParameterValues(virtualCombinationName, projectAllowedSetupParameterValueIds) {
	var virtualCombinationIsValid = true;
	
	// Get the virtual combination
	var theVirtualCombinationAsJson = globalVirtualCombinationsContainer.virtualCombinations[virtualCombinationName];
	
	if (undefined != theVirtualCombinationAsJson) {
		// Iterate over the setup parameter names
		var setupParameters = globalSetupParametersContainer.setupParameters;
		for (var setupParameterIndex = 0; setupParameterIndex < setupParameters.length && virtualCombinationIsValid; setupParameterIndex++) {
			
			var setupParameter = setupParameters[setupParameterIndex];
			var setupParameterName = setupParameter.setupParameterName;
			
			// Iterate over the setup parameter values
			var theSetupParameterValuesAsJson = setupParameter.setupParameterValues;
			
			// Keep a flag that indicates if at least one value was found fit as allowed in the project
			var foundAllowedSetupParameterValue = false;
			
			// Keep a flag that indicates if the virtual combination has a setup parameter value (i.e. the setup parameter is not signed only as 'Any')
			var virtualCombinationContainsSetupParameterValueInSetupParameter = false;
	
			for (var setupParameterVal in theSetupParameterValuesAsJson)  {
				var setupParameterValId = theSetupParameterValuesAsJson[setupParameterVal].id;
	
				if ($.inArray(setupParameterValId, theVirtualCombinationAsJson.setupParameterValueIds) > -1) {
					if ($.inArray(setupParameterValId, projectAllowedSetupParameterValueIds) > -1) {
						foundAllowedSetupParameterValue = true;
						break;
					}
				
					virtualCombinationContainsSetupParameterValueInSetupParameter = true;
				}
			}
			
			if (!foundAllowedSetupParameterValue && virtualCombinationContainsSetupParameterValueInSetupParameter) {
				// This setup parameter is illegal - there is a setup parameter that doesn't have any valid setup parameter value
				virtualCombinationIsValid = false
			}
		}
	}
	
	return virtualCombinationIsValid;
}
/** javascripts/virtualcombinationsjs/VirtualCombinationsEventsHelper.js **/
var globalSetupParametersContainer = {};
var globalVirtualCombinationsContainer = {};

function loadVirtualCombinations(onComplete) {
	var link = "/tasks/LoadVirtualCombinations";
	var async = true;
	var request = {};
	PostJsonWithJsonFeedbackFuncs(link, async, request, 
		function(jsonResponse) {
			globalSetupParametersContainer = jsonResponse.setupParametersContainer;
			globalVirtualCombinationsContainer = jsonResponse.virtualCombinationsContainer;
			virtualCombinations_renderVirtualCombinationNames();	
			if (onComplete != undefined) {
				onComplete();
			}
		},
		function(textResponse) {
			UIUtility_showAlert('Failed to load virtual combinations: [' + textResponse + ']', 'Load');
		}
	);
}

function sendSaveVCRequest(virtualCombinationAsJson, onComplete) {
	var link = '/tasks/SaveVirtualCombination';
	var async = true;
	PostJsonWithJsonFeedbackFuncs(link, async, virtualCombinationAsJson,
		function(jsonResponse) {
			if (onComplete != undefined) {
				onComplete();
			}
		},
		function(textResponse) {
			UIUtility_showAlert('Failed to save virtual combination: [' + textResponse + ']', 'Save');
		}
	);	
}

function sendDeleteVirtualCombinationsRequest(virtualCombinationId, onComplete) {
	
	var link = '/tasks/DeleteVirtualCombination';
	var async = true;
	PostJsonWithJsonFeedbackFuncs(link, async, { virtualCombinationId: virtualCombinationId },
		function(jsonResponse) {
			if (onComplete != undefined) {
				onComplete();
			}
		},
		function(textResponse) {
			UIUtility_showAlert('Failed to delete virtual combination: [' + textResponse + ']', 'Delete');
		}
	);	
	// Close the dialog of the delete
	$("#deleteVirtualCombinationDialog").dialog("close");
}

function reloadVirtualCombinations(onComplete) {

	hideVirtualCombinationContent();
	hideVirtualCombinationsUsage();
	
	// Re-render the virtual combination names
	loadVirtualCombinations(onComplete);
}

function generateSelectVCCallback(name, triggerSelection) {
	return function() {
		// Select new VC
		if (triggerSelection) {
			$('#inputSelectVirtualCombination').combobox("setValue", name);
			selectVirtualCombination(name);
		} else {
			// Not triggering event, but should at least update the hidden field with the new name
			$("#hdnOriginalVirtualCombinationName").val(name);
		}
	};
}

function doesVCNameExist(name) {
	var found = false;
	var arr = $("#inputSelectVirtualCombination").data('vcNames');
	arr.forEach(function (elem) {
		if (elem == name) {
			found = true;
		}
	});
	return found;
}

function onNewVirtualCombinationConfirm() {

	var name = $("#newVirtualCombinationName").val();
	if (name == "" || doesVCNameExist(name)) {
		$("#nameExistsDialog").dialog("open");
	} else {
		// Clear name input (for next time the dialog will be shown)
		$("#newVirtualCombinationName").val("");

		// Load new (empty) VC for save
		loadVirtualCombinationContent(0, name, new Array(), new Array());

		// Save loaded VC
		virtualCombinations_saveVirtualCombination("", function () {
			reloadVirtualCombinations(generateSelectVCCallback(name, true));
		});

		// Collapse section
		$("#newVirtualCombinationHeader").click();
	}
}

function onSelectVirtualCombination() {

	// Get the selected virtual combination name
	var virtualCombinationName = getValueFromElement($('#inputSelectVirtualCombination'));
	
	selectVirtualCombination(virtualCombinationName);
}

function selectVirtualCombination(virtualCombinationName) {

	// Clear the validation data
	hideVirtualCombinationsUsage();
	clearVirtualCombinationValidationData(true);
	
	var virtualCombination = globalVirtualCombinationsContainer.virtualCombinations[virtualCombinationName];
	
	// Extract the virtual combination id
	var virtualCombinationId = virtualCombination.virtualCombinationId;
	
	// Extract the virtual combination setup parameter values
	var setupParameterValueIds = virtualCombination.setupParameterValueIds;
	
	// Extract the no coverage setup parameter ids
	var noCoverageSetupParameterIds = virtualCombination.noCoverageSetupParameterIds;

	// Render the virtual combination content
	renderVirtualCombinationContent(virtualCombinationId, virtualCombinationName, setupParameterValueIds, noCoverageSetupParameterIds);

	// Store data for reverting
	$("#hdnVirtualCombinationsData").data('lastLoadedName', virtualCombinationName);
	$("#hdnVirtualCombinationsData").data('lastLoadedSetupParamValues', setupParameterValueIds);
	$("#hdnVirtualCombinationsData").data('lastLoadedNoCoverageSetupParams', noCoverageSetupParameterIds);

	// If virtual combination is 'Any' or 'Default' (default project uses the default VC), disable all fields and delete button
	if (virtualCombinationName == 'Any' || virtualCombinationName == 'Default') {
		$("input[type=checkbox]").attr("disabled", true);
		$("#deleteVCButton").button("disable");
		$("#renameVCButton").button("disable");
	} else {
		$("input[type=checkbox]").removeAttr("disabled");
		$("#deleteVCButton").button("enable");
		$("#renameVCButton").button("enable");
	}
}

function virtualCombinations_saveVirtualCombination(saveVirtualCombinationAsName, onComplete) {

	// Clear previous errors
	setValueInVirtualCombinationOperationError('');
	
	// Extract the vc name
	var vcName = $('#lblVirtualCombinationName').html();
	
	if (!isStringEmpty(saveVirtualCombinationAsName)) {
		// If the given parameter is not empty - take it - this means that the 'Save As' operation took place
		vcName = saveVirtualCombinationAsName;
	} else {
		// Extract the original virtual combination name (so if the user type other name, we will have the original one)
		var originalVirtualCombinationName = $('#hdnOriginalVirtualCombinationName').val();
	}

	// Make sure the vc name is not empty
	if (isStringEmpty(vcName)) {
		setValueInVirtualCombinationOperationError('The virtual combination name is missing!');
		return;
	}

	var vcCheckedSetupParameters = populateCheckedSetupParametersInVirtualCombination();

	if (!vcCheckedSetupParameters.isValid) {
		setValueInVirtualCombinationOperationError('Please configure each one of the setup parameters!<br />Virtual combination is not saved');
		return;
	}

	// Send the save VC to the server
	sendSaveVC(vcName, vcCheckedSetupParameters.checkedSetupParameterValueIds, vcCheckedSetupParameters.checkedNoCoverageSetupParameterIds, onComplete);
}

function sendSaveVC(vcName, checkedSetupParameterValueIds, checkedNoCoverageSetupParameterIds, onComplete) {
	
	// Populate the json object to send to the server
	var jsn = populateJsonForSavingVC(vcName, checkedSetupParameterValueIds, checkedNoCoverageSetupParameterIds);
	
	// Send a request to the server to save the virtual combination
	sendSaveVCRequest(jsn, onComplete);
}

function populateJsonForSavingVC(vcName, checkedSetupParameterValueIds, checkedNoCoverageSetupParameterIds) {
	
	// Wrap a json object to include all relevant data
	var jsn = {
			"virtualCombinationId":"",
			"virtualCombinationName":"",
			"setupParameterValueIds":[],
			"noCoverageSetupParameterIds":[]
	};
	
	// Get the virtual combination id
	var virtualCombinationId = $('#hdnVirtualCombinationId').val();
	
	// Append the virtual combination id
	jsn.virtualCombinationId = virtualCombinationId;
	
	// Append the virtual combination name
	jsn.virtualCombinationName = vcName;

	// Append the array of checked setup parameter value ids
	for (var setupValIndex = 0; setupValIndex < checkedSetupParameterValueIds.length; setupValIndex++) {
		jsn.setupParameterValueIds.push(checkedSetupParameterValueIds[setupValIndex]);
	}

	// Append the array of checked no coverage setup parameter ids
	for (var setupIndex = 0; setupIndex < checkedNoCoverageSetupParameterIds.length; setupIndex++) {
		jsn.noCoverageSetupParameterIds.push(checkedNoCoverageSetupParameterIds[setupIndex]);
	}
	
	return jsn;
}

function onDeleteVirtualCombination() {
	
	// Extract the original virtual combination name (so if the user type other name, we will have the original one)
	var originalVirtualCombinationName = $('#hdnOriginalVirtualCombinationName').val();

	// Populate the text of the virtual combination name
	$('#lblVirtualCombinationNameToDelete').html(originalVirtualCombinationName);

	// Show the dialog
	$("#deleteVirtualCombinationDialog").dialog("open");
}

function onDeleteVirtualCombinationConfirm() {
	
	// Extract the virtual combination id
	var virtualCombinationId = $('#hdnVirtualCombinationId').val();
	
	// Send a request to the server to delete the virtual combination
	sendDeleteVirtualCombinationsRequest(virtualCombinationId, function () {
		reloadVirtualCombinations(function () {
			$("#inputSelectVirtualCombination").combobox("setValue", "");
		});
	});
}

function onRenameVirtualCombinationOpen() {
	$("#renameVirtualCombinationName").val('');
	$("#renameVirtualCombinationDialog").dialog("open");
}

function onRenameVirtualCombinationConfirm() {
	var oldName = $("#hdnOriginalVirtualCombinationName").val();
	var newName = $("#renameVirtualCombinationName").val();
	if (newName == "" || doesVCNameExist(newName)) {
		$("#nameExistsDialog").dialog("open");
	} else {
		$("#renameVirtualCombinationDialog").dialog("close");
		virtualCombinations_saveVirtualCombination(newName, function () {
			loadVirtualCombinations(generateSelectVCCallback(newName, false));
			$("#lblVirtualCombinationName").html(newName);
		});
	}
}

function onDuplicateVirtualCombinationOpen() {
	$("#dupVirtualCombinationName").val('');
	$("#duplicateVirtualCombinationDialog").dialog("open");
}

function onDuplicateVirtualCombinationConfirm() {
	var newName = $("#dupVirtualCombinationName").val();
	if (newName == "" || doesVCNameExist(newName)) {
		$("#nameExistsDialog").dialog("open");
	} else {
		$("#duplicateVirtualCombinationDialog").dialog("close");

		// Clear the hidden virtual combination id so a new virtual combination will be created
		$('#hdnVirtualCombinationId').val('0');
	
		// Save new VC
		virtualCombinations_saveVirtualCombination(newName, function () {
			reloadVirtualCombinations(generateSelectVCCallback(newName, true));
		});
	}
}

function virtualCombinations_onSaveVirtualCombination() {

	// Confirm
	UIUtility_showConfirmDialog("You are about to make changes to the virtual combination. Are you sure?", "Save", virtualCombinations_onSaveVirtualCombination_confirm);
}

function virtualCombinations_onSaveVirtualCombination_confirm() {

	var name = $("#lblVirtualCombinationName").html();
	virtualCombinations_saveVirtualCombination(name, function () {
		loadVirtualCombinations(generateSelectVCCallback(name, false));
	});
}

function onValidateVirtualCombination() {

	// Clear virtual combination validation data
	clearVirtualCombinationValidationData(true);
	
	// Show the div of the validation
	$('#divVirtualCombinationValidation').attr('class', '');
	
	location.hash = "#divVirtualCombinationValidation";
}

function onPerformVirtualCombinationValidation() {

	// Clear virtual combination validation data
	clearVirtualCombinationValidationData(false);
	
	// Extract the selected virtual combination
	var selectedVirtualCombinationId = $('#hdnVirtualCombinationId').val();
		
	// Extract the selected virtual lab
	var selectedVirtualLabId = getValueFromElement($('#slctVirtualLabs'));
	
	// Send a request to the server to perform virtual combination validation
	sendValidateVCRequest(selectedVirtualCombinationId, selectedVirtualLabId);
}

function onCheckWhyAgentDoesntMatch() {
	// Clear the results if were any
	$('#divWhyAgentDoesntMatchResults').html('');
	
	// Extract the agent id
	var agentId = getValueFromElement($('#slctAgent'));
	
	// Extract the permutation number
	var permutationNum = getValueFromElement($('#slctPermutationNum'));
	
	// Render the agent matching keys
	renderAgentMatchingKeysVsPermutation(agentId, permutationNum);
}

function virtualCombinations_loadVirtualCombinationsUsage() {

	// Hide the current content
	hideVirtualCombinationContent();
	hideVirtualCombinationsUsage();	

	// Get the virtual combinations usage
	var link = '/tasks/loadVirtualCombinationsUsage';
	var async = true;
	var jsonRequest = {}; // Empty request
	PostJsonWithJsonFeedbackFuncs(link, async, jsonRequest, virtualCombinations_loadVirtualCombinationsUsage_success, virtualCombinations_loadVirtualCombinationsUsage_failure);
}

function virtualCombinations_loadVirtualCombinationsUsage_success(jsonResponse) {

	// Get the virtual combination names
	var virtualCombinationNames = globalVirtualCombinationsContainer.virtualCombinationNames;
	
	// Build the usage HTML
	var usageHtml = '';	
	for (var nameIndex = 0; nameIndex < virtualCombinationNames.length; nameIndex++) {
		
		// Start the row
		usageHtml += '<tr>';

		// Get the virtual combination name
		var virtualCombinationName = virtualCombinationNames[nameIndex];
		usageHtml += '<td>';
		usageHtml += virtualCombinationName;
		usageHtml += '</td>';

		// Test repository
		usageHtml += '<td>';
		usageHtml += '<input type="checkbox" disabled="disabled" ';
		if (jsonResponse.testRepositoryVirtualCombinations.indexOf(virtualCombinationName) != -1) {
			usageHtml += 'checked="checked"';
		}
		usageHtml += '/>';
		usageHtml += '</td>';
		
		// Test suites
		usageHtml += '<td>';
		if (virtualCombinationName in jsonResponse.virtualCombinationNameToTestSuiteNames) {
			var testSuiteNames = jsonResponse.virtualCombinationNameToTestSuiteNames[virtualCombinationName];
			for (var testSuiteNameIndex = 0; testSuiteNameIndex < testSuiteNames.length; testSuiteNameIndex++) {
				var testSuiteName = testSuiteNames[testSuiteNameIndex];
				usageHtml += testSuiteName + '<br/>';
			}
		}
		usageHtml += '</td>';
		
		// Test plans
		usageHtml += '<td>';
		if (virtualCombinationName in jsonResponse.virtualCombinationNameToTestPlanNames) {
			var testPlanNames = jsonResponse.virtualCombinationNameToTestPlanNames[virtualCombinationName];
			for (var testPlanNameIndex = 0; testPlanNameIndex < testPlanNames.length; testPlanNameIndex++) {
				var testPlanName = testPlanNames[testPlanNameIndex];
				usageHtml += testPlanName + '<br/>';
			}
		}
		usageHtml += '</td>';
		
		// Close the row
		usageHtml += '</tr>';
	}
	
	// Add the HTML to the table
	$('#tblVirtualCombinationsUsage tbody').html(usageHtml);
	
	// Show the virtual combinations usage
	showVirtualCombinationsUsage();
}

function virtualCombinations_loadVirtualCombinationsUsage_failure(textResponse) {
	
	UIUtility_showAlert('Failed to load virtual combinations usage: ' + textResponse, 'Load');
}

function populateCheckedSetupParametersInVirtualCombination() {
	
	// A flag that indicates if the virtual combination is valid
	var isValid = true;
	
	// Keep an array of checked setup parameter values
	var checkedSetupParameterValueIds = new Array();
	
	// Keep an array of checked no coverage setup parameter ids
	var checkedNoCoverageSetupParameterIds = new Array();
	
	// Iterate over the setup parameters
	$('#tblVirtualCombinationSetupParameters tbody tr').each(function() {
		
		if (!isValid) {
			return;
		}
		
		// Extract the setup parameter id of the row
		var setupParameterId = $(this).find('#setupParamID').attr('data-setup-parameter-id');
		
		// Keep a flag that indicates if any value was checked
		var valueWasChecked = false;
		
		// Keep a flag that indicates if no coverage value was checked
		var noCoverageWasChecked = false;
		
		// Iterate over the checked setup parameter values
		$(this).find('input:checked').each(function() {
			var setupParamValueId = $(this).attr('data-setup-parameter-value-id');
			if ('any' != setupParamValueId) {
				checkedSetupParameterValueIds.push(setupParamValueId);
				valueWasChecked = true;
			} else {
				checkedNoCoverageSetupParameterIds.push(setupParameterId);
				noCoverageWasChecked = true;
			}
		});
		
		// Validate that one of the following was checked - 'any' or any of the values
		if (!noCoverageWasChecked && !valueWasChecked) {
			isValid = false;
		}
	});
	
	// Populate & return the response
	var checkedSetupParameters = {};
	checkedSetupParameters.isValid = isValid;
	checkedSetupParameters.checkedSetupParameterValueIds = checkedSetupParameterValueIds;
	checkedSetupParameters.checkedNoCoverageSetupParameterIds = checkedNoCoverageSetupParameterIds;
	return checkedSetupParameters;
}
/** javascripts/virtuallabsjs/VirtualLabsCommonHelper.js **/
function storeVirtualLabs(virtualLabsData)
{
	// Extract the the virtual labs
	$('#hdnVirtualLabsData').val(virtualLabsData);
}

/**************** Virtual labs getters methods ****************/
function getVirtualLabsData()
{
	return JSON.parse($('#hdnVirtualLabsData').val());
}

function getVirtualLabIdsAsJson(virtualLabData)
{
	return virtualLabData.virtualLabIds;
}

function getVirtualLabAsJson(virtualLabData, virtualLabId)
{
	return virtualLabData[virtualLabId];
}

function getVirtualLabNamesByIds(virtualLabIds)
{
	var virtualLabNames = new Array();
	var virtualLabsData = getVirtualLabsData();
	for (var virtualLabIndex = 0; virtualLabIndex < virtualLabIds.length; virtualLabIndex++)
	{
		// The virtual lab id
		var virtualLabId = virtualLabIds[virtualLabIndex];
	
		// Get the name
		var virtualLabName = getVirtualLabAsJson(virtualLabsData, virtualLabId).virtualLabName;
	
		// Add to the array
		virtualLabNames.push(virtualLabName); 
	}
	
	return virtualLabNames;
}
/** javascripts/virtuallabsjs/VirtualLabsManagement.js **/
// Note that this function is not used in the virtual labs page, but is used in other pages (Batches, Test Plans)
function loadVirtualLabsData(renderFunction)
{
	// Prepare the request url
	var linkUrl = '/tasks/LoadVirtualLabs';
	
	// Send the request
	var xmlhttp = Get(linkUrl);
	xmlhttp.onreadystatechange=function() {
		if (xmlhttp.readyState == 4)
		{
			if (xmlhttp.status == 200)
			{
				// Store the virtual labs as json
				storeVirtualLabs(xmlhttp.responseText);
				
				if (undefined != renderFunction)
				{
					// If the render function is not empty invoke it
					invokeFunction(renderFunction, null);
				}
			}
			else
			{
				UIUtility_showAlert("Failed to load the virtual lab names");
			}
		}
	};	
}

function VirtualLabsManagement_initializeDeleteVirtualLabConfirmDialog() {
	
	$("#deleteVirtualLabConfirmDialog").dialog({
		autoOpen: false,
		height: 350,
		width: 550,
		modal: true,
		buttons: {
			"Ok": function() {
				// Close the dialog
	    	  	$(this).dialog("close");
	    	  	
	    	  	virtualLabs_onConfirmDeleteVirtualLab();
	    	  	
	    	  	return false;
	        },
			"Cancel": function() {
	        	// Close the dialog
	    	  	$(this).dialog("close");
	    	  	return false;
	        }
		}
	});
}

function onEditVirtualLab(virtualLabID) {

	var foundRow = getVirtualLabRow(virtualLabID);

	if (null != foundRow) {
	
		// Keep data on variables
		var serverDomainName = foundRow.find('#tdServerName').html();
		var vlName = foundRow.find('#tdVirtualLabName').html();
		var vlReportGroup = foundRow.find('#tdReportGroup').html();
		var vlMailingList = foundRow.find('#tdLabStatusMailingList').html();
		var vlMailingListForTestCoverage = foundRow.find('#tdTestCoverageMailingList').html();
		var vlMailingListForNotifications = foundRow.find('#tdNotificationsMailingList').html();
		var vlOwner = foundRow.find('#tdVirtualLabOwner').html();
		
		// Mark this row as edit one
		foundRow.attr('data-vl-row-type', 'edit');
		
		// Replace all labels by inputs text
		foundRow.find('#tdVirtualLabName').html('<input id=\"txtVlName\" type=\"text\" value=\"' + vlName + '\"\>');
		foundRow.find('#tdReportGroup').html('<input id=\"txtVlReportGroup\" type=\"text\" value=\"' + vlReportGroup + '\"\>');
		foundRow.find('#tdLabStatusMailingList').html('<input id=\"txtVlMailingList\"  type=\"text\" value=\"' + vlMailingList + '\"\>');
		foundRow.find('#tdTestCoverageMailingList').html('<input id=\"txtVlMailingListForTestCoverage\"  type=\"text\" value=\"' + vlMailingListForTestCoverage + '\"\>');
		foundRow.find('#tdNotificationsMailingList').html('<input id=\"txtVlMailingListForNotifications\" type=\"text\" value=\"' + vlMailingListForNotifications + '\"\>');
		foundRow.find('#tdVirtualLabOwner').html('<input id=\"txtVlOwner\"  type=\"text\" value=\"' + vlOwner + '\"\>');

		// Replace server description label with select box
		var serverSelectElementHtml = '<select id=\"slctVlServer\" name=\"slctVlServer\" disabled>';
		for (var serverIndex = 0; serverIndex < globalServers.length; serverIndex++) {
		    var currentServer = globalServers[serverIndex];
		    serverSelectElementHtml += ('<option value=' + currentServer.serverId + ' ');
		    if (currentServer.serverDomainName == serverDomainName) {
		    	serverSelectElementHtml += ('selected=\"selected\"');
		    }
		  	serverSelectElementHtml += '>' + currentServer.serverDomainName + '</option>';
		}
		serverSelectElementHtml += '</select>';
		foundRow.find('#tdServerName').html(serverSelectElementHtml);

		// Replace button label
		foundRow.find('#tdSaveEditVirtualLab').html(
				'<button id="saveEditVirtualLab" onclick="onSaveVirtualLab(\''+ virtualLabID + '\')" title="Save" />');

		var editButton = foundRow.find("#saveEditVirtualLab");
		UIUtility_initializeButtonWithSelector(editButton, "ui-icon-disk");
		UIUtility_setSmallButtonPadding(editButton);
	}
}

function onSaveVirtualLab(virtualLabID) {

	var foundRow = getVirtualLabRow(virtualLabID);

	if (null != foundRow) {
	
		// Keep data in variables
		var serverId = getValueFromElement(foundRow.find('#slctVlServer'));
		var serverDomainName= getTextFromElement(foundRow.find('#slctVlServer'));
		var vlName = foundRow.find('#txtVlName').val();
		var vlReportGroup = foundRow.find('#txtVlReportGroup').val();
		var vlMailingList = foundRow.find('#txtVlMailingList').val();
		var vlMailingListForTestCoverage = foundRow.find('#txtVlMailingListForTestCoverage').val();
		var vlMailingListForNotifications = foundRow.find('#txtVlMailingListForNotifications').val();
		var vlOwner = foundRow.find('#txtVlOwner').val();
		
		// Validate that the dns name and virtual lab name not empty + one virtual lab is configured as default
		var isValid = validateSaveVirtualLab(serverDomainName, vlName, vlMailingList, vlMailingListForTestCoverage, vlMailingListForNotifications);
		if (!isValid) {
			return;
		}
		
		// Peform the update
		performUpdateVirtualLab(foundRow, virtualLabID, serverId, serverDomainName, vlName, vlReportGroup, vlMailingList, vlMailingListForTestCoverage, vlMailingListForNotifications, vlOwner);
	}
}

function onAddVirtualLab() {

	// Get the values from the form
	var serverId = getValueFromElement($('#slctAddVirtualLabServer'));
	var serverDescription = getTextFromElement($('#slctAddVirtualLabServer'));
	var virtualLabName = $('#addVirtualLabVirtualLabName').val();
	var reportGroup = $('#addVirtualLabReportGroup').val();
	var mailingListForLabStatus = $('#addVirtualLabVirtualLabMailingList').val();
	var mailingListForTestCoverage = $('#addVirtualLabVirtualLabMailingListForTestCoverage').val();
	var mailingListForNotifications = $('#addVirtualLabMailingListForNotifications').val();
	var owner = $('#addVirtualLabVirtualLabOwner').val();
	
	// Prepare the virtual lab object
	var virtualLab = {};
	virtualLab.serverId = serverId;
	virtualLab.virtualLabName = virtualLabName;
	virtualLab.reportGroup = reportGroup;
	virtualLab.mailingListForLabStatus = mailingListForLabStatus;
	virtualLab.mailingListForTestCoverage = mailingListForTestCoverage;
	virtualLab.mailingListForNotifications = mailingListForNotifications;
	virtualLab.owner = owner;

	// Validate that the server description and the virtual lab name are not empty
	var isValid = validateSaveVirtualLab(serverDescription, virtualLabName);
	if (!isValid) {
		return;
	}

	// Peform the add
	performAddVirtualLab(virtualLab, serverDescription);
}

function onDeleteVirtualLab(virtualLabID) {

	// Keep the virtual lab id in the dialog
	$('#deleteVirtualLabConfirmDialog').find('#hdnVirtualLabId').val(virtualLabID)

	// Show the confirm dialog
	$('#deleteVirtualLabConfirmDialog').dialog('open');
}

function virtualLabs_onConfirmDeleteVirtualLab() {
	
	// Extract the virtual lab from the dialog
	var virtualLabID = $('#deleteVirtualLabConfirmDialog').find('#hdnVirtualLabId').val();
	
	// Get the row
	var foundRow = getVirtualLabRow(virtualLabID);

	if (foundRow != null) {
		performDeleteVirtualLab(foundRow, virtualLabID);
	}
}

function performAddVirtualLab(virtualLab, serverDescription) {
	
	// Prepare the request
	var jsonRequest = virtualLab;
	
	// Post
	var link = "/tasks/VirtualLabManagement_AddVirtualLab";
	var async = true;
	PostJsonWithJsonFeedbackFuncs(link, async, jsonRequest, 
		function(jsonResponse) {
		
			// Extract the virtual Lab ID
			var virtualLabId = jsonResponse.virtualLabId;
			
			// Populate the row to be added
			var newRow = '<tr data-vl-row-type="view" data-virtual-lab-id="' + virtualLabId + '" data-server-id="' + virtualLab.serverId + '">' +
							'<td id="tdServerName">' + serverDescription + '</td>' + 
							'<td id="tdVirtualLabName">' + virtualLab.virtualLabName + '</td>' +
							'<td id="tdReportGroup">' + virtualLab.reportGroup + '</td>' +
							'<td id="tdLabStatusMailingList">' + virtualLab.mailingListForLabStatus + '</td>' +
							'<td id="tdTestCoverageMailingList">' + virtualLab.mailingListForTestCoverage + '</td>' +
							'<td id="tdNotificationsMailingList">' + virtualLab.mailingListForNotifications + '</td>' + 
							'<td id="tdVirtualLabOwner">' + virtualLab.owner + '</td>' +
							'<td id="tdSaveEditVirtualLab"><button id="saveEditVirtualLab" onclick="onEditVirtualLab(\''+ virtualLabId + '\')" title="Edit" /></td>' +
							'<td><button id="deleteVirtualLab" onclick="onDeleteVirtualLab(\''+ virtualLabId + '\')" title="Delete" /></td>' +
						'<tr>';

			// Add the new row to the table
			$('#tblVirtualLabs tr:last').before(newRow);

			// Initialize buttons
			var row = $('#tblVirtualLabs tr[data-virtual-lab-id]:last');
			var editButton = row.find("#saveEditVirtualLab");
			UIUtility_initializeButtonWithSelector(editButton, "ui-icon-pencil");
			UIUtility_setSmallButtonPadding(editButton);
			var deleteButton = row.find("#deleteVirtualLab");
			UIUtility_initializeButtonWithSelector(deleteButton, "ui-icon-trash");
			UIUtility_setSmallButtonPadding(deleteButton);

			// Clear the textboxes
			$('#addVirtualLabVirtualLabName').val('');
			$('#addVirtualLabReportGroup').val('');
			$('#addVirtualLabVirtualLabMailingList').val('');
			$('#addVirtualLabVirtualLabMailingListForTestCoverage').val('');
			$('#addVirtualLabMailingListForNotifications').val('');
			$('#addVirtualLabVirtualLabOwner').val('');
		},
		function(textResponse) {
			UIUtility_showAlert('Failed to add virtual lab [' + virtualLab.virtualLabName + ']: ' + textResponse , 'Add');
		}
	);
}

function performUpdateVirtualLab(row, virtualLabId, serverId, serverDomainName, virtualLabName, reportGroup, mailingListForLabStatus, mailingListForTestCoverage, mailingListForNotifications, owner) {

	// Prepare the request
	var jsonRequest = {};
	jsonRequest.virtualLabId = virtualLabId;
	jsonRequest.virtualLabName = virtualLabName;
	jsonRequest.serverId = serverId;
	jsonRequest.reportGroup = reportGroup;
	jsonRequest.mailingListForLabStatus = mailingListForLabStatus;
	jsonRequest.mailingListForTestCoverage = mailingListForTestCoverage;
	jsonRequest.mailingListForNotifications = mailingListForNotifications;
	jsonRequest.owner = owner;
	
	// Post
	var link = "/tasks/VirtualLabManagement_UpdateVirtualLab";
	var async = true;
	PostJsonWithJsonFeedbackFuncs(link, async, jsonRequest, 
		function(jsonResponse) {

			// Set the row as view
			row.attr('data-vl-row-type', 'view');

			// Update hidden fields
			row.attr('data-server-id', serverId);

			// Replace all labels by inputs text
			row.find('#tdServerName').html(serverDomainName);
			row.find('#tdVirtualLabName').html(virtualLabName);
			row.find('#tdReportGroup').html(reportGroup);
			row.find('#tdLabStatusMailingList').html(mailingListForLabStatus);
			row.find('#tdTestCoverageMailingList').html(mailingListForTestCoverage);
			row.find('#tdNotificationsMailingList').html(mailingListForNotifications);
			row.find('#tdVirtualLabOwner').html(owner);

			// Replace button label
			row.find('#tdSaveEditVirtualLab').html(
					'<button id="saveEditVirtualLab" onclick="onEditVirtualLab(\''+ virtualLabId + '\')" title="Edit" />');
			var editButton = row.find("#saveEditVirtualLab");
			UIUtility_initializeButtonWithSelector(editButton, "ui-icon-pencil");
			UIUtility_setSmallButtonPadding(editButton);
		},
		function(textResponse) {
			UIUtility_showAlert('Failed to update virtual lab [' + virtualLabName + ']: ' + textResponse , 'Update');
		}
	);
}

function performDeleteVirtualLab(row, virtualLabId) {
	
	// Prepare the request
	var jsonRequest = {};
	jsonRequest.virtualLabId = virtualLabId;

	// Post
	var link = "/tasks/VirtualLabManagement_DeleteVirtualLab"; 
	var async = true;
	PostJsonWithJsonFeedbackFuncs(link, async, jsonRequest, 
		function(jsonResponse) {
			// Success, refresh the page because the groups might change too
			reloadPage();
		},
		function(textResponse) {
			UIUtility_showAlert('Failed to delete virtual lab ID [' + virtualLabId + ']: ' + textResponse , 'Delete');
		}
	);
}

function validateSaveVirtualLab(serverDomainName, vlName, vlMailingList, vlMailingListForTestCoverage, vlMailingListForNotifications) {
	// Make sure that the DNS name is not empty
	if (isStringEmpty(serverDomainName)) {
		UIUtility_showAlert('The lab manager DNS name should not be empty', "Error");
		return false;
	}

	// Make sure that the virtual lab name is not empty
	if (isStringEmpty(vlName)) {
		UIUtility_showAlert('The virtual lab name should not be empty', "Error");
		return false;
	}

	// Mailing lists

	if (!isStringEmpty(vlMailingList)) {
		var validationResult = validateMailingList(vlMailingList);
		if (validationResult != true) {
			UIUtility_showAlert("Status mailing list - invalid email: " + validationResult + ". Please use a valid @apple.com or @group.apple.com email address.", "Error");
			return false;
		}
	}

	if (!isStringEmpty(vlMailingListForTestCoverage)) {
		var validationResult = validateMailingList(vlMailingListForTestCoverage);
		if (validationResult != true) {
			UIUtility_showAlert("Coverage mailing list - invalid email: " + validationResult + ". Please use a valid @apple.com or @group.apple.com email address.", "Error");
			return false;
		}
	}

	if (!isStringEmpty(vlMailingListForNotifications)) {
		var validationResult = validateMailingList(vlMailingListForNotifications);
		if (validationResult != true) {
			UIUtility_showAlert("Notifications mailing list - invalid email: " + validationResult + ". Please use a valid @apple.com or @group.apple.com email address.", "Error");
			return false;
		}
	}

	return true;
}

function getVirtualLabRow(virtualLabID) {
	
	var foundRow = null;
	$('#tblVirtualLabs tbody tr').each(function() {
		
		var curVirtualLabID = $(this).attr('data-virtual-lab-id');
		if (virtualLabID == curVirtualLabID) {
			foundRow = $(this);
			return;
		}
	});
	
	return foundRow;
}

function renderVirtualLabs(slctVirtualLabId) {
	
	// Extract the virtual labs as json
	var virtualLabsAsJson = getVirtualLabsData();
	
	// Clear the virtual lab select box
	$('#' + slctVirtualLabId).html('');
	
	// Get the virtual lab ids
	var virtualLabIds = virtualLabsAsJson.virtualLabIds;
	
	// Iterate over the virtual labs
	for (var virtualLabIndex = 0; virtualLabIndex < virtualLabIds.length; virtualLabIndex++) {
		
		// The current virtual lab id
		var virtualLabId = virtualLabIds[virtualLabIndex];
		
		// Get the virtual lab
		var virtualLab = getVirtualLabAsJson(virtualLabsAsJson, virtualLabId);
		
		if (virtualLab.virtualLabBelongToServer)
		{
			// Append the option
			$('#' + slctVirtualLabId).append(
				'<option belong-to-server="true" value="' + virtualLab.virtualLabId + '">' + virtualLab.virtualLabName + '</option>');
		}
	}
}

function VirtualLabs_OnSelectVirtualLabGroup() {
	var groupId = $("#slctVirtualLabGroups").val();
	var group = globalGroups["" + groupId];
	console.log(group);
}

function VirtualLabs_OnEditGroup(row) {
	// Extract information from row if we have any
	var groupId = 0;
	var groupName = "";
	var virtualLabNames = [];
	if (row != undefined) {
		groupId = row.attr('data-group-id');
		groupName = row.find("#tdGroupName").text().trim();
		var parts = row.find("#tdVirtualLabNames").text().trim().split(",");
		for (var i = 0; i < parts.length; i++) {
			var part = parts[i].trim();
			if (!isStringEmpty(part)) {
				virtualLabNames.push(part);
			}
		}
	}

	var message = "Name: <input type='text' id='txtGroupName' value='" + groupName + "'></input><br/><br/>";

	// Add select box for virtual lab names
	message += "Virtual labs:<br/><select id='slctGroupVirtualLabs' multiple='true' style='width: 545px;'>";
	$("#tblVirtualLabs > tbody > tr[data-virtual-lab-id]").each(function () {
		var row = $(this);
		var virtualLabName = row.find("#tdVirtualLabName").text().trim();
		message += "<option value='" + row.attr('data-virtual-lab-id') + "'";
		if (virtualLabNames.indexOf(virtualLabName) != -1) {
			message += " selected";
		}
		message += ">" + virtualLabName + "</option>";
	});
	message += "</select>";

	UIUtility_showConfirmDialog(message, "Virtual Lab Group", function () {
		// Get virtual lab IDs for selected names
		var virtualLabIds = $("#slctGroupVirtualLabs").val();

		// Get group name and make sure its unique
		var foundId = undefined;
		var groupName = $("#txtGroupName").val();
		$("#tblGroups > tbody > tr").each(function () {
			var row = $(this);
			if (row.find("td:eq(0)").text().trim() == groupName) {
				foundId = row.attr('data-group-id');
			}
		});
		if (foundId != undefined && foundId != groupId) {
			UIUtility_showAlert("Group already exists, please choose a different name", "Error");
			return;
		}
		if (groupName == "All") {
			UIUtility_showAlert("The group name All is reserved, please choose a different name", "Error");
			return;
		}
		if (virtualLabIds == null || virtualLabIds.length == 0) {
			UIUtility_showAlert("You must select at least one virtual lab", "Error");
			return;
		}

		// Send request
		PostJsonWithJsonFeedbackFuncs('/tasks/VirtualLabManagement_PersistVirtualLabGroup', true, {
			groupId: groupId,
			groupName: groupName,
			virtualLabIds: virtualLabIds
		}, function (result) {
			// Build virtual lab names string
			var virtualLabNamesStr = "";
			for (var i = 0; i < virtualLabIds.length; i++) {
				if (virtualLabNamesStr != "") {
					virtualLabNamesStr += ", ";
				}
				virtualLabNamesStr += $("#tblVirtualLabs > tbody > tr[data-virtual-lab-id='" + virtualLabIds[i] + "'] > #tdVirtualLabName").text().trim();
			}

			if (row == undefined) {
				// Add row
				var rowHtml = "<tr data-group-id='" + result.id + "'><td id='tdGroupName'>" + groupName + "</td><td id='tdVirtualLabNames'>" + virtualLabNamesStr + "</td><td>"
				+ "<button id='btnEditGroup' onclick=\"VirtualLabs_OnEditGroup($(this).closest('tr'));\"></button> "
				+ "<button id='btnDeleteGroup' onclick=\"VirtualLabs_OnDeleteGroup($(this).closest('tr'));\"></button></td></tr>";
				var groupsTbody = $("#tblGroups > tbody");
				groupsTbody.append(rowHtml);

				// Edit group button
				var editGroupButton = groupsTbody.find("> tr:last #btnEditGroup");
				UIUtility_initializeButtonWithSelector(editGroupButton, "ui-icon-pencil");
				UIUtility_setSmallButtonPadding(editGroupButton);

				// Delete group button
				var deleteGroupButton = groupsTbody.find("> tr:last #btnDeleteGroup");
				UIUtility_initializeButtonWithSelector(deleteGroupButton, "ui-icon-trash");
				UIUtility_setSmallButtonPadding(deleteGroupButton);
			} else {
				row.find("#tdGroupName").html(groupName);
				row.find("#tdVirtualLabNames").html(virtualLabNamesStr);
			}
		}, function (error) {
			UIUtility_showAlert(error, "Error");
		});
	}, 600, 500);

	// Make select box selectize
	$("#slctGroupVirtualLabs").selectize();
}

function VirtualLabs_OnDeleteGroup(row) {
	var groupId = row.attr('data-group-id');
	var groupName = row.find("#tdGroupName").text().trim();
	UIUtility_showConfirmDialog("Are you sure you want to delete group " + groupName + "?", "Delete Virtual Lab Group", function () {
		pageLoading();
		Get('/tasks/VirtualLabManagement_DeleteVirtualLabGroup/' + groupId,
			function () {
				pageFinishedLoading();
				row.remove();
			},
			function (error) {
				pageFinishedLoading();
				UIUtility_showAlert(error, "Error");
			});
	});
}

/** javascripts/virtuallabsjs/VirtualLabsMultiSelection.js **/
function populateSelectedVirtualLabs() {

	populateSelectedOptions('slctVirtualLabs', 'hdnSelectedVirtualLabs');
	
	// Populate if to show results with empty virtual lab 
	var isToShowResultsWithEmptyVirtualLab = $('#chkShowResultsWithoutVirtualLab').is(':checked');
	$('#hdnChkShowResultsWithoutVirtualLab').val(isToShowResultsWithEmptyVirtualLab);
}
/** javascripts/projectsjs/ProjectsEventsHelper.js **/
function projects_onNewProjectConfirm() {
	
	var projectName = $("#newProjectName").val();
	if (projectName == "" || projects_doesProjectNameExist(projectName)) {
		
		$("#nameExistsDialog").dialog("open");
	
	} else {
		
		// Clear name input (for next time the dialog will be shown)
		$("#newProjectName").val("");

		// New project has all value IDs selected
		var setupParameterValueIds = new Array();
		var setupParameters = globalSetupParameters.setupParameters;
		for (var setupParameterIndex = 0; setupParameterIndex < setupParameters.length; setupParameterIndex++) {
			var setupParameterObj = setupParameters[setupParameterIndex];
			var setupParameterValues = setupParameterObj.setupParameterValues;
			for (var setupParameterValueIndex = 0; setupParameterValueIndex < setupParameterValues.length; setupParameterValueIndex++) {
				var setupParameterValueObj = setupParameterValues[setupParameterValueIndex];
				setupParameterValueIds.push(setupParameterValueObj.setupParameterValueId);
			}
		}
		
		// Prepare the project object
		var project = {};
		project.projectId = 0;
		project.projectName = projectName;
		project.virtualCombinationId = 0;
		project.includeAllSetups = false;
		
		// Prepare the virtual combination object
		var virtualCombination = {};
		virtualCombination.virtualCombinationId = 0;
		virtualCombination.virtualCombinationName = projectName;
		virtualCombination.projectSpec = true;
		virtualCombination.noCoverageSetupParameterIds = [];
		virtualCombination.setupParameterValueIds = setupParameterValueIds;

		// Load new (empty) project for save
		var projectData = {};
		projectData.project = project;
		projectData.virtualCombination = virtualCombination;
		var allowedPermutationsGroups = []; // TODO: Load allowed permutations groups of default test version when loading the projects in projects_loadProjects
		projects_loadProjectContent(projectData, allowedPermutationsGroups);

		// Collapse section
		$("#newProjectHeader").click();
		
		// Show the project content section
		projects_showProjectContentProjectsManagement();
	}
}

function projects_onSaveProject() {

	// Confirm
	UIUtility_showConfirmDialog("You are about to make changes to the project. Are you sure?", "Save", projects_onSaveProject_confirm);
}

function projects_onSaveProject_confirm() {

	var name = $("#lblProjectName").html();
	projects_saveProject(name);
}

function projects_saveProject(saveProjectAsName) {
	
	// Clear previous errors
	setValueInProjectOperationErrorProjectsManagement('');

	// Extract the project name
	var projectName = $('#lblProjectName').html();

	if (!isStringEmpty(saveProjectAsName)) {
		// If the given parameter is not empty - take it - this means that the 'Save As' operation took place
		projectName = saveProjectAsName;
	}

	// Make sure the project name is not empty
	if (isStringEmpty(projectName)) {
		setValueInProjectOperationErrorProjectsManagement('The project name is missing!');
		return;
	}

	var autoDeploymentWorkflowId = $("#slctAutoDeployment option:selected").attr('data-id');
	if (autoDeploymentWorkflowId == 0) {
		autoDeploymentWorkflowId = undefined;
	}

	var serverAutoDeploymentWorkflowId = $("#slctServerAutoDeployment option:selected").attr('data-id');
	if (serverAutoDeploymentWorkflowId == 0) {
		serverAutoDeploymentWorkflowId = undefined;
	}

	var checkedSetupParameterValueIds = undefined;
	if (!isClosedLoop()) {
		// Extract the virtual combination checked setup parameters
		var vcCheckedSetupParameters = populateCheckedSetupParametersInVirtualCombination();

		// Make sure it is valid
		if (!vcCheckedSetupParameters.isValid) {
			setValueInProjectOperationErrorProjectsManagement('Please configure each one of the setup parameters!<br />Project is not saved');
			return;
		}

		checkedSetupParameterValueIds = vcCheckedSetupParameters.checkedSetupParameterValueIds;
	}

	// Send the save project to the server
	sendSaveProjectProjectsManagement(projectName, checkedSetupParameterValueIds, autoDeploymentWorkflowId, serverAutoDeploymentWorkflowId);
}

function sendSaveProjectProjectsManagement(projectName, setupParameterValueIds, autoDeploymentWorkflowId, serverAutoDeploymentWorkflowId) {
	
	// Populate the project as JSON
	var projectAsJson = {
			"projectId":"",
			"projectName":"",
			"includeAllSetups":""
	};

	// Set the project id
	projectAsJson.projectId = $('#hdnProjectId').val();
	
	// Set the project name
	projectAsJson.projectName = projectName;

	// Set auto deployment workflow ID if there is one
	if (autoDeploymentWorkflowId != undefined) {
		projectAsJson.autoDeploymentWorkflowId = autoDeploymentWorkflowId;
	}
	
	// Set auto deployment workflow ID if there is one
	if (serverAutoDeploymentWorkflowId != undefined) {
		projectAsJson.serverAutoDeploymentWorkflowId = serverAutoDeploymentWorkflowId;
	}

	// Set the include all setups flag 
	var includeAllSetupsValue =  $('#hdnIncludeAllSetups').val();
	if (!includeAllSetupsValue) {
		includeAllSetupsValue = false;
	}

	projectAsJson.includeAllSetups = includeAllSetupsValue;

	var allowedPermutationsGroupId = getValueFromElement('#slctAllowedPermutationsGroup');
	projectAsJson.allowedPermutationsGroupId = allowedPermutationsGroupId;
	
	// Combine both project and virtual combination in one whole json
	var projectDataAsJson = new Object();
	
	// Set the project
	projectDataAsJson.project = projectAsJson;
	
	if (isClosedLoop()) {
		// Don't update virtual combination for SSD, and test version is irrelevant because of that
		projectDataAsJson.updateVC = false;
		projectDataAsJson.testVersionId = 0;
	} else {
		// Set the virtual combination
		var virtualCombinationAsJson = populateJsonForSavingVC(projectName, setupParameterValueIds, new Array());
		projectDataAsJson.virtualCombination = virtualCombinationAsJson;
	}

	// Post
	var link = '/tasks/SaveProject';
	var async = true;
	PostJsonWithJsonFeedbackFuncs(link, async, projectDataAsJson, 
		function () {
			projects_loadProjects();
		},
		function (textResponse) {
			UIUtility_showAlert('Failed to save project: [' + textResponse + ']', 'Save');
		}
	);
}

function onArchiveProjectProjectsManagement() {
	
	// Extract the original project name (so if the user type other name, we will have the original one)
	var originalProjectName = $('#hdnOriginalProjectName').val();
	
	// Populate the text of the project name
	$('#lblProjectNameToArchive').html(originalProjectName);
	
	// Show the dialog
	$("#archiveProjectDialog").dialog("open");
}

function onArchiveProjectConfirmProjectsManagement() {
	
	// Extract both project id & virtual combination id
	var projectId 			 = $('#hdnProjectId').val();
	var virtualCombinationId = $('#hdnVirtualCombinationId').val();
	
	// Post
	var link = '/tasks/ArchiveProject';
	var async = true;
	var request = {};
	request.projectId = projectId;
	request.virtualCombinationId = virtualCombinationId;
	PostJsonWithJsonFeedbackFuncs(link, async, request, 
		function(jsonResponse) {
			hideProjectContentProjectsManagement();
			projects_loadProjects();
			$("#inputSelectProject").combobox("setValue", "");
		},
		function(textResponse) {
			UIUtility_showAlert('Failed to archive project: [' + textResponse + ']', 'Archive');
		}
	);
	
	// Close the dialog of the archive
	$("#archiveProjectDialog").dialog("close");
}

function onRenameProjectOpen() {
	$("#renameProjectName").val('');
	$("#renameProjectDialog").dialog("open");
}

function onRenameProjectConfirm() {
	var oldName = $("#hdnOriginalProjectName").val();
	var newName = $("#renameProjectName").val();
	if (newName == "" || projects_doesProjectNameExist(newName)) {
		$("#lblProjectName").html(oldName);
		$("#nameExistsDialog").dialog("open");
	} else {
		$("#renameProjectDialog").dialog("close");
		projects_saveProject(newName, function () {
			projects_loadProjects()
			$("#lblProjectName").html(newName);
		});
	}
}

function onDuplicateProjectOpen() {
	$("#dupProjectName").val('');
	$("#duplicateProjectDialog").dialog("open");
}

function onDuplicateProjectConfirm() {
	var newName = $("#dupProjectName").val();
	if (newName == "" || projects_doesProjectNameExist(newName)) {
		$("#nameExistsDialog").dialog("open");
	} else {
		$("#duplicateProjectDialog").dialog("close");

		// Clear the hidden virtual combination id so a new virtual combination will be created
		$('#hdnProjectId').val('0');

		// Save new project
		projects_saveProject(newName);
	}
}
/** javascripts/projectsjs/ProjectsManagement.js **/
var globalProjects_toggleButtons = [];
var globalProjects_toggleStates = {};
var globalProjectNameToProjectId = {};

function projects_doesProjectNameExist(projectName) {
	var projectNameExists = false;
	// Check project names
	projectNameExists = globalProjectNameToProjectId.hasOwnProperty(projectName)
	// TODO: Check VC names (cause for a new project a new VC wih the project name is created)
	
	return projectNameExists;
}

function projects_loadProjects() {
	var link = '/tasks/LoadProjects';
	var async = true;
	var request = {};
	PostJsonWithJsonFeedbackFuncs(link, async, request, 
		function(jsonResponse) {
			var html = "";
			var projectNames = [];
			for (var projectIndex = 0; projectIndex < jsonResponse.projects.length; projectIndex++) {
				var project = jsonResponse.projects[projectIndex];
				html += "<option id='" + project.projectName + "'>" + project.projectName + "</option>";
				projectNames.push(project.projectName);
				globalProjectNameToProjectId[project.projectName] = project.projectId;
			}
			$('#inputSelectProject').html(html);
			$('#inputSelectProject').combobox({});
			$('#inputSelectProject').data('projectNames', projectNames);
			$('#inputSelectProject').combobox("setValue", "");
		}, function(textResponse) {
			UIUtility_showAlert('Failed to load projects: [' + textResponse + ']', 'Load');
		}
	);
}

function Projects_OnLoadProject() {
	var projectName = getValueFromElement($('#inputSelectProject'));
	var projectId = globalProjectNameToProjectId[projectName];
	projects_loadProjectData(projectId);
}

function projects_loadProjectData(projectId) {
	var request = { projectId: projectId };
	if (isClosedLoop()) {
		request.testVersionId = 0;
	}
	var link = '/tasks/loadProjectData';
	var async = true;
	PostJsonWithJsonFeedbackFuncs(link, async, request, 
		function(jsonResponse) {
			projects_renderProject(jsonResponse.projectData, jsonResponse.allowedPermutationsGroups);
		}, function(textResponse) {
			UIUtility_showAlert('Failed to load project: [' + textResponse + ']', 'Load');
		}
	);
}

function projects_renderProject(projectData, allowedPermutationsGroups) {
	
	// Render the project content
	projects_renderProjectContent(projectData, allowedPermutationsGroups);

	// If project is 'Default', disable all fields and delete button
	if (projectData.project.projectName == 'Default') {
		$("input[type=checkbox]").attr("disabled", true);
		$("#archiveProjectButton").button("disable");
		$("#revertProjectButton").button("disable");
		$("#renameProjectButton").button("disable");
	} else {
		$("input[type=checkbox]").removeAttr("disabled");
		$("#archiveProjectButton").button("enable");
		$("#revertProjectButton").button("enable");
		$("#renameProjectButton").button("enable");
	}
}

function projects_renderProjectContent(projectData, allowedPermutationsGroups) {
	
	// Load data
	projects_loadProjectContent(projectData, allowedPermutationsGroups);

	// Show the project content section
	projects_showProjectContentProjectsManagement();
}

function projects_showProjectContentProjectsManagement() {
	// Clear previous errors
	setValueInProjectOperationErrorProjectsManagement('');
	
	$('#divProjectContent').removeClass('inactive');
}

function projects_loadProjectContent(projectData, allowedPermutationsGroups) {
	
	var project = projectData.project;
	var virtualCombination = projectData.virtualCombination;
	
	// Store the project id in the hidden input
	$('#hdnProjectId').val(project.projectId);
	
	// Store the project name in the hidden input
	$('#hdnOriginalProjectName').val(project.projectName);

	// Store the virtual combination id in the hidden input
	$('#hdnVirtualCombinationId').val(project.virtualCombinationId);

	// Render the project name
	$('#lblProjectName').html(project.projectName);

	// Store the virtual combination id in the hidden input
	$('#hdnIncludeAllSetups').val(project.includeAllSetups);

	// Default auto deployment selector
	if (project.autoDeploymentWorkflowId == undefined) {
		project.autoDeploymentWorkflowId = 0;
	}
	$("#slctAutoDeployment option[data-id='" + project.autoDeploymentWorkflowId + "']").prop("selected", true);

	// Server auto deployment selector
	if (project.serverAutoDeploymentWorkflowId == undefined) {
		project.serverAutoDeploymentWorkflowId = 0;
	}
	$("#slctServerAutoDeployment option[data-id='" + project.serverAutoDeploymentWorkflowId + "']").prop("selected", true);

	// Allowed permutations selector
	var allowedPermutationsGroupSelectorHtml = '';
	allowedPermutationsGroupSelectorHtml += '<option value="0">Default</option>';
	for (var groupIndex = 0; groupIndex < allowedPermutationsGroups.length; groupIndex++) {
		var currentGroup = allowedPermutationsGroups[groupIndex];
		allowedPermutationsGroupSelectorHtml += '<option value="' + currentGroup.allowedPermutationsGroupId + '" ';
		if (currentGroup.allowedPermutationsGroupId == project.allowedPermutationsGroupId) {
			allowedPermutationsGroupSelectorHtml += 'selected="selected" ';
		}
		allowedPermutationsGroupSelectorHtml += '">' + currentGroup.allowedPermutationsGroupName + '</option>';
	}
	$('#slctAllowedPermutationsGroup').html(allowedPermutationsGroupSelectorHtml);

	if (!isClosedLoop()) {
		// Render the virtual combination setup parameters
		projects_renderSetupParameters(virtualCombination);
	}
}

function projects_renderSetupParameters(virtualCombination) {

	// First clear the table content
	removeAllTableRows('tblVirtualCombinationSetupParameters');

	// Iterate over the setup parameters
	for (var setupParameterIndex = 0; setupParameterIndex < globalSetupParameters.setupParameters.length; setupParameterIndex++) {
	
		// The current setup parameter
		var setupParameter = globalSetupParameters.setupParameters[setupParameterIndex];
		
		// Render the setup parameter
		projects_renderSetupParameter(setupParameter, virtualCombination);
	}
}

function projects_renderSetupParameter(setupParameter, virtualCombination) {

	// Get the setup parameter id
	var setupParameterId = setupParameter.setupParameterId;
	
	// Get the setup parameter values
	var setupParameterValues = setupParameter.setupParameterValues;
	
	// Populate the row
	var setupParameterAsRow = '<tr>';
	
	// Attach the name
	setupParameterAsRow += '<td id="setupParamID" data-setup-parameter-id="' + setupParameter.setupParameterId + '">' + setupParameter.setupParameterName + '</td>';
	
	// Attach the values
	setupParameterAsRow += '<td>';

	// Keep a flag that indicates if any setup parameter value was chosen
	var anySetupParameterValueWasChosen = false;
	for (var setupParameterValueIndex = 0; setupParameterValueIndex < setupParameterValues.length; setupParameterValueIndex++) {
	
		var setupParameterValueObj = setupParameterValues[setupParameterValueIndex];
		
		// Get the setup parameter value id
		var setupParameterValueId = setupParameterValueObj.setupParameterValueId;
		
		// Get the setup parameter value
		var setupParameterValue = setupParameterValueObj.setupParameterValue;
		
		// Determine if the setup parameter value is already checked in the virtual combination
		var setupParameterValueExist = $.inArray(setupParameterValueId, virtualCombination.setupParameterValueIds);
		
		// Attach the value into the row
		setupParameterAsRow += 
			'<input id="setupParameterValue" type="checkbox" ' + 
			'data-setup-parameter-value-id="' + setupParameterValueId + '"' +
			'value="' + setupParameterValue + '"'; 
		
		if (setupParameterValueExist >= 0) {
			setupParameterAsRow += ' checked="true"';
			anySetupParameterValueWasChosen = true;
		}
		
		setupParameterAsRow += '"/>  ' + setupParameterValue + '  ';
	}
	
	// Determine if the setup parameter id is already checked by the virtual combination (as no coverage)
	var noCoveragetupParameterIdExist = $.inArray(setupParameterId, virtualCombination.noCoverageSetupParameterIds);
	
	// Close the column that contains all setup parameter values
	setupParameterAsRow += '</td>';
	
	// Close the row
	setupParameterAsRow += '</tr>';
		
	// Add the row
	$("#tblVirtualCombinationSetupParameters tbody").append(setupParameterAsRow);
}
/** javascripts/projectsjs/ProjectsRenderHelper.js **/
function projects_initializeToggleBehaviour(toggleBtnId, btnIcon, divIdToToggleFor, callBack) {	
	UIUtility_initializeToggleBehaviour(
			toggleBtnId, btnIcon, divIdToToggleFor, globalProjects_toggleButtons, globalProjects_toggleStates, callBack);
}

function Projects_initializeButtons() {
	UIUtility_initializeButton('addProject'				  , 'ui-icon-document');
	UIUtility_initializeButton('btnSaveProject'			  , 'ui-icon-disk');
	UIUtility_initializeButton('btnLoadProject'			  , 'ui-icon-folder-open');
	UIUtility_initializeButton('duplicateProjectButton'	  , 'ui-icon-copy');
	UIUtility_initializeButton('archiveProjectButton'	  , 'ui-icon-trash');
	UIUtility_initializeButton('revertProjectButton'	  , 'ui-icon-arrowreturn-1-w');
	UIUtility_initializeButton('renameProjectButton'	  , 'ui-icon-pencil');
}

function initializeDuplicateProjectDialogProjectsManagement() {
	$("#duplicateProjectDialog").dialog({
		autoOpen: false,
		height: 250,
		width: 350,
		modal: true,
		buttons: {
			"Confirm": function() {
				onDuplicateProjectConfirm();
	        },
	        "Cancel": function() {
	        	// Close the dialog
	    	  	$(this).dialog("close");
	        }
		},
	});
}

function initializeRenameProjectDialogProjectsManagement() {
	$("#renameProjectDialog").dialog({
		autoOpen: false,
		height: 250,
		width: 350,
		modal: true,
		buttons: {
			"Confirm": function() {
				onRenameProjectConfirm();
	        },
	        "Cancel": function() {
	        	// Close the dialog
	    	  	$(this).dialog("close");
	        }
		},
	});
}

function initializeArchiveProjectDialogProjectsManagement() {
	$("#archiveProjectDialog").dialog({
		autoOpen: false,
		height: 250,
		width: 350,
		modal: true,
		buttons: {
			"Confirm": function() {
				onArchiveProjectConfirmProjectsManagement();
	        },
	        "Cancel": function() {
	        	// Close the dialog
	    	  	$(this).dialog("close");
	        }
		},
	});
}

function hideProjectContentProjectsManagement() {
	$('#divProjectContent').addClass('inactive');
}

function setValueInProjectOperationErrorProjectsManagement(val) {
	$('#lblProjectOperationError').html(val);
}
/** javascripts/scenariossetups/ScenariosSetupsCommonHelper.js **/
function storeConfigurationScenariosData(configurationScenariosDataAsJson) {

	// Extract the scenarios data into json
	$('#hdnConfigurationScenariosData').data('scenariosData', configurationScenariosDataAsJson.scenariosData);
	
	// Extract the virtual combination data into json
	$('#hdnVirtualCombinationsData').data('virtualCombinationsData', configurationScenariosDataAsJson.virtualCombinationData);
	
	// Store an array that includes all category names
	TestRep_CategoryNames = [];
	for (var scenarioVirtualCombinationIdIndex = 0; 
		scenarioVirtualCombinationIdIndex < configurationScenariosDataAsJson.scenariosData.scenarioVirtualCombinationIds.length; 
		scenarioVirtualCombinationIdIndex++) {
		// Extract the scenario data
		var scenarioVCId = configurationScenariosDataAsJson.scenariosData.scenarioVirtualCombinationIds[scenarioVirtualCombinationIdIndex];
		var scenarioDataAsJson = configurationScenariosDataAsJson.scenariosData[scenarioVCId];
	}
}

/**************** Configuration scenarios getters methods ****************/

function getConfigurationScenariosData() {

	var parsedJsonObj = $('#hdnConfigurationScenariosData').data('scenariosData'); 
	
	return parsedJsonObj;
}

function getConfigurationSecenarioVCIdsAsJson() {
	return getConfigurationScenariosData().scenarioVirtualCombinationIds;
}

function getConfigurationScenarioAsJson(scenarioVCId) {
	return getConfigurationScenariosData()[scenarioVCId];
}

/**************** Configuration virtual combinations getters methods ****************/

function getConfigurationVirtualCombinationsDataAsJson() {
	return getVirtualCombinationsAsJson();
}

/**************** Configuration scenarios tags getters methods ****************/

function getScenariosTagsDataAsJson() {
	return getConfigurationScenariosData().scenariosTagsData;
}

function getScenariosTagsDataScenarioIdsAsJson(scenariosTagsData) {
	return scenariosTagsData.scenarioIds;
}

/**************** Test customized attributes getters methods ****************/

function getCustomizedAttributesAsJson() {
	return getConfigurationScenariosData().customizedAttributes;
}

function getTestCustomizedAttributesAsJson() {
	return getConfigurationScenariosData().testCustomizedAttributes;
}


/** javascripts/scenariossetups/ScenariosSetupsRenderHelper.js **/
var globalTestCustomizedAttributeNames = [];
var globalCustomizedAttributeValues = {};

function renderConfigurationScenarios(enableVirtualCombinationModification) {

	// Extract the template row
	var configurationScenarioTemplateRow = $('#tblScenariosTemplate tbody tr').last();
	
	// Make the template row enabled/disabled
	enableEntireTableRow(configurationScenarioTemplateRow);
	
	// Make the set row enabled/disabled
	enableEntireTableRow($('#trActionOnSelected'));

	// Update the template row virtual combinations drop down list
	renderVirtualCombinations(configurationScenarioTemplateRow, enableVirtualCombinationModification);
	
	// The template row as html
	var configurationScenarioTemplateRowAsHtml = configurationScenarioTemplateRow.html();
	
	// Add / Update / Remove test customized attribute columns
	var testRepository = false;
	configurationScenarioTemplateRowAsHtml = renderTestCustomizedAttributeColumns(testRepository, configurationScenarioTemplateRowAsHtml);
		
	// Get all scenario virtual combinations
	var scenarioVirtualCombinationIds = globalScenariosData.scenarioVirtualCombinationIds;
	
	// Indicates that all scenarios will be added to the last of the table
	var appendScenarioToLast = true;

	// Create empty rows (faster to create HTML for all in one time)
	var scenarioDataBySVC = new Object();
	var rows = new Object();
	rows.all = new Array();
	for (var scenarioVirtualCombinationIndex = 0; scenarioVirtualCombinationIndex < scenarioVirtualCombinationIds.length; scenarioVirtualCombinationIndex++) {

		// The current scenario virtual combination id
		var currentVirtualCombiantionId = scenarioVirtualCombinationIds[scenarioVirtualCombinationIndex];
		
		// Get the configuration scenario and save mapping by SVC ID
		var scenarioToRender = globalScenariosData[currentVirtualCombiantionId];
		scenarioDataBySVC["" + scenarioToRender.scenarioVirtualCombinationId] = scenarioToRender;

		var row = $('<tr id="' + scenarioToRender.scenarioVirtualCombinationId + '">' + configurationScenarioTemplateRowAsHtml + '</tr>');

		// Render configuration
		var svcIdStr = '' + scenarioToRender.scenarioVirtualCombinationId;
		renderConfigurationScenario(scenarioDataBySVC[svcIdStr], row);

		// Add to structures
		rows[svcIdStr] = row;
		rows.all.push(row);
	}

	renderTestCustomizedAttributes(rows);

	return rows;
}

function renderVirtualCombinations(templateRow, enableVirtualCombinationModification) {

	if (enableVirtualCombinationModification == undefined) {
		enableVirtualCombinationModification = true;
	}
	
	// Get a reference to the select box of the set (in the actions row)
	var setVirtualCombinationsSelectBox = $('#tblScenarios').find('#slctVirtualCombination');
	
	// Get a reference to the select box in the template row
	var virtualCombinationsSelectBox = templateRow.find('#slctVirtualCombination');
	
	// Clear the select boxes
	setVirtualCombinationsSelectBox.find('option').remove();
	virtualCombinationsSelectBox.find('option').remove();
	
	// Append the 'Set VC...' in the set selectbox
	setVirtualCombinationsSelectBox.append('<option>Set Virtual Combination...</option>');
	
	// Get the virtual combination pairs
	var virtualCombinationNames = globalVirtualCombinationsContainer.virtualCombinationNames;

	// Render the select box
	for (var virtualCombinationIndex = 0; virtualCombinationIndex < virtualCombinationNames.length; virtualCombinationIndex++) { 
		var virtualCombinationName = virtualCombinationNames[virtualCombinationIndex];
		var virtualCombination =  globalVirtualCombinationsContainer.virtualCombinations[virtualCombinationName];

		// Option to append
		var optionToAppend = '<option value="' + virtualCombination.virtualCombinationId + '">' + virtualCombination.virtualCombinationName + '</option>';

		if (enableVirtualCombinationModification) {
			// Append the pair content
			virtualCombinationsSelectBox.append(optionToAppend);
			setVirtualCombinationsSelectBox.append(optionToAppend);
		} 
	}
	if (!enableVirtualCombinationModification) {
		virtualCombinationsSelectBox.append('<option customized="true" value="0">Customized</option>');
		setVirtualCombinationsSelectBox.append('<option customized="true" value="0">Customized</option>');
	}
}

function renderConfigurationScenario(configurationScenarioToRender, newRow) {

	// Fill the scenario virtual combination id
	newRow.attr('data-scenario-virtual-combination-id', configurationScenarioToRender.scenarioVirtualCombinationId);
	
	// Fill the scenario id id attribute
	newRow.attr('data-scenario-id', configurationScenarioToRender.id);
	
	// Fill the scenario name attribute
	newRow.attr('data-scenario-name', configurationScenarioToRender.name);
	
	// Fill the hidden id with the scenario id
	newRow.find('#hdnID').val(configurationScenarioToRender.id);
	
	// Fill the scenario name
	newRow.find('#tdScenarioName').html(configurationScenarioToRender.name);
	
	// Fill the category name
	var categoryName = newRow.find('#tdCategoryName');
	categoryName.html(configurationScenarioToRender.categoryName);
	categoryName.attr('data-filter-values', configurationScenarioToRender.categoryName + ';');

	// Fill the priority
	var slctPriority = newRow.find('#slctPriority');
	slctPriority.val(configurationScenarioToRender.priority);
	slctPriority.attr('data-default-priority', configurationScenarioToRender.priority);
	slctPriority.attr('saved', configurationScenarioToRender.priority);

	// Fill the repeat
	var slctRepeat = newRow.find('#slctRepeat');
	slctRepeat.val(configurationScenarioToRender.repeat);
	slctRepeat.attr('data-default-repeat', configurationScenarioToRender.repeat);
	slctRepeat.attr('saved', configurationScenarioToRender.repeat);

	// If we have radars, set the radars
	var radars = newRow.find("#tdRadars");
	if (radars.length > 0) {
		var filter = "";
		var radarsHtml = "";
		for (var i = 0; i < configurationScenarioToRender.radars.length; i++) {
			if (i > 0) {
				radarsHtml += ", ";
				filter += ";";
			}
			radarsHtml += "<a href='rdar://problem/" + configurationScenarioToRender.radars[i] + "'>" + configurationScenarioToRender.radars[i] + "</a>";
			filter += configurationScenarioToRender.radars[i];
		}
		radars.html(radarsHtml);
		radars.attr('data-filter-values', filter);
	}

	// Fill the comment
	newRow.find('#tdComment').find('#txtComment').val(configurationScenarioToRender.comment);
	
	// Check if the option exists, if not add it
	var option = newRow.find("#slctVirtualCombination option[value='" + configurationScenarioToRender.virtualCombinationId + "']");
	if (option.length == 0) {

		// Get the virtual combination ID
		var virtualCombinationId = configurationScenarioToRender.virtualCombinationId;

		// Get the virtual combination name
		var virtualCombinationName = globalVirtualCombinationsContainer.virtualCombinationIdToName[virtualCombinationId];

		// Get the virtual combination
		var virtualCombination = globalVirtualCombinationsContainer.virtualCombinations[virtualCombinationName];

		if ("true" != virtualCombination.customized) {
			// Add the option to the select
			var optionToAppend = '<option customized="false" value="' + virtualCombinationId + '">' + virtualCombinationName + '</option>';
			newRow.find('#slctVirtualCombination').append(optionToAppend);
		} else {
			newRow.find('#slctVirtualCombination ').html('<option customized="true" value="' + virtualCombinationId + '">Customized</option>');
		}
	}

	// Fill the virtual combination name
	newRow.find('#slctVirtualCombination').val(configurationScenarioToRender.virtualCombinationId);
	newRow.find('#slctVirtualCombination').attr('saved', configurationScenarioToRender.virtualCombinationId);

	// Store the default
	newRow.find('#slctVirtualCombination').attr('default-virtual-combination-id', configurationScenarioToRender.virtualCombinationId);

	// Show the row
	newRow.attr('class', '');
	
	return newRow;
}

function renderScenariosChanges(callingElement, selectedRows) {

	// Get the the element id
	var callingElementId = callingElement.id;
	
	// Get the the element value
	var callingElementValue = getValueFromElement($(callingElement));
	
	// Reset the selection
	callingElement.selectedIndex = 0;
	
	// Iterate over the rows to modify with the given attribute value
	for (var selectedRowIndex = 0; selectedRowIndex < selectedRows.length; selectedRowIndex++) {
	
		// Get the current selected row
		var selectedRow = selectedRows[selectedRowIndex];
		
		// The element to be modified
		var elementToModify = $(selectedRow).find('#' + callingElementId);
		
		// Modify the element value
		setValueOfElement(elementToModify, callingElementValue);
		
		// If the element has an attribute that notifies to render the color / post changes - call the proper function
		invokeFunctionFromElementAttribute(elementToModify, 'renderColorFunction');
		invokeFunctionFromElementAttribute(elementToModify, 'postOnChange');
		
		// Mark element's row as dirty
		testManagement_markRowAsDirty(elementToModify);
		testManagement_markRowAsCustomized(elementToModify);
	}
}

function renderScenarioVirtualCombinationTooltip(virtualCombinationSelector, projectName) {

	var tooltipVal = '';
	
	if ('slctVirtualCombination' != virtualCombinationSelector.id) {
		return;
	}
	
	var virtualCombinationName = getTextFromElement(virtualCombinationSelector);
	
	// Get the virtual combination as JSON
	var theVirtualCombinationAsJson = globalVirtualCombinationsContainer.virtualCombinations[virtualCombinationName];
	
	if (undefined == theVirtualCombinationAsJson) {
		// If undefined, populate it from the setup parameter selections
		theVirtualCombinationAsJson = {"setupParameterValueIds": [], "noCoverageSetupParameterIds": []};

		// Get the containing row
		var theScenarioRow = $(slctVirtualCombination).closest('tr');
		
		// Get the checked any checkboxes
		var setupParameterIds = getAttributeValuesFromCheckedCheckboxesInRow(theScenarioRow, 'setup-parameter-id');
		setupParameterIds.forEach(function(setupParameterId) {
			theVirtualCombinationAsJson.noCoverageSetupParameterIds.push(parseInt(parseInt(setupParameterId)));
		});
		
		// Get the checked setup parameter value checkboxes
		var setupParameterValueIds = getAttributeValuesFromCheckedCheckboxesInRow(theScenarioRow, 'setup-parameter-value-id');
		setupParameterValueIds.forEach(function(setupParameterValueId) {
			theVirtualCombinationAsJson.setupParameterValueIds.push(parseInt(parseInt(setupParameterValueId)));
		});
	}
	
	tooltipVal = renderVirtualCombinationJsonTooltip(theVirtualCombinationAsJson, projectName);
	
	return tooltipVal;
}

function renderTestCustomizedAttributeColumns(isTestRepository, configurationScenarioTemplateRowAsHtml) {
	
	// Get the customized attributes as JSON
	var customizedAttributesJsonArr = globalScenariosData.customizedAttributes;
	
	// Loop over the customized attributes
	var newArrayOfTestCustomizedAttributeNames = new Array();
	
	if (customizedAttributesJsonArr != undefined) {
	
		// Reset the global map of customized attribute values
		globalCustomizedAttributeValues = {};
		
		for (var customizedAttributeIndex = 0; customizedAttributeIndex < customizedAttributesJsonArr.length; customizedAttributeIndex++) {
		
			// Get the customized attribute
			var customizedAttribute = customizedAttributesJsonArr[customizedAttributeIndex];
			
			// Get the entity type, customized attribute ID and name, and multiple choice flag
			var entityType = customizedAttribute.entityType;
			var customizedAttributeId = customizedAttribute.customizedAttributeId;
			var customizedAttributeName = customizedAttribute.customizedAttributeName;
			var multipleChoice = customizedAttribute.multipleChoice;
			
			// Add an entry for the customized attribute in the map of values
			globalCustomizedAttributeValues[customizedAttributeName] = [];
			
			// Add the customized attribute name to the new array of names
			newArrayOfTestCustomizedAttributeNames.push(customizedAttributeName);
			
			// Check if the table already contains the customized attribute
			var columnExists = ($.inArray(customizedAttributeName, globalTestCustomizedAttributeNames) >= 0);
			
			if (columnExists) {
				
				// Remove from the global array
				globalTestCustomizedAttributeNames.splice(globalTestCustomizedAttributeNames.indexOf(customizedAttributeName), 1);
				
			} else {
			
				// Prepare HTML for actions on selected row
				var actionOnSelectedHtml = 
					'<th ' +
					'id="th' + customizedAttributeName + '" ' +
					'name="th' + customizedAttributeName + '" ' +
					'data-entity-type="' + entityType + '" ' + 
					'data-customized-attribute-id="' + customizedAttributeId + '" ' +
					'data-customized-attribute-name="' + customizedAttributeName + '" ' +
					'data-multiple-choice="' + multipleChoice + '" ' +
					'>';
				if (isTestRepository) {
					if (multipleChoice) {
					
						actionOnSelectedHtml += 
							'<select ' +
							'id="slct' + customizedAttributeName + '" ' + 
							'name="slct' + customizedAttributeName + '" ' + 
							'onChange="testRepository_setTestCustomizedAttribute(this)" ' +
							'>' +
							'<option value="0">Set ' + customizedAttributeName + '</option>';

						// Add the customized attribute values to the select element
						for (var valueIndex = 0; valueIndex < customizedAttribute.customizedAttributeValues.length; valueIndex++) {
							
							var customizedAttributeValueId = customizedAttribute.customizedAttributeValues[valueIndex].customizedAttributeValueId;
							var customizedAttributeValue = customizedAttribute.customizedAttributeValues[valueIndex].customizedAttributeValue;
							actionOnSelectedHtml += 
								'<option value="' + customizedAttributeValueId + '">' + 
								customizedAttributeValue + 
								'</option>';
							
							// Add an entry for the customized attribute value in the map of values
							globalCustomizedAttributeValues[customizedAttributeName].push(customizedAttributeValue);
						}
						actionOnSelectedHtml += '</select>';
					
					} else {

						actionOnSelectedHtml += 
							'<input type="button" value="Set ' + customizedAttributeName + '" ' +
							'onclick="testRepository_setTestCustomizedAttributeText(this)" />';
					}
				}

				actionOnSelectedHtml += '</th>';

				// Add the column to all the rows			
				$('#tblScenarios').find('#trActionOnSelected').find('#thRightMostCell').before(actionOnSelectedHtml);

				var columnNameCellHtml = 
					('<th ' +
					'id="th' + customizedAttributeName + '" ' +
					'name="th' + customizedAttributeName + '" ' +
					'data-entity-type="' + entityType + '" ' + 
					'data-customized-attribute-id="' + customizedAttributeId + '" ' +
					'data-customized-attribute-name="' + customizedAttributeName + '" ' +
					'data-multiple-choice="' + multipleChoice + '" ' +
					'data-view="test-attributes-view" ' +
					'data-filter-enabled data-filter-refresh-on-open ');
				if (isTestRepository) {
					columnNameCellHtml += 'data-filter-search ';
				}
				columnNameCellHtml += ('>' + customizedAttributeName + '</th>');
				$('#tblScenarios').find('#trColumnNames').find('#thRightMostCell').before(columnNameCellHtml);

			}

			configurationScenarioTemplateRowAsHtml +=
				'<td ' +
				'id="td' + customizedAttributeName + '" ' +
				'name="td' + customizedAttributeName + '" ' +
				'></td>';
		}
		
		configurationScenarioTemplateRowAsHtml += '<td id="tdRightMostCell"></td>';
	}
	
	// Save the new array of test customized attribute names
	globalTestCustomizedAttributeNames = newArrayOfTestCustomizedAttributeNames;
	
	return configurationScenarioTemplateRowAsHtml;
}

function renderTestCustomizedAttributes(rows) {

	var testCustomizedAttributesJsonArr = globalScenariosData.testCustomizedAttributes;
	
	if (testCustomizedAttributesJsonArr != undefined) {

		for (var scenarioVirtualCombinationId in testCustomizedAttributesJsonArr) {

			// Get the test customized attributes
			var currentTestCustomizedAttributes = testCustomizedAttributesJsonArr[scenarioVirtualCombinationId]; 

			// Get the scenario row
			var scenarioTableRow = rows["" + scenarioVirtualCombinationId];

			// Iterate over the test customized attributes
			for (var currentCustomizedAttributeName in currentTestCustomizedAttributes) {

				// Get the value
				var currentCustomizedAttributeValue = currentTestCustomizedAttributes[currentCustomizedAttributeName];

				// Get the relevant cell
				var cell = scenarioTableRow.find('#td' + currentCustomizedAttributeName);

				// Set the value
				cell.html(currentCustomizedAttributeValue);
			}
		}
	}
}

function testManagement_markRowAsDirty(callingElement) {
	// Get the parent row
	var tr = $(callingElement).parents('tr:eq(0)');
	// Set the dirty flag
	$(tr).attr('data-dirty', true);
	// Color the row
	$(tr).addClass('TestManagementDifferentFromDefault');
}

function testManagement_markRowAsCustomized(callingElement) {
	// Get the parent row
	var tr = $(callingElement).parents('tr:eq(0)');
	// Set the customized flag
	$(tr).find('#tdRestoreDefault').attr('data-customized', true);
}
/** javascripts/testsuites/TestSuitesEventsHelper.js **/
var globalProjectNameToProjectId = {};
var globalTestSuitesMetaData = {};
var globalTestVersionId = 0;
var globalSetupParametersContainer = {};
var globalVirtualCombinationsContainer = {};
var globalScenariosData = {};
var globalTestSuiteData = {};
var globalProjectData = {};

function TestSuitesMng_loadTestSuitesMetadata(renderFunction, testSuiteIdToLoad) {
	
	var link = '/tasks/LoadTestSuitesMetadata';
	var async = true;
	var request = {};
	PostJsonWithJsonFeedbackFuncs(link, async, request,
		function(jsonResponse) {
			TestSuitesMng_loadTestSuitesMetadataResponse(jsonResponse, renderFunction, testSuiteIdToLoad);
		},
		function(textResponse) {
			UIUtility_showAlert('Failed to load test suites meta data: [' + textResponse + ']', 'Load');
		}
	);
}

function TestSuitesMng_loadTestSuitesMetadataResponse(jsonResponse, renderFunction, testSuiteIdToLoad) {
	globalTestSuitesMetaData = jsonResponse;

	// Call the render function
	invokeFunction(renderFunction);

	if (testSuiteIdToLoad != undefined) {
		// Load the test suite
		TestSuitesMng_loadTestSuite(testSuiteIdToLoad);
	}
}

function TestSuitesMng_onNewTestSuite() {

	// Clear previous errors
	$('#lblNewTestSuiteValidationError').html('');
	
	// Extract the test suite to add
	var testSuiteNameToAdd = $('#txtTestSuiteNameToAdd').val();
	
	// Extract the project name
	var projectName = getValueFromElement($('#slctProjectForNew')); 
	
	// Extract the project id
	var projectId = globalProjectNameToProjectId[projectName];
	
	// Make sure that the test suite name to add is not empty
	if (isStringEmpty(testSuiteNameToAdd)) {
		$('#lblNewTestSuiteValidationError').html("'Test Suite' field is missing");
		return;
	}
	
	// Make sure that the project id is found
	if (isStringEmpty(projectId.toString())) {
		$('#lblNewTestSuiteValidationError').html("'Project' field is missing or not configured properly");
		return;
	}
	
	// Send a request to the server to add the test suite 
	TestSuitesMng_sendNewTestSuiteRequest(testSuiteNameToAdd, projectId);
}

function TestSuitesMng_onLoadTestSuite() {
	// Extract the test suite name
	var slct = $('#slctTestSuiteForLoading');
	var testSuiteName = getValueFromElement(slct);
	slct.find("option").each(function () {
		var $this = $(this);
		if ($this.text() == testSuiteName) {
			testSuiteName = $(this).attr("value");
		}
	});

	// Extract the test suite id
	var testSuiteId = globalTestSuitesMetaData[testSuiteName].testSuiteId;

	TestSuitesMng_loadTestSuite(testSuiteId);
}

function TestSuitesMng_loadTestSuite(testSuiteId) {
	var link = '/tasks/LoadTestSuite';
	var async = true;
	var request = {};
	request.testSuiteId = testSuiteId;
	PostJsonWithJsonFeedbackFuncs(link, async, request, 
		function(jsonResponse) {
			globalTestVersionId = jsonResponse.testVersionId;
			globalSetupParametersContainer = jsonResponse.setupParametersContainer;
			globalVirtualCombinationsContainer = jsonResponse.virtualCombinationsContainer;
			globalScenariosData = jsonResponse.scenariosData.scenariosData;
			globalTestSuiteData = jsonResponse.testSuite;
			globalProjectData = jsonResponse.projectData.projectData;
			// Render the test suite data
			TestSuitesMng_renderTestSuite();

			relayoutStretchContainers();
		},
		function(textResponse) {
			UIUtility_showAlert('Failed to load test suite: [' + textResponse + ']', 'Load');
		}
	);
}

function TestSuitesMng_onArchiveTestSuiteConfirm() {

	// Extract the test suite name
	var testSuiteName = getValueFromElement($('#slctTestSuiteForArchiving'));
	var dateEnd = testSuiteName.lastIndexOf("(");
	if (dateEnd != -1) {
		testSuiteName = testSuiteName.substring(0, dateEnd).trim();
	}

	// Extract the test suite id
	var testSuiteIdToArchive = globalTestSuitesMetaData[testSuiteName].testSuiteId;
	
	// Send a request to the server to archive the test suite
	TestSuitesMng_sendRequestToArchiveTestSuite(testSuiteIdToArchive);

	$("#inputTestSuiteForArchiving").val('');
}

function TestSuitesMng_onArchiveTestSuite() {

	// Change the label of the test suite name
	$('#lblTestSuiteNameForArchiving').html(getValueFromElement($('#slctTestSuiteForArchiving')));
	
	$("#archiveTestSuiteDialog").dialog("open");
}

function TestSuitesMng_onUpdateTestSuiteScenario(callingElement) {

	// Get the row of the calling element 
	var tr = $(callingElement).parents('tr:eq(0)');

	// Put the row in an array
	var selectedRows = new Array();
	selectedRows.push(tr); 
	
	TestSuitesMng_updateTestSuiteScenarios(callingElement, selectedRows);
}

function TestSuitesMng_onUpdateTestSuiteScenarios(callingElement) {

	// Get the selected rows
	var selectedRows = getContainingTableSelectedRowsDifferentFromCallingElement(callingElement);
	
	TestSuitesMng_updateTestSuiteScenarios(callingElement, selectedRows);
}

function TestSuitesMng_updateTestSuiteScenarios(callingElement, selectedRows) {

	if (selectedRows.length > 0) {
		renderScenariosChanges(callingElement, selectedRows);
	}
}

function TestSuitesMng_onRestoreTestSuiteScenario(callingElement) {

	// Get the row of the calling element 
	var tr = $(callingElement).parents('tr:eq(0)');

	// Put the row in an array
	var selectedRows = new Array();
	selectedRows.push(tr); 
	
	TestSuitesMng_restoreTestSuiteScenarios(callingElement, selectedRows);
}

function TestSuitesMng_onRestoreTestSuiteScenarios(callingElement) {

	// Get the selected rows
	var selectedRows = getContainingTableSelectedRows(callingElement);
	
	TestSuitesMng_restoreTestSuiteScenarios(callingElement, selectedRows);
}

function TestSuitesMng_restoreTestSuiteScenarios(callingElement, selectedRows) {

	if (selectedRows.length > 0)  {
	
		TestSuitesMng_renderTestSuiteScenariosWithDefaults(selectedRows);
	}
}

function TestSuitesMng_onDuplicateTestSuite() {

	// Clear previous errors
	$('#lblDuplicateTestSuiteValidationErrorDialog').html('');
	
	// Extract the test suite name
	var testSuiteName = getValueFromElement($('#slctTestSuiteForDuplicating'));
	
	// Extract the test suite id
	var testSuiteId = globalTestSuitesMetaData[testSuiteName].testSuiteId;
	
	// Set the test suite in the dialog
	$('#duplicateTestSuiteDialog').find('#hdnTestSuiteIdForDuplicating').val(testSuiteId);
	
	// Set the test suite name in the dialog
	$('#duplicateTestSuiteDialog').find('#lblTestSuiteNameForDuplicating').html(testSuiteName);
	
	// Set the project name
	var projectName = globalTestSuitesMetaData[testSuiteName].testSuiteProjectName;
	$('#duplicateTestSuiteDialog').find('#slctProjectForDup').combobox("setValue", projectName);
	
	// Enable the duplicate button button
	$('#btnDuplicateTestSuiteConfirm').button('enable');
	
	// Show the dialog
	$("#duplicateTestSuiteDialog").dialog("open");
}

function TestSuitesMng_onDuplicateTestSuiteConfirm() {

	// Clear previous errors
	$('#lblDuplicateTestSuiteValidationErrorDialog').html('');
	
	// Extract the new test suite name
	var newTestSuiteName = $('#txtNewTestSuiteNameForDuplicating').val();
	
	// Extract the project name
	var projectName = getValueFromElement($('#duplicateTestSuiteDialog').find('#slctProjectForDup'));
	
	// Extract the project id
	var projectId = globalProjectNameToProjectId[projectName];
	
	// Make sure that the test suite name to add is not empty
	if (isStringEmpty(newTestSuiteName)) {
		$('#lblDuplicateTestSuiteValidationErrorDialog').html("'New Test Suite' field is missing");
		return;
	}
	
	// Make sure that the project id is found
	if (isStringEmpty(projectId.toString())) {
		$('#lblDuplicateTestSuiteValidationErrorDialog').html("'Project' field is missing or not configured properly");
		return;
	}
	
	// Extract the test suite id to duplicate
	var testSuiteIdToDuplicate = $('#duplicateTestSuiteDialog').find('#hdnTestSuiteIdForDuplicating').val();
	
	// Send a request to duplicate the test suite
	TestSuitesMng_sendRequestToDuplicateTestSuite(testSuiteIdToDuplicate, newTestSuiteName, projectId);
}

function TestSuitesMng_onValidateTestSuite() {

	pageLoading();
	
	// To make the loader visible do that after timeout
	setTimeout(function() {

		// Extract the test suite project
		var projectName = $('#divTestSuiteMetadata').find('#tdProject select option:selected').text();

		// Get the allowed project setup parameters
		var allowedProjectSetupParameterValueIds = globalProjectData.virtualCombination.setupParameterValueIds;

		// Iterate over the table rows
		$('#tblScenarios tbody tr').each(function() {
			// Get the virtual combination select box
			var theVirtualCombinationSlct = $(this).find('#slctVirtualCombination');
			
			// Get the selected virtual combination name from the selected
			var theSelectedVirtualCombinationName = getTextFromElement(theVirtualCombinationSlct);
			
			// Compare the virtual combination to the allowed project setup parameter value ids
			var isValid = isVirtualCombinationValidComparingProjectAllowedSetupParameterValues(
					theSelectedVirtualCombinationName, 
					allowedProjectSetupParameterValueIds);
			
			// If not valid mark as red
			if (!isValid) {
				// Mark it with color
				theVirtualCombinationSlct.attr('class', 'IllegalVirtualCombination');
			}
			
		});

		pageFinishedLoading();
	}, 0);
}

function TestSuitesMng_onAllowedPermutations() {
	location.href = '/ui/displayAllowedPermutationsManagement?testVersionId=' + globalTestSuiteData.testVersionId +
		'&allowedPermutationsGroupId=' + $("#hdnAllowedPermutationsGroupId").val();
}

function testSuite_save() {
	
	// Confirm
	UIUtility_showConfirmDialog("You are about to make changes to the test suite. Are you sure?", "Save", testSuite_save_confirm);
}

function testSuite_save_confirm() {

	// The JSON request
	var jsonRequest = {};
	
	// Get the test suite ID
	var testSuiteId = getValueFromElement($('#hdnTestSuiteId'));
	jsonRequest.testSuiteId = testSuiteId;

	// Check if should change name
	var testSuiteName = getValueFromElement($("#txtTestSuiteName"));
	if (getValueFromElement("#originalTestSuiteName") != testSuiteName) {
		jsonRequest.newTestSuiteName = testSuiteName;
	}

	// Check if should change project
	var projectId = $("#tdProject select option:selected").attr('value');
	if (getValueFromElement("#originalProjectId") != projectId) {
		jsonRequest.newProjectId = projectId;
	}

	// Arrange the dirty rows in an array
	var scenarios = [];
	jsonRequest.scenarios = scenarios;
	$('#tblScenarios tbody tr').each(function() {
		
		// If the row is dirty
		if ($(this).is('[data-dirty]')) {
		
			// Get the data
			var scenarioVirtualCombinationId = $(this).attr('data-scenario-virtual-combination-id');
			var included = getValueFromElement($(this).find('#chkIncludeInExecution'));
			var customized = false;
			if ($(this).find('#tdRestoreDefault').is('[data-customized]')) {
				customized = $(this).find('#tdRestoreDefault').attr('data-customized');
			}
			var priority = getValueFromElement($(this).find('#slctPriority'));
			var repeat = getValueFromElement($(this).find('#slctRepeat'));
			var virtualCombinationId = getValueFromElement($(this).find('#slctVirtualCombination'));
		
			// Create a test suite scenario object
			var testSuiteScenario = {};
			testSuiteScenario.scenarioVirtualCombinationId = scenarioVirtualCombinationId;
			testSuiteScenario.included = included;
			testSuiteScenario.customized = customized;
			testSuiteScenario.priority = priority;
			testSuiteScenario.repeat = repeat;
			testSuiteScenario.virtualCombinationId = virtualCombinationId;
			
			// Add to the array
			scenarios.push(testSuiteScenario);
		}
	});
	
	// Post
	var link = '/tasks/saveTestSuite';
	var async = true;
	PostJsonWithJsonFeedbackFuncs(link, async, jsonRequest, testSuite_save_success, testSuite_save_failure);
}

function testSuite_save_success(jsonResponse) {

	// Remove the diry row indication from all the rows
	$('#tblScenarios tbody tr').each(function() {
		$(this).removeAttr('data-dirty');
		$(this).removeClass('TestManagementDifferentFromDefault');
	});

	// Set original test suite name to current name
	$("#originalTestSuiteName").val($("#txtTestSuiteName").val());

	UIUtility_showAlert('Test suite was saved successfully', 'Save');
}

function testSuite_save_failure(responseText) {

	UIUtility_showAlert('Failed to save changes in the test suite: ' + responseText, 'Save');
}
/** javascripts/testsuites/TestSuitesRenderHelper.js **/
var TestSuitesManagement_toggleButtons = new Array();
var TestSuitesManagement_toggleStates = {};

function TestSuitesMng_initializeDialogs() {
	TestSuitesMng_initializeDuplicateDialog();
	TestSuitesMng_initializeArchiveDialog();
}

function TestSuitesMng_initializeDuplicateDialog() {

	$("#duplicateTestSuiteDialog").dialog({
		autoOpen: false,
		height: 400,
		width: 550,
		modal: true,
		buttons: [ 
		          {
		        	  id: "btnDuplicateTestSuiteConfirm",
		        	  text: "Duplicate",
		        	  click: function() {
		        		  TestSuitesMng_onDuplicateTestSuiteConfirm();
		        	  }
		          },
		          {
		        	  id: "btnCancel",
		        	  text: "Cancel",
		        	  click: function() {
		        		  $(this).dialog("close");
		        	  }
		          }
		          ]
	});
}

function TestSuitesMng_initializeArchiveDialog() {

	$("#archiveTestSuiteDialog").dialog({
		autoOpen: false,
		height: 400,
		width: 550,
		modal: true,
		buttons: [ 
		          {
		        	  id: "btnArchiveTestSuiteConfirm",
		        	  text: "Archive",
		        	  click: function() {
		        		  TestSuitesMng_onArchiveTestSuiteConfirm();
		        		  $(this).dialog("close");
		        	  }
		          },
		          {
		        	  id: "btnCancel",
		        	  text: "Cancel",
		        	  click: function() {
		        		  $(this).dialog("close");
		        	  }
		          }
		          ]
	});
}

function TestSuitesMng_initializeButtons() {

	TestSuitesMng_initializeToggleBehaviour('btnNewTestSuiteToggle', 'ui-icon-document', 'showNewTestSuiteFormEffect', '');
	TestSuitesMng_initializeToggleBehaviour('btnLoadTestSuiteToggle', 'ui-icon-folder-open', 'showLoadTestSuiteFormEffect', '');
	TestSuitesMng_initializeToggleBehaviour('btnDuplicateTestSuiteToggle', 'ui-icon-copy', 'showDuplicateTestSuiteFormEffect', '');
	TestSuitesMng_initializeToggleBehaviour('btnArchiveTestSuiteToggle', 'ui-icon-trash', 'showArchiveTestSuiteFormEffect', '');
	
	UIUtility_initializeButton('btnNewTestSuite'		  		, 'ui-icon-document');
	UIUtility_initializeButton('btnLoadTestSuite'		  		, 'ui-icon-folder-open');
	UIUtility_initializeButton('btnDuplicateTestSuite'	  		, 'ui-icon-copy');
	UIUtility_initializeButton('btnDuplicateTestSuiteConfirm'	, 'ui-icon-copy');
	UIUtility_initializeButton('btnArchiveTestSuite'	  		, 'ui-icon-trash');
	UIUtility_initializeButton('btnArchiveTestSuiteConfirm'		, 'ui-icon-trash');
	UIUtility_initializeButton('btnValidateTestSuite' 	  		, 'ui-icon-check');
	UIUtility_initializeButton('btnCancel'	 				 	, 'ui-icon-cancel');
	UIUtility_initializeButton('btnSaveTestSuite'				, 'ui-icon-disk');
	UIUtility_initializeButton('btnShowChangeLog'				, 'ui-icon-script');
	UIUtility_initializeButton('btnAllowedPermutations'			, 'ui-icon-zoomin');
}

function TestSuitesMng_initializeToggleBehaviour(toggleBtnId, btnIcon, divIdToToggleFor, callBack) {
	
	UIUtility_initializeToggleBehaviour(
			toggleBtnId, btnIcon, divIdToToggleFor, TestSuitesManagement_toggleButtons, TestSuitesManagement_toggleStates, callBack);
}

function TestSuitesMng_renderProjectNames(elemId) {

	var projectNames = Object.keys(globalProjectNameToProjectId); 

	var html = "";
	projectNames.forEach(function (name) {
		html += "<option id='" + name + "'>" + name + "</option>";
	});
	var elem = $('#' + elemId);
	elem.html(html);
	elem.combobox({});
	elem.data('projectNames', projectNames);
	elem.combobox("setValue", "");
	$(".ui-autocomplete").css('height', '215px');
}

function TestSuitesMng_renderTestSuitesMetadata() {

	// Clear the select boxes
	$('select[id^=slctTestSuite]').html('');

	// Extract the test suite names as json
	var testSuiteNamesAsJson = globalTestSuitesMetaData;

	// Add the option to all input boxes
	var optionsHtml = '';
	for (var i = 0; i < testSuiteNamesAsJson.testSuiteNames.length; i++) {
		var tsName = testSuiteNamesAsJson.testSuiteNames[i];
		optionsHtml += "<option value='" + tsName + "'>" + tsName +
			" (" + testSuiteNamesAsJson[tsName].testSuiteCreationTime + ")</option>";
	}
	var slct = $('select[id^=slctTestSuite]');
	slct.append(optionsHtml).combobox();
	slct.parent().find(".ui-autocomplete-input").css('width', '350px');
}

function TestSuitesMng_hideTestSuiteData() {

	// Hide the div with the test suite data
	$('#divTestSuiteData').addClass('inactive');
}

function TestSuitesMng_renderTestSuite() {

	// Clear current test suite data
	$('#tblScenarios tbody').html('');
	
	// Extract the test suite from the JSON
	var testSuiteAsJson = globalTestSuiteData;
	
	// Render the basic test suite data
	TestSuitesMng_renderBasicTestSuiteData(testSuiteAsJson);

	// Render the configuration scenarios (uses the same code that the setup scenarios page uses)
	var enableVirtualCombinationModification = true;
	var rows = renderConfigurationScenarios(enableVirtualCombinationModification);

	// Override the data with the test suite scenarios
	TestSuitesMng_renderIncludedAndOverridenTestSuiteScenariosData(testSuiteAsJson, rows);

	// Add rows to table (assuming table is empty)
	var tbody = $("<tbody />");
	for (var i = 0; i < rows.all.length; i++) {
		tbody.append(rows.all[i]);
	}
	$('#tblScenarios > tbody').remove();
	$('#tblScenarios').append(tbody);

	// Disable all input and select elements if this is the default test suite
	var testSuiteName = testSuiteAsJson.testSuiteName;
	if (testSuiteName == 'Default') {
		$('#tblScenarios select').each(function() {
			$(this).attr('disabled', 'disabled');
		});
		$('#tblScenarios input').each(function() {
			$(this).attr('disabled', 'disabled');
		}); 
	}
	
	// Show the div with the test suite data
	$('#divTestSuiteData').removeClass('inactive');
	
	// Enable the check all checkbox
	$('#chkSelectAll').prop("disabled", false);
	
	// Prepare the table for view
	prepareTableFiltersExt('tblScenarios', false, true);
}

function TestSuitesMng_renderBasicTestSuiteData(testSuiteAsJson) {

	// Get a reference to the test suite name text box
	var metadataDiv = $('#divTestSuiteMetadata');
	var txtTestSuite = metadataDiv.find('#txtTestSuiteName');

	// Set allowed permutations group ID
	$("#hdnAllowedPermutationsGroupId").val(testSuiteAsJson.allowedPermutationsGroupId);

	// Render the test suite id & name
	$('#hdnTestSuiteId').val(testSuiteAsJson.testSuiteId);
	$('#originalTestSuiteName').val(testSuiteAsJson.testSuiteName);
	txtTestSuite.val(testSuiteAsJson.testSuiteName);

	// Set entity ID for change log (if visible)
	var tdChangeLog = $('#tdChangeLog');
	if (tdChangeLog.length > 0) {
		setValueOfElement(tdChangeLog.find('#hdnEntityId'), testSuiteAsJson.testSuiteId);
	}

	// Set original project ID
	$('#originalProjectId').val(testSuiteAsJson.projectId);

	// Make sure that the text box is big enough
	var testSuiteNameSize 	= testSuiteAsJson.testSuiteName.length;
	var txtTestSuiteSize	= txtTestSuite.attr('size');

	if (testSuiteNameSize > txtTestSuiteSize && txtTestSuiteSize < 100) {
		txtTestSuite.attr('size', testSuiteNameSize);
	}

	// Select the project in the select box. Both sets are needed because of browser bugs
	var selectBox = metadataDiv.find('#tdProject select');
	selectBox.val("");
	selectBox.val(testSuiteAsJson.projectId);
	TestSuitesMng_ChangeProject(selectBox);
}

function TestSuitesMng_ChangeProject(selectBox) {
	var projectId = selectBox.find("option:selected").attr('value');
	$('#tdViewProject').html('<a href="/ui/displayProjectsManagement?projectId=' + projectId + '">View Selected Project</a>');
}

function TestSuitesMng_renderIncludedAndOverridenTestSuiteScenariosData(testSuiteAsJson, rows) {

	// Extract the test suite scenarios
	var testSuiteScenarios = testSuiteAsJson.testSuiteScenarios;

	// Store number of included test suite scenarios
	var numberOfIncludedTestSuiteScenarios = 0;

	// Iterate over the test suite scenarios
	for (var testSuiteScenarioIndex = 0; testSuiteScenarioIndex < testSuiteScenarios.length; testSuiteScenarioIndex++) {

		// Extract the current test suite scenario
		var testSuiteScenarioAsJson = testSuiteScenarios[testSuiteScenarioIndex];

		// Get the scenario virtual combination ID
		var scenarioVirtualCombinationId = testSuiteScenarioAsJson.scenarioVirtualCombinationId;

		// Using the scenario id, get a reference to the table row
		var testSuiteScenarioTableRow = rows[scenarioVirtualCombinationId];

		// Extract the included flag
		var included = testSuiteScenarioAsJson.included;

		if (included) {
		
			// Increment the number of included test suite scenarios
			numberOfIncludedTestSuiteScenarios++;
		}

		// Update the included flag
		testSuiteScenarioTableRow.find('#chkIncludeInExecution').prop('checked', included);
		
		// Update the customized flag
		var customized = testSuiteScenarioAsJson.customized;
		testSuiteScenarioTableRow.find('#tdRestoreDefault').attr('data-customized', customized);
		
		if (customized) {
		
			// Update the priority with the customized one
			var customizedPriority = testSuiteScenarioAsJson.customizedPriority;
			var slctPriority = testSuiteScenarioTableRow.find('#slctPriority');
			slctPriority.val(customizedPriority);
			renderPriorityColor(slctPriority);
			
			// Update the repeat with the customized one
			var customizedRepeat = testSuiteScenarioAsJson.customizedRepeat;
			var slctRepeat = testSuiteScenarioTableRow.find('#slctRepeat');
			slctRepeat.val(customizedRepeat);
			renderRepeatColor(slctRepeat);
						
			// Update the virtual combination ID with the customized one
			var customizedVirtualCombinationId = testSuiteScenarioAsJson.customizedVirtualCombination;
			var slctVirtualCombination = testSuiteScenarioTableRow.find('#slctVirtualCombination');
			slctVirtualCombination.val(customizedVirtualCombinationId);
			renderVirtualCombinationColor(slctVirtualCombination);
		}
	}

	// Update the UI with the number of included test suite scenarios
	$('#lblNumberOfIncludedTestSuiteScenarios').html(numberOfIncludedTestSuiteScenarios);
}

function TestSuitesMng_renderTestSuiteScenariosWithDefaults(rowsToRenderWithDefaults) {

	for (var rowIndex = 0; rowIndex < rowsToRenderWithDefaults.length; rowIndex++) {
		var rowToRenderWithDefaults = rowsToRenderWithDefaults[rowIndex]; 	
		TestSuitesMng_renderTestSuiteScenarioWithDefaults(rowToRenderWithDefaults);
	}
}

function TestSuitesMng_renderTestSuiteScenarioWithDefaults(rowToRenderWithDefaults) {

	// Set the row as not customized
	$(rowToRenderWithDefaults).find('#tdRestoreDefault').attr('data-customized', false);

	// Get the select virtual combination
	var slctVirtualCombination = $(rowToRenderWithDefaults).find('#slctVirtualCombination');
	
	// Extract & update the virtual combination
	var defaultVirtualCombinationId = slctVirtualCombination.attr('default-virtual-combination-id');
	slctVirtualCombination.val(defaultVirtualCombinationId);
	
	// Render the virtual combination color
	renderVirtualCombinationColor(slctVirtualCombination);
	
	// Get the select priority
	var slctPriority = $(rowToRenderWithDefaults).find('#slctPriority');

	// Extract & update the priority
	var defaultPriority = slctPriority.attr('data-default-priority');
	slctPriority.val(defaultPriority);

	// Render the priority color
	renderPriorityColor(slctPriority);

	// Get the repeat
	var slctRepeat = $(rowToRenderWithDefaults).find('#slctRepeat');
	
	// Extract & update the repeat
	var defaultRepeat = slctRepeat.attr('data-default-repeat');
	slctRepeat.val(defaultRepeat);
	
	// Render the repeat color
	renderRepeatColor(slctRepeat);
}

function testSuites_onClickIncludeSingleScenario(callingElement) {

	// Mark the row as dirty
	testManagement_markRowAsDirty(callingElement);

	// Update the number of included scenarios
	testSuites_updateNumOfIncludedScenarios();
}

function testSuites_onClickIncludeMultipleScenarios(callingElement) {

	// Update scenarios
	TestSuitesMng_onUpdateTestSuiteScenarios(callingElement);
	
	// Update number of included scenarios
	testSuites_updateNumOfIncludedScenarios();
}

function testSuites_updateNumOfIncludedScenarios() {

	// Update number of included scenarios
	var numOfIncludedScenarios = 0;
	$('#tblScenarios > tbody > tr:visible').each(function() {
		// Get the included check box
		var includeCheckbox = $(this).find('#chkIncludeInExecution');

		// Get the value and increase the number of included scenarios
		var included = getValueFromElement(includeCheckbox);
		if (included) {
			numOfIncludedScenarios++;
		}
	});

	// Set the value
	$('#lblNumberOfIncludedTestSuiteScenarios').html(numOfIncludedScenarios);
}

/** javascripts/testsuites/TestSuitesRequestDispatcherHelper.js **/
function TestSuitesMng_sendNewTestSuiteRequest(testSuiteNameToAdd, projectId) {

	var link = '/tasks/NewTestSuite';
	var async = true;
	var request = {};
	request.testSuiteNameToAdd = testSuiteNameToAdd;
	request.projectId = projectId;
	PostJsonWithJsonFeedbackFuncs(link, async, request, 
		function(jsonResponse) {
			var testSuiteIdToLoad = jsonResponse.testSuiteId;
			TestSuitesMng_loadTestSuitesMetadata('TestSuitesMng_renderTestSuitesMetadata', testSuiteIdToLoad);
			relayoutStretchContainers();
		},
		function(textResponse) {
			UIUtility_showAlert('Failed to add test suite: [' + textResponse + ']', 'New');
		}
	);
}

function TestSuitesMng_sendRequestToArchiveTestSuite(testSuiteIdToDelete) {
	var link = '/tasks/ArchiveTestSuite';
	var async = true;
	var request = {};
	request.testSuiteId = testSuiteIdToDelete;
	PostJsonWithJsonFeedbackFuncs(link, async, request, 
		function(jsonResponse) {
			TestSuitesMng_loadTestSuitesMetadata('TestSuitesMng_renderTestSuitesMetadata');
		},
		function(textResponse) {
			UIUtility_showAlert('Failed to archive test suite: [' + textResponse + ']', 'Archive');
		}
	);
}

function TestSuitesMng_sendRequestToDuplicateTestSuite(testSuiteIdToDuplicate, newTestSuiteName, projectId) {
	var link = '/tasks/DuplicateTestSuite';
	var async = true;
	var request = {};
	request.testSuiteIdToDuplicate = testSuiteIdToDuplicate;
	request.newTestSuiteName = newTestSuiteName;
	request.projectId = projectId;
	PostJsonWithJsonFeedbackFuncs(link, async, request, 
		function(jsonResponse) {
			TestSuitesMng_loadTestSuitesMetadata('TestSuitesMng_renderTestSuitesMetadata');
		},
		function(textResponse) {
			UIUtility_showAlert('Failed to duplicate test suite: [' + textResponse + ']', 'Update');
		}
	);
	$("#duplicateTestSuiteDialog").dialog("close");
}

/** javascripts/testplans/TestPlanChangesData.js **/
function TestPlanChangesClass() {
	
	this.getCleanedTPChangesAsJson = function() {
		
		var asJson = 
		{
			"changes":
			{
				"changedScenarioVCIds": []
			}
		};
		
		return asJson;
	};
	
	// This member contains the test plan changes as json
	this.tpChangesAsJson = this.getCleanedTPChangesAsJson();
	
	this.resetTPChangesAsJson = function() {
		this.tpChangesAsJson = this.getCleanedTPChangesAsJson();
	};
	
	this.getChangesAsJson = function() {
		return this.tpChangesAsJson; 
	};
	
	this.getVCTemplateAsJson = function() {
		var vcTemplateAsJson = 
			{
				"delete": "false", 
				"vcId": "0", 
				"setupParameterValueIdsToAdd": [], 
				"setupParameterValueIdsToRemove": [],
				"setupParameterIdsToAdd": [], 
				"setupParameterIdsToRemove": []
			};
		
		return vcTemplateAsJson;
	};
	
	this.changeTestPlanScenarioProperty = function(scenarioVCId, propertyName, propertyValue, isEqualToSavedValue) {
		// Add the scenario vc id to the changes (if necessary)
		this.addNewScenarioChange(scenarioVCId);
		
		// Get the scenario changes
		scenarioChangesAsJson = this.tpChangesAsJson.changes[scenarioVCId];
		
		// Modify the property value, if is equal to the saved one remove it 
		if (isEqualToSavedValue) {
			delete scenarioChangesAsJson[propertyName];
		} else {
			scenarioChangesAsJson.customized = true;
			scenarioChangesAsJson[propertyName] = propertyValue;
		}
	};
	
	this.changeTestPlanScenarioVC = function(scenarioVCId, isEqualToSavedValue, isCustomized) {
		// Add the scenario vc id to the changes (if necessary)
		this.addNewScenarioChange(scenarioVCId);
		
		// Get the scenario row
		var scenarioRow = getScenarioTableRowByScenarioVirtualCombinationId(scenarioVCId);
		
		// Get the scenario changes
		scenarioChangesAsJson = this.tpChangesAsJson.changes[scenarioVCId];
		
		// If equal to the saved value - remove both sections - customized & mask
		if (isEqualToSavedValue) {
			delete scenarioChangesAsJson.mask;
			delete scenarioChangesAsJson.customizedVC;
		} else {
			if (isClosedLoop()) {
				
				if (isCustomized) {
					// Add both sections - customized & mask
					scenarioChangesAsJson.mask 			= this.getVCTemplateAsJson();
					scenarioChangesAsJson.customizedVC 	= this.getVCTemplateAsJson();

					// Pass over existing checked setup parameter value ids and add them
					var checkedSetupParameterValueIds = TestPlans_getCheckedSetupParameterValueIds(scenarioVCId);
					scenarioChangesAsJson.customizedVC.setupParameterValueIdsToAdd = checkedSetupParameterValueIds; 

					// Pass over existing checked setup parameter ids and add them
					var checkedSetupParameterIds = TestPlans_getCheckedSetupParameterIds(scenarioVCId);
					scenarioChangesAsJson.customizedVC.setupParameterIdsToAdd = checkedSetupParameterIds;
				} else {
					// Extract the saved customized vc id
					var customizedSavedVcId = scenarioRow.find('#slctVirtualCombination').attr('saved');

					// Extract the mask vc id
					var maskVcId = scenarioRow.attr('mask-virtual-combination-id');

					// Update in the changes json
					scenarioChangesAsJson.mask 			= {"delete": "true", "vcId": maskVcId};
					scenarioChangesAsJson.customizedVC 	= {"delete": "true", "vcId": customizedSavedVcId};
				}
			} else {
				// Add customized section
				scenarioChangesAsJson.customizedVC 	= this.getVCTemplateAsJson();
				
				// Extract the vc id
				var customizedVcID = getValueFromElement(scenarioRow.find('#slctVirtualCombination'));
				
				// Update in the changes json
				scenarioChangesAsJson.customizedVC.modify	= true;
				scenarioChangesAsJson.customizedVC.vcId		= customizedVcID;
			}
		}
		
		TestPlans_enableSetupParameterCheckboxes(scenarioRow, isCustomized)
	};
	
	this.checkTestPlanScenarioSetupParameterValue = function(
			scenarioVCId, 
			maskVirtualCombinationId, 
			customizedVirtualCombinationId, 
			defaultVirtualCombinationId,
			setupParameterValueId, 
			callingElementValue, 
			isEqualToSavedValue) {
		// Add the scenario vc id to the changes (if necessary)
		this.addNewScenarioChange(scenarioVCId);
		
		// Get the scenario changes
		scenarioChangesAsJson = this.tpChangesAsJson.changes[scenarioVCId];
		
		if (isEqualToSavedValue) {
			// The saved value is equal to the current value - remove from all possible arrays
			ArrayUtils_removeFromArray(scenarioChangesAsJson.mask.setupParameterValueIdsToAdd			, setupParameterValueId);
			ArrayUtils_removeFromArray(scenarioChangesAsJson.mask.setupParameterValueIdsToRemove		, setupParameterValueId);
			ArrayUtils_removeFromArray(scenarioChangesAsJson.customizedVC.setupParameterValueIdsToAdd	, setupParameterValueId);
			ArrayUtils_removeFromArray(scenarioChangesAsJson.customizedVC.setupParameterValueIdsToRemove, setupParameterValueId);
		} else {
			var customizedVCId = isDefaultCustomizedBeingChanged ? 0 : customizedVirtualCombinationId;
			
			// The saved value is not equal to the current value
			if (undefined == scenarioChangesAsJson.mask && 0 == customizedVCId) {
				var isCustomized = true;
				this.changeTestPlanScenarioVC(scenarioVCId, isEqualToSavedValue, isCustomized);
			} else {
				this.addMaskAndCustomizedVirtualCombination(scenarioVCId);
			}
			
			// Check if the virtual combination was already customized and is being changed
			var isDefaultCustomizedBeingChanged = defaultVirtualCombinationId == customizedVirtualCombinationId
			
			// Update the mask & customized VC ids
			scenarioChangesAsJson.mask.vcId 		= undefined != maskVirtualCombinationId ? maskVirtualCombinationId : 0;
			scenarioChangesAsJson.customizedVC.vcId = customizedVCId;
			
			if ("true" == callingElementValue) {
				// The setup parameter value is checked
				// Remove from mask.setupParameterValueIdsToAdd
				ArrayUtils_removeFromArray(scenarioChangesAsJson.mask.setupParameterValueIdsToAdd, setupParameterValueId);
				
				// Add to mask.setupParameterValueIdsToRemove
				scenarioChangesAsJson.mask.setupParameterValueIdsToRemove.push(setupParameterValueId);
				
				// Add to customizedVC.setupParameterValueIdsToAdd
				scenarioChangesAsJson.customizedVC.setupParameterValueIdsToAdd.push(setupParameterValueId);
				
				// Remove from customizedVC.setupParameterValueIdsToRemove
				ArrayUtils_removeFromArray(scenarioChangesAsJson.customizedVC.setupParameterValueIdsToRemove, setupParameterValueId);
			} else {
				// The setup parameter value is unchecked
				// Remove from the mask.setupParameterValueIdsToRemove
				ArrayUtils_removeFromArray(scenarioChangesAsJson.mask.setupParameterValueIdsToRemove, setupParameterValueId);
				
				// Add to mask.setupParameterValueIdsToAdd
				scenarioChangesAsJson.mask.setupParameterValueIdsToAdd.push(setupParameterValueId);
				
				// Remove from customizedVC.setupParameterValueIdsToAdd
				ArrayUtils_removeFromArray(scenarioChangesAsJson.customizedVC.setupParameterValueIdsToAdd, setupParameterValueId);
				
				// Add to customizedVC.setupParameterValueIdsToRemove
				scenarioChangesAsJson.customizedVC.setupParameterValueIdsToRemove.push(setupParameterValueId);
			}
		}
	};
	
	this.checkTestPlanScenariosAnySetupParameter = function(
			scenarioVCId, 
			maskVirtualCombinationId, 
			customizedVirtualCombinationId, 
			defaultVirtualCombinationId,
			setupParameterId, 
			callingElementValue, 
			isEqualToSavedValue) {
		// Add the scenario vc id to the changes (if necessary)
		this.addNewScenarioChange(scenarioVCId);
		
		// Get the scenario changes
		scenarioChangesAsJson = this.tpChangesAsJson.changes[scenarioVCId];
		
		if (isEqualToSavedValue) {
			// The saved value is equal to the current value - remove from all possible arrays 
			ArrayUtils_removeFromArray(scenarioChangesAsJson.mask.setupParameterIdsToAdd			, setupParameterId);
			ArrayUtils_removeFromArray(scenarioChangesAsJson.mask.setupParameterIdsToRemove 		, setupParameterId);
			ArrayUtils_removeFromArray(scenarioChangesAsJson.customizedVC.setupParameterIdsToAdd	, setupParameterId);
			ArrayUtils_removeFromArray(scenarioChangesAsJson.customizedVC.setupParameterIdsToRemove , setupParameterId);
		} else {
			// The saved value is not equal to the current value
			// Ensure that the mask and customized sections exist
			this.addMaskAndCustomizedVirtualCombination(scenarioVCId);
			
			// Check if the virtual combination was already customized and is being changed
			var isDefaultCustomizedBeingChanged = defaultVirtualCombinationId == customizedVirtualCombinationId
			
			// Update the mask & customized VC ids
			scenarioChangesAsJson.mask.vcId 		= undefined != maskVirtualCombinationId ? maskVirtualCombinationId : 0;
			scenarioChangesAsJson.customizedVC.vcId = isDefaultCustomizedBeingChanged ? 0 : customizedVirtualCombinationId;
			
			if ("true" == callingElementValue) {
				// The setup parameter is checked
				// Remove from mask.setupParameterIdsToRemove
				ArrayUtils_removeFromArray(scenarioChangesAsJson.mask.setupParameterIdsToRemove, setupParameterId);
				
				// Add to mask.setupParameterIdsToAdd
				scenarioChangesAsJson.mask.setupParameterIdsToAdd.push(setupParameterId);
				
				// Remove from customizedVC.setupParameterIdsToRemove
				ArrayUtils_removeFromArray(scenarioChangesAsJson.customizedVC.setupParameterIdsToRemove, setupParameterId);
				
				// Add to customizedVC.setupParameterIdsToAdd
				scenarioChangesAsJson.customizedVC.setupParameterIdsToAdd.push(setupParameterId);

			} else {
				// The setup parameter is unchecked
				// Remove from mask.setupParameterIdsToRemove
				ArrayUtils_removeFromArray(scenarioChangesAsJson.mask.setupParameterIdsToRemove, setupParameterId);
				
				// Add to mask.setupParameterIdsToRemove
				scenarioChangesAsJson.mask.setupParameterIdsToRemove.push(setupParameterId);
				
				// Remove from customizedVC.setupParameterIdsToAdd
				ArrayUtils_removeFromArray(scenarioChangesAsJson.customizedVC.setupParameterIdsToAdd, setupParameterId);
				
				// Add to customizedVC.setupParameterIdsToRemove
				scenarioChangesAsJson.customizedVC.setupParameterIdsToRemove.push(setupParameterId);
			}
		}
	};
	
	this.restoreTestPlanScenarios = function(scenarioVCId) {
		// Erase the scenario from the changes
		this.removeScenarioChange(scenarioVCId);
	};
	
	this.addNewScenarioChange = function(scenarioVCId) {
		// Add the scenario vc id to the array of changed scenario vc ids
		if ($.inArray(scenarioVCId, this.tpChangesAsJson.changes.changedScenarioVCIds) > -1) {
			return;
		}
		
		this.tpChangesAsJson.changes.changedScenarioVCIds.push(scenarioVCId);

		this.tpChangesAsJson.changes[scenarioVCId] = 
		{
			"scenarioVCId": scenarioVCId
		}
	};
	
	this.addMaskAndCustomizedVirtualCombination = function(scenarioVCId) {
		
		if (undefined == this.tpChangesAsJson.changes[scenarioVCId].mask) {
			this.tpChangesAsJson.changes[scenarioVCId].mask = this.getVCTemplateAsJson();
		}
		
		if (undefined == this.tpChangesAsJson.changes[scenarioVCId].customizedVC) {
			this.tpChangesAsJson.changes[scenarioVCId].customizedVC = this.getVCTemplateAsJson();
		}
	};
	
	this.removeScenarioChange = function(scenarioVCId) {
		// If not in the changes do nothing
		if (-1 == $.inArray(scenarioVCId, this.tpChangesAsJson.changes.changedScenarioVCIds)) {
			return;
		}
		
		// Remove from the array
		ArrayUtils_removeFromArray(this.tpChangesAsJson.changes.changedScenarioVCIds, scenarioVCId);
		
		// Clean from the json
		delete this.tpChangesAsJson.changes[scenarioVCId];
	}
}

function TestPlans_changeTestPlanScenariosProperty(callingElement, selectedRows) {
	// Extract the calling element id
	var callingElementId = callingElement.id;
	
	// Extract the calling element name
	var callingElementName = $(callingElement).attr('name');
	
	// Extract the calling element
	var callingElementValue = getValueFromElement($(callingElement)).toString();
	
	// Iterate over the rows
	selectedRows.forEach(function(selectedRow) {
		// Get the element in the selected row
		var elementInSelectedRow = $(selectedRow).find('#' + callingElementId);
		
		// Extract the saved value and scenario virtual combination ID
		var savedValue 			= elementInSelectedRow.attr('saved');
		var scenarioVCId 		= $(selectedRow).attr('data-scenario-virtual-combination-id');
		
		// Extract the test plan changes object
		var testPlanChangesObj 	= $('#hdnTestPlanChanges').data('testPlanChanges');

		// Perform the property change
		TestPlans_getTestPlanChangesClass().changeTestPlanScenarioProperty(
				scenarioVCId, callingElementName, callingElementValue, savedValue == callingElementValue);
	});

	// Render the changes in the UI
	renderScenariosChanges(callingElement, selectedRows);
}

function TestPlans_changeTestPlanScenariosVC(callingElement, selectedRows) {
	// Render the changes in the UI
	renderScenariosChanges(callingElement, selectedRows);
	
	// Extract the calling element id
	var callingElementId = callingElement.id;
	
	// Extract the calling element
	var callingElementValue = getValueFromElement($(callingElement)).toString();
	
	// Iterate over the rows
	selectedRows.forEach(function(selectedRow) {
		// Get the element in the selected row
		var elementInSelectedRow = $(selectedRow).find('#' + callingElementId);
		
		// Extract the saved value and scenario virtual combination ID
		var savedValue 			= elementInSelectedRow.attr('saved');
		var scenarioVCId 		= $(selectedRow).attr('data-scenario-virtual-combination-id');
		var customizedAttrVal	= getAttrValueFromSelected(elementInSelectedRow, 'customized');
		var isCustomized			= "true" == customizedAttrVal; 
		
		// Extract the test plan changes object
		var testPlanChangesObj 	= $('#hdnTestPlanChanges').data('testPlanChanges');
		
		// Perform the change of the VC
		TestPlans_getTestPlanChangesClass().changeTestPlanScenarioVC(
				scenarioVCId, savedValue == callingElementValue, isCustomized);
		
		// Check if the vc is ok (comparing with the project allowed setup parameter values)
		checkEmptyVirtualCombinations(selectedRow)
	});
}

function TestPlans_checkTestPlanScenariosSetupParameterValue(callingElement, selectedRows) {
	// Render the changes in the UI
	renderScenariosChanges(callingElement, selectedRows);
	
	// Extract the calling element id
	var callingElementId = callingElement.id;
	
	// Extract the setup parameter value id
	var setupParamterValueId = $(callingElement).attr('setup-parameter-value-id');
	
	// Extract the calling element value
	var callingElementValue = getValueFromElement($(callingElement)).toString();
	
	// Iterate over the rows
	selectedRows.forEach(function(selectedRow) {
		// Get the element in the selected row
		var elementInSelectedRow = $(selectedRow).find('#' + callingElementId);
		
		// Extract the saved value and scenario virtual combination ID
		var savedValue 			= elementInSelectedRow.attr('saved');
		var scenarioVCId 		= $(selectedRow).attr('data-scenario-virtual-combination-id');
		
		// Extract the mask virtual combination id
		var maskVirtualCombinationId = $(selectedRow).attr('mask-virtual-combination-id');
		
		// Extract the customized virtual combination id
		var customizedVirtualCombinationId = getValueFromElement($(selectedRow).find('#slctVirtualCombination'));
		
		// Extract the default virtual combination id
		var defaultVirtualCombinationId = $(selectedRow).find('#slctVirtualCombination').attr('default-virtual-combination-id')
		
		// Extract the test plan changes object
		var testPlanChangesObj = $('#hdnTestPlanChanges').data('testPlanChanges');
		
		// Perform the change of the setup parameter value
		TestPlans_getTestPlanChangesClass().checkTestPlanScenarioSetupParameterValue(
				scenarioVCId, 
				maskVirtualCombinationId,
				customizedVirtualCombinationId,
				defaultVirtualCombinationId,
				setupParamterValueId, 
				callingElementValue, 
				savedValue == callingElementValue);
	});
}

function TestPlans_checkTestPlanScenariosAnySetupParameter(callingElement, selectedRows) {
	// Render the changes in the UI
	renderScenariosChanges(callingElement, selectedRows);
	
	// Extract the calling element id
	var callingElementId = callingElement.id;
	
	// Extract the setup parameter id
	var setupParamterId = $(callingElement).attr('setup-parameter-id');
	
	// Extract the calling element value
	var callingElementValue = getValueFromElement($(callingElement)).toString();
	
	// Iterate over the rows
	selectedRows.forEach(function(selectedRow) {
		// Get the element in the selected row
		var elementInSelectedRow = $(selectedRow).find('#' + callingElementId);
		
		// Extract the saved value & scenario vc id & scenario id
		var savedValue 			= elementInSelectedRow.attr('saved');
		var scenarioVCId 		= $(selectedRow).attr('data-scenario-virtual-combination-id');
		
		// Extract the mask virtual combination id
		var maskVirtualCombinationId = $(selectedRow).attr('mask-virtual-combination-id');
		
		// Extract the customized virtual combination id
		var customizedVirtualCombinationId = getValueFromElement($(selectedRow).find('#slctVirtualCombination'));
		
		// Extract the default virtual combination id
		var defaultVirtualCombinationId = $(selectedRow).find('#slctVirtualCombination').attr('default-virtual-combination-id')
		
		// Perform the change of the setup parameter (any)
		TestPlans_getTestPlanChangesClass().checkTestPlanScenariosAnySetupParameter(
				scenarioVCId, 
				maskVirtualCombinationId,
				customizedVirtualCombinationId,
				defaultVirtualCombinationId,
				setupParamterId, 
				callingElementValue, 
				savedValue == callingElementValue);
	});
	
	// Extract the test plan changes object
	var testPlanChangesObj 	= $('#hdnTestPlanChanges').data('testPlanChanges');
}

function TestPlans_restoreTestPlanScenarios(selectedRows) {
	// Iterate over the rows
	selectedRows.forEach(function(selectedRow) {
		
		// Extract the saved value & scenario vc id & scenario id
		var scenarioVCId = $(selectedRow).attr('data-scenario-virtual-combination-id');
		
		// Restore in the changes
		TestPlans_getTestPlanChangesClass().restoreTestPlanScenarios(scenarioVCId);
	});
	
	// Extract the test plan changes object
	var testPlanChangesObj 	= $('#hdnTestPlanChanges').data('testPlanChanges');
}

function TestPlans_getTestPlanChangesClass() {
	return $('#hdnTestPlanChanges').data('testPlanChanges');
}
/** javascripts/testplans/TestPlansCommonHelper.js **/
var TestPlans_TestSuitesCollection = {};
var TestPlans_SelectedTestSuiteId = null;
var TestPlans_SelectedTestSuiteIdForDuplicate = null;
var TestPlans_ProjectsCollection = {};
var TestPlans_toggleButtons = new Array();
var TestPlans_toggleStates = {};

function storeTestPlanNames(testPlanNames) {
	$('#hdnTestPlanNames').data('testPlanNames', testPlanNames);
}

function storeTestPlanData(testPlanData)
{
	// Parse the test plan data into json
	var testPlanDataAsJson = JSON.parse(testPlanData);
	
	// Extract the scenario data into json
	storeConfigurationScenariosData(testPlanDataAsJson.scenariosData);
	
	// Extract the test plan
	$('#hdnTestPlan').data('testPlan', testPlanDataAsJson.testPlan);
}

/**************** Test plan names getters methods ****************/
function getTestPlanNamesAsJson()
{
	var parsedJsonObj = $('#hdnTestPlanNames').data('testPlanNames'); 
	
	return parsedJsonObj;
}

function getTestPlanIdsAsJson()
{
	return getTestPlanNamesAsJson().testPlanIds;
}

function getTestPlanByIDAsJson(testPlanId)
{
	return getTestPlanNamesAsJson()[testPlanId];
}

/**************** Configuration scenarios getters methods ****************/
function getTestPlanConfigurationScenariosAsJson()
{
	var parsedJsonObj = $('#hdnConfigurationScenariosData').data('scenariosData'); 
	
	return parsedJsonObj;
}

/**************** Test plan getters methods ****************/
function getTestPlanAsJson()
{
	var parsedJsonObj = $('#hdnTestPlan').data('testPlan'); 
	
	return parsedJsonObj;
}

function getTestPlanScenarios(testPlanAsJson)
{
	return testPlanAsJson.testPlanScenarios;
}

function TestPlans_getTestVersionId() {
	return $('#testSuiteName').data('testVersionId');
}

/** javascripts/testplans/TestPlansEventsHelper.js **/
function TestPlans_loadTestPlanNames(testPlanIdToLoad, cont) {
	var link = '/tasks/LoadTestPlanNames';
	var async = true;
	var request = {};
	PostJsonWithJsonFeedbackFuncs(link, async, request,
		function(jsonResponse) {
			// Store the test plan names as json
			storeTestPlanNames(jsonResponse);

			// Render the test plan names
			cont(jsonResponse);

			if (testPlanIdToLoad != undefined) {
				// Load the test plan
				TestPlans_loadTestPlan(testPlanIdToLoad);
			}
		},
		function(textResponse) {
			UIUtility_showAlert('Failed to load test plan names: [' + textResponse + ']', 'Load');
		}
	);
}

function TestPlanBasicData(testPlanId, testPlanName, testSuiteId, testVersionId) {
	this.testPlanId 		= testPlanId;
	this.testPlanName 		= testPlanName;
	this.testSuiteId		= testSuiteId;
	this.testVersionId		= testVersionId;
}

function onShowErrorDialog(errorMessage, errorTitle) {

	// Set dialog error message
	$('label[id^=errorDetails]').html(errorMessage);
	
	// Set dialog error title
	if (errorTitle) {
		 $("#errorDialog").attr("title",errorTitle);
	}
	
	// Open Error Dialog
	 $("#errorDialog").dialog({
		  width:700,
	      buttons: {
	        Ok: function() {
	    	  $( this ).dialog( "close" ); 
	        }
	      }
	 
	 });
}

function TestPlans_onAddTestPlan() {
	
	// Clear the new test plan error message
	$('#lblAddTestPlanValidationError').html('');
	
	// Extract the test plan to add
	var testPlanNameToAdd = $('#txtTestPlanNameToAdd').val();
	
	// Make sure that the test plan name to add is not empty
	if (isStringEmpty(testPlanNameToAdd)) {
		$('#lblAddTestPlanValidationError').html("'Test Plan Name' field is missing");
		return;
	}
	
	// Make sure the test name does not exist
	var testPlanNameExists = false;
	var testPlanNameToAddLowerCase = testPlanNameToAdd.toLowerCase();
	$('#slctTestPlanForLoad option').each(function() {
		var currentTestPlanName = $(this).html();
		var currentTestPlanNameLowerCase = currentTestPlanName.toLowerCase();
		if (testPlanNameToAddLowerCase == currentTestPlanNameLowerCase) {
			testPlanNameExists = true;
		}
	});
	if (testPlanNameExists) {
		$('#lblAddTestPlanValidationError').html('A test plan with the name [' + testPlanNameToAdd + '] already exists');
		return;
	}

	// Send a request to the server to add the test plan 
	sendAddTestPlanRequest(testPlanNameToAdd.trim(), TestPlans_SelectedTestSuiteId);
}

function TestPlans_onLoadTestPlan() {
	// Extract the test plan id
	var testPlanId = $('#slctTestPlanForLoad option:selected').val();
	
	TestPlans_loadTestPlan(testPlanId);
}

function TestPlans_loadTestPlan(testPlanId) {
	var testPlanBasicData = TestPlans_populateTestPlanBasicData(testPlanId);
	
	// Send the request and handle the response
	TestPlans_sendLoadTestPlanRequest(testPlanId, testPlanBasicData.testSuiteId, testPlanBasicData.testVersionId);
}

function TestPlans_onDeleteTestPlan() {
	  // Extract the test plan id
	  var testPlanIdToDelete = getValueFromElement($('#slctTestPlanForDeleting'));
	  if (isStringEmpty(testPlanIdToDelete)) {
		  UIUtility_showAlert("Please select a test plan to archive");
		  return;
	  }

	  // Open the dialog
	  var testPlanNameToDelete = getTextFromElement($('#slctTestPlanForDeleting'));
	  $("#dialogDeleteTestPlan").find('#lblToArchiveTestPlanName').html(testPlanNameToDelete);
	  $("#dialogDeleteTestPlan").dialog('open');
}

function TestPlans_onEditSaveTestPlanName() {

	// Get reference to the text test plan
	var txtTestPlan = $('#divTestPlanBasicData').find('#txtTestPlanName');
	
	// Check if the test plan name is enabled/disabled
	var isTestPlanNameDisabled = $(txtTestPlan).is('[disabled]');
	
	if (isTestPlanNameDisabled) {
	
		// This means that the user clicks to edit the test plan name
		// Enable the text box
		$(txtTestPlan).removeAttr('disabled');
		
		// Change the label of the edit/save button to 'Save'
		$('#btnEditSaveTestPlanName').val('Save');
	
	} else {
	
		// This means that the user clicks to save the test plan name
		// Extract the test plan id
		var testPlanId = $('#hdnTestPlanId').val();

		// Extract the test plan name
		var newTestPlanName = $(txtTestPlan).val();

		// Send a request to update the test plan name
		sendRequestToUpdateTestPlanName(testPlanId, newTestPlanName.trim());
	}
}

function TestPlans_onChangeTestPlanScenariosProperty(callingElement) {
	// Get all selected rows
	var selectedRows = getContainingTableSelectedRowsDifferentFromCallingElement(callingElement);

	// Change the test plan scenarios property
	TestPlans_changeTestPlanScenariosProperty(callingElement, selectedRows);
}

function TestPlans_onChangeTestPlanScenarioProperty(callingElement) {
	// Add the row of the calling element to the array
	var selectedRows = new Array();
	selectedRows.push($(callingElement).parents('tr:eq(0)'));
	
	// Change the test plan scenario property 
	TestPlans_changeTestPlanScenariosProperty(callingElement, selectedRows);
}

function TestPlans_onChangeTestPlanScenariosVC(callingElement) {
	// Get all selected rows
	var selectedRows = getContainingTableSelectedRowsDifferentFromCallingElement(callingElement);
	
	// Change the test plan scenarios VC
	TestPlans_changeTestPlanScenariosVC(callingElement, selectedRows);
}

function TestPlans_onChangeTestPlanScenarioVC(callingElement) {
	// If the VC was changed back to non-customized trigger the changes of all the setup parameters
	var vcValue = getTextFromElement($(callingElement));
	if ("Customized" != vcValue) {
		TestPlans_restoreSetupParameterValueSelectionsToDefaults(callingElement);
	}

	// Add the row of the calling element to the array
	var selectedRows = new Array();
	selectedRows.push($(callingElement).parents('tr:eq(0)'));

	// Change the test plan scenario VC 
	TestPlans_changeTestPlanScenariosVC(callingElement, selectedRows);
}

function TestPlan_onCheckTestPlanScenariosSetupParameterValue(callingElement) {
	// Get all selected rows
	var selectedRows = getContainingTableSelectedRowsDifferentFromCallingElement(callingElement);
	
	// Check / uncheck the test plan scenarios setup parameter value 
	TestPlans_checkTestPlanScenariosSetupParameterValue(callingElement, selectedRows);
}

function TestPlan_onCheckTestPlanScenarioSetupParameterValue(callingElement) {
	// Add the row of the calling element to the array
	var selectedRows = new Array();
	selectedRows.push($(callingElement).parents('tr:eq(0)'));
	
	// Check / uncheck the test plan scenario setup parameter value 
	TestPlans_checkTestPlanScenariosSetupParameterValue(callingElement, selectedRows);
}

function TestPlan_onCheckTestPlanScenariosAnySetupParameter(callingElement) {
	// Get all selected rows
	var selectedRows = getContainingTableSelectedRowsDifferentFromCallingElement(callingElement);
	
	// Check / uncheck the test plan scenarios any setup parameter 
	TestPlans_checkTestPlanScenariosAnySetupParameter(callingElement, selectedRows);
}

function TestPlan_onCheckTestPlanScenarioAnySetupParameter(callingElement) {
	// Add the row of the calling element to the array
	var selectedRows = new Array();
	selectedRows.push($(callingElement).parents('tr:eq(0)'));
	
	// Check / uncheck the test plan scenario any setup parameter 
	TestPlans_checkTestPlanScenariosAnySetupParameter(callingElement, selectedRows);
}

function TestPlans_onRestoreTestPlanScenario(callingElement) {
	// Get the row of the calling element 
	var tr = $(callingElement).parents('tr:eq(0)');

	// Put the row in an array
	var selectedRows = new Array();
	selectedRows.push(tr); 
	
	// Show the dialog about restore test plan scenarios
	TestPlans_showDialogOnRestoreTestPlanScenarios(selectedRows);
}

function TestPlans_onRestoreTestPlanScenarios(callingElement) {
	// Get the selected rows
	var selectedRows = getContainingTableSelectedRows(callingElement);
	
	// Show the dialog about restore test plan scenarios
	TestPlans_showDialogOnRestoreTestPlanScenarios(selectedRows);
}

function TestPlans_onRestoreTestPlanScenariosConfirm() {
	// Clean previous errors
	$('#restoreTPScenarioDialog').find('lblRestoreTPScenarioError').html('');
	
	// Extract the selected rows from the dialog
	var selectedRows = $('#restoreTPScenarioDialog').data('selectedRows');
	
	// Extract the test plan id
	var testPlanId = $('#hdnTestPlanId').val();
	
	// Populate the request
	var restoreRequestAsJson = {"scenarios": []};
	
	// Iterate over the selected rows
	selectedRows.forEach(function(selectedRow) {
		// Extract the scenario id & scenario VC id
		var scenarioVCId = $(selectedRow).attr('data-scenario-virtual-combination-id');
		
		// Add to the request
		var scenarioAsJson = {"scenarioVCId": scenarioVCId};
		restoreRequestAsJson.scenarios.push(scenarioAsJson);
	});
		
	// Send request to the server to restore the scenarios
	TestPlans_sendRequestToRestoreTestPlanScenarios(restoreRequestAsJson, testPlanId, selectedRows)
}

function getTestPlanScenarioElementNameByCallingElementId(callingElementId) {
	var attributeName = 'unknown';
	
	if (stringContains(callingElementId, 'IncludeInExecution'))
	{
		attributeName = 'testPlanIncluded';
	}
	else if (stringContains(callingElementId, 'VirtualCombination'))
	{
		attributeName = 'testPlanVirtualCombinationId';
	}
	
	return attributeName;
}

function TestPlans_onDuplicateTestPlan() {
	// Clear previous errors
	$('#lblDuplicateTestPlanValidationError').html("");
	
	// Extract the test plan id
	var testPlanIdToDuplicate = $('#slctTestPlanForDuplicating option:selected').attr('value')

	if (isStringEmpty(getValueFromElement('#slctTestPlanForDuplicating'))) {
		$('#lblDuplicateTestPlanValidationError').html("Please select a test plan");
		return;
	}

	/**
	 * Extract the test suite id to duplicate to
	 * If closed loop extract it from the test plan (since the "to" TS is the same)
	 * Otherwise take it from the form
	 */
	var testSuiteIdToDuplicateTo = null;
	if (isClosedLoop()) {
		testSuiteIdToDuplicateTo = TestPlans_populateTestPlanBasicData(testPlanIdToDuplicate).testSuiteId;
	} else {
		testSuiteIdToDuplicateTo = TestPlans_SelectedTestSuiteIdForDuplicate;
	}
	
	// Get the new test plan name
	var newTestPlanName = $('#txtDuplicateAs').val();
		
	// Submit the form if the test plan name is not empty 
	if (isStringEmpty(newTestPlanName)) {
		$('#lblDuplicateTestPlanValidationError').html("The new test plan name field is missing");
		return;
	}
		
	// Send a request to the server to duplicate the test plan
	sendRequestToDuplicateTestPlan(testPlanIdToDuplicate, newTestPlanName, testSuiteIdToDuplicateTo);
}

function onRenderTestPlanComplete() {

	// Prepare the table for view
	prepareTableFiltersExt('tblScenarios', false, true);
	
	// Apply view
	$('#slctView').change();
				
	checkEmptyVirtualCombinations();
}

function checkEmptyVirtualCombinations(callingElement) {
	// If closed loop do nothing
	if (isClosedLoop()) {
		return;
	}
	
	// Iterate over the table rows
	if (callingElement) {
		isLegalVirtualCombination(callingElement);
	} else {
		$('#tblScenarios tbody tr').each(function() {
			isLegalVirtualCombination(this);
		});
	}
}

function isLegalVirtualCombination(rowElement) {

	// If the row is a bastard test then skip
	if ($(rowElement).is('[bastard]')) {
		return;
	}

	// Extract the test suite project
	var projectName = $('#divTestPlanBasicData').find('#projectName').html();
	
	// Get the allowed project setup parameters
	var allowedProjectSetupParameterValueIds = globalProjectData.setupParameterValueIds;
	
	// Get the virtual combination select box
	var theVirtualCombinationSlct = $(rowElement).find('#slctVirtualCombination');
	
	// Get the selected virtual combination name from the selected
	var theSelectedVirtualCombinationName = getTextFromElement(theVirtualCombinationSlct);
	
	// Compare the virtual combination to the allowed project setup parameter value ids
	var isValid = isVirtualCombinationValidComparingProjectAllowedSetupParameterValues(
			theSelectedVirtualCombinationName, 
			allowedProjectSetupParameterValueIds);
	
	// If not valid mark as red
	if (!isValid) {
		// Mark it with color
		theVirtualCombinationSlct.attr('class', 'IllegalVirtualCombination');
		
	} else if (theVirtualCombinationSlct.attr('class') == 'IllegalVirtualCombination') {
		theVirtualCombinationSlct.attr('class', '');
	}
}

function TestPlans_populateTestPlanBasicData(testPlanId) {
	// Get the test plan as json
	var testPlan = getTestPlanByIDAsJson(testPlanId);
	
	// Extract the test plan - test plan name
	var testPlanName = testPlan.testPlanName;
	
	// The test suite id
	var	testSuiteId	 = testPlan.testSuiteId;
	
	// The test version id
	var testVersionId = testPlan.testVersionId
	
	return new TestPlanBasicData(testPlanId, testPlanName, testSuiteId, testVersionId); 
}

function onTestPlanChange(callingElement)
{
	// Extract the selected value from the calling element
	var selectedValue = getValueFromElement(callingElement);
	
	// Set the value of all select test plans
	setValueOfElement($('select[id^=slctTestPlan]'), selectedValue);
}

function TestPlans_onSyncLMS() {
	// Clean previous errors
	$('#lblSyncLMSError').html('');
	
	// Open the dialog
	$('#syncLMSDialog').dialog('open');
}

function TestPlans_onSyncLMSConfirm() {
	
	// Clean previous errors
	$('#lblSyncLMSError').html('');
	
	// Make sure that LMS version was selected & parse it
	var lmsVersion = parseLMSVersion($('#inputLMSVersions').val());
	if (isStringEmpty(lmsVersion)) {
		$('#lblSyncLMSError').html('The LMS version is empty!');
		return;
	}
	
	// Send a request to sync the LMS
	TestPlans_sendRequestToGetLMSTestsData(lmsVersion, 'TestPlans_renderLMSTestsData');
}

function TestPlans_onApplyTS() {
	// Clean previous errors
	$('#applyTSDialog').find('#lblApplyTSError').html('');
	
	// Show the dialog
	$('#applyTSDialog').dialog('open');
}

function TestPlans_onApplyTSConfirm() {
	// Clean previous errors
	$('#applyTSDialog').find('#lblApplyTSError').html('');
	
	// Show the loader
	$('#applyTSDialog').find('#applyTSLoader').removeClass('inactive');

	// Close the popup
	$('#applyTSDialog').dialog('close');

	// Send a request to save the current test plan
	TestPlans_sendRequestToSaveTP(TestPlans_onSaveTPPriorApplySuccess, TestPlans_onSaveTPPriorApplyFailure);
}

function TestPlans_onSaveTPPriorApplySuccess(responseAsJson) {
	// Update the data after save TP success
	TestPlans_updateDataAfterSaveTPSuccess(responseAsJson);
	
	// Extract the test plan id
	var testPlanId = $('#hdnTestPlanId').val();
	
	// Extract the test suite id
	var testSuiteId = TestPlans_SelectedTestSuiteId; 
	
	// Send a request to apply the TS on the TP
	TestPlans_sendRequestToApplyTS(testPlanId, testSuiteId);
}

function TestPlans_onSaveTPPriorApplyFailure(error) {
	// Hide the loader
	$('#applyTSDialog').find('#applyTSLoader').addClass('inactive');
	
	// Show the error in the dialog
	$('#applyTSDialog').find('#lblApplyTSError').html('Failed to apply the Test Suite');
}

function TestPlans_onSaveTP() {
	// Open the dialog
	$('#saveTPDialog').dialog('open');
}

function TestPlans_onSaveTPConfirm() {
	// Close the popup
	$('#saveTPDialog').dialog('close');

	// Send a request to save the test plan
	TestPlans_sendRequestToSaveTP();
}

function TestPlans_onSaveTPSuccess(responseAsJson) {
	// Update the data after save TP success
	TestPlans_updateDataAfterSaveTPSuccess(responseAsJson);
	
	// Remove the dirty row indication from all the rows
	$('#tblScenarios tbody tr').each(function() {
		$(this).removeAttr('data-dirty');
		$(this).removeClass('TestManagementDifferentFromDefault');
	});
	
	// Re-render the test plan names
	TestPlans_loadTestPlanNames(undefined, renderTestPlanNames);
	
	UIUtility_showAlert('Test plan was saved successfully', 'Save');
}

function TestPlans_onSaveTPFailure(errorMessage) {
	UIUtility_showAlert("Failed to save test plan", "Error");
}

function TestPlans_updateDataAfterSaveTPSuccess(responseAsJson) {
	// Extract the tp changes as json
	var tpChangesAsJson = TestPlans_getTestPlanChangesClass().getChangesAsJson();
	
	// Iterate over the changed scenarios
	responseAsJson.changes.changedScenarioVCIds.forEach(function(changedScenarioVCID) {
		// Extract the changed scenario from the response
		var changedScenarioAsJsonFromResponse = responseAsJson.changes[changedScenarioVCID];
		
		// Get the scenario row
		var scenarioRow = getScenarioTableRowByScenarioVirtualCombinationId(changedScenarioVCID);
		
		if (undefined != changedScenarioAsJsonFromResponse) {
			// Update the virtual combination ids (mask & customized)
			if (undefined != changedScenarioAsJsonFromResponse.customizedVCId) {
				TestPlans_updateCustomizedVirtualCombinationWithId(scenarioRow, changedScenarioAsJsonFromResponse.customizedVCId);
				scenarioRow.find('#slctVirtualCombination').attr('saved', changedScenarioAsJsonFromResponse.customizedVCId);
			}
			if (undefined != changedScenarioAsJsonFromResponse.maskVCId) {
				scenarioRow.attr('mask-virtual-combination-id', changedScenarioAsJsonFromResponse.maskVCId);
			}
		}
		
		// Extract the changed scenario from the request to modify the 'saved' attribute of the changes
		var changedScenarioAsJsonFromRequest = tpChangesAsJson.changes[changedScenarioVCID];
		
		// Modify the 'saved' attribute in the 'include' checkbox
		if (undefined != changedScenarioAsJsonFromRequest.included) {
			scenarioRow.find('#chkIncludeInExecution').attr('saved', changedScenarioAsJsonFromRequest.included);
		} 
		
		// Modify the 'saved' attribute in the priority
		if (undefined != changedScenarioAsJsonFromRequest.priority) {
			scenarioRow.find('#slctPriority').attr('saved', changedScenarioAsJsonFromRequest.priority);
		}
		
		// Modify the 'saved' attribute in the repeat
		if (undefined != changedScenarioAsJsonFromRequest.repeat) {
			scenarioRow.find('#slctRepeat').attr('saved', changedScenarioAsJsonFromRequest.repeat);
		}
		
		if (undefined != changedScenarioAsJsonFromRequest.customizedVC) {
			// Modify the 'saved' attribute in the setup parameters (any)
			if (undefined != changedScenarioAsJsonFromRequest.customizedVC.setupParameterIdsToAdd) {
				changedScenarioAsJsonFromRequest.customizedVC.setupParameterIdsToAdd.forEach(function(setupParameterIdToAdd) {
					// The saved value should be true
					scenarioRow.find('#chkAny' + setupParameterIdToAdd).attr('saved', 'true');
				});
			}
			if (undefined != changedScenarioAsJsonFromRequest.customizedVC.setupParameterIdsToRemove) {
				changedScenarioAsJsonFromRequest.customizedVC.setupParameterIdsToRemove.forEach(function(setupParameterIdToRemove) {
					// The saved value should be false
					scenarioRow.find('#chkAny' + setupParameterIdToRemove).attr('saved', 'false');
				})
			}
		
			// Modify the 'saved' attribute in the setup parameter values
			if (undefined != changedScenarioAsJsonFromRequest.customizedVC.setupParameterIdsToAdd) {
				changedScenarioAsJsonFromRequest.customizedVC.setupParameterValueIdsToAdd.forEach(function(setupParameterValueIdToAdd) {
					// The saved value should be true
					scenarioRow.find('#chk' + setupParameterValueIdToAdd).attr('saved', 'true');
				});
			}
			if (undefined != changedScenarioAsJsonFromRequest.customizedVC.setupParameterValueIdsToRemove) {
				changedScenarioAsJsonFromRequest.customizedVC.setupParameterValueIdsToRemove.forEach(function(setupParameterValueIdToRemove) {
					// The saved value should be false
					scenarioRow.find('#chk' + setupParameterValueIdToRemove).attr('saved', 'false');
				})
			}
		}
	});
	
	// Reset the TP changes json
	TestPlans_getTestPlanChangesClass().resetTPChangesAsJson();
}

function TestPlans_onRemoveTestConfirm() {
	
	// Clear previous error message
	$('#notifyAboutBastardTest').find('#lblDeleteTPScenarioError').html('');
	
	// Extract the calling element from the dialog
	var callingElement = $('#notifyAboutBastardTest').data('callingElement');
	
	// Extract the test plan id
	var testPlanId = $('#hdnTestPlanId').val();
	
	// Extract the scenario virtual combination id
	var scenarioVirtualCombinationId = $(callingElement).closest('tr').attr('data-scenario-virtual-combination-id');
	
	// Send a request to remove test plan scenarios
	TestPlans_sendRequestToDeleteTestPlanScenario(testPlanId, scenarioVirtualCombinationId);
}

function TestPlans_onRemoveTestCancel() {
	// Extract the calling element from the dialog
	var callingElement = $('#notifyAboutBastardTest').data('callingElement');
	
	// Check again the include checkbox
	$(callingElement).closest('tr').find('#chkIncludeInExecution').prop('checked', true);
	
	// Close the dialog
	$('#notifyAboutBastardTest').dialog('close');
}

function TestPlans_restoreSetupParameterValueSelectionsToDefaults(callingElement) {
	
	var theRow = $(callingElement).parents('tr:eq(0)');
	
	// Reset the unchecked setup parameter values in case were reduced + default is true
	var uncheckedCheckboxes = theRow.find('input[type="checkbox"]').filter(function() {
		var isChecked = $(this).is(':checked');
		var defaultVal = $(this).attr('default');
		return !isStringEmpty($(this).attr('setup-parameter-value-id')) && !isChecked && 'true' == defaultVal;
	});
	uncheckedCheckboxes.each(function() {
		$(this).trigger('click');
	});
	
	// Reset the checked setup parameters (any) in case were checked
	var checkedCheckboxes = theRow.find('input[type="checkbox"]').filter(function() {
		var isChecked = $(this).is(':checked');
		var defaultVal = $(this).attr('default');
		return !isStringEmpty($(this).attr('setup-parameter-id')) && isChecked && 'false' == defaultVal;
	});
	checkedCheckboxes.each(function() {
		$(this).trigger('click');
	});
}

function testPlans_toggleSortable() {
	// Sortable
	var testOrderIsImportant = BooleanUtilityFunctions_StringToBoolean(getValueFromElement($('#chkOrderIsImportant')));
	if (testOrderIsImportant) {
		$('#tblScenarios #divSortableControls').removeClass("inactive");
	} else {
		$('#tblScenarios #divSortableControls').addClass("inactive");
	}
}

function TestPlans_SortableTop() {
	var table = $("#tblScenarios");
	var selectedRows = getSelectedRows(table);
	var tbody = table.find("> tbody");
	for (var i = selectedRows.length - 1; i >= 0; i--) {
		selectedRows[i].remove();
		tbody.prepend(selectedRows[i]);
	}
}

function TestPlans_SortableUp() {
	var table = $("#tblScenarios");
	var selectedRows = getSelectedRows(table);
	for (var i = 0; i < selectedRows.length; i++) {
		var rows = table.find("> tbody > tr");
		var rowIndex = rows.index(selectedRows[i]);
		if (rowIndex == 0) {
			return;
		}
		selectedRows[i].remove();
		$(selectedRows[i]).insertBefore(rows.eq(rowIndex - 1));
	}
}

function TestPlans_SortableDown() {
	var table = $("#tblScenarios");
	var selectedRows = getSelectedRows(table);
	for (var i = selectedRows.length - 1; i >= 0; i--) {
		var rows = table.find("> tbody > tr");
		var rowIndex = rows.index(selectedRows[i]);
		if (rowIndex == rows.length - 1) {
			return;
		}
		selectedRows[i].remove();
		$(selectedRows[i]).insertAfter(rows.eq(rowIndex + 1));
	}
}

function TestPlans_SortableBottom() {
	var table = $("#tblScenarios");
	var selectedRows = getSelectedRows(table);
	var tbody = table.find("> tbody");
	for (var i = 0; i < selectedRows.length; i++) {
		selectedRows[i].remove();
		tbody.append(selectedRows[i]);
	}
}

function TestPlans_CategoriesTreeSelectionChanged() {
	// Get all selected into a set (assuming __parent__ will never be relevant)
	var selected = $("#divCategoriesTree").jstree().get_bottom_selected();
	var selectedSet = new Set();
	for (var i = 0; i < selected.length; i++) {
		selectedSet.add(selected[i]);
	}

	// Change inactive accordingly
	$("#tblScenarios > tbody > tr").each(function () {
		var row = $(this);
		var checkbox = row.find("#chkIncludeInExecution");
		var isIncluded = checkbox.prop("checked");
		if (selectedSet.has(row.attr('data-scenario-name'))) {
			if (row.hasClass("inactive-force")) {
				row.removeClass("inactive-force");
			}
			if (!isIncluded) {
				checkbox.click();
			}
		} else {
			if (!row.hasClass("inactive-force")) {
				row.addClass("inactive-force");
			}
			if (isIncluded) {
				checkbox.click();
			}
		}
	})
}

/** javascripts/testplans/TestPlansRenderHelper.js **/
function TestPlans_showHideDataBasedOnPageData() {
	if (isClosedLoop()) {

		// Hide the test suite in the duplicate form
		$('#showDuplicateTestPlanFormEffect').find('#trTestSuiteInDuplicateTestPlan').addClass('inactive');
		
	} else {
		// Hide Sync LMS operation
		$('#divTestPlanOperations').find('#tdSyncLMSOperation').addClass('inactive');
		
		// Hide the last synced LMS version
		$('#divTestPlanBasicData').find('#trLastSyncedLMSVersion').addClass('inactive');
		
		// Hide the Tags column
		TestPlans_hideColumn('Tags');
	}
}

function TestPlans_hideColumn(columnName) {
	var tdColumnId = '#td' + columnName;
	var thColumnId = '#th' + columnName;
	
	$('#tblScenariosTemplate').find(tdColumnId).addClass('inactive');
	$('#tblScenariosHeaderTemplate').find('#trActionOnSelected').find(thColumnId).addClass('inactive');
	$('#tblScenariosHeaderTemplate').find('#trColumnNames').find(thColumnId).addClass('inactive');
}

function TestPlans_initializeDialogs() {
	// Initialize the sync LMS dialog
	TestPlans_initializeSyncLMSDialog();
	
	// Initialize the apply TS dialog
	TestPlans_initializeApplyTSDialog();
	
	// Initialize the notify about bastard test dialog
	TestPlans_initializeNotifyAboutBastardTestDialog();
	
	// Initialize the restore test plan scenarios dialog
	TestPlans_initializeRestoreTestPlanScenariosDialog();
	
	// Initialize the save TP dialog
	TestPlans_initializeSaveTPDialog();
	
	// Initialize the delete TP dialog
	TestPlans_initializeDeleteTestPlanDialog();
}

function TestPlans_initializeSyncLMSDialog()
{
	$("#syncLMSDialog").dialog({
		autoOpen: false,
		height: 400,
		width: 550,
		modal: true,
		buttons: [ 
		          {
		        	  id: "btnSyncLMSConfirm",
		        	  text: "Sync",
		        	  click: function() {
		        		  TestPlans_onSyncLMSConfirm();
		        	  }
		          },
		          {
		        	  id: "btnCancel",
		        	  text: "Cancel",
		        	  click: function() {
		        		  $(this).dialog("close");
		        	  }
		          }
		          ]
	});
}

function TestPlans_initializeApplyTSDialog()
{
	$("#applyTSDialog").dialog({
		autoOpen: false,
		height: 400,
		width: 550,
		modal: true,
		buttons: [ 
		          {
		        	  id: "btnApplyTSConfirm",
		        	  text: "Apply",
		        	  click: function() {
		        		  TestPlans_onApplyTSConfirm();
		        	  }
		          },
		          {
		        	  id: "btnCancel",
		        	  text: "Cancel",
		        	  click: function() {
		        		  $(this).dialog("close");
		        	  }
		          }
		          ]
	});
}

function TestPlans_initializeNotifyAboutBastardTestDialog()
{
	$("#notifyAboutBastardTest").dialog({
		autoOpen: false,
		height: 400,
		width: 550,
		modal: true,
		buttons: [ 
		          {
		        	  id: "btnConfirmRemove",
		        	  text: "Remove Test",
		        	  click: function() {
		        		  TestPlans_onRemoveTestConfirm();
		        	  }
		          },
		          {
		        	  id: "btnCancel",
		        	  text: "Cancel",
		        	  click: function() {
		        		  TestPlans_onRemoveTestCancel();
		        	  }
		          }
		          ]
	});
}

function TestPlans_initializeSaveTPDialog() {
	$("#saveTPDialog").dialog({
		autoOpen: false,
		height: 400,
		width: 550,
		modal: true,
		buttons: [ 
		          {
		        	  id: "btnSaveTPConfirm",
		        	  text: "Save",
		        	  click: function() {
		        		  TestPlans_onSaveTPConfirm();
		        	  }
		          },
		          {
		        	  id: "btnCancel",
		        	  text: "Cancel",
		        	  click: function() {
		        		  $(this).dialog("close");
		        	  }
		          }
		          ]
	});
}

function TestPlans_initializeRestoreTestPlanScenariosDialog() {
	$("#restoreTPScenarioDialog").dialog({
		autoOpen: false,
		height: 400,
		width: 550,
		modal: true,
		buttons: [ 
		          {
		        	  id: "btnRestoreTPScenariosConfirm",
		        	  text: "Restore",
		        	  click: function() {
		        		  TestPlans_onRestoreTestPlanScenariosConfirm();
		        	  }
		          },
		          {
		        	  id: "btnCancel",
		        	  text: "Cancel",
		        	  click: function() {
		        		  $(this).dialog("close");
		        	  }
		          }
		          ]
	});
}

function TestPlans_initializeDeleteTestPlanDialog() {
	$("#dialogDeleteTestPlan").dialog({
		autoOpen: false,
		height: 400,
		width: 550,
		modal: true,
		buttons: [ 
		          {
		        	  id: "btnDeleteTPConfirm",
		        	  text: "Archive",
		        	  click: function() {
		        		  // Extract the test plan id
		        		  var testPlanIdToDelete = $('#slctTestPlanForDeleting option:selected').attr('value');
		        		  
		        		  // Send a request to the server to delete the test plan
		        		  sendRequestToDeleteTestPlan(testPlanIdToDelete);
		        		  
		        		  $(this).dialog("close");
		        	  }
		          },
		          {
		        	  id: "btnCancel",
		        	  text: "Cancel",
		        	  click: function() {
		        		  $(this).dialog("close");
		        	  }
		          }
		          ]
	});
}

function TestPlans_initializeButtons() {
	TestPlans_initializeToggleBehaviour(
			'btnAddTestPlanToggle', 'ui-icon-document', 'showAddTestPlanFormEffect', '');
	TestPlans_initializeToggleBehaviour(
			'btnLoadTestPlanToggle', 'ui-icon-folder-open', 'showLoadTestPlanFormEffect', '');
	TestPlans_initializeToggleBehaviour(
			'btnDuplicateTestPlanToggle', 'ui-icon-copy', 'showDuplicateTestPlanFormEffect', '');
	TestPlans_initializeToggleBehaviour(
			'btnArchiveTestPlanToggle', 'ui-icon-trash', 'showArchiveTestPlanFormEffect', '');
	
	UIUtility_initializeButton('btnAddTestPlan'				 , 'ui-icon-document');
	UIUtility_initializeButton('btnLoadTestPlan'			 , 'ui-icon-folder-open');
	UIUtility_initializeButton('btnDuplicate'				 , 'ui-icon-copy');
	UIUtility_initializeButton('btnDelete'					 , 'ui-icon-trash');
	UIUtility_initializeButton('btnDeleteTPConfirm'			 , 'ui-icon-trash');
	UIUtility_initializeButton('btnApplyTS'					 , 'ui-icon-arrowstop-1-s');
	UIUtility_initializeButton('btnApplyTSConfirm'			 , 'ui-icon-arrowstop-1-s');
	UIUtility_initializeButton('btnSyncLMS'					 , 'ui-icon-transferthick-e-w');
	UIUtility_initializeButton('btnSyncLMSConfirm'			 , 'ui-icon-transferthick-e-w');
	UIUtility_initializeButton('btnSaveTP'					 , 'ui-icon-disk');
	UIUtility_initializeButton('btnSaveTPConfirm'			 , 'ui-icon-disk');
	UIUtility_initializeButton('btnCancel'					 , 'ui-icon-cancel');
	UIUtility_initializeButton('btnRestoreTPScenariosConfirm', 'ui-icon-arrowreturnthick-1-w');
	UIUtility_initializeButton('btnConfirmRemove'			 , 'ui-icon-trash');
	UIUtility_initializeButton('btnShowChangeLog'			 , 'ui-icon-script');
	UIUtility_initializeButton('btnSortableTop'				 , 'ui-icon-arrowthickstop-1-n');
	UIUtility_initializeButton('btnSortableUp'				 , 'ui-icon-arrowthick-1-n');
	UIUtility_initializeButton('btnSortableDown'			 , 'ui-icon-arrowthick-1-s');
	UIUtility_initializeButton('btnSortableBottom'			 , 'ui-icon-arrowthickstop-1-s');

	UIUtility_setSmallButtonPadding($("#btnSortableTop, #btnSortableUp, #btnSortableDown, #btnSortableBottom"));
}

function TestPlans_initializeToggleBehaviour(toggleBtnId, btnIcon, divIdToToggleFor, callBack) {
	
	UIUtility_initializeToggleBehaviour(
			toggleBtnId, btnIcon, divIdToToggleFor, TestPlans_toggleButtons, TestPlans_toggleStates, callBack);
}

function renderTestSuiteNames(jsonResponse) {
	globalTestSuitesMetaData = jsonResponse;

	var testSuiteMap = new Array();

	globalTestSuitesMetaData.testSuiteNames.forEach(function(entry) {
		var testSuiteName = globalTestSuitesMetaData[entry].testSuiteName;
		testSuiteMap.push(testSuiteName);
		TestPlans_TestSuitesCollection[testSuiteName] = {"testSuiteId": "", "testVersionId": ""};
		TestPlans_TestSuitesCollection[testSuiteName].testSuiteId = globalTestSuitesMetaData[entry].testSuiteId;
		TestPlans_TestSuitesCollection[testSuiteName].testVersionId = globalTestSuitesMetaData[entry].testVersionId;
	});

	$("#slctTestSuite").autocomplete({
	      select: function( event, ui ) {},
	      source: testSuiteMap,
	      minLength: 0
	   		}).on('focus', function () {
		  		  $(this).autocomplete('search', '');
			}).on("autocompleteselect", function( event, ui ) {
				TestPlans_SelectedTestSuiteId = TestPlans_TestSuitesCollection[ui.item.value].testSuiteId;
			});
	
	$("#slctApplyTestSuite").autocomplete({
	      select: function( event, ui ) {},
	      source: testSuiteMap,
	      minLength: 0
	   		}).on('focus', function () {
		  		  $(this).autocomplete('search', '');
			}).on("autocompleteselect", function( event, ui ) {
				TestPlans_SelectedTestSuiteId = TestPlans_TestSuitesCollection[ui.item.value].testSuiteId;
			});
	
	$("#slctTestSuiteForDuplicate").autocomplete({
	      select: function( event, ui ) {},
	      source: testSuiteMap,
	      minLength: 0
	   		}).on('focus', function () {
		  		  $(this).autocomplete('search', '');
			}).on("autocompleteselect", function( event, ui ) {
				TestPlans_SelectedTestSuiteIdForDuplicate = TestPlans_TestSuitesCollection[ui.item.value].testSuiteId;
			});
}

function renderTestPlanNames() {
	// Clear the select boxes
	var slctBox = $('select[id^=slctTestPlan]');
	slctBox.html('');
	slctBox.parent().find('input').val("");

	// If data-allow-custom is set, we'll allow a custom option and select it by default
	if (slctBox.is("[data-allow-custom]")) {
		slctBox.append("<option value='-1'>Custom ...</option>");
	}

	// Get the test plan ids
	var testPlanIds = getTestPlanIdsAsJson();
	
	// Iterate over the ids and populate the select boxes
	for (var testPlanIndex = 0; testPlanIndex < testPlanIds.length; testPlanIndex++) {
	
		// Extract the test plan id
		var testPlanId = testPlanIds[testPlanIndex];
		
		// Get the test plan with its data
		var testPlanDataAsJson = getTestPlanByIDAsJson(testPlanId);
		
		// Create an option to render
		if (!testPlanDataAsJson.draft) {
			var optionToAdd = 
				'<option value="' + testPlanDataAsJson.testPlanId + '"' +
				'virtual-lab-id="' + testPlanDataAsJson.testPlanVirtualLabId + '">' + testPlanDataAsJson.testPlanName + '</option>';
			slctBox.append(optionToAdd);
		}	
	}

	slctBox.combobox();
	slctBox.parent().find('.ui-autocomplete-input').css('min-width', '250px');
	$('.ui-autocomplete').css('max-height', '400px');
}

function hideTestPlanData() {
	//Hide the div with the test plan data
	$('#divTestPlanData').addClass('inactive');
}

function renderTestPlan() {
	// Clear current test plan data
	$('#tblScenarios thead').html('');
	$('#tblScenarios tbody').html('');

	globalTestCustomizedAttributeNames = new Array();
	
	// If closed loop then enable the not-LRU columns
	if (isClosedLoop()) {
		$('#tblScenariosHeaderTemplate thead th[id="thLruDisabled"]').each(function() {
			$(this).removeClass('inactive');
		});
		$('#tblScenariosTemplate').find('#tdLruDisabled').removeClass('inactive');
	}
	
	// Add the header
	var theHeaderAsHtml = $('#tblScenariosHeaderTemplate thead').html();
	$('#tblScenarios > thead').html(theHeaderAsHtml);

	// Extract the test plan from the JSON
	var testPlanAsJson = globalTestPlanData;
	
	// Render the basic test plan data
	renderBasicTestPlanData(testPlanAsJson);

	// Render the configuration scenarios (uses the same code that the setup scenarios page uses)
	var enableVCModification = !isClosedLoop();
	var rows = renderConfigurationScenarios(enableVCModification);

	// Override the data with the test plan scenarios
	renderIncludedAndOverridenTestPlanScenariosData(testPlanAsJson, rows);

	// If we have categories tree, start with all rows as forcely hidden
	var categoriesTree = $("#divCategoriesTree");
	if (categoriesTree.length > 0) {
		// Deselect all in tree
		var tree = categoriesTree.jstree();
		tree.deselect_all(true);

		// Close all but root
		tree.close_all();
		tree.toggle_node("__root__");

		// Hide all rows by default, except those selected
		for (var i = 0; i < rows.all.length; i++) {
			if (!rows.all[i].find("> #tdIncludeInExecution > #chkIncludeInExecution").prop("checked")) {
				rows.all[i].addClass("inactive-force");
			} else {
				tree.select_node(rows.all[i].attr("data-scenario-name"), true, true);
			}
		}

		// Redraw tree, previous changes weren't propogated to the UI
		tree.redraw();
	}

	// Re-organize the setup parameters with the setup parameter values
	TestPlans_reOrganizeSetupParameters(rows);

	// Populate the setup parameter value selections
	TestPlans_populateSetupParameterValueSelections(rows);

	// Override the customization attributes
	testPlans_renderTestPlanScenariosOverriddenProperties(testPlanAsJson, rows);

	// Add rows to table (assuming table is empty)
	var tbody = $("<tbody id='tbodyScenarios' />");
	for (var i = 0; i < rows.all.length; i++) {
		tbody.append(rows.all[i]);
	}
	$('#tblScenarios > tbody').remove();
	$('#tblScenarios').append(tbody);

	// Sortable
	testPlans_toggleSortable();

	// Check access and set read only if no access
	if (testPlanAsJson.limitToUsernames.length > 0 &&
			testPlanAsJson.limitToUsernames.indexOf(getLoggedInUsername()) == -1 &&
			!isLabAdmin()) {
		$("#divTestPlanOperations").hide();
		$("#btnEditSaveTestPlanName").hide();
		$("#slctLimitToUsernames")[0].selectize.disable();
		$("#chkOrderIsImportant").prop("disabled", true);
		$("#tblScenarios").find("input, select").prop("disabled", true);
	} else {
		$("#divTestPlanOperations").show();
		$("#btnEditSaveTestPlanName").show();
		$("#slctLimitToUsernames")[0].selectize.enable();
		$("#chkOrderIsImportant").prop("disabled", false);
		$("#tblScenarios").find("input, select").prop("disabled", false);
	}

	// By default make sure the showAdvanced checkbox is unchecked
	var chkShowAdvanced = $('#chkShowAdvanced');
	chkShowAdvanced.prop("checked", false);

	// Since it's in the header, we should render it after rendering the test plan
	var chkOrderIsImportant = $('#chkOrderIsImportant');
	UIUtility_initializeToggleButtonWithSelector(chkOrderIsImportant, 'ui-icon-arrow-4');
	UIUtility_initializeToggleButtonWithSelector(chkShowAdvanced, 'ui-icon-gear');

	var testOrderIsImportant = testPlanAsJson.testOrderIsImportant;
	if (testOrderIsImportant) {
		chkOrderIsImportant.click();
	}

	// Show the div with the test plan data
	$('#divTestPlanData').removeClass('inactive');

	// Enable the check all checkbox
	$('#chkSelectAll').prop("disabled", false);

	onRenderTestPlanComplete();

	TestPlans_UpdateContainerWidth();
}

function TestPlans_UpdateContainerWidth() {
	// Lets find the largest width table and set the container's minimum width to it
	var width = 0;
	$("table").each(function () {
		var curWidth = $(this).width();
		if (curWidth > width) {
			width = curWidth;
		}
	});
	if (width != 0) {
		// Add 20/40 pixels for insets
		$("#divScenariosWrapper").css('min-width', (width + 20) + 'px')
		$("#divTestPlanData").css('min-width', (width + 40) + 'px');
	}
}

function renderBasicTestPlanData(testPlanAsJson) {
	// Get a reference to the test plan name text box
	var txtTestPlanName = $('#divTestPlanBasicData').find('#txtTestPlanName');

	// Render the test plan id & name
	setValueOfElement($('#hdnTestPlanId'), testPlanAsJson.testPlanId);
	setValueOfElement($(txtTestPlanName), testPlanAsJson.testPlanName);
	// In view only the test plan operaions section is removed
	var requestParams = getRequestParameters();
	if (requestParams['viewOnly'] != 'true') {
		setValueOfElement($('#divTestPlanOperations').find('#tdChangeLog').find('#hdnEntityId'), testPlanAsJson.testPlanId);
	}
	
	// Make sure that the text box is big enough
	var testPlanNameSize 	= testPlanAsJson.testPlanName.length;
	var txtTestPlanSize	 	= txtTestPlanName.attr('size');
	
	if (testPlanNameSize > txtTestPlanSize && txtTestPlanSize < 100) {
		txtTestPlanName.attr('size', testPlanNameSize);
	}
	
	// Created by and time
	if (!isStringEmpty(testPlanAsJson.createdBy)) {
		$('#divTestPlanBasicData').find('#spanCreatedBy').attr('title', 'Created by ' + testPlanAsJson.createdBy + ' at ' + testPlanAsJson.createdTime);
		$('#divTestPlanBasicData').find('#spanCreatedBy').html('<sup>(?)</sup>');
	} else {
		$('#divTestPlanBasicData').find('#spanCreatedBy').attr('title', '');
		$('#divTestPlanBasicData').find('#spanCreatedBy').html('');
	}

	// Set test suite link	
	var testSuiteName = "";
	for (var testSuite in TestPlans_TestSuitesCollection) {
		if (TestPlans_TestSuitesCollection[testSuite].testSuiteId == testPlanAsJson.testSuiteId) {
			testSuiteName = testSuite;
			break;
		}
	}
	$('#testSuiteName').html("<a href='/ui/displayTestSuitesManagement?testSuiteId=" + testPlanAsJson.testSuiteId + "'>" + testSuiteName + "</a>");
	$('#testSuiteName').data('testVersionId', testPlanAsJson.testVersionId);

	// Set the project name
	$('#projectName').html("<a href='/ui/displayProjectsManagement?projectId=" + testPlanAsJson.projectId + "'>" + testPlanAsJson.projectName + "</a>");
	$('#projectName').data('projectId', testPlanAsJson.projectId);
	
	// Clean the last synced lms value
	$('#trLastSyncedLMSVersion').find('#tdLastSyncedLMSVersion').html('N/A');

	// Render limit to usernames
	$("#slctLimitToUsernames")[0].selectize.setValue(testPlanAsJson.limitToUsernames);
}

function renderTestPlanSelectsAfterTestPlanNameUpdate(testPlanId, newTestPlanName) {
	$('select[id^=slctTestPlan]').each(function() {
		$(this).find('option[value=' + testPlanId + ']').text(newTestPlanName);
	});
}

function renderIncludedAndOverridenTestPlanScenariosData(testPlanAsJson, rows) {
	// Extract the test plan scenarios
	var testPlanScenarios = getTestPlanScenarios(testPlanAsJson);

	// Store number of included test plan scenarios in execution
	var numberOfIncludedTestPlanScenarios = 0;

	// Iterate over the test plan scenarios
	for (var testPlanScenarioIndex = 0; testPlanScenarioIndex < testPlanScenarios.length; testPlanScenarioIndex++) {
		var testPlanScenarioTableRow = null;

		// Extract the current test plan scenario
		var testPlanScenarioAsJson = testPlanScenarios[testPlanScenarioIndex];

		// Extract the scenario id
		var scenarioVirtualCombinationId = testPlanScenarioAsJson.scenarioVirtualCombinationId;

		// Handle the bastard issue
		if (testPlanScenarioAsJson.bastard) {
			// Add a new row to the scenarios table signed as bastard
			testPlanScenarioTableRow = testPlans_addBasatrdScenarioAsFirstInTable(
					scenarioVirtualCombinationId, testPlanScenarioAsJson.scenarioName, testPlanScenarioAsJson.scenarioVirtualCombinationId, rows);

			// Modify the onclick of the include in execution
			testPlanScenarioTableRow.find('#chkIncludeInExecution').attr('onclick', 'TestPlans_showNotifyAboutBastardTestDialog(this)');

			// Disable the filter checkbox
			testPlanScenarioTableRow.find('#chkSelect').prop('disabled', 'true');
		} else {
			// Using the scenario id, get a reference to the table row
			testPlanScenarioTableRow = rows[scenarioVirtualCombinationId];
		}

		// Extract the included flag
		var included = testPlanScenarioAsJson.included;
		
		if (included) {
			// Increment the number of included test plan scenarios
			numberOfIncludedTestPlanScenarios++;
		}
		
		// Update the included flag
		testPlanScenarioTableRow.find('#chkIncludeInExecution').prop('checked', included);
		testPlanScenarioTableRow.find('#chkIncludeInExecution').attr('saved', included);

		if (!testPlanScenarioAsJson.bastard) {
			// Get the select virtual combination of the row
			var slctVirtualCombination = testPlanScenarioTableRow.find('#slctVirtualCombination');
			
			// Extract the customized virtual combination id
			var customizedVirtualCombinationId = testPlanScenarioAsJson.customizedVirtualCombinationId;
			if (customizedVirtualCombinationId != undefined) {
				// Modify the id of the customized virtual combination
				TestPlans_updateCustomizedVirtualCombinationWithId(testPlanScenarioTableRow, customizedVirtualCombinationId);

				slctVirtualCombination.val(customizedVirtualCombinationId);
				slctVirtualCombination.attr('saved', customizedVirtualCombinationId);

				// Render the virtual combination color
				renderVirtualCombinationColor(slctVirtualCombination);
			} else {
				// Clear the color
				slctVirtualCombination.attr('class', '');
			}

			// Extract the mask virtual combination id
			var maskVirtualCombinationId = testPlanScenarioAsJson.maskVirtualCombinationId;
			if (undefined != maskVirtualCombinationId) {
				testPlanScenarioTableRow.attr('mask-virtual-combination-id', maskVirtualCombinationId);
			}
		}
	}
	
	// Update the UI with the number of included test plan scenarios
	$('#lblNumberOfIncludedTestPlanScenarios').html(numberOfIncludedTestPlanScenarios);
}

function testPlans_addBasatrdScenarioAsFirstInTable(scenarioId, scenarioName, scenarioVirtualCombinationId, rows) {
	// Extract the template row
	var configurationScenarioTemplateRow = $('#tblScenariosTemplate tbody tr').last();

	// Make the template row enabled/disabled
	enableEntireTableRow(configurationScenarioTemplateRow);

	// The template row as html
	var configurationScenarioTemplateRowAsHtml = configurationScenarioTemplateRow.html();

	// The row to add
	var newRow = $('<tr>' + configurationScenarioTemplateRowAsHtml + '</tr>');

	// Add tds according to how many we have in any row (if we have at least one row), to fill missing attribute columns
	if (rows.all.length > 0) {
		var want = rows.all[0].find("td").length;
		var exist = newRow.find("td").length;
		var html = "";
		for (var i = exist; i < want; i++) {
			html += "<td></td>";
		}
		if (html != "") {
			newRow.append(html);
		}
	}

	// Add the template row to the first row in the array
	rows[scenarioVirtualCombinationId] = newRow;
	rows.all.splice(0, 0, newRow);

	// Clean all cells
	newRow.find('td').each(function() {
		if (this.id != 'tdSelect' && this.id != 'tdIncludeInExecution') {
			$(this).html('');
		}
	});

	// Fill the scenario id attribute
	newRow.attr('data-scenario-id', scenarioId);

	// Fill the scenario virutal combination id attribute
	newRow.attr('data-scenario-virtual-combination-id', scenarioVirtualCombinationId);

	// Fill the scenario name attribute
	newRow.attr('data-scenario-name', scenarioName);

	// Fill the hidden id with the scenario id
	newRow.find('#hdnID').val(scenarioId);

	// Fill the scenario name
	newRow.find('#tdScenarioName').html(scenarioName);

	// Make the background of the row with gray
	newRow.addClass('grayed');

	// Turn on the bastard attribute 
	newRow.attr('bastard', true);

	newRow.removeClass('inactive');

	return newRow;
}

function testPlans_renderTestPlanScenariosOverriddenProperties(testPlanAsJson, rows) {

	// Extract the test plan scenarios customized attributes
	var testPlanScenarios = getTestPlanScenarios(testPlanAsJson);
	
	// Iterate over the test plan scenarios customized attributes
	for (var testPlanScenarioIndex = 0; testPlanScenarioIndex < testPlanScenarios.length; testPlanScenarioIndex++) {
		
		// Extract the current test plan scenario
		var testPlanScenario = testPlanScenarios[testPlanScenarioIndex];
			
		// Extract the scenario virtual combination id
		var scenarioVirtualCombinationId = testPlanScenario.scenarioVirtualCombinationId;
		
		// Using the scenario id, get a reference to the table row
		var testPlanScenarioTableRow = rows[scenarioVirtualCombinationId];
		
		// Get the customized and bastard flags
		var bastard = testPlanScenario.bastard;
		var customized = testPlanScenario.customized;

		// Set the customized attribute
		testPlanScenarioTableRow.attr('data-customized', customized);
		
		// Skip if scenario is not customized
		if (bastard || !customized) {
			continue;
		}
				
		// Get the priority & repeat select elements
		var slctPriority = testPlanScenarioTableRow.find('#slctPriority');
		var slctRepeat = testPlanScenarioTableRow.find('#slctRepeat');
		
		// Extract the customized priority
		var customizedPriority = testPlanScenario.customizedPriority;
		
		// Update the priority with the customized one
		slctPriority.val(customizedPriority);
		slctPriority.attr('saved', customizedPriority);
		
		// Render the select priority color
		renderPriorityColor(slctPriority);
		
		// Extract the customized repeat
		var customizedRepeat = testPlanScenario.customizedRepeat;
		
		// Update the priority with the customized one
		slctRepeat.val(customizedRepeat);
		slctRepeat.attr('saved', customizedRepeat);
		
		// Render the select repeat color
		renderRepeatColor(slctRepeat);

		// Update the LRU disabled column
		var lruDisabled = testPlanScenario.lruDisabled;
		setValueOfElement(testPlanScenarioTableRow.find('#chkLruDisabled'), lruDisabled);

		// Update the comment column
		var comment = testPlanScenario.comment;
		setValueOfElement(testPlanScenarioTableRow.find('#txtTestComment'), comment);
	}
}

function TestPlans_renderTestPlanScenariosWithDefaults(rowsToRenderWithDefaults) {
	for (var rowIndex = 0; rowIndex < rowsToRenderWithDefaults.length; rowIndex++) {
		var rowToRenderWithDefaults = rowsToRenderWithDefaults[rowIndex]; 	
		TestPlans_renderTestPlanScenarioWithDefaults($(rowToRenderWithDefaults));
	}
}

function TestPlans_renderTestPlanScenarioWithDefaults(rowToRenderWithDefaults) {
	// Get the select virtual combination
	var slctVirtualCombination = rowToRenderWithDefaults.find('#slctVirtualCombination');
	
	// Extract & update the virtual combination
	var defaultVirtualCombinationId = slctVirtualCombination.attr('default-virtual-combination-id');
	slctVirtualCombination.val(defaultVirtualCombinationId);
	
	// Populate the setup parameter value selections
	var isCustomizedVirtualCombination = TestPlans_populateSetupParameterValueSelectionsForRow($(rowToRenderWithDefaults));
	TestPlans_enableSetupParameterCheckboxes(rowToRenderWithDefaults, isCustomizedVirtualCombination);
	
	// Render the virtual combination color
	renderVirtualCombinationColor(slctVirtualCombination);

	// Get the select priority
	var slctPriority = rowToRenderWithDefaults.find('#slctPriority');
	
	// Extract & update the priority
	var defaultPriority = slctPriority.attr('data-default-priority');
	slctPriority.val(defaultPriority);
	
	// Render the priority color
	renderPriorityColor(slctPriority);
	
	// Get the repeat
	var slctRepeat = rowToRenderWithDefaults.find('#slctRepeat');
	
	// Extract & update the repeat
	var defaultRepeat = slctRepeat.attr('data-default-repeat');
	slctRepeat.val(defaultRepeat);
	
	// Render the repeat color
	renderRepeatColor(slctRepeat);

	// Render the setup parameters & values color
	rowToRenderWithDefaults.find('input[type="checkbox"]').each(function() {
		if (!isStringEmpty($(this).attr('setup-parameter-value-id'))) {
			TestPlans_renderCheckSetupParameterValueColor($(this));
		}

		if (!isStringEmpty($(this).attr('setup-parameter-id'))) {
			TestPlans_renderCheckAnySetupParameterColor($(this));
		}
	});

	// Check if virtual combination is valid 
	checkEmptyVirtualCombinations(rowToRenderWithDefaults);
}

function renderVirtualCombinationColor(virtualCombinationElement) {
	// Extract the default virtual combination id
	var defaultVirtualCombinationId = $(virtualCombinationElement).attr('default-virtual-combination-id');
	
	// Extract the selected virtual combination id
	var selectedVirtualCombinationId = $(virtualCombinationElement).find('option:selected').val();
	
	// Render the element according to if equals or not to the default
	testManagement_renderScenarioSelectElementAsDifferentFromDefault(
			virtualCombinationElement, selectedVirtualCombinationId != defaultVirtualCombinationId);
}

function renderPriorityColor(slctPriorityElement) {

	// Extract the default repeat
	var defaultPriority = slctPriorityElement.attr('data-default-priority');
	
	// Extract the selected repeat
	var selectedPriority = slctPriorityElement.find('option:selected').val();
	
	// Render the element according to if equals or not to the default
	testManagement_renderScenarioSelectElementAsDifferentFromDefault(slctPriorityElement, defaultPriority != selectedPriority);
}

function renderRepeatColor(slctRepeatElement) {

	// Extract the default repeat
	var defaultRepeat = slctRepeatElement.attr('data-default-repeat');
	
	// Extract the selected repeat
	var selectedRepeat = slctRepeatElement.find('option:selected').val();
	
	// Render the element according to if equals or not to the default
	testManagement_renderScenarioSelectElementAsDifferentFromDefault(slctRepeatElement, defaultRepeat != selectedRepeat);
}

function TestPlans_renderCheckSetupParameterValueColor(callingCheckBox) {
	callingCheckBox = $(callingCheckBox);

	// Get the default value
	var defaultCheck = callingCheckBox.attr('default'); 
	
	// Current value
	var currentCheckValue = "" + callingCheckBox.prop("checked");

	// Color it with different value from the default
	TestPlans_renderTheTestPlanScenarioCheckboxElementAsDifferentFromDefault(callingCheckBox, defaultCheck != currentCheckValue);
}

function TestPlans_renderCheckAnySetupParameterColor(callingCheckBox) {
	callingCheckBox = $(callingCheckBox);

	// Get the default value
	var defaultCheck = callingCheckBox.attr('default'); 

	// Current value
	var currentCheckValue = "" + callingCheckBox.prop("checked");

	// Color it with different value from the default
	TestPlans_renderTheTestPlanScenarioCheckboxElementAsDifferentFromDefault(callingCheckBox, defaultCheck != currentCheckValue);
}

function TestPlans_renderTheTestPlanScenarioCheckboxElementAsDifferentFromDefault(element, isDifferentFromDefault) {
	// Check if element doesn't has illegal class
	if (!element.hasClass("IllegalVirtualCombination")) {

		// Get the span element surrounding the checkbox 
		var span = element.parent();

		if (isDifferentFromDefault) {
			// Mark it with color
			span.addClass('DifferentFromDefault');
		} else {
			// Clear the color
			span.removeClass('DifferentFromDefault');
		}
	}
}

function testManagement_renderScenarioSelectElementAsDifferentFromDefault(element, isDifferentFromDefault) {
	// Check if element doesn't has illegal class
	if (!element.hasClass("IllegalVirtualCombination")) {
		if (isDifferentFromDefault) {
			// Mark it with color
			$(element).attr('class', 'DifferentFromDefault');
		}
		else {
			// Clear the color
			$(element).attr('class', '');
		}
	}
}

function onPostIncludeInExecutionChanged(chkIncluded) {
	var numberToAdd = 0;
	
	// If included
	var isIncluded = $(chkIncluded).is(':checked');
	
	// Increment / decrement
	if (isIncluded) {
		numberToAdd = 1;
	} else {
		numberToAdd = -1;
	}
	TestPlans_modifyNumberOfIncludedTestPlanScenarios(numberToAdd);
}

function TestPlans_modifyNumberOfIncludedTestPlanScenarios(numberToAdd) {
	// Extract the current number of included test plan scenarios 
	var numberOfIncludedTestPlanScenarios = parseInt($('#lblNumberOfIncludedTestPlanScenarios').html());
	
	// Change the number
	numberOfIncludedTestPlanScenarios += numberToAdd;
	
	// Set back the value
	$('#lblNumberOfIncludedTestPlanScenarios').html(numberOfIncludedTestPlanScenarios);
}

function TestPlans_reOrganizeSetupParameters(rows) {
	
	if (!isClosedLoop()) {
		return;
	}

	// Extract the project spec all setup parameters
	var setupParameters = globalSetupParametersContainer.setupParameters;

	// HTML for filters row
	var filtersTrHtml = '';

	// The setup parameter names as html - will be the header
	var columnsTrHtml = '';

	// The setup parameter values - will be the data inside each row
	var setupParameterValuesAsHtml = '';

	// Iterate over the setup parameters
	for (var setupParameterIndex = 0; setupParameterIndex < setupParameters.length; setupParameterIndex++) {

		// Extract the current setup parameter name
		var setupParameter = setupParameters[setupParameterIndex];
		var setupParameterName = setupParameter.setupParameterName;

		// Add the setup parameter to the filters row
		filtersTrHtml += '<th id="th' + setupParameterName + '" class="inactive"></th>';

		// Add the setup parameter name to the header
		columnsTrHtml += '<th data-setup-parameter class="inactive" style="white-space: nowrap;" id="th' + setupParameterName + '" ';
		columnsTrHtml += 'data-filter-enabled data-filter-multiple data-filter-refresh-on-open ';
		columnsTrHtml += 'data-filter-collect-values-function="filterCollectValues_MultipleValuesAttribute" ';
		columnsTrHtml += 'data-filter-apply-function="filterApply_MultipleCheckboxes" ';
		columnsTrHtml += 'data-filter-finite-values ';
		columnsTrHtml += 'data-filter-with-no-sort ';
		columnsTrHtml += 'data-filter-allow-and-relation ';
		columnsTrHtml += 'data-filter-values=" ';
		columnsTrHtml += 'Any;';

		// Extract the setup parameter values
		var setupParameterValues = setupParameter.setupParameterValues;

		// Attach a new cell (per setup parameter) 
		setupParameterValuesAsHtml += '<td class="inactive" style="white-space: nowrap;" id="td' + setupParameterName + '">';

		// Iterate over the setup parameter values
		for (var setupParameterValueIndex = 0; setupParameterValueIndex < setupParameterValues.length; setupParameterValueIndex++) {

			// Extract the current setup parameter value
			var setupParameterValueObj = setupParameterValues[setupParameterValueIndex];

			// Extract the setup parameter value id
			var setupParameterValueId = setupParameterValueObj.setupParameterValueId;
			var setupParameterValue = setupParameterValueObj.setupParameterValue;

			// Attach the setup parameter value
			setupParameterValuesAsHtml += 
				'<span><input setup-parameter-value-id="' +  setupParameterValueId + '" id="chk' + setupParameterValueId + 
				'" type="checkbox" disabled="true" value="' + setupParameterValue + '" default=false ' + 
				'renderColorFunction="TestPlans_renderCheckSetupParameterValueColor" ' + 
				'onclick="TestPlan_onCheckTestPlanScenarioSetupParameterValue(this)" /> ' + setupParameterValue + ' </span>  ';
			
			columnsTrHtml += setupParameterValue + ';';
		}

		// Attach 'Any'
		setupParameterValuesAsHtml += '<br><span><input setup-parameter-id="' +  setupParameter.setupParameterId + 
			'" id="chkAny' + setupParameter.setupParameterId + '" type="checkbox" disabled="true"' +
			' value="Any" default=false renderColorFunction="TestPlans_renderCheckAnySetupParameterColor" ' +
			'onclick="TestPlan_onCheckTestPlanScenarioAnySetupParameter(this)" /> Any&nbsp;</span></td>';
		columnsTrHtml += '"'

		// Close the HTML for the column names row
		columnsTrHtml += '>' + setupParameterName + '</th>';
	}

	// For performance reasons, instead of cloning, we'll create one big HTML and move elements individually
	var bigStr = "";
	for (var i = 0; i < rows.all.length; i++) {
		bigStr += "<tr>" + setupParameterValuesAsHtml + "</tr>";
	}
	var bigContainer = $("<tbody>" + bigStr + "</tbody>");
	var setupParamRows = bigContainer.find("tr");

	// Add the setup parameter values to all rows in the table
	for (var i = 0; i < rows.all.length; i++) {
		rows.all[i].find('td[id^="tdVirtualCombination"]').after($(setupParamRows[i]).find("td"));
	}

	// Add the header rows (in the actions replace td with th + Scenario with Scenarios)
	var tblScenarios = $('#tblScenarios');
	tblScenarios.find('#trActionOnSelected th[id^="thVirtualCombination"]').after(
			setupParameterValuesAsHtml.replace(/td/g, "th").replace(/Scenario/g, "Scenarios").replace(/disabled="true"/g, ""));
	tblScenarios.find('#trFilters th[id^="thVirtualCombination"]').after(filtersTrHtml);
	tblScenarios.find('#trColumnNames th[id^="thVirtualCombination"]').after(columnsTrHtml);
}

function TestPlans_populateSetupParameterValueSelections(rows) {

	if (!isClosedLoop()) {
		return;
	}

	// Iterate over all table rows
	for (var i = 0; i < rows.all.length; i++) {
		// The row
		var theRow = rows.all[i];

		// If bastard continue to next row 
		var bastard = theRow.attr('bastard');
		if (bastard) {
			continue;
		}

		// Populate the setup parameter value selections
		var isCustomizedVirtualCombination = TestPlans_populateSetupParameterValueSelectionsForRow(theRow);

		// Handle it only if customized (since the default is disabled) - enable the checkboxes according to the default virtual combination id
		if (isCustomizedVirtualCombination) {
			TestPlans_enableSetupParameterCheckboxes(theRow, isCustomizedVirtualCombination);
		}
	}
}

function TestPlans_populateSetupParameterValueSelectionsForRow(scenarioRow) {
	// Map all setup parameter checkboxes by setup parameter value ID, and reset all selections
	var setupParamValueCheckboxes = new Object();
	var anySetupParamCheckboxes = new Object();
	scenarioRow.find('input[type="checkbox"]').each(function() {
		var checkbox = $(this);
		var setupParamId = checkbox.attr('setup-parameter-id');
		var setupParamValueId = checkbox.attr('setup-parameter-value-id');
		var isAny = !isStringEmpty(setupParamId);
		if (!isStringEmpty(setupParamValueId) || isAny) {
			// Clear selection
			checkbox.prop('checked', false);

			// Save mapping
			if (isAny) {
				anySetupParamCheckboxes[setupParamId] = checkbox;
			} else {
				setupParamValueCheckboxes[setupParamValueId] = checkbox;
			}
		}
	});

	// Extract the VC of the current row
	var selectedVirtualCombinationId = getValueFromElement(scenarioRow.find('#slctVirtualCombination'));
					
	// Extract the VC configuration
	var virtualCombinationName = globalVirtualCombinationsContainer.virtualCombinationIdToName[selectedVirtualCombinationId];
	var virtualCombinationAsJson = globalVirtualCombinationsContainer.virtualCombinations[virtualCombinationName];
	
	// Determine if customized
	var isCustomized = virtualCombinationAsJson.customized;
	
	// Extract the default virtual combination id
	var defaultVirtualCombinationId = scenarioRow.find('#slctVirtualCombination').attr('default-virtual-combination-id')

	// Extract the default VC configuration
	var defaultVirtualCombinationName = globalVirtualCombinationsContainer.virtualCombinationIdToName[defaultVirtualCombinationId];
	var defaultVirtualCombinationAsJson = globalVirtualCombinationsContainer.virtualCombinations[defaultVirtualCombinationName];

	// Update the defaults
	defaultVirtualCombinationAsJson.setupParameterValueIds.forEach(function (vcSetupParameterValueId) {
		setupParamValueCheckboxes[vcSetupParameterValueId].attr('default', true);
	});
	defaultVirtualCombinationAsJson.noCoverageSetupParameterIds.forEach(function (vcNoCoverageSetupParameterId) {
		anySetupParamCheckboxes[vcNoCoverageSetupParameterId].attr('default', true);
	});

	// Get the mask virtual combination
	var maskVirtualCombinationId = scenarioRow.attr('mask-virtual-combination-id');

	// Check all setup paramter values that part of the virtual combination
	virtualCombinationAsJson.setupParameterValueIds.forEach(function (vcSetupParameterValueId) {
		setupParamValueCheckboxes[vcSetupParameterValueId].prop('checked', 'true').attr('saved', 'true');
	});

	// Check the 'Any' values according to the virtual combination
	virtualCombinationAsJson.noCoverageSetupParameterIds.forEach(function (vcNoCoverageSetupParameterId) {
		anySetupParamCheckboxes[vcNoCoverageSetupParameterId].prop('checked', 'true').attr('saved', 'true');

		// Store the default value
		anySetupParamCheckboxes[vcNoCoverageSetupParameterId].attr(
				'default', 
				$.inArray(vcNoCoverageSetupParameterId, defaultVirtualCombinationAsJson.noCoverageSetupParameterIds) >= 0);
	});

	// Update colors
	for (setupParamValueId in setupParamValueCheckboxes) {
		TestPlans_renderCheckSetupParameterValueColor(setupParamValueCheckboxes[setupParamValueId]);
	}
	for (setupParamId in anySetupParamCheckboxes) {
		TestPlans_renderCheckAnySetupParameterColor(anySetupParamCheckboxes[setupParamId]);
	}

	return isCustomized;
}

function TestPlans_enableSetupParameterCheckboxes(theRow, isCustomized) {
	// If not customized
	if (!isCustomized) {
		// Disable all checkboxes
		theRow.find('input[type="checkbox"]').each(function() {
			if (!isStringEmpty($(this).attr('setup-parameter-value-id')) || !isStringEmpty($(this).attr('setup-parameter-id'))) {
				$(this).prop('disabled', 'true');
			}
		});

	} else {
		// Get the default virtual combination id
		var defaultVirtualCombinationId = theRow.find('#slctVirtualCombination').attr('default-virtual-combination-id');
		var defualtVirtualCombinationName = globalVirtualCombinationsContainer.virtualCombinationIdToName[defaultVirtualCombinationId];
		var virtualCombinationAsJson = globalVirtualCombinationsContainer.virtualCombinations[defualtVirtualCombinationName];
		
		// Enable the setup parameter value checkboxes that are part of the default virtual combination
		var defaultSetupParameterValueIds = virtualCombinationAsJson.setupParameterValueIds;
		defaultSetupParameterValueIds.forEach(function(defaultSetupParameterValueId) {
			theRow.find('input[id="chk' + defaultSetupParameterValueId + '"]').prop('disabled', false);
		});
		
		// Enable the setup parameter (any) checkboxes
		theRow.find('input[id^="chkAny"]').prop('disabled', false);
		
		// Disable the setup parameter (any) checkboxes that are part of the default virtual combination
		var defaultSetupParameterIds = virtualCombinationAsJson.noCoverageSetupParameterIds;
		defaultSetupParameterIds.forEach(function(defaultSetupParameterId) {
			theRow.find('input[id="chkAny' + defaultSetupParameterId + '"]').prop('disabled', true);
		});
	}
}

function TestPlans_populateLMSVersions(lmsVersionNamesArr) {
	$("#inputLMSVersions").autocomplete({
		select: function( event, ui ) {},
		source: lmsVersionNamesArr,
		minLength: 0
	}).on('focus', function () {
		$(this).autocomplete('search', '');
	});
}

function TestPlans_renderLMSTestsData(lmsTestsDataAsJson) {
	
	// Clear all tags from all tests
	$('#tblScenarios tbody tr').find('#tdTags').html('');
	$('#tblScenarios tbody tr').find('#tdTags').attr('data-filter-values', '');
	
	// Clear the test state from all tests
	$('#tblScenarios tbody tr').find('#tdTestState').attr('data-filter-values', 'Not ready to run;');
	$('#tblScenarios tbody tr').find('#tdTestState').html('Not ready to run');
	$('#tblScenarios tbody tr').find('#tdTestState').prop('not-ready-to-run', 'true');
	$('#tblScenarios tbody tr').find('#tdTestState').attr('class', 'inactive');
	$('#tblScenarios thead tr').find('#thTestState').attr('class', 'inactive');
	$('#tblScenarios thead tr').find('#thSetTestState').attr('class', 'inactive');
	
	// Sign all tests as not ready to run
	$('#tblScenarios tbody tr').find('#tdTestState').addClass('problematic-row');

	// Iterate over the lms tests
	lmsTestsDataAsJson.tests.forEach(function(testAsJson) {
		// Extract the test runner name
		var testRunnerKey = testAsJson.testRunnerKey;
		
		// Extract the ready to run
		var isTestReadyToRun = testAsJson.isTestReadyToRun;
		
		// Find the row by test runner key
		var testRow = $('#tblScenarios tbody tr td[id="tdtestRunnerKey"]').filter(function() {
		    return $(this).text() == testRunnerKey;
		}).closest('tr');

		if (undefined != testRow && testRow.length > 0) {
			// Populate the tags column
			testRow.find('#tdTags').attr('data-filter-values', arrToString(testAsJson.tags, ';', '') + ';');
			testRow.find('#tdTags').html(arrToString(testAsJson.tags, '<br>', ''));

			// Sign the test as ready to run
			if (isTestReadyToRun) {
				testRow.find('#tdTestState').prop('not-ready-to-run', false);
			}

			// Set test runner name
			if (testRow.find("#tdtestRunnerName").text().trim() != testAsJson.testRunnerName) {
				testRow.find("#tdtestRunnerName").text(testAsJson.testRunnerName);
			}
		}
	});
	
	// Show the test state column
	TestPlans_showTestStateColumn();
	
	// Iterate over the table rows to calculate the test state status
	TestPlans_populateTestsStateStatus();
	
	// Prepare the table for view
	prepareTableFiltersExt('tblScenarios', false);
}

function TestPlans_showTestStateColumn() {
	$('#tblScenarios thead tr').find('#thSetTestState').attr('class', '');
	$('#tblScenarios thead tr').find('#thTestState').attr('class', '');
	$('#tblScenarios tbody tr').find('#tdTestState').removeClass('inactive');	
}

function TestPlans_populateTestsStateStatus() {
	$('#tblScenarios tbody tr').each(function() {
		TestPlans_populateTestStateStatus($(this));
	});
}

function TestPlans_populateTestStateStatus(row) {
	var testStateCell = row.find('#tdTestState');
	
	// Clear the test state class
	testStateCell.removeClass('problematic-row');
	
	var testStateAsHtml 	= '';
	var testStateForFilter 	= '';
	var status 				= true;
	
	// Extract the properties
	if (!isStringEmpty(testStateCell.prop('not-ready-to-run'))) {
		testStateForFilter += 'Not ready to run;';
		testStateAsHtml += 'Not ready to run<br>';
		status = false;
	}
	if (!isStringEmpty(testStateCell.prop('not-in-ts'))) {
		testStateForFilter += 'Not in ts;';
		testStateAsHtml += 'Not in ts<br>';
		status = false;
	}
	
	// Cut the last char
	testStateAsHtml = cutLastChars(testStateAsHtml, '<br>');
	
	// Update the cell & filters & class
	if (!status) {
		testStateCell.addClass('problematic-row');
	} else {
		testStateForFilter 	= 'Ok;';
		testStateAsHtml 	= 'Ok';
	}
	testStateCell.html(testStateAsHtml);
	testStateCell.attr('data-filter-values', testStateForFilter)
}

function TestPlans_updateCustomizedVirtualCombinationWithId(scenarioRow, customizedVirtualCombinationId) {
	// Update the VC select with the duplicated id
	var slctVirtualCombination = scenarioRow.find('#slctVirtualCombination');
	var customizedOption = slctVirtualCombination.find('option[value=0]');
	customizedOption.attr('value', customizedVirtualCombinationId);
	customizedOption.attr('customized', true);
}

function TestPlans_getCheckedSetupParameterValueIds(scenarioVCId) {
	// Get the scenario row
	var scenarioRow = getScenarioTableRowByScenarioVirtualCombinationId(scenarioVCId);
	
	var setupParameterValueIds = getAttributeValuesFromCheckedCheckboxesInRow(scenarioRow, 'setup-parameter-value-id');

	return setupParameterValueIds;
}

function TestPlans_getCheckedSetupParameterIds(scenarioVCId) {
	// Get the scenario row
	var scenarioRow = getScenarioTableRowByScenarioVirtualCombinationId(scenarioVCId);
	
	var setupParameterIds = getAttributeValuesFromCheckedCheckboxesInRow(scenarioRow, 'setup-parameter-id');

	return setupParameterIds;
}

function TestPlans_showDialogOnRestoreTestPlanScenarios(selectedRows) {
	// Store the selected rows in the dialog data
	$('#restoreTPScenarioDialog').data('selectedRows', selectedRows);
	
	// Clean previous errors
	$('#restoreTPScenarioDialog').find('#lblRestoreTPScenarioError').html('');
	
	// Show the dialog
	$('#restoreTPScenarioDialog').dialog('open');
}

function TestPlans_showNotifyAboutBastardTestDialog(callingElement) {
	// Clear previous error message
	$('#notifyAboutBastardTest').find('#lblDeleteTPScenarioError').html('');
	
	// Store the calling element in the dialog
	$('#notifyAboutBastardTest').data('callingElement', callingElement);
	
	// Show the dialog
	$('#notifyAboutBastardTest').dialog('open');
}

function TestPlans_TriggerAdvanced() {
	var table = $("#tblScenarios");
	var isChecked = $('#chkShowAdvanced').prop("checked");
	table.find("[data-setup-parameter], [id='thRepeat']:eq(0)").each(function () {
		var id = $(this).attr('id');
		var idWithoutPrefix = id.substring(2);
		var selector = table.find("[id='th" + idWithoutPrefix + "'], [id='td" + idWithoutPrefix + "']");
		if (isChecked) {
			selector.removeClass("inactive");
		} else {
			selector.addClass("inactive");
		}
	});

	// Table width can expand/shrink
	TestPlans_UpdateContainerWidth();
}

function getScenarioTableRowByScenarioVirtualCombinationId(scenarioVirtualCombinationId) {
	return $('#tblScenarios tbody tr[data-scenario-virtual-combination-id=' + scenarioVirtualCombinationId + ']');
}

function TestPlans_updateNumOfIncludedScenarios() {

	// Update number of included scenarios
	var numOfIncludedScenarios = 0;
	$('#tblScenarios > tbody > tr:visible').each(function() {
		// Get the included check box
		var includeCheckbox = $(this).find('#chkIncludeInExecution');

		// Get the value and increase the number of included scenarios
		var included = getValueFromElement(includeCheckbox);
		if (included) {
			numOfIncludedScenarios++;
		}
	});

	// Set the value
	$('#lblNumberOfIncludedTestPlanScenarios').html(numOfIncludedScenarios);
}

/** javascripts/testplans/TestPlansRequestDispatcherHelper.js **/
var globalTestVersionId = 0;
var globalSetupParametersContainer = {};
var globalVirtualCombinationsContainer = {};
var globalScenariosData = {};
var globalTestPlanData = {};
var globalProjectData = {};
var globalTestSuitesMetaData = {};

function sendAddTestPlanRequest(testPlanNameToAdd , testSuiteIdToAdd) {
	var link = '/tasks/AddTestPlan';
	var async = true;
	var request = {};
	request.testPlanNameToAdd = testPlanNameToAdd;
	request.testSuiteIdToAdd = testSuiteIdToAdd;
	PostJsonWithJsonFeedbackFuncs(link, async, request,
		function(jsonResponse) {
			// Test plan id to load
			var testPlanIdToLoad = jsonResponse.newTestPlanId;
			
			// Load the test plan names - this will also load the test plan content
			TestPlans_loadTestPlanNames(testPlanIdToLoad, renderTestPlanNames);
		},
		function(textResponse) {
			UIUtility_showAlert('Failed to add test plan: [' + textResponse + ']', 'Load');
		}
	);
}

function TestPlans_sendLoadTestPlanRequest(testPlanId, testSuiteId, optCont) {
	PostJsonWithJsonFeedbackFuncs(
		'/tasks/LoadTestPlan',
		true,
		{ testPlanId: testPlanId, testSuiteId: testSuiteId },
		function(jsonResponse) {
			globalTestVersionId = jsonResponse.testVersionId;
			globalSetupParametersContainer = jsonResponse.setupParametersContainer;
			globalVirtualCombinationsContainer = jsonResponse.virtualCombinationsContainer;
			globalScenariosData = jsonResponse.scenariosData.scenariosData;
			globalTestPlanData = jsonResponse.testPlan;
			globalProjectData = jsonResponse.projectData.projectData;
		
			// Render the test plan data
			renderTestPlan();

			relayoutStretchContainers();

			// Initialize the test plan changes
			$('#hdnTestPlanChanges').data('testPlanChanges', new TestPlanChangesClass());
	
			if (optCont != undefined) {
				optCont();
			}

			pageFinishedLoading();
		},
		function(textResponse) {
			UIUtility_showAlert('Failed to load test plan: [' + textResponse + ']', 'Load');

			pageFinishedLoading();
		},
		true);
}

function sendRequestToDeleteTestPlan(testPlanIdToDelete) {
	var link = '/tasks/DeleteTestPlan';
	var async = true;
	var request = {};
	request.testPlanId = testPlanIdToDelete;
	PostJsonWithJsonFeedbackFuncs(link, async, request,
		function(jsonResponse) {
			TestPlans_loadTestPlanNames(undefined, renderTestPlanNames);
		},
		function(textResponse) {
			UIUtility_showAlert('Failed to delete test plan: [' + textResponse + ']', 'Load');
		}
	);
}

function sendRequestToUpdateTestPlanName(testPlanId, newTestPlanName) {
	var link = '/tasks/UpdateTestPlanName';
	var async = true;
	var request = {};
	request.testPlanId = testPlanId;
	request.newTestPlanName = newTestPlanName;
	PostJsonWithJsonFeedbackFuncs(link, async, request,
		function(jsonResponse) {
			// Disable the text box
			$('#divTestPlanBasicData').find('#txtTestPlanName').prop('disabled', 'true');
			
			// Change the label of the edit/save button to 'Edit'
			$('#btnEditSaveTestPlanName').val('Edit');
		},
		function(textResponse) {
			UIUtility_showAlert('Failed to update test plan name: [' + textResponse + ']', 'Update');
		}
	);
}

function TestPlans_sendRequestToRestoreTestPlanScenarios(restoreRequestAsJson, testPlanId, selectedRows) {
	var link = '/tasks/RestoreTestPlanScenarios';
	var async = true;
	var request = restoreRequestAsJson;
	request.testPlanId = testPlanId;
	PostJsonWithJsonFeedbackFuncs(link, async, request,
		function(jsonResponse) {
			// Clean the scenario changes
			 TestPlans_restoreTestPlanScenarios(selectedRows);
			
			// Render the selected rows with the default
			TestPlans_renderTestPlanScenariosWithDefaults(selectedRows);
		},
		function(textResponse) {
			UIUtility_showAlert('Failed to restore to default: [' + textResponse + ']', 'Restore');
		}
	);
	// Close the dialog
	$('#restoreTPScenarioDialog').dialog('close');
}

function sendRequestToDuplicateTestPlan(testPlanIdToDuplicate, newTestPlanName, testSuiteIdToDuplicateTo) {
	var link = '/tasks/DuplicateTestPlan';
	var async = true;
	var request = {};
	request.testPlanIdToDuplicate = testPlanIdToDuplicate;
	request.newTestPlanName = newTestPlanName;
	request.testSuiteIdToDuplicateTo = testSuiteIdToDuplicateTo;
	PostJsonWithJsonFeedbackFuncs(link, async, request,
		function(jsonResponse) {
			var newTestPlanId = jsonResponse.newTestPlanId;
			TestPlans_loadTestPlanNames(newTestPlanId, renderTestPlanNames);
		},
		function(textResponse) {
			UIUtility_showAlert('Failed to duplicate test plan: [' + textResponse + ']', 'Duplicate');
		}
	);
}

function TestPlans_sendRequestToSendTestPlan(sendTPRequestAsJson, sessionUUID) {

	// Disable sending until we're done
	$('#btnSendTestPlan').button("disable");

	// Close the send dialog
	$("#sendTestPlanDialog").dialog("close");

	// Post
	var link = '/tasks/SendTestPlan';
	if (sessionUUID != undefined) {
		link += "?sessionUUID=" + sessionUUID;
	}
	var async = true;
	var request = sendTPRequestAsJson;
	PostJsonWithJsonFeedbackFuncs(link, async, request,
		function(jsonResponse) {
			// No action
		},
		function(textResponse) {
			UIUtility_showAlert('Failed to send test plan: [' + textResponse + ']', 'Send');

			// Enable sending again
			$('#btnSendTestPlan').button("enable");
		}
	);
}

function sendRequestToDisplayTestPlanValidationPage(
		testPlanId, 
		testPlanName, 
		testSuiteId,
		enableSendTestPlan,
		agentIds,
		autoDeployment,
		mergeTPExecutionId,
		customExecName)
{
	var contextAsJson = {};
	var contextElem = $("#hdnContext");
	var sessionUUID = undefined;
	var linkUrl = "/tasks/DisplayTestPlanValidationManagement"; 
	if (contextElem != undefined && contextElem.length > 0) {
		contextAsJson = contextElem.data('context');

		// Try taking session UUID
		if (contextAsJson['sessionUUID'] != undefined) {
			sessionUUID = contextAsJson['sessionUUID'];
			linkUrl += "?sessionUUID=" + sessionUUID;
		}
	}

	// Insert into context
	contextAsJson["testPlanId"] = testPlanId;
	contextAsJson["testPlanName"] = testPlanName;
	contextAsJson["testSuiteId"] = testSuiteId;
	contextAsJson["enableSendTestPlan"] = enableSendTestPlan;
	contextAsJson["autoDeployment"] = autoDeployment;
	contextAsJson["agentIds"] = agentIds;
	contextAsJson["mergeTPExecutionId"] = parseReplacers(mergeTPExecutionId);
	if (customExecName != undefined) {
		contextAsJson["customExecutionName"] = customExecName;
	}

	// Post to new window
	PostJsonToNewWindow(linkUrl, { contextAsJson: JSON.stringify(contextAsJson) }, "TestPlanValidation_" + sessionUUID);
}

function TestPlans_sendRequestToGetLMSTestsData(lmsVersion, callback) {
	
	// Extract the project name
	var projectName = $('#projectName').text();

	// Extract the project id
	var projectId = $('#projectName').data('projectId');

	// Populate the url
	var linkUrl = "/tasks/GetLMSTestsData?lmsVersion=" + lmsVersion + "&projectName=" + projectName + "&projectId=" + projectId;

	// Send the request
	pageLoading();
	var xmlhttp = Get(linkUrl);
	xmlhttp.onreadystatechange=function() {
		if (xmlhttp.readyState == 4) {
			pageFinishedLoading();
			if (xmlhttp.status == 200) {
				// Parse the LMS tests data
				var lmsTestsDataAsJson = JSON.parse(xmlhttp.responseText);
				
				// Invoke the callback
				invokeFunction(callback, lmsTestsDataAsJson);
				
				// Update the last synced LMS version
				$('#divTestPlanBasicData').find('#tdLastSyncedLMSVersion').html(lmsVersion);
				$('#divTestPlanBasicData').find('#trLastSyncedLMSVersion').addClass('highlighted').each(function (i) {
			        setTimeout(function (tr) {
			            tr.removeClass('highlighted');
			        }, 3000, $(this));
			    });

				// Close the dialog
				$('#syncLMSDialog').dialog('close');
			} else {
				console.log(xmlhttp.responseText);
				$('#lblSyncLMSError').html('Failed to load the LMS tests data');
			}
		}
	};
}

function TestPlans_sendRequestToSaveTP(functionToInvokeOnSuccess, functionToInvokeOnFailure) {

	// Extract the tp changes as json
	var tpChangesAsJson = TestPlans_getTestPlanChangesClass().getChangesAsJson();
	
	// Make sure to have the included value of all the tests
	// Also collect the customized flag and the priority and repeat values
	var changesKeys = Object.keys(tpChangesAsJson.changes);
	for (var changeIndex = 0; changeIndex < changesKeys.length; changeIndex++) {
		// Get the scenario virtual combination ID
		var svcId = changesKeys[changeIndex];
		// Get the scenario virtual combination row
		var svcRow = $('#tblScenarios tbody tr[data-scenario-virtual-combination-id="' + svcId + '"]');
		// Get the included value
		var includedAsString = getValueFromElement($(svcRow).find('#chkIncludeInExecution'));
		var included = BooleanUtilityFunctions_StringToBoolean(includedAsString);
		// Get the customized flag, and the priority and repeat values
		var customizedAsString = $(svcRow).attr('data-customized');
		var customized = BooleanUtilityFunctions_StringToBoolean(customizedAsString);
		customized = customized || (tpChangesAsJson.changes[svcId].hasOwnProperty('customized') && tpChangesAsJson.changes[svcId].customized == true)
		var priority = getValueFromElement($(svcRow).find('#slctPriority'));
		var repeat = getValueFromElement($(svcRow).find('#slctRepeat'));
		// LRU
		var lruDisabledAsString = getValueFromElement($(svcRow).find('#chkLruDisabled'));
		var lruDisabled = BooleanUtilityFunctions_StringToBoolean(lruDisabledAsString);
		var comment = getValueFromElement($(svcRow).find('#txtTestComment'));

		// Update the changes
		tpChangesAsJson.changes[svcId].included = included;
		tpChangesAsJson.changes[svcId].customized = customized;
		tpChangesAsJson.changes[svcId].priority = priority;
		tpChangesAsJson.changes[svcId].repeat = repeat;
		tpChangesAsJson.changes[svcId].lruDisabled = lruDisabled;
		tpChangesAsJson.changes[svcId].comment = comment;
	}

	// Test order
	var testOrderIsImportant = BooleanUtilityFunctions_StringToBoolean(getValueFromElement($('#chkOrderIsImportant')));
	tpChangesAsJson.testOrderIsImportant = testOrderIsImportant;
	var testOrder = [];
	if (testOrderIsImportant) {
		$('#tblScenarios tbody tr').each(function() {
			var currentSvcId = $(this).attr('data-scenario-virtual-combination-id');
			testOrder.push(currentSvcId);
		});
	}
	tpChangesAsJson.testOrder = testOrder;

	// Limit to usernames
	tpChangesAsJson.limitedToUsernames = $("#slctLimitToUsernames").val();

	// Extract the test plan id
	var testPlanId = $('#hdnTestPlanId').val();
	
	// Extract the test version id
	var testVersionId = TestPlans_getTestVersionId();

	// The url to send the delete request
	var linkUrl = '/tasks/SaveTestPlan?testPlanId=' + testPlanId + '&testVersionId=' + testVersionId;
	var isAsync = true;
	var localFunctionToInvokeOnSuccess = undefined == functionToInvokeOnSuccess ? TestPlans_onSaveTPSuccess : functionToInvokeOnSuccess;
	var localFunctionToInvokeOnFailure = undefined == functionToInvokeOnSuccess ? TestPlans_onSaveTPFailure : functionToInvokeOnFailure;

	PostJsonWithJsonFeedbackFuncs(linkUrl, isAsync, tpChangesAsJson, localFunctionToInvokeOnSuccess, localFunctionToInvokeOnFailure);
}

function TestPlans_sendRequestToApplyTS(testPlanId, testSuiteId) {

	var link = '/tasks/LoadTestPlanWithAppliedTestSuite';
	var async = true;
	var request = {};
	request.testPlanId = testPlanId;
	request.testSuiteId = testSuiteId;
	PostJsonWithJsonFeedbackFuncs(link, async, request, 
		function(jsonResponse) {
			globalTestVersionId = jsonResponse.testPlan.testVersionId;
			globalSetupParametersContainer = jsonResponse.setupParametersContainer;
			globalVirtualCombinationsContainer = jsonResponse.virtualCombinationsContainer;
			globalScenariosData = jsonResponse.scenariosData.scenariosData;
			globalTestPlanData = jsonResponse.testPlan;
			globalProjectData = jsonResponse.projectData.projectData;
			renderTestPlan();
		}, function(textResponse) {
			UIUtility_showAlert('Failed to load test plan with applied test suite: [' + textResponse + ']', 'Load');
		}
	);
	$('#applyTSDialog').dialog('close');
}

function TestPlans_sendRequestToDeleteTestPlanScenario(testPlanId, scenarioVirtualCombinationId) {
	var link = '/tasks/DeleteTestPlanScenario';
	var async = true;
	var request = {};
	request.testPlanId = testPlanId;
	request.scenarioVirtualCombinationId = scenarioVirtualCombinationId;
	PostJsonWithJsonFeedbackFuncs(link, async, request, 
		function(jsonResponse) {
			// Delete the the relevant row from the table
			testPlans_removeTestFromTableByScenarioVirtualCombinationId(scenarioVirtualCombinationId);
			// Decrease the number of included test plan scenarios
			TestPlans_modifyNumberOfIncludedTestPlanScenarios(-1);
		}, function(textResponse) {
			UIUtility_showAlert('Failed to delete test plan: [' + textResponse + ']', 'Delete');
		}
	);
	// Close the dialog 
	$('#notifyAboutBastardTest').dialog('close');
}

function testPlans_removeTestFromTableByScenarioVirtualCombinationId(scenarioVirtualCombinationId) {
	var foundRow = getScenarioTableRowByScenarioVirtualCombinationId(scenarioVirtualCombinationId);
	
	if (undefined != foundRow) {
		foundRow.remove();
	}
}
/** javascripts/testplans/validate/TestPlanValidationManagement.js **/
function TestPlansValidation_performTestPlanValidation()
{
	// Extract the test plan id
	var testPlanId = parseInt(getValueFromElement($('#hdnTestPlanId')));

	// Extract the test suite id
	var testSuiteId = parseInt(getValueFromElement($('#hdnTestSuiteId')));
	
	// Extract the agent names and convert to array
	var agentNamesStr = getValueFromElement($('#hdnHostIps'));
	var agentNames = (isStringEmpty(agentNamesStr) ? [] : JSON.parse(agentNamesStr));

	// Extract merge TP execution ID
	var mergeTPExecutionId = getValueFromElement($('#hdnMergeTPExecutionId'));
	if (isStringEmpty(mergeTPExecutionId)) {
		mergeTPExecutionId = undefined;
	}

	// Send a request to validate the test plan
	TestPlansValidation_sendRequestToValidateTestPlan(testPlanId, testSuiteId, agentNames, mergeTPExecutionId);
}

/** javascripts/testplans/validate/TestPlanValidationRequestDispatcherHelper.js **/
function TestPlansValidation_sendRequestToValidateTestPlan(testPlanId, testSuiteId, agentNames, mergeTPExecutionId) {
	var request = {
			testPlanId: testPlanId,
			testSuiteId: testSuiteId,
			agentNames: agentNames
	};

	var context = $("#hdnContext").data('context');
	if (context != undefined) {
		request.lmsVersion = context.LMSVersion;
		request.allowedPermutationsGroupId = context.allowedPermutationsGroupId;
	}

	if (mergeTPExecutionId != undefined) {
		request.mergeTPExecutionId = insertReplacers(mergeTPExecutionId);
	}

	// Get the request parameters
	var requestParameters = getRequestParameters();
	var sessionUUID = requestParameters['sessionUUID'];

	PostJsonWithJsonFeedbackFuncs(
			'/tasks/ValidateTestPlan' + (isStringEmpty(sessionUUID) ? "" : "?sessionUUID=" + sessionUUID),
			true,
			request,
			function (response) {
				// Success - render the entire validation screen
				TestPlansValidation_renderTestPlanValidationResults(response);

				// Show the content
				$('#divMatchingAgentsPerPermutation').attr('class', '');
				$('#divSections').accordion("option", "active", 1);

				// Make the table "zebra"
				ZebraTable('tblMatchingAgentsPerPermutation', 'VirtualCombinationName');

				// Close the dialog
				$("#sendTestPlanDialog").dialog("close");
			},
			function (response) {
				// Close the dialog
				$("#sendTestPlanDialog").dialog("close");

				UIUtility_showAlert(response, "Error");
			});
}

function TestPlansValidation_sendRequestToRunTPSimulation(testPlanId, testSuiteId, agentNames, validationSnapshotId, isBroadcast,
		targetCoverage, targetTime, targetTestsCount, labArrangement, target) {

	var data = {
			agentNames: agentNames,
			testPlanId: testPlanId,
			validationSnapshotId: validationSnapshotId,
			isBroadcast: isBroadcast,
			targetCoverage: targetCoverage,
		};

	if (testSuiteId != undefined) {
		data.testSuiteId = testSuiteId;
	}

	var context = $("#hdnContext").data('context');
	if (context != undefined) {
		data.lmsVersion = context.LMSVersion;
	}

	if (labArrangement != undefined) {
		data.labArrangement = labArrangement;
	}

	if (!isStringEmpty(targetTime)) {
		data.targetTime = targetTime;
	}

	if (!isStringEmpty(targetTestsCount)) {
		data.targetTestsCount = targetTestsCount;
	}

	if (isStringEmpty(target)) {
		target = "_blank";
	}

	PostJsonToNewWindow("/tasks/RunTPSimulation", data, target);
}

/** javascripts/testplans/validate/TestPlanValidationRenderHelper.js **/
function TestPlansValidation_showHideDataBasedOnPageData() {
	$('#btnSendTestPlan').css("width", "110px");

	if (!isStringEmpty($("#hdnMergeTPExecutionId").val())) {
		// Merge, hide broadcast and endless checkboxes
		$('#trChkBroadcast').addClass('inactive');
		$('#trChkEndless').addClass('inactive');
	}
}

function TestPlansValidation_initializeSendTestPlanAfterValidationAsDialog() {
	if (!isStringEmpty($("#hdnMergeTPExecutionId").val())) {
		$("#trEndless").addClass("inactive");
		$("#trChkBroadcast").addClass("inactive");
	}

	var sendTPButtons =
		[{
			id: "btnSendMatchedOnly",
			text: "Send Matched Only",
			click: function() {
				TestPlansValidation_onSendTestPlanAfterValidationSendMatchedConfirm();
			}
		 },
		 {
			 id: "btnCancel",
			 text: "Cancel",
			 click: function() {
				 $(this).dialog("close");
			 }
		 }];

	$("#sendTestPlanDialog").dialog({
		autoOpen: false,
		height: 400 + $("#tpExecParameters tr").length * 27,
		width: 550,
		modal: true,
		buttons: sendTPButtons
	});
}

function TestPlansValidation_renderSummaryParameters(context) {
	var fieldsToDisplay = context.fieldsToDisplay;
	var rowsAsHtml = "";
	for (var id in fieldsToDisplay) {
		var name = fieldsToDisplay[id];

		// Add column
		if (context[id] != undefined) {
			rowsAsHtml += '<tr><th style="text-align:left">' + name + ':</th>' + 
						 '<td id="td' + id + '">' + context[id] + '</td></tr>';
		}
	}

	// Append the row to the html
	$('#tbodyTPValidationParameters').append(rowsAsHtml);
}

function TestPlansValidation_renderTestPlanValidationResults(testValidationResponseAsJson) {
	
	// Save the response
	globalVirtualCombinationsMatchingData = testValidationResponseAsJson;
	
	// Get the summary
	var summaryAsJson = testValidationResponseAsJson.testPlanValidationSummary;
	
	// Render the summary
	renderTestPlanValidationSummary(summaryAsJson);
	
	// Get the sorted setup parameter names
	var sortedSetupParameterNames = testValidationResponseAsJson.sortedSetupParameterNames;
	
	// Get the virtual combinations
	var virtualCombinationsAsJson = testValidationResponseAsJson.virtualCombinations;
	
	// Get the virtual combination ID's without allowed permutations
	var virtualCombinationIdsWithoutAllowedPermutations = testValidationResponseAsJson.virtualCombinationIdsWithoutAllowedPermutations; 
	
	// Get the virtual combination ID to setup parameter values map
	var virtualCombinationIdToSetupParameterValues = testValidationResponseAsJson.virtualCombinationIdToSetupParameterValues;
	
	// Render the matching agents per test
	TestPlanValidation_renderTestPlanValidationTests(
			sortedSetupParameterNames, virtualCombinationIdToSetupParameterValues, virtualCombinationsAsJson, virtualCombinationIdsWithoutAllowedPermutations);
	
	// Render the matching agents per permutation
	TestPlansValidation_renderTestPlanValidationMatchingAgentsPerPermutation(
			sortedSetupParameterNames, virtualCombinationsAsJson, virtualCombinationIdsWithoutAllowedPermutations);
	
	// Render the matching tests per agent
	TestPlansValidation_renderTestPlanValidationMatchingTestsPerAgent(testValidationResponseAsJson.agentsTests);
}

function renderTestPlanValidationSummary(summaryAsJson) {
	
	// Store the test plan validation snapshot id
	$('#hdnTestPlanValidationSnapshotId').val(summaryAsJson.testPlanValidationSnapshotId);

	var numOfPermutationsHtml = "<span title='The number of scenario permutations in the test plan'>#Permutations:</span>";
	var numOfUnmatchedPermutationsHtml = "<span title='The number of scenario permutations in the test plan which are not matched with any agent. In case of merging, this will not contain previously matched permutations'>#Unmatched Permutations:</span>";

	// Add the filtered agents to the summary
	TestPlanValidation_addFilteredAgentsToTestPlanValidationSummary(summaryAsJson);

	// Add the number of tests & permutations to the summary
	TestPlansValidation_appendInfoToTestPlanValidationSummary('MatchedTests', '#Tests:', summaryAsJson.numberOfTests);
	TestPlansValidation_appendInfoToTestPlanValidationSummary('MatchedPerms', numOfPermutationsHtml, summaryAsJson.numberOfPermutations);

	// Add the number of unmatched tests & unmatched permutations to the summary + update the confirm dialog
	TestPlansValidation_appendInfoToTestPlanValidationSummary('UnmatchedTests', '#Unmatched Tests:', summaryAsJson.numberOfUnmatchedTests);
	TestPlansValidation_appendInfoToTestPlanValidationSummary('UnmatchedPerms', numOfUnmatchedPermutationsHtml, summaryAsJson.numberOfUnmatchedPermutations);
	if (summaryAsJson.numberOfUnmatchedPermutations > 0) {
		$('#divNumberOfUnmatchedPermutations').attr('class', '');
		$('#sendTestPlanDialog').find('#lblNumberOfUnmatchedPermutations').html(summaryAsJson.numberOfUnmatchedPermutations);
	} else {
		$('#divNumberOfUnmatchedPermutations').attr('class', 'inactive');
	}

	var coverageHtml = "%Coverage:";

	// If merge, add number of new tests and leave room for new permutations count which will later be updated
	if (summaryAsJson.numberOfNewTests != undefined) {
		var newTestsHtml = "<span title='Number of tests which did not run on the original TP execution, but will run due to this merge'>#New Tests:</span>";
		var newPermutationsHtml = "<span title='Number of permutations which did not run on the original TP execution, but will run due to this merge'>#New Permutations:</span>";
		TestPlansValidation_appendInfoToTestPlanValidationSummary('NewTests', newTestsHtml, summaryAsJson.numberOfNewTests);
		TestPlansValidation_appendInfoToTestPlanValidationSummary('NewPerms', newPermutationsHtml, '<label id="newPermutations"></label>');
		coverageHtml = '%Coverage After Merge:';
	}

	// Add the coverage + update the confirm dialog
	var numberOfMatchedCombinations = summaryAsJson.numberOfPermutations - summaryAsJson.numberOfUnmatchedPermutations;
	var coverageForView = summaryAsJson.coverage + '% (' + numberOfMatchedCombinations + '/' + summaryAsJson.numberOfPermutations + ')';
	TestPlansValidation_appendInfoToTestPlanValidationSummary('Coverage', coverageHtml, coverageForView);
	$('#sendTestPlanDialog').find('#lblCoverage').html(coverageForView);

	// Enable / disable the send TP button according to the number of matched combination
	if (numberOfMatchedCombinations > 0) {
		$("#btnSendMatchedOnly").button("enable");
		$('#sendTestPlanDialog').find('#lblSendTPConfirmation').html('Do you want to send the test plan ?');
	} else {
		$("#btnSendMatchedOnly").button("disable");
		$('#sendTestPlanDialog').find('#lblSendTPConfirmation').html('You cannot send the Test Plan since there are no matched permutations');
	}
}

function TestPlanValidation_addFilteredAgentsToTestPlanValidationSummary(validationSummary) {
	
	// Get the agents without matching keys
	var agentsWithoutMatchingKeys = validationSummary.agentsWithoutMatchingKeys;
	
	// Get the filtered out agents due to unmatched customized agent attributes
	var filteredOutByAttributesAgentNames = validationSummary.filteredOutByAttributesAgentNames;
	
	// Prepare the filtered agents HTML
	if (agentsWithoutMatchingKeys.length > 0 || filteredOutByAttributesAgentNames.length > 0) {
		var html = "<table><tbody>";

		if (agentsWithoutMatchingKeys.length > 0) {
			html += '<tr><th id="thFilteredAgents" style="text-align: left; color: red;">No Matching Permutations:&nbsp;</th><td>';
			for (var agentIndex = 0; agentIndex < agentsWithoutMatchingKeys.length; agentIndex++) {
				if (agentIndex > 0) {
					html += ", ";
				}
				html += agentsWithoutMatchingKeys[agentIndex];
			}
			html += '</td></tr>'; 
		}

		if (filteredOutByAttributesAgentNames.length > 0) {
			html += '<tr><th id="thFilteredAgents" style="text-align: left; color: red;">Unmatched Attributes:&nbsp;</th><td>';
			for (var agentIndex = 0; agentIndex < filteredOutByAttributesAgentNames.length; agentIndex++) {
				if (agentIndex > 0) {
					html += ", ";
				}
				html += filteredOutByAttributesAgentNames[agentIndex];
			}
			html += '</td></tr>'; 
		}

		html += "</tbody></table>";

		// Set the HTML
		$('#tpValidationFilterSummary').prepend(html);
	}
}

function TestPlansValidation_appendInfoToTestPlanValidationSummary(id, paramName, paramValue) {
	// Populate the row as html 
	var rowAsHtml = 
			'<tr>' +
				'<th style="text-align:left">' + paramName + '</th>' + 
				'<td id="td' + id + '">' + paramValue + '</td>' +
			'</tr>';
	
	// Append the row to the html
	$('#tbodyTestPlanValidationSummary').append(rowAsHtml);
}

function TestPlanValidation_renderTestPlanValidationTests(
		sortedSetupParameterNames, virtualCombinationIdToSetupParameterValues, virtualCombinationsAsJson, virtualCombinationIdsWithoutAllowedPermutations) {

	// Add the sorted setup parameter names to the header rows
	var columnNamesRow = $('#tblMatchingAgentsPerTests').find('#trColumnNames');
	for (var parameterIndex = 0; parameterIndex < sortedSetupParameterNames.length; parameterIndex++) {
		var currentParameterName = sortedSetupParameterNames[parameterIndex];
		$(columnNamesRow).append('<th id="thSetupParameter' + currentParameterName + '" data-filter-enabled>' + currentParameterName + '</th>');
	}

	// Iterate over the virtual combination ID's
	var virtualCombinationIds = virtualCombinationsAsJson.virtualCombinationIds;
	for (var virtualCombinationIndex = 0; virtualCombinationIndex < virtualCombinationIds.length; virtualCombinationIndex++) {
	
		// The current virtual combination ID
		var virtualCombinationId = virtualCombinationIds[virtualCombinationIndex];
		var virtualCombinationIdAsString = virtualCombinationId + '';
		
		// Extract the virtual combination as JSON
		var virtualCombinationAsJson = virtualCombinationsAsJson[virtualCombinationId];
		
		// Get the virtual combination name
		var virtualCombinationName = virtualCombinationAsJson.virtualCombinationName;
		
		// Is permutations virtual combination
		var isPermutations = virtualCombinationAsJson.isPermutations;
		
		// Check whether the virtual combination does not have any allowed permutations
		var hasAllowedPermutations = !virtualCombinationIdsWithoutAllowedPermutations.hasOwnProperty(virtualCombinationIdAsString);
		
		// Get the test names
		var virtualCombinationTestNames = virtualCombinationAsJson.scenarioNames;
		var virtualCombinationTestNamesToFilter = arrToString(virtualCombinationTestNames, ';', '') + ';';
		
		// Get the number of matched permutations and number of unmatched permutations
		var numOfMatchedPermutations = virtualCombinationAsJson.numOfMatchedPermutations;
		var numOfUnmatchedPermutations = virtualCombinationAsJson.numOfUnmatchedPermutations;
		
		// Create the row for the virtual combination
		var rowHtml = '<tr>';
		
		// Test status
		if (numOfUnmatchedPermutations == 0) {
			rowHtml += '<td id="tdTestStatus" data-filter-value="Fully Matched">';	
			rowHtml += '<input type="textbox" class="TestStatusPassed" readonly="readonly" style="border:3px white solid;padding:3px;" value="Fully Matched">';	
		} else if (numOfMatchedPermutations == 0) {
			rowHtml += '<td id="tdTestStatus" data-filter-value="Unmatched">';
			rowHtml += '<input type="textbox" class="TestStatusFailed" readonly="readonly" style="border:3px white solid;padding:3px;" value="Unmatched">';	
		} else {
			rowHtml += '<td id="tdTestStatus" data-filter-value="Partly Matched">';
			rowHtml += '<input type="textbox" class="TestStatusWarning" readonly="readonly" style="border:3px white solid;padding:3px;" value="Partly Matched">';	
		}
		rowHtml += '</td>';
		
		// Test names
		rowHtml += '<td id="tdTestNames" data-filter-values="' + virtualCombinationTestNamesToFilter + '">';
		for (var testIndex = 0; testIndex < virtualCombinationTestNames.length; testIndex++) {
			var currentTestName = virtualCombinationTestNames[testIndex];
			rowHtml += currentTestName + '<br/>';
		}
		rowHtml += '</td>';
		
		// Number of tests
		rowHtml += '<td id="tdNumOfTests">';
		rowHtml += virtualCombinationTestNames.length;
		rowHtml += '</td>';
		
		// Number of matched permutations
		rowHtml += '<td id="tdNumOfMatchedPermutations" align="center">';
		if (hasAllowedPermutations) {
			rowHtml += numOfMatchedPermutations;
		} else {
			rowHtml += 'N/A';
		}
		rowHtml += '</td>';
		
		// Number of unmatched permutations
		rowHtml += '<td id="tdNumOfUnmatchedPermutations" align="center">';
		if (hasAllowedPermutations) {
			rowHtml += numOfUnmatchedPermutations;
		} else {
			rowHtml += 'N/A';
		}	
		rowHtml += '</td>';
		
		// Virtual combination name
		rowHtml += '<td id="tdVirtualCombinationName" ';
		if (!hasAllowedPermutations) {
			rowHtml += 'style="text-decoration:line-through;" title="No allowed permutations" ';
		}
		rowHtml += '>';
		rowHtml += virtualCombinationName;
		rowHtml += '</td>';
		
		// Setup parameter values
		var virtualCombinationParameterValues = virtualCombinationIdToSetupParameterValues[virtualCombinationIdAsString];
		for (var parameterIndex = 0; parameterIndex < sortedSetupParameterNames.length; parameterIndex++) {
			var currentParameterName = sortedSetupParameterNames[parameterIndex];
			var currentParameterValues = isPermutations ? '' : virtualCombinationParameterValues[currentParameterName];
			rowHtml += '<td id="tdSetupParameter' + currentParameterName + '">';
			rowHtml += currentParameterValues;
			rowHtml += '</td>';
		}
		
		// End the row and append it
		rowHtml += '</tr>';
		$('#divMatchingAgentsPerTest tbody').append(rowHtml);
	}
	
	// Prepare the table for view
	prepareTableFiltersExt('tblMatchingAgentsPerTests', false);
}

function TestPlansValidation_renderTestPlanValidationMatchingAgentsPerPermutation(
		sortedSetupParameterNames, virtualCombinationsAsJson, virtualCombinationIdsWithoutAllowedPermutations) {

	// Add the sorted setup parameter names to the header rows
	var columnNamesRow = $('#tblMatchingAgentsPerPermutation').find('#trColumnNames');
	for (var parameterIndex = 0; parameterIndex < sortedSetupParameterNames.length; parameterIndex++) {
		var currentParameterName = sortedSetupParameterNames[parameterIndex];
		$(columnNamesRow).append('<th id="thSetupParameter' + currentParameterName + '" data-filter-enabled>' + currentParameterName + '</th>');
	}

	// Get the template rows
	var rowTemplateMatchingAgentsPerTest = $('#templateMatchingAgentsPerTestsRow tbody tr').last().html();
	
	// Iterate over the virtual combination ID's
	var newPermutations = 0;
	var virtualCombinationIds = virtualCombinationsAsJson.virtualCombinationIds;
	for (var virtualCombinationIndex = 0; virtualCombinationIndex < virtualCombinationIds.length; virtualCombinationIndex++) {
		
		// The current virtual combination id
		var virtualCombinationId = virtualCombinationIds[virtualCombinationIndex];
		var virtualCombinationIdAsString = virtualCombinationId + '';
		
		// Extract the virtual combination as json
		var virtualCombinationAsJson = virtualCombinationsAsJson[virtualCombinationId];
		
		// Whether the virtual combinations has allowed permutations
		var hasAllowedPermutations = !virtualCombinationIdsWithoutAllowedPermutations.hasOwnProperty(virtualCombinationIdAsString);

		// Render the row
		newPermutations += TestPlansValidation_renderTestPlanValidationMatchingAgentsPerPermutationOfVirtualCombination(
				sortedSetupParameterNames, virtualCombinationAsJson, rowTemplateMatchingAgentsPerTest, hasAllowedPermutations);
	}

	$("#newPermutations").text(newPermutations);

	// Prepare the table for view
	prepareTableFiltersExt('tblMatchingAgentsPerPermutation', true);
}

function TestPlansValidation_renderTestPlanValidationMatchingAgentsPerPermutationOfVirtualCombination(
		sortedSetupParameterNames, virtualCombinationAsJson, rowTemplateMatchingAgentsPerTest, hasAllowedPermutations) {
	
	// Row to add as html
	var rowToAddAsHtml = '<tr>' + rowTemplateMatchingAgentsPerTest + '</tr>';

	var newPermutations = 0;

	// Get the number of permutations
	var numberOfPermutations = virtualCombinationAsJson.permutationIds.length;
	
	// Get the test names
	var virtualCombinationTestNames = virtualCombinationAsJson.scenarioNames;
	var virtualCombinationTestNamesToFilter = arrToString(virtualCombinationTestNames, ';', '') + ';';
	
	// Get the number of matched permutations and number of unmatched permutations of the virtual combination
	// And check if the virtual combination is completely unmatched
	var numOfMatchedPermutations = virtualCombinationAsJson.numOfMatchedPermutations;
	var numOfUnmatchedPermutations = virtualCombinationAsJson.numOfUnmatchedPermutations;
	var unmatchedVirtualCombination = (numOfMatchedPermutations == 0 && numOfUnmatchedPermutations > 0);

	for (var permutationNumber = 0; permutationNumber < numberOfPermutations; permutationNumber++) {
		
		// Add the template
		$('#tblMatchingAgentsPerPermutation').find('#tbodyMatchingAgents').append(rowToAddAsHtml);

		// Get a reference to the last row
		addedRow = $('#tblMatchingAgentsPerPermutation').find('#tbodyMatchingAgents').find('tr:last');

		// Indicate if the row belongs to a virtual combination that is completely unmatched
		if (unmatchedVirtualCombination) {
			$(addedRow).attr('data-unmatched-virtual-combination', '');
		} 

		// Get the current permutation id
		var permutationId = virtualCombinationAsJson.permutationIds[permutationNumber];

		// Get the current permutation
		var permutationAsJson = virtualCombinationAsJson[permutationId];

		// Render the permutation
		populateRowWithVirtualCombinationPermutation(sortedSetupParameterNames, addedRow, hasAllowedPermutations, permutationNumber, permutationId, permutationAsJson);

		// Check if there's an override and build a customized test names string
		var virtualCombinationTestNamesToHtml = "";
		var testStatusesHtml = "";
		var completedTestNames = virtualCombinationAsJson.completedTestsByPermutationId[permutationId];
		var notCompletedTestNames = virtualCombinationAsJson.notCompletedTestsByPermutationId[permutationId];
		var hasAgents = permutationAsJson.matchingAgents[0] != "-";
		var testStatusPrefixHtml = "<span id='tdTestStatus' nowrap style='text-align: center; width: 105px; display: block; margin: 2px; padding-top: 1px; padding-bottom: 1px' ";
		var testStatusNamesToFilter = new Object();
		for (var i = 0; i < virtualCombinationTestNames.length; i++) {
			if ($.inArray(virtualCombinationTestNames[i], completedTestNames) != -1) {
				testStatusesHtml += testStatusPrefixHtml + "class='TestStatusPassed'>Completed</span>";
				testStatusNamesToFilter["Completed"] = true;
			} else if ($.inArray(virtualCombinationTestNames[i], notCompletedTestNames) != -1) {
				testStatusesHtml += testStatusPrefixHtml + "class='HostStatusInUse'>Not Completed</span>";
				testStatusNamesToFilter["Not Completed"] = true;
			} else if (hasAgents) {
				testStatusesHtml += testStatusPrefixHtml + "class='TestStatusInQueue'>New</span>";
				newPermutations++;
				testStatusNamesToFilter["New"] = true;
			} else {
				testStatusesHtml += testStatusPrefixHtml + "class='TestStatusDiscarded'>Not Matched</span>";
				testStatusNamesToFilter["Not Matched"] = true;
			}
			virtualCombinationTestNamesToHtml += "<span id='spanTestName' nowrap style='display: block; margin: 2px; padding-top: 1px; padding-bottom: 1px'>" + virtualCombinationTestNames[i] + "</span>";
		}

		// Render the test statuses
		addedRow.find("#tdTestStatus").html(testStatusesHtml);
		addedRow.find('#tdTestStatus').attr('data-filter-values', arrToString(Object.keys(testStatusNamesToFilter), ';', '') + ';');

		// Render the test names
		addedRow.find('#tdTestNames').html(virtualCombinationTestNamesToHtml);
		addedRow.find('#tdTestNames').attr('data-filter-values', virtualCombinationTestNamesToFilter);

		// Render the number of test names
		addedRow.find('#tdNumOfTests').html(virtualCombinationTestNames.length);

		// Render the virtual combination name
		addedRow.find('#tdVirtualCombinationName').html(virtualCombinationAsJson.virtualCombinationName);
		if (!hasAllowedPermutations && sortedSetupParameterNames.length > 0) {
			addedRow.find('#tdVirtualCombinationName').css('text-decoration', 'line-through');
			addedRow.find('#tdVirtualCombinationName').attr('title', 'No allowed permutations');
		}

		if (sortedSetupParameterNames.length == 0) {
			addedRow.find("#btnShowAgents").remove();
		}
	}

	return newPermutations;
}

function testPlanValidation_showAgents(callingElement) {

	// Get the row of the element
	var callingElementRow = $(callingElement).parents('tr:eq(0)');
	
	// Get the row ID
	var callingElementRowId = $(callingElementRow).attr('id');
	
	// Get the permutation matching regex
	var matchingRegex = $(callingElementRow).attr('data-matching-regex');
		
	// Get information from the virtual combinations matching data
	var sortedSetupParameterNames = globalVirtualCombinationsMatchingData.sortedSetupParameterNames;
	var matchingRegexToMatchingKeysToUnmatchedParameterNames = globalVirtualCombinationsMatchingData.matchingRegexToMatchingKeysToUnmatchedParameterNames;
	var agentNameToMatchingKeys = globalVirtualCombinationsMatchingData.agentNameToMatchingKeys;
	var matchingKeyToTargetSetup = globalVirtualCombinationsMatchingData.matchingKeyToTargetSetup;
	
	// Create the row with the agents information
	var rowHtml = '';
	rowHtml += '<tr id="trAgents' + callingElementRowId + '"><td></td><td colspan="20">';
	rowHtml += '<table class="hor-minimalist-c">';
	rowHtml += '<thead>';
	rowHtml += '<tr>';
	rowHtml += '<th>Agent</th>';
	for (var parameterIndex = 0; parameterIndex < sortedSetupParameterNames.length; parameterIndex++) {
		var currentParameterName = sortedSetupParameterNames[parameterIndex];
		rowHtml += '<th>' + currentParameterName + '</th>';
	}
	rowHtml += '</tr>';
	rowHtml += '</thead>'
	rowHtml += '<tbody>';
	$.each(agentNameToMatchingKeys, function(key, value) {
	    
	    var agentName = key;
	    var matchingKeys = value;
	    
	    // Iterate over the matching keys
	    for (var keyIndex = 0; keyIndex < matchingKeys.length; keyIndex++) {
	    	
	    	var matchingKey = matchingKeys[keyIndex];
	    	
	    	// Get the target setup
	    	var targetSetup = matchingKeyToTargetSetup[matchingKey];
	    	
	    	// Get the unmatched setup parameter names
	    	var unmatchedParameterNames = matchingRegexToMatchingKeysToUnmatchedParameterNames[matchingRegex][matchingKey];
	    	
	    	console.log(unmatchedParameterNames);
	    
	    	rowHtml += '<tr>';
	    	rowHtml += '<td>' + agentName + '</td>';
	    	for (var parameterIndex = 0; parameterIndex < sortedSetupParameterNames.length; parameterIndex++) {
				var currentParameterName = sortedSetupParameterNames[parameterIndex];
				var currentParameterValue = targetSetup[currentParameterName];
				rowHtml += '<td>';
				if ($.inArray(currentParameterName, unmatchedParameterNames) >= 0) {
					rowHtml += '<font color="red">';
				}
				rowHtml += currentParameterValue;
				if ($.inArray(currentParameterName, unmatchedParameterNames) >= 0) {
					rowHtml += '</font>';
				}
				rowHtml += '</td>';
			}
	    	rowHtml += '</tr>';
	    }
	});
	rowHtml += '</tbody>';
	rowHtml += '</table>';
	rowHtml += '</td></tr>';
	
	// Add the agents row
	$(callingElementRow).after(rowHtml);

	// Switch the plus and minus buttons
	$(callingElementRow).find('#btnShowAgents').addClass('inactive');
	$(callingElementRow).find('#btnHideAgents').removeClass('inactive');
}

function testPlanValidation_hideAgents(callingElement) {
	
	// Get the row of the element
	var callingElementRow = $(callingElement).parents('tr:eq(0)');
	
	// Get the table of the row
	var table = $(callingElementRow).parents('table:eq(0)');
	
	// Get the row ID
	var callingElementRowId = $(callingElementRow).attr('id');	
	
	// Remove the row
	$(table).find('#trAgents' + callingElementRowId).remove();
	
	// Switch the plus and minus buttons
	$(callingElementRow).find('#btnHideAgents').addClass('inactive');
	$(callingElementRow).find('#btnShowAgents').removeClass('inactive');
}

function TestPlansValidation_renderTestPlanValidationMatchingTestsPerAgent(agentsTestsAsJson) {
	// Extract the template row
	var rowTemplate = '<tr>' + $('#templateMatchingTestsPerAgentRow tbody tr').last().html() + '</tr>' ;
	
	// Iterate over the agent ids
	for (var agentIndex = 0; agentIndex < agentsTestsAsJson.agentIds.length; agentIndex++) {
		// Add the first row template
		$('#tblMatchingTestsPerAgent').find('#tbodyMatchingTestsPerAgent').append(rowTemplate);
		
		// Get a reference to the last row
		var addedRow = $('#tblMatchingTestsPerAgent').find('#tbodyMatchingTestsPerAgent').find('tr:last');
		
		// Extract the current agent id
		var agentId = agentsTestsAsJson.agentIds[agentIndex];
		
		// Render the agent id
		addedRow.find('#tdAgentId').html(agentId);
		
		// Extract the number of tests
		var agentTestsNumber = agentsTestsAsJson[agentId].agentTestsNumber;
		
		// Render the tests number & tests
		addedRow.find('#tdNumOfTests').html(agentTestsNumber);
		if (agentTestsNumber == 0) {
			addedRow.find('#tdNumOfTests').attr('class', 'NoMatchingAgents');
			addedRow.find('#tdTestNames').html('-');
			addedRow.find('#tdTestNames').attr('data-filter-values', '-;');
		} else {
			// Extract the test names
			var agentTests = agentsTestsAsJson[agentId].agentTests;
			
			// Render the test names
			addedRow.find('#tdTestNames').html(arrToString(agentTests, '</br>', ''));
			
			// Handle the filter
			addedRow.find('#tdTestNames').attr('data-filter-values', arrToString(agentTests, ';', '') + ';');
		}
	}
	
	// Prepare the table for view
	prepareTableFiltersExt('tblMatchingTestsPerAgent', false);
}

function TestPlansValidation_showSendTestPlanAfterValidationDialog() {
	// Show the dialog
	$("#sendTestPlanDialog").dialog("open");
}

function TestPlanValidation_initializeButtons() {
	UIUtility_initializeButton('btnSendTestPlan'			 , 'ui-icon-play');
	UIUtility_initializeButton('btnRunSimulation'			 , 'ui-icon-play');
	UIUtility_initializeButton('btnSendMatchedOnly'			 , 'ui-icon-play');
	UIUtility_initializeButton('btnCloseTestPlanValidation'	 , 'ui-icon-close');
	UIUtility_initializeButton('btnCancel'	 				 , 'ui-icon-cancel');
	UIUtility_initializeButton('btnExportToExcel'			 , 'ui-icon-document');
}

/** javascripts/testplans/validate/TestPlanValidationEventsHelper.js **/
function TestPlansValidation_onSendTestPlanAfterValidation() {
	// Show the dialog
	TestPlansValidation_showSendTestPlanAfterValidationDialog();
}

function TestPlansValidation_onSendTestPlanAfterValidationSendMatchedConfirm() {
	TestPlansValidation_onSendTestPlanAfterValidationConfirm();
}

function TestPlansValidation_onSendTestPlanAfterValidationConfirm() {
	// Extract the test plan id
	var testPlanId = $('#hdnTestPlanId').val();
	
	// Extract the agent ids
	var agentIds = $('#hdnHostIps').val();
	
	// Check rounds
	var maxRounds = $("#txtRounds").val();
	if ($("#chkEndless").prop("checked")) {
		maxRounds = MAX_INT_VALUE;
	}

	// Check if broadcast is checked
	var enableBroadcast = $('#chkBroadcast').is(':checked');
	
	// Extract the check test plan snapshot ID
	var checkTestPlanSnapshotId = $('#hdnCheckTestPlanSnapshotId').val();

	// Extract the snapshot id
	var snapshotId = $('#hdnTestPlanValidationSnapshotId').val();
	
	// Extract the test suite id
	var testSuiteId  = $('#hdnTestSuiteId').val();
	
	// Extract the test plan name
	var testPlanName = $('#hdnTestPlanName').val();

	// Extract merge TP execution ID
	var mergeTPExecutionId = $("#hdnMergeTPExecutionId").val();
	if (isStringEmpty(mergeTPExecutionId)) {
		mergeTPExecutionId = undefined;
	}

	// Extract TP execution parameters
	var tpExecParameters = [];
	$("#tpExecParameters").find("input, select").each(function () {
		var input = $(this);
		var name = input.attr('name');
		var value = input.val();
		tpExecParameters.push({ name: name, value: value });
	});

	// Populate a json file
	var sendTPRequestAsJson = {
		"testPlanId": testPlanId,
		"testPlanName": testPlanName,
		"agentIds": agentIds,
		"mergeTPExecutionId": mergeTPExecutionId,
		"maxRounds": maxRounds,
		"enableBroadcast": enableBroadcast,
		"checkTestPlanSnapshotId": checkTestPlanSnapshotId,
		"testPlanValidationSnapshotId": snapshotId,
		"testSuiteId": testSuiteId,
		"tpExecParameters": tpExecParameters
	}

	// Get session UUID if there is one
	var sessionUUID = undefined;
	var context = $("#hdnContext").data('context');
	if (context != undefined) {
		sessionUUID = context['sessionUUID'];
	}

	TestPlans_sendRequestToSendTestPlan(sendTPRequestAsJson, sessionUUID);
}

function TestPlanValidation_exportToExcel() {

	var jsonRequest = {};
	var excel = {};
	jsonRequest.excel = excel;
	
	// Create the workbook 
	var workbook = {};
	workbook.workbookName = 'testPlanValidation';
	excel.workbook = workbook;
	
	// Create the sheets
	var sheets = [];
	workbook.sheets = sheets;
	
	// Create the permutations sheet
	var sheet = {};
	sheet.sheetName = 'permutations';
	sheets.push(sheet);
	var rows = [];
	sheet.rows = rows;
	
	// Get the table header row
	var headerRow = {};
	rows.push(headerRow);
	var headerValues = [];
	headerRow.values = headerValues;
	$('#tblMatchingAgentsPerPermutation').find('thead tr[id="trColumnNames"] th').each(function() {
		
		if ($(this).is('[data-export-ignore]')) {
			return;
		}
		
		// Get the current value
		var currentValue = $(this).text().trim();
		headerValues.push(currentValue);
	});
	
	// Get the table data
	$('#tblMatchingAgentsPerPermutation > tbody > tr').each(function() {
		
		var currentPermutationRow = $(this);
		
		// Create a line for each test in the row
		$(currentPermutationRow).find('#spanTestName').each(function() {
			
			// Add a row
			var dataRow = {};
			rows.push(dataRow);
			var dataValues = [];
			dataRow.values = dataValues;
			
			var currentTestRow = $(this);
			
			// Get the data from the test row
			$(currentTestRow).find('td').each(function() {
				
				if ($(this).is('[data-export-ignore]')) {
					return;
				}
				
				// Get the current value
				var currentValue = '';
				if ($(this).is('[data-export-value]')) {
					currentValue = $(this).attr('data-export-value')
				} else {
					currentValue = $(this).text().trim();
				}
				dataValues.push(currentValue);
			});
			
			
			// Get the data from the permutation row
			$(currentPermutationRow).find('td').each(function() {
				
				if ($(this).is('[data-export-ignore]')) {
					return;
				}
				
				// Get the current value
				var currentValue = '';
				if ($(this).is('[data-export-value]')) {
					currentValue = $(this).attr('data-export-value')
				} else {
					currentValue = $(this).text().trim();
				}
				dataValues.push(currentValue);
			});
		});
	});
	
	// Export to excel
	var link = '/tasks/genericReports_exportToExcel';
	PostJsonToNewWindow(link, jsonRequest, '_self', true);
}

function TestPlansValidation_onRunTPSimulation() {
	var messages = [
	              "Please fill out the following parameters, or leave empty to use defaults.",
	              "<input type='checkbox' id='chkSimulationBroadcast'><label for='chkSimulationBroadcast'>&nbsp;Broadcast</label></input>",
	              "<table><tr><td>Target Coverage (%):</td><td><input type='text' id='chkSimulationTargetCoverage' value='100'></input></td></tr>" +
	              	"<tr><td>Target Time (hours):</td><td><input type='text' id='chkSimulationTargetTime'></input></td></tr>" +
	              	"<tr><td>Target # of Tests:</td><td><input type='text' id='chkSimulationTargetTestsCount'></input></td></tr></table>"
	             ];
	UIUtility_showConfirmDialog(messages, "Run Simulation", function () {
		// Take parameters from dialog
		var isBroadcast = $("#chkSimulationBroadcast").prop("checked");
		var targetCoverage = $("#chkSimulationTargetCoverage").val();
		var targetTime = $("#chkSimulationTargetTime").val();
		var targetTestsCount = $("#chkSimulationTargetTestsCount").val();

		// Extract the test plan id
		var testPlanId = $('#hdnTestPlanId').val();
		
		// Extract the agent ids
		var agentIds = JSON.parse($('#hdnHostIps').val());

		// Extract the snapshot id
		var snapshotId = $('#hdnTestPlanValidationSnapshotId').val();
		
		// Extract the test suite id
		var testSuiteId  = $('#hdnTestSuiteId').val();

		// Send request
		TestPlansValidation_sendRequestToRunTPSimulation(testPlanId, testSuiteId, agentIds, snapshotId, isBroadcast,
				targetCoverage, targetTime, targetTestsCount);
	}, 580, 400);
}

/** javascripts/testplans/check/CheckTestPlanRequestDispatcherHelper.js **/
function CheckTestPlan_sendRequestToDisplayCheckTestPlanPage(testPlanId, testPlanName, agentIds, customExecName) {
	// Create URL
	var linkUrl = '/tasks/DisplayCheckTestPlan?testPlanId=' + testPlanId + '&testPlanName=' + testPlanName;

	// Post to new window
	var json = {
		agentsDataAsJson: {
			agentIds: agentIds
		}
	};
	if (customExecName != undefined) {
		json.customExecutionName = customExecName;
	}
	PostJsonToNewWindow(linkUrl, json);
}

function CheckTestPlan_sendRequestToCheckTestPlan(testPlanId, testSuiteId, lmsVersion, cont) {
	// Populate the url
	var linkUrl = "/tasks/CheckTestPlan?testPlanId=" + testPlanId + "&testSuiteId=" + testSuiteId + "&lmsVersion=" + lmsVersion;

	// Send the request
	pageLoading();
	var xmlhttp = Get(linkUrl);
	xmlhttp.onreadystatechange=function() {
		if (xmlhttp.readyState == 4) {
			if (xmlhttp.status == 200) {
				// Parse the check TP results data
				var checkTPResultsData = JSON.parse(xmlhttp.responseText);

				// Send to continuation
				cont(checkTPResultsData);
			} else {
				console.log(xmlhttp.responseText);
				$('#lblCheckTPError').html('Failed to check test plan');
			}

			// Hide the loader
			pageFinishedLoading();
		}
	};
}

/** javascripts/testplans/check/CheckTestPlanRenderHelper.js **/
function CheckTestPlan_initializeButtons() {
	UIUtility_initializeButton('btnCheckTestPlan', 'ui-icon-check');
	
	UIUtility_initializeButtonWithRightIcon('btnNext', 'ui-icon-seek-next');

	UIUtility_initializeButton("togglePermutations", "ui-icon-plus");

	// Header functionality
	$(".LMSectionHeader, .LMSectionSubHeader").each(setSectionToggle);
}

function CheckTestPlan_initializeDialogs() {
	CheckTestPlan_initializeWarningDialog();
}

function CheckTestPlan_initializeWarningDialog() {
	
	// The dialog itself
	$("#nextWarningDialog").dialog({
		autoOpen: false,
		height: 400,
		width: 550,
		modal: true,
		buttons: [ 
		          {
		        	  text: "Continue",
		        	  click: function() {
		        		  CheckTestPlan_onNext(false);
		        	  }
		          },
		          {
		        	  text: "Cancel",
		        	  click: function() {
		        		  $(this).dialog("close");
		        	  }
		          }
		          ]
	});
}

function CheckTestPlan_getTestSuiteName() {
	var rawName = getValueFromElement($('#inputTestSuite'));
	var lastParenthesisOpen = rawName.lastIndexOf("(");
	if (lastParenthesisOpen != -1) {
		return rawName.substring(0, lastParenthesisOpen - 1);
	}
	return rawName;
}

function CheckTestPlan_renderTestSuiteNames() {
	// Extract the test suite names as json
	var testSuiteNamesAsJson = globalTestSuitesMetaData;
	var rawNames = testSuiteNamesAsJson.testSuiteNames;
	var testSuiteNames = [];
	for (var i = 0; i < rawNames.length; i++) {
		var creationTime = testSuiteNamesAsJson[rawNames[i]].testSuiteCreationTime;
		var creationTimeStr = "";
		if (creationTime != undefined) {
			creationTimeStr = " (" + creationTime + ")";
		}
		testSuiteNames.push(rawNames[i] + creationTimeStr);
	}

	// Add the option to the input box
	$('input[id^=inputTestSuite]').autocomplete({
		select: function( event, ui ) {},
		source: testSuiteNames,
		minLength: 0,
	}).on('focus', function () {
	    $(this).autocomplete('search', '');
	});
}

function CheckTestPlan_showHideTests(callingElement) {
	var selectedEffect 	= 'slide';
	var options		 	= {};

	// run the effect
	$(callingElement).parent().find("#showTestsEffect").toggle(selectedEffect, options, 200);
}

function CheckTestPlan_renderLMSVersions(lmsVersionNamesArr) {
	$("#inputLMSVersions").autocomplete({
		select: function( event, ui ) {},
		source: lmsVersionNamesArr,
		minLength: 0
	}).on('focus', function () {
		$(this).autocomplete('search', '');
	});
}

function CheckTestPlan_renderCheckTestPlanResults(checkTPResultsDataAsJson) {
	
	// Save the check test plan results snapshot ID
	var checkTestPlanSnapshotId = checkTPResultsDataAsJson.databaseSnapshotId;
	$('#hdnCheckTestPlanSnapshotId').val(checkTestPlanSnapshotId);
	
	// Extract the general status
	var generalStatus = checkTPResultsDataAsJson.status;
	
	// If error disable the next button
	if ("Error" == generalStatus) {
		$('#btnNext').button("disable");
	} else {
		$('#btnNext').button("enable");
	}
	
	// Update the checked test plan in the hidden input
	$('#hdnTestPlanId').val(checkTPResultsDataAsJson.checkedTestPlanId);
	
	// Update the general status + the class for color
	$('#spanCheckTPResult').html('&nbsp' + generalStatus + '&nbsp');
	$('#spanCheckTPResult').attr('class', 'checkTP' + generalStatus)
	$('#spanCheckTPResult').data('generalStatus', generalStatus);
	
	// Store the auto deployment workflow data
	$('#hdnAutoDeploymentWorkflowData').data('autoDeploymentWorkflowId', checkTPResultsDataAsJson.autoDeploymentWorkflowId);
	$('#hdnAutoDeploymentWorkflowData').data('autoDeploymentWorkflowName', checkTPResultsDataAsJson.autoDeploymentWorkflowName);
	
	// Hide the rows in the table data
	$('#tblCheckTPReportSummary tbody').html('');
	
	// Get the template
	var reasonRowTemplateAsHtml = $('#tblReasonTemplate tbody').html();
	
	// Render the table data - iterate over the reasons
	checkTPResultsDataAsJson.reasons.forEach(function(reason) {
		// Add the template row to the end
		$('#tblCheckTPReportSummary > tbody').append(reasonRowTemplateAsHtml);

		// Get a reference to the just added row
		var reasonRow = $('#tblCheckTPReportSummary > tbody > tr').last();
		
		// Extract the reason data
		var reasonDataAsJson = checkTPResultsDataAsJson[reason];
		
		// Extract the description
		var reasonDescription = reasonDataAsJson.description;
		
		// Extract the reason row status
		var reasonRowStatus = reasonDataAsJson.status;
		
		// Get the number of tests
		var numOfTests = reasonDataAsJson.numOfTests;
		
		// Populate the reason
		reasonRow.find('#thDescription').html(reasonDescription);
		
		// Populate the status in the row + the class for color
		
		if (numOfTests == 0) {
			reasonRow.find('#tdStatus').html('Passed');
			reasonRow.find('#tdStatus').attr('class', 'checkTPPassed')
		} else {
			reasonRow.find('#tdStatus').html(reasonRowStatus);
			reasonRow.find('#tdStatus').attr('class', 'checkTP' + reasonRowStatus)
		}
		
		// Populate the number of tests
		reasonRow.find('#tdNumOfTests').html(numOfTests);
		
		// Populate the list of tests
		reasonDataAsJson.tests.forEach(function(test) {
			reasonRow.find('#tblTests tbody').append('<tr><td>' + test + '</td></tr>');
		});
		
		// Show the row
		reasonRow.attr('class', '');
	});
	
	// Get the template row for the permutations
	var permutationRowTemplate = $('#tblCheckTPReportPermutationsTemplate tbody tr:first');

	// Clear existing rows
	$('#tblCheckTPReportPermutations > tbody > tr').remove();

	// Render the permutation rows
	var ts = 0;
	var tp = 0;
	checkTPResultsDataAsJson.permutationRows.forEach(function(permutationRowData) {
		// Clone the template row
		var permutationRow = $(permutationRowTemplate).clone();
		
		// Populate reason
		var reason = permutationRowData.description;
		permutationRow.find('#tdReason').html(reason);

		var testsInPermutation = permutationRowData.tests.length;
		if (reason.indexOf("Test(s) included in TS but not in TP") != -1) {
			ts += testsInPermutation;
		} else if (reason.indexOf("Test(s) included in TS and in TP") != -1) {
			ts += testsInPermutation;
			tp += testsInPermutation;
		}

		// Populate status
		var status = permutationRowData.status;
		permutationRow.find('#tdStatus').addClass('checkTP' + status);
		permutationRow.find('#tdStatus').html(status);

		// Populate test names
		var testNamesHtml = '';
		for (var testIndex = 0; testIndex < testsInPermutation; testIndex++) {
			var testName = permutationRowData.tests[testIndex];
			testNamesHtml += testName;
			if (testIndex < permutationRowData.tests.length - 1) {
				testNamesHtml += '<br/>';
			}
		}
		permutationRow.find('#tdScenarioNames').html(testNamesHtml);
		
		// Populate permutation
		var permutationHtml = '';
		if (undefined != permutationRowData.targetSetup) {
			for (var setupParameterIndex = 0; setupParameterIndex < permutationRowData.targetSetup.length; setupParameterIndex++) {
				var setupParameterName = permutationRowData.targetSetup[setupParameterIndex].setupParameterName;
				var setupParameterValues = permutationRowData.targetSetup[setupParameterIndex].setupParameterValues;
				permutationHtml += setupParameterName + ': ' + setupParameterValues;
				if (setupParameterIndex < permutationRowData.targetSetup.length - 1) {
					permutationHtml += '<br/>';
				}
			}
		}
		permutationRow.find('#tdPermutation').html(permutationHtml);
	
		// Populate virtual combination name
		var virtualCombinationName = permutationRowData.virtualCombinationName;
		permutationRow.find('#tdVirtualCombinationName').html(virtualCombinationName);

		// Add the template row to the end of the tbody
		$('#tblCheckTPReportPermutations tbody').append(permutationRow);
	});

	// Render test plan coverage of test suite
	$("#spanCoverage").text(calcPercentage(tp, ts) + "% (" + tp + "/" + ts + ")");

	// Show the report
	$("#divCheckTPHeader").click();
	$('#divCheckTPReport').removeClass("inactive");
}

/** javascripts/testplans/check/CheckTestPlanEventsHelper.js **/
function CheckTestPlan_onCheckTestPlan() {
	// Clean previous errors
	$('#lblCheckTPError').html('');

	// Hide the previous results
	$('#divCheckTPReport').addClass('inactive');
	
	// Extract the test suite name
	var testSuiteName = CheckTestPlan_getTestSuiteName();
	
	// Make sure that test suite was given
	if (isStringEmpty(testSuiteName)) {
		$('#lblCheckTPError').html('Test suite name is missing');
		
		return;
	}

	// Extract the test suite id
	var testSuiteId = globalTestSuitesMetaData[testSuiteName].testSuiteId;

	// Make sure that the test suite exists
	if (testSuiteId == undefined || isStringEmpty(testSuiteId.toString())) {
		$('#lblCheckTPError').html("The test suite does not exist");
		
		return;
	}

	// Extract the LMS version & parse it - i.e. extract the version from string
	var rawLMSVersion = getValueFromElement($('#inputLMSVersions'));
	var lmsVersion = CheckTestPlan_IsParseLMSFileName() ? parseLMSVersion(rawLMSVersion) : rawLMSVersion;

	// Make sure that LMS was given if required
	if (isStringEmpty(lmsVersion) && $("#inputLMSVersions:visible").length > 0) {
		$('#lblCheckTPError').html('Package version is missing');

		return;
	}
	
	// Extract the test plan id
	var testPlanId = $('#hdnOriginalCheckedTestPlanId').val();

	// Send a request to check the test plan
	CheckTestPlan_sendRequestToCheckTestPlan(testPlanId, testSuiteId, lmsVersion, CheckTestPlan_renderCheckTestPlanResults);
}

function CheckTestPlan_onNext(showConfirm) {
	var testPlanId = getValueFromElement($('#hdnTestPlanId'));
	var testPlanName = getValueFromElement($('#hdnTestPlanName'));
	var testSuiteName 	= CheckTestPlan_getTestSuiteName();
	var testSuiteId = globalTestSuitesMetaData[testSuiteName].testSuiteId;
	var checkTestPlanSnapshotId = getValueFromElement($('#hdnCheckTestPlanSnapshotId'));
	var allowedPermsGroupId = $('#allowedPermsGroup').val();

	// Extract the auto deployment workflow
	var workflowId 		= $('#hdnAutoDeploymentWorkflowData').data('autoDeploymentWorkflowId');
	var workflowName 	= $('#hdnAutoDeploymentWorkflowData').data('autoDeploymentWorkflowName');
	var sessionUUID 	= generateUUID();
	var contextAsJson	= {
		"lmsFileName": getValueFromElement($('#inputLMSVersions')),
		"testSuiteId": testSuiteId,
		"testSuiteName": testSuiteName,
		"testPlanId": testPlanId,
		"testPlanName": testPlanName,
		"allowedPermutationsGroupId": allowedPermsGroupId,
		"checkTestPlanSnapshotId": checkTestPlanSnapshotId
	};

	// Extract custom execution name if exists
	var customExecName = getValueFromElement($("#hdnCustomExecName"));
	if (!isStringEmpty(customExecName)) {
		contextAsJson.customExecutionName = customExecName;
	}

	// Take workflow information from input if manual selection exists, otherwise stay with the project's defaults
	// The input shouldn't exist if we have a project default
	var slctWorkflow = $("#inputWorkflow");
	if (slctWorkflow.length > 0) {
		workflowId = slctWorkflow.val();
		workflowName = slctWorkflow.find("option[value='" + workflowId + "']").text();
	}

	if (workflowId == 0) {
		// This means that auto deployment was not configured for the project
		UIUtility_showAlert("No auto deployment is configured for the test suite related project", "Error");
		return;
	}

	// Extract the agent ids
	var agentIds = $('#hdnAgentIds').data('agentIds');
	
	// Extract the status - if warning show a message
	var generatlStatus = $('#spanCheckTPResult').data('generalStatus');
	
	if (showConfirm && 'Warning' == generatlStatus) {
		$('#nextWarningDialog').dialog('open');
		return;
	}

	// Send a request to the load the workflow (in the same window)
	var autoDeployment = true;
	WorkflowsMng_sendLoadWorkflow(workflowId, workflowName, autoDeployment, agentIds, contextAsJson, sessionUUID, undefined, true);

	// Close the dialog
	$('#nextWarningDialog').dialog('close');
}
/** javascripts/workflows/WorkflowsCommonHelper.js **/
var WorkflowsMonitoring_exitCodeDescriptionPairsAsJson = {}; 

function WorkflowsMng_storeWorkflowsData(workflowsData) {
	$('#hdnWorkflowsData').val(workflowsData);
}

function WorkflowsMng_getWorkflowsData() {
	return JSON.parse($('#hdnWorkflowsData').val());
}

function WorkflowsMng_getWorkflowId(workflowName) {
	return WorkflowsMng_getWorkflowsData()[workflowName];
}

function WorkflowsMng_storeWorkflowContent(workflowContent) {
	$('#hdnWorkflowContent').val(workflowContent);
}

function WorkflowsMng_getWorkflowContent() {
	return JSON.parse($('#hdnWorkflowContent').val());
}

function WorkflowsMonitoring_storeExitCodeDescriptionPairs(exitCodeDescriptionParisAsJson) {
	WorkflowsMonitoring_exitCodeDescriptionPairsAsJson = exitCodeDescriptionParisAsJson; 
}

function WorkflowsMonitoring_getExitCodeDescription(exitCode) {
	var exitCodeDescription = WorkflowsMonitoring_exitCodeDescriptionPairsAsJson[exitCode];
	
	if (isStringEmpty(exitCodeDescription)) {
		exitCodeDescription = '';
	}
	
	return exitCodeDescription;
}

/** javascripts/workflows/WorkflowsManagement.js **/
function WorkflowMng_loadWorkflowContent(optionalContinuationBefore, optionalContinuationAfter) {
	// Extract the workflow id
	var workflowId = $('#hdnWorkflowId').val();

	// Prepare the request url
	var linkUrl = '/tasks/LoadWorkflowContent?workflowId=' + workflowId;

	// Send the request
	var xmlhttp = Get(linkUrl);
	pageLoading();
	xmlhttp.onreadystatechange=function() {
		if (xmlhttp.readyState == 4) {
			pageFinishedLoading();
			if (xmlhttp.status == 200) {
				// Store the workflow content as json
				WorkflowsMng_storeWorkflowContent(xmlhttp.responseText);

				// Call continuation if exists (before rendering because uses creates the elements only here)
				if (optionalContinuationBefore != undefined) {
					optionalContinuationBefore(true);
				}

				// Render the workflow content
				WorkflowsMng_renderWorkflowContent();

				if (optionalContinuationAfter != undefined) {
					optionalContinuationAfter(true);
				}
			} else {
				if (optionalContinuationBefore != undefined) {
					optionalContinuationBefore(false);
				}
				if (optionalContinuationAfter != undefined) {
					optionalContinuationAfter(false);
				}
				UIUtility_showAlert("Can't load workflow contents", "Error");
			}
		}
	};
}
/** javascripts/workflows/WorkflowsMngRenderHelper.js **/
var IsWorkflowRunStatusToggled = false;

function WorkflowsMng_initializeDialogs() {
	WorkflowsMng_initializeSkipWorkflowErrorDialog();
	WorkflowsMng_initializeNextWarningDialog();
}

function WorkflowsMng_initializeNextWarningDialog() {
	$("#nextWorkflowWarningDialog").dialog({
		autoOpen: false,
		height: 400,
		width: 550,
		modal: true,
		buttons: [{
			text: "Ok",
			click: function() {
				$(this).dialog("close");
				WorkflowsMng_performNext();
			}
		},
		{
			text: "Cancel",
			click: function() {
				$(this).dialog("close");
			}
		}]
	});
}

function WorkflowsMng_initializeSkipWorkflowErrorDialog() {
	$("#skipWorkflowErrorDialog").dialog({
		autoOpen: false,
		height: 400,
		width: 550,
		modal: true,
		buttons: [{
			text: "Ok",
			click: function() {
				$(this).dialog("close");
			}
		}]
	});
}

function WorkflowMng_initializeButtons() {
	UIUtility_initializeButton('btnRunWorkflow'			, 'ui-icon-circle-triangle-e');
	UIUtility_initializeButton('btnViewWorkflowRunning'	, 'ui-icon-folder-open');
	UIUtility_initializeButton('btnSkip'				, 'ui-icon-check');
	UIUtility_initializeButtonWithRightIcon('btnNext'	, 'ui-icon-seek-next');
	UIUtility_initializeToggleButton('showStatsButton'	, 'ui-icon-star');
	UIUtility_initializeButton('autofillButton'			, 'ui-icon-lightbulb');
	UIUtility_initializeButton('exportButton'			, 'ui-icon-disk');
	UIUtility_initializeButton('loadButton'				, 'ui-icon-folder-open');
	UIUtility_initializeButton('newPlanButton'			, 'ui-icon-document');
	UIUtility_initializeButton('savePlanButton'			, 'ui-icon-disk');
	UIUtility_initializeButton('scheduleButton'			, 'ui-icon-clock');
	UIUtility_initializeButton('btnModifyAgents'		, 'ui-icon-pencil');
	UIUtility_initializeToggleButton('btnAgents'		, 'ui-icon-gear');
	UIUtility_initializeToggleButton('btnPlans'			, 'ui-icon-clock');
	UIUtility_initializeButton('queuePlanButton'		, 'ui-icon-circle-triangle-e');
	UIUtility_initializeButton("deleteAllStatsButton");

	// Set action for toggle buttons
	$("[data-trigger]").each(function () {
		var button = $(this);
		button.click(function () {
			var selectedEffect = 'blind';
			var options		 = {};

			var triggerId = button.attr('data-trigger');
			var div = $("#" + triggerId);

			// Hide all other divs
			$("[data-trigger]").each(function () {
				var otherButton = $(this);
				var otherDiv = $("#" + otherButton.attr("data-trigger"));
				if (!otherDiv.is(div) && otherDiv.is(":visible")) {
					otherButton.click();
				}
			});

			// Show this div
			div.toggle(selectedEffect, options, 500);
		});
	});

	// Set action for toggle all checkbox
	var toggleAll = $("#chkToggleAllSteps");
	toggleAll.click(function () {
		var state = toggleAll.prop("checked");
		var rows = $("#tblWorkflowSteps > tbody > tr");
		for (var i = 0; i < rows.length; i++) {
			var theInputCheckbox = $(rows[i]).find("td:first input");
			if (!theInputCheckbox.prop('disabled')) {
				theInputCheckbox.prop("checked", state);
			}
		}

		WorkflowsMng_updateTimeEstimation();
	});
}

function WorkflowsMng_renderWorkflowContent() {
	// Extract the workflow content as json
	var workflowContentAsJson = WorkflowsMng_getWorkflowContent();

	// Render the steps
	WorkflowsMng_renderWorkflowSteps(workflowContentAsJson.workflowSteps, workflowContentAsJson.isAutoFillIdenticalInputNames);

	// Render statistics
	var statistics = workflowContentAsJson.statistics;
	for (var i = 0; i < statistics.length; i++) {

		var min = statistics[i].minTimeInSecs;
		var max = statistics[i].maxTimeInSecs;

		// Build final string
		var finalStr = WorkflowsMng_buildTimeString(min, max);
		if (finalStr == undefined) {
			hasTotalTime = false;
			continue;
		}

		var cols = $("#tblWorkflowSteps > tbody > [data-step-id='" + statistics[i].stepId + "'] > #tdETA");
		cols.html(finalStr);
		cols.data('min', min);
		cols.data('max', max);
	}

	// Status counters
	var isShowDeleteStats = $("#deleteAllStatsButton").length > 0;
	var table = $("#tblWorkflowSteps");
	table.find("> tbody > tr").each(function () {
		var stepRow = $(this);

		// Find statistics object
		var stepId = parseInt(stepRow.attr('data-step-id'));
		var statusCounters = undefined;
		for (var i = 0; i < statistics.length; i++) {
			if (statistics[i].stepId == stepId) {
				statusCounters = statistics[i].statusCounters;
				break;
			}
		}

		// Default to N/A
		var successPercentage = "N/A";
		var warningPercentage = "N/A";
		var failedPercentage = "N/A";

		if (statusCounters != undefined) {
			// Get specific counters
			var success = 0;
			var warning = 0;
			var failed = 0;
			for (var status in statusCounters) {
				var counter = statusCounters[status];
				if (status == "SUCCESS") {
					success += counter;
				} else if (status == "FAILED") {
					failed += counter;
				} else if (status == "WARNING") {
					warning += counter;
				}
				// We don't count other statuses (like aborted) in the total in purpose
			}

			var total = success + warning + failed;
			if (total > 0) {
				// There is some data, calculate percentages
				successPercentage = calcPercentage(success, total) + "%";
				warningPercentage = calcPercentage(warning, total) + "%";
				failedPercentage = calcPercentage(failed, total) + "%";
			}
		}

		// Create HTML
		var statusCountersHtml = "";
		statusCountersHtml += "<span class='WorkflowStatusSUCCESS' style='text-align: center; width: 60px; display: inline-block'>" + successPercentage + "</span>";
		statusCountersHtml += "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
		statusCountersHtml += "<span class='WorkflowStatusWARNING' style='text-align: center; width: 60px; display: inline-block'>" + warningPercentage + "</span>";
		statusCountersHtml += "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
		statusCountersHtml += "<span class='WorkflowStatusFAILED' style='text-align: center; width: 60px; display: inline-block'>" + failedPercentage + "</span>";
		if (isShowDeleteStats) {
			statusCountersHtml += "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
			statusCountersHtml += "<span style='display: inline-block'><button id='btnDeleteStats' title='Clear statistics for the step'></button></span>";
		}
		var tdStats = stepRow.find("#tdStatusStatistics");
		tdStats.html(statusCountersHtml);
		if (isShowDeleteStats) {
			var deleteButton = tdStats.find("#btnDeleteStats");
			UIUtility_initializeButtonWithSelector(deleteButton, "ui-icon-trash");
			UIUtility_setSmallButtonPadding(deleteButton);
			deleteButton.click(function () {
				UIUtility_showConfirmDialog(["Are you sure you want to delete the statistics?"], "Delete Statistics", function () {
					// Send delete request
					deleteRequest(
							'/workflows/steps/' + stepId + '/statistics',
							function () {
								// Clear percentages
								tdStats.find(".WorkflowStatusSUCCESS, .WorkflowStatusWARNING, .WorkflowStatusFAILED").text('N/A');
							}, function (err) {
								UIUtility_showAlert(err, "Error");
							});
				});
			});
		}
	});

	WorkflowsMng_updateTimeEstimation();

	// Maintain good widths with table and statistics bar below it
	if (!isMobile()) {
		WorkflowsMng_tableWidthUpdated();
	}
}

function WorkflowsMng_tableWidthUpdated() {
	var table = $("#tblWorkflowSteps");
	var tblWidth = table.width();
	if (tblWidth > 530) {
		// Enlarge statistics div
		$("#divStatistics").css('width', tblWidth + "px");
	} else {
		// Enlarge table
		table.css('min-width', '530px');
	}
}

function WorkflowsMng_deleteAllStatistics() {
	UIUtility_showConfirmDialog(["Are you sure you want to delete all statistics?"], "Delete Statistics", function () {
		// Send delete requests
		$("[data-step-id]").each(function () {
			var row = $(this);
			var stepId = row.attr('data-step-id');
			deleteRequest(
					'/workflows/steps/' + stepId + '/statistics',
					function () {
						// Clear percentages
						row.find(".WorkflowStatusSUCCESS, .WorkflowStatusWARNING, .WorkflowStatusFAILED").text('N/A');
					}, function (err) {
						UIUtility_showAlert(err, "Error");
					});
		});
	});
}

function WorkflowsMng_toggleStatistics(checkbox) {
	var cols = $("#tblWorkflowSteps").find("#thETA, #tdETA, #thStatusStatistics, #tdStatusStatistics");
	if (checkbox.prop("checked")) {
		cols.removeClass("inactive");
		$("#deleteAllStatusSpan").removeClass("inactive");
	} else {
		cols.addClass("inactive");
		$("#deleteAllStatusSpan").addClass("inactive");
	}
	WorkflowsMng_tableWidthUpdated();
}

function WorkflowsMng_updateTimeEstimation() {
	var hasTotalTime = true;
	var totalMinTime = 0;
	var totalMaxTime = 0;
	var count = 0;

	$("#tblWorkflowSteps > tbody #tdETA").each(function () {
		var td = $(this);
		var tdEnable = td.parent().find("#tdEnable input");
		if (tdEnable.prop("checked")) {
			var min = td.data('min');
			var max = td.data('max');
			if (min == undefined && max == undefined) {
				hasTotalTime = false;
			} else {
				// Update totals
				if (min != -1) {
					totalMinTime += min;
				}
				if (max != -1) {
					totalMaxTime += max;
				}
			}
			count++;
		}
	});

	if (count == 0) {
		$("#totalTimeEstimation").html("No selected steps");
	} else if (hasTotalTime) {
		$("#totalTimeEstimation").html(WorkflowsMng_buildTimeString(totalMinTime, totalMaxTime));
	} else {
		$("#totalTimeEstimation").html("Not enough data collected");
	}
}

function WorkflowsMng_buildTimeString(min, max) {
	if (min == -1 && max == -1) {
		return undefined;
	}

	var minStr = "" + Math.round(min / 60);
	var maxStr = "" + Math.round(max / 60);
	var finalStr = "";
	if (minStr == maxStr) {
		finalStr = minStr;
	} else {
		if (min != -1) {
			finalStr += minStr;
			if (max != -1) {
				finalStr += "-";
			}
		}
		if (max != -1) {
			finalStr += maxStr;
		}
	}

	if (isStringEmpty(finalStr)) {
		return undefined;
	}

	if (finalStr == "1") {
		finalStr += " minute";
	} else if (finalStr == "0") {
		finalStr = "Less than one minute";
	} else {
		finalStr += " minutes";
	}

	return finalStr;
}

function WorkflowsMng_renderWorkflowSteps(workflowSteps, autoFillIdenticalInputs) {
	// Clean the workflow steps
	$('#tblWorkflowSteps tbody').html('');
	
	// Extract the template row
	var workflowStepTemplateRow = $('#tblWorkflowStepsTemplate tbody tr').last();

	// Clone context so it might be changed in inner functions
	var context = $('#hdnContext').data('context');
	if (context != undefined) {
		context = $.extend({}, context);
	}

	// If we're int a workflow plan, extract enabled step names array
	var enabledSteps = $("#hdnWorkflowPlanEnabledStepNames").val();
	if (isStringEmpty(enabledSteps)) {
		enabledSteps = undefined;
	} else {
		enabledSteps = JSON.parse(enabledSteps);
	}

	// Iterate over the steps
	var workflowStepIds = workflowSteps.workflowStepIds;
	var stepIndex = 0;
	for (stepIndex = 0; stepIndex < workflowStepIds.length; stepIndex++) {
		// Extract the current workflow step id
		var workflowStepId = workflowStepIds[stepIndex];
		
		// Extract the step as json
		var workflowStepAsJson = workflowSteps[workflowStepId];

		// Render the workflow step row
		WorkflowsMng_renderWorkflowStep(stepIndex + 1, workflowStepAsJson, workflowStepTemplateRow, context, autoFillIdenticalInputs, enabledSteps);
	}
}

function WorkflowsMng_renderWorkflowStep(stepNumber, workflowStepAsJson, workflowStepTemplateRow, context, autoFillIdenticalInputs, enabledSteps) {
	// Extract the workflow step id
	var workflowStepId = workflowStepAsJson.workflowStepId;

	// The row to add
	var rowToAdd = '<tr id="' + workflowStepId + '" data-step-id="' + workflowStepAsJson.stepId + '" data-step-operation-type="' +
		workflowStepAsJson.operationType + '" data-step-type="' + workflowStepAsJson.stepType + '">' + workflowStepTemplateRow.html() + '</tr>'

	// Add the template row before the last row
	$('#tblWorkflowSteps tbody[id^="tbodyWorkflowSteps"]').append(rowToAdd);

	// Get reference to the added row
	var newRow = $('#tblWorkflowSteps tbody tr:last');

	var enableStep;
	if (enabledSteps == undefined) {
		// Enable step defaults to configuration value
		enableStep = !workflowStepAsJson.disableByDefault;
	} else {
		// Look for the step there and remove if found so if a step which already exists is added, it won't be enabled the second time
		// This does not consider ordering
		var indexInEnabled = enabledSteps.indexOf(workflowStepAsJson.stepName);
		if (indexInEnabled == -1) {
			enableStep = false;
		} else {
			enabledSteps.splice(indexInEnabled, 1);
			enableStep = true;
		}
	}

	// Sign the step as enabled/disabled according to config
	newRow.find('#chkEnable').prop('checked', enableStep);

	// If mandatory & auto deployment - disable the chkEnable flag
	var isAutoDeployment = $('#hdnAutoDeployment').data('isAutoDeployment');
	if ((isAutoDeployment || useMandatoryFlagOnNonAutoDeployment()) && workflowStepAsJson.mandatory) {
		newRow.find('#chkEnable').prop('disabled', true);
	}

	// Populate the step number
	newRow.find('#tdNumber').html(stepNumber);

	// Populate the step name
	var stepTooltip = '';
	if (!isStringEmpty(workflowStepAsJson.description)) {
		stepTooltip = '<span title="' + workflowStepAsJson.description + '" style="text-weight:thin;"><sup> (?)</sup></span>';
	}
	var stepPrefix = "";
	if (workflowStepAsJson.stepType == "Agent") {
		stepPrefix = "<span style='color: blue'>(A)</span> ";
	} else if (workflowStepAsJson.stepType == "LM") {
		stepPrefix = "<span style='color: blue'>(LM)</span> ";
	} else {
		stepPrefix = "<span style='color: blue'>(H)</span> ";
	}
	var tdStepName = newRow.find('#tdStepName');
	tdStepName.attr('step-name', workflowStepAsJson.stepName);	
	tdStepName.html(stepPrefix + workflowStepAsJson.stepName + stepTooltip);

	// Populate the step type (if exists)
	newRow.find('#tdType').html();
	
	// Render the step inputs
	WorkflowsMng_renderWorkflowStepInputs(workflowStepAsJson.inputs, newRow, context, autoFillIdenticalInputs);

	// Add hidden arguments section
	if (!isStringEmpty(workflowStepAsJson.hiddenArgs)) {
		var args = newRow.find("#tdArguments");
		args.append("<table id='tblShowHidden'><tr><td style='border: 0px' colspan='2'><a href='#' style='color: inherit; text-decoration: none'>+ Show hidden</a><div id='hiddenArgs' class='inactive'>" +
				workflowStepAsJson.hiddenArgs + "</div></td></tr></table>");
		args.find("a").click(function () {
			var link = $(this);
			var hiddenArgsDiv = link.parent().find("#hiddenArgs");
			if (hiddenArgsDiv.hasClass("inactive")) {
				hiddenArgsDiv.removeClass("inactive");
				link.text("- Hide hidden");
			} else {
				hiddenArgsDiv.addClass("inactive");
				link.text("+ Show hidden");
			}
		})
	}

	// Register for a row click to enable/disable (except the arguments column because of user click misses)
	newRow.click(function (e) {
		var $this = $(e.target);
		if ($this.is("td") && $this.attr('id') != "tdArguments" && $this.closest('tr[input-id]').length == 0) {
			$this = $this.closest("tr[data-step-id]");
		}
		if ($this.is("tr")) {
			$this.find("#chkEnable").click();
		}
	});
}

function WorkflowsMng_renderWorkflowStepInput(inputAsJson) {
	// Extract the input information 
	var inputId 						= inputAsJson.inputId;
	var inputName 						= inputAsJson.inputName;
	var inputDisplayName 				= inputAsJson.inputDisplayName;
	var inputType 						= inputAsJson.inputType;
	var inputSourceType					= inputAsJson.inputSourceType;
	var inputSource						= inputAsJson.inputSource;
	var inputCustomizedAttributeName	= inputAsJson.attachedCustomizedAttributeName;
	var hidden							= inputAsJson.hidden;
	var parserJSFunction				= inputAsJson.parserJSFunction;
	var dependentOnInputs				= inputAsJson.dependentOnInputs;
	var dependencyValues				= inputAsJson.dependencyValues;
	var allowEmpty						= inputAsJson.allowEmpty;
	var visibilityJSFunction			= inputAsJson.visibilityJSFunction;
	var validationJSFunction			= inputAsJson.validationJSFunction;

	// Evaluate parser JS function
	if (isStringEmpty(parserJSFunction)) {
		parserJSFunction = undefined;
	} else {
		eval("parserJSFunction = " + parserJSFunction);
	}

	// Evaluate visibility JS function
	var visibilityFuncHtml = "";
	if (isStringEmpty(visibilityJSFunction)) {
		visibilityJSFunction = undefined;
	} else {
		eval("visibilityJSFunction = " + visibilityJSFunction);
		visibilityFuncHtml = " data-visibility-function";
	}
	
	// Evaluate validation JS function
	var validationFuncHtml = "";
	if (isStringEmpty(validationJSFunction)) {
		validationJSFunction = undefined;
	} else {
		eval("validationJSFunction = " + validationJSFunction);
		validationFuncHtml = " data-validation-function";
	}

	// Generate input dependency attribute if there are any
	var dependentOnInputsAttr = "";
	if (dependentOnInputs != undefined && dependentOnInputs.length > 0) {
		dependentOnInputsAttr = " data-dependent-on-inputs='";
		for (var i = 0; i < dependentOnInputs.length; i++) {
			if (i > 0) {
				dependentOnInputsAttr += " ";
			}
			dependentOnInputsAttr += dependentOnInputs[i];
		}
		dependentOnInputsAttr += "'";
	}

	// Make dependency values attribute string
	var dependencyValuesAttr = "";
	if (!isStringEmpty(dependencyValues)) {
		dependencyValuesAttr = JSON.stringify(dependencyValues);
		dependencyValuesAttr = replaceAll(dependencyValuesAttr, "'", "\\'");
		dependencyValuesAttr = " data-dependency-values='" + dependencyValuesAttr + "'";
	}

	// Create the row element
	var displayState = "";
	if (hidden) {
		displayState = " class='inactive'";
	}
	var elementAsHtml = '<tr input-id="' + inputId + '" input-display-name ="' + inputDisplayName + 
		'" input-name ="' + inputName + '" input-customized-attribute-name ="' + inputCustomizedAttributeName +
		'" data-filter-ignore data-zebra-ignore' + displayState + dependentOnInputsAttr + dependencyValuesAttr +
		'><td style="border: 0px"><strong>';

	var width = 'style="min-width: 240px; max-width: 240px"';
	elementAsHtml += '<label>' + inputDisplayName + ':</label></strong></td><td id="tdInputValue" style="border: 0px">';

	// If we're on mobile, we shouldn't have autocomplete (since it's not supported in jQuery mobile)
	if (isMobile() && inputType == "SelectAutoComplete") {
		inputType = "Select";
	}

	var allowEmptyHtml = (allowEmpty ? " data-allow-empty" : "");

	switch (inputType) {
	case "Text":
	case "MultilineText":
		var elementId = 'txt' + inputId;
		var defaultValue = "";
		var tag;
		var closer;
		if (inputType == "Text") {
			tag = 'input type="text"';
			closer = ' />';
			if (inputAsJson.defaultValue != undefined) {
				// Replace " with &quot; in value because it's in HTML
				defaultValue = 'value="' + replaceAll(inputAsJson.defaultValue, "\"", "&quot;") + '"';
			}
		} else {
			tag = 'textarea';
			closer = '>' + (inputAsJson.defaultValue != undefined ? inputAsJson.defaultValue : '') + '</textarea>'

			// We want to let the text area expand if user moves the handle
			width = 'style="min-width: 240px; width: 240px"';
		}

		elementAsHtml += '<' + tag + ' step-input="true" id="' + elementId + '" ' + width + ' ' + defaultValue + allowEmptyHtml +
			visibilityFuncHtml + validationFuncHtml + closer;

		if (parserJSFunction != undefined) {
			elementAsHtml += '<br /><span data-parser data-id="' + inputId + '" '
			elementAsHtml += 'data-element-id="' + elementId + '"></span>';
			$("body").data('parserJSFunction_' + elementId, parserJSFunction);
		}

		if (visibilityJSFunction != undefined) {
			$("body").data('visibilityJSFunction_' + elementId, visibilityJSFunction);
		}

		if (validationJSFunction != undefined) {
			$("body").data('validationJSFunction_' + elementId, validationJSFunction);
		}

		break;

	case "File":
		var elementId = 'file' + inputId;
		var chooseFileAction =
			"chooseFile(function (fileName) {" +
				"var elem = $('#" + elementId + "');" +
				"elem.val(fileName);" +
				"elem.trigger('change');" +
			"});";
		elementAsHtml += '<button id="browse' + elementId + '" onclick="' + chooseFileAction + '">Browse</button>&nbsp;' +
			'<span onclick="' + chooseFileAction + '">' +
			'<input step-input="true" id="' + elementId + '" disabled="disabled" style="min-width: 200px; max-width: 200px" type="text"' +
				allowEmptyHtml + visibilityFuncHtml + validationFuncHtml + '/></span>';

		if (parserJSFunction != undefined) {
			elementAsHtml += '<br /><span data-parser data-id="' + inputId + '" '
			elementAsHtml += 'data-element-id="' + elementId + '"></span>';
			$("body").data('parserJSFunction_' + elementId, parserJSFunction);
		}

		if (visibilityJSFunction != undefined) {
			$("body").data('visibilityJSFunction_' + elementId, visibilityJSFunction);
		}

		if (validationJSFunction != undefined) {
			$("body").data('validationJSFunction_' + elementId, validationJSFunction);
		}

		break;

	case "MultiSelect":
	case "Select":
		var isMultiSelect = inputType == "MultiSelect";
		var elementId = 'slct' + inputId;
		var inputSourceInfoHtml = ' data-input-source-type="' + inputSourceType + '" data-input-source="' + inputSource + '" ';
		elementAsHtml += '<select step-input="true" id="' + elementId + '" style="width: 100%"' +
			inputSourceInfoHtml + allowEmptyHtml + visibilityFuncHtml + validationFuncHtml + (isMultiSelect ? ' multiple' : '') + '>';

		// Populate the values
		var ids = [];
		var values = [];
		switch (inputSourceType) {
			case "CustomizedValues":
				values = inputSource.split(";")
				break;

			case "SVN":
			case "Git":
			case "File":
			case "Folder":
			case "TestSuites":
			case "TestPlans":
			case "FastRuns":
			case "WebServerDirectoryListing":
			case "VirtualLabs":
			case "WorkflowPlans":
			case "Workflows":
			case "UserPackages":
			case "SuperUserPackages":
			case "AllowedPermutationsGroups":
				values = inputAsJson.itemsInInputSource.split(";");
				break;

			case "TestPlanExecutions":
				ids.push("");
				values.push("");
				var temp = inputAsJson.itemsInInputSource.split(";");
				for (var i = 0; i < temp.length; i++) {
					var idStartIndex = temp[i].lastIndexOf("[");
					var idEndIndex = temp[i].lastIndexOf("]");
					if (idStartIndex >= 0 && idEndIndex > idStartIndex) {
						values.push(temp[i].substring(0, idStartIndex).trim());
						ids.push(temp[i].substring(idStartIndex + 1, idEndIndex));
					}
				}
				break;

			default:
				break;
		}

		for (var valIndex = 0; valIndex < values.length; valIndex++) {
			var val = values[valIndex];

			// Parse internal => display patterns
			var internalVal = val;
			var displayVal = val;
			var arrowIndex = val.indexOf("=>");
			if (arrowIndex >= 0) {
				displayVal = val.substring(0, arrowIndex).trim();
				internalVal = val.substring(arrowIndex + 2).trim();
			}

			// If we have something in the IDs array, the internal value should be different
			if (valIndex < ids.length) {
				internalVal = ids[valIndex];
			}

			// Default value
			var selected = "";
			if (inputAsJson.defaultValue != undefined && val == inputAsJson.defaultValue) {
				selected = "selected";
			}

			elementAsHtml += '<option value="' + internalVal + '" ' + selected + '>' + displayVal + '</option>';
		}

		elementAsHtml += '</select>';

		if (parserJSFunction != undefined) {
			elementAsHtml += '<br /><span data-parser data-id="' + inputId + '" ' + width;
			elementAsHtml += ' data-element-id="' + elementId + '"></span>';
			$("body").data('parserJSFunction_' + elementId, parserJSFunction);
		}

		if (visibilityJSFunction != undefined) {
			$("body").data('visibilityJSFunction_' + elementId, visibilityJSFunction);
		}

		if (validationJSFunction != undefined) {
			$("body").data('validationJSFunction_' + elementId, validationJSFunction);
		}

		break;

	case "SelectAutoComplete":
		var elementId = 'txt' + inputId;

		// Populate the values
		var values;
		switch (inputSourceType) {
			case "CustomizedValues":
				values = inputSource;
				break;
			case "SVN":
			case "Git":
			case "File":
			case "Folder":
			case "TestSuites":
			case "TestPlans":
			case "FastRuns":
			case "WebServerDirectoryListing":
			case "VirtualLabs":
			case "WorkflowPlans":
			case "Workflows":
			case "UserPackages":
			case "SuperUserPackages":
			case "AllowedPermutationsGroups":
				values = inputAsJson.itemsInInputSource;
				break;
			default:
				values = "";
				break;
		}

		var defaultValue = "";
		if (inputAsJson.defaultValue != undefined) {
			defaultValue = ' value="' + inputAsJson.defaultValue + '"';
		}

		var inputSourceInfoHtml = ' data-input-source-type="' + inputSourceType + '" data-input-source="' + inputSource + '" ';
		elementAsHtml += 
			'<input step-input="true" id="' + elementId + '" input-type="auto-complete" auto-complete-data="' + values + '" ' +
				inputSourceInfoHtml + width + defaultValue + allowEmptyHtml + visibilityFuncHtml + ' />';

		if (parserJSFunction != undefined) {
			elementAsHtml += '<br /><span data-parser data-id="' + inputId + '" ' + width;
			elementAsHtml += ' data-element-id="' + elementId + '"></span>';
			$("body").data('parserJSFunction_' + elementId, parserJSFunction);
		}

		if (visibilityJSFunction != undefined) {
			$("body").data('visibilityJSFunction_' + elementId, visibilityJSFunction);
		}

		if (validationJSFunction != undefined) {
			$("body").data('validationJSFunction_' + elementId, validationJSFunction);
		}

		break;

	case "Checkbox":
		var elementId = 'chk' + inputId;
		var checked = "";
		if (inputAsJson.defaultValue == "true") {
			checked = " checked";
		}
		elementAsHtml += '<input type="checkbox" step-input="true" id="' + elementId + '" ' + width + checked +
			allowEmptyHtml + visibilityFuncHtml + validationFuncHtml + ' />';

		if (visibilityJSFunction != undefined) {
			$("body").data('visibilityJSFunction_' + elementId, visibilityJSFunction);
		}

		if (validationJSFunction != undefined) {
			$("body").data('validationJSFunction_' + elementId, validationJSFunction);
		}

		break;

	default:
		console.error('Unknown input type [' + inputType + ']');
		return;
	}

	elementAsHtml += '</td></tr>';

	return elementAsHtml;
}

function WorkflowsMng_renderWorkflowStepInputs(stepInputs, newRow, context, autoFillIdenticalInputs) {
	// Disable only if there's no workflow plan ID, which means we're not in the workflow plans page
	var disableInputs = ($("#hdnWorkflowPlanId").length == 0);

	// The element that represents the arguments
	var argumentsColumnAsHtml = '';
	
	// Iterate over the step inputs
	var inputIds = stepInputs.inputIds;
	var inputIndex = 0;
	for (inputIndex = 0; inputIndex < inputIds.length; inputIndex++) {
		// Extract the current input id
		var inputId = inputIds[inputIndex];
		
		// Extract the input as json
		var inputAsJson = stepInputs[inputId];

		// Render the input column
		var argumentAsHtml = WorkflowsMng_renderWorkflowStepInput(inputAsJson);
		if (!isStringEmpty(argumentAsHtml)) {
			// No new line before this input, but make sure we have at least one row
			if (inputAsJson.noNewLineBefore && !isStringEmpty(argumentsColumnAsHtml)) {
				// Close the current table, open a new one, and close after the argument
				argumentsColumnAsHtml += "</table><table style='display: inline-block'>" + argumentAsHtml + "</table>";
			} else {
				// If there's a next step and it has noNewLineBefore set to true, close the current table, so we won't be dependent
				// on previous rows for the size of elements on this row
				if (inputIndex + 1 < inputIds.length && stepInputs[inputIds[inputIndex + 1]].noNewLineBefore) {
					argumentsColumnAsHtml += "</table>";
				}

				// If we're in the first input, open a table
				// If it's not the first input but we are not in a table (because the previous input had noNewLineBefore set to true, go down a line
				if (argumentsColumnAsHtml.length < 8 || argumentsColumnAsHtml.substring(argumentsColumnAsHtml.length - 8) == "</table>") {
					if (!isStringEmpty(argumentsColumnAsHtml)) {
						argumentsColumnAsHtml += "<br/>";
					}
					argumentsColumnAsHtml += "<table style='display: inline-block'>";
				}

				// Append the row here
				argumentsColumnAsHtml += argumentAsHtml;
			}
		}
	}
	if (!isStringEmpty(argumentsColumnAsHtml)) {
		argumentsColumnAsHtml += "</table>";
	}

	if (!isStringEmpty(argumentsColumnAsHtml)) {
		// Attach the arguments column
		var tdArgs = newRow.find('#tdArguments');
		tdArgs.html(argumentsColumnAsHtml);

		// Find tables with only inactive rows, and make them hidden too
		tdArgs.find("table").each(function () {
			var table = $(this);
			if (table.find("[input-id]").length == table.find(".inactive[input-id]").length) {
				table.css('display', 'none')
			}
		});

		$(function () {
			var shouldAutofillInput = function (inputName) {
				var stepOperationType = newRow.attr('data-step-operation-type');
				if (stepOperationType == 'TestPlanSending') {
					if (inputName == 'testPlanName' || inputName == 'testSuiteName' || inputName == 'isBroadcast' || inputName == 'isEndless') {
						return false;
					}
				}
				return true;
			};

			// Iterate over the auto complete inputs and populate them
			newRow.find('input[input-type="auto-complete"]').each(function() {
				$(this).autocomplete({
					select: function( event, ui ) {
						// Search for other inputs with the same name and modify them, if we need to
						var inputName = $(this).closest('tr').attr('input-name');
						if (autoFillIdenticalInputs && shouldAutofillInput(inputName)) {
							var inputValue = ui.item.value;
							var workflowSteps = $('#tblWorkflowSteps tbody[id^="tbodyWorkflowSteps"]');
							workflowSteps.find('tr[input-name="' + inputName + '"]').each(function() {
								var curInput = $(this).find('input, select');
								curInput.val(inputValue);

								// Trigger change for parser handler
								curInput.trigger("change");
							});
						}

						// Trigger change for parser handler
						$(this).trigger("change");
					},
					source: $(this).attr('auto-complete-data').split(';'),
					minLength: 0,
				}).on('focus', function () {
				    $(this).autocomplete('search', '');
				});
				
				$(this).attr('auto-complete-data', '');
			});

			// Search for other inputs with the same name and modify them, if we need to
			if (autoFillIdenticalInputs) {
				newRow.find('input[type="text"], select, textarea').each(function() {
					// Check if visible by checking if we're in hiddenArgs
					var input = $(this);
					if (input.closest("div#hiddenArgs").length > 0 || input.closest("tr[input-id]").hasClass("inactive")) {
						return;
					}

					var inputName = input.closest("tr").attr('input-name');
					if (!shouldAutofillInput) {
						return;
					}

					input.change(function (event, ui) {
						// Extract input name and value
						var inputValue = input.val();

						var workflowSteps = $('#tblWorkflowSteps tbody[id^="tbodyWorkflowSteps"]');
						workflowSteps.find('tr[input-name="' + inputName + '"]').each(function() {
							var curInput = $(this).find('input, select');
							curInput.each(function () {
								if (curInput.is(input) || curInput.data('visitedAutoFill') === true) {
									return;
								}

								if (getValueFromElement(curInput) != inputValue) {
									setValueOfElement(curInput, inputValue);

									// Trigger change for parser handler
									curInput.data('visitedAutoFill', true);
									curInput.trigger("change");
									curInput.removeData('visitedAutoFill');
								}
							})
						});
					});
				});
			}

			// Check if the input is found in the context - if found - set the value & disable the input
			newRow.find('input, select, textarea').each(function() {
				var inputName = $(this).closest('tr').attr('input-name');

				// workflowName is in the context, but we don't want to apply it
				if (!isStringEmpty(inputName) && inputName != "workflowName") {
					// Try unprased first, it might exist
					var inputValue;
					if (context.unparsed != undefined && context.unparsed[inputName] != undefined) {
						inputValue = context.unparsed[inputName];
					} else {
						inputValue = context[inputName];
					}

					// Check if this input name was visited already, to support multiple inputs with the same name
					// Only take the value if it exists
					if (context.visitedInputNames != undefined && context.visitedInputNames[inputName] != undefined) {
						var tmpValue = undefined;
						var currentInputName = inputName + "[" + context.visitedInputNames[inputName] + "]";
						if (context.unparsed != undefined && context.unparsed[currentInputName] != undefined) {
							tmpValue = context.unparsed[currentInputName];
						} else {
							tmpValue = context[currentInputName];
						}
						if (tmpValue != undefined) {
							inputValue = tmpValue;
						}
					}

					// Store that this input name was visited (might be visited more than once)
					if (context.visitedInputNames == undefined) {
						context.visitedInputNames = new Object();
					}
					if (context.visitedInputNames[inputName] == undefined) {
						context.visitedInputNames[inputName] = 0;
					}
					context.visitedInputNames[inputName]++;

					if (!isStringEmpty(inputValue)) {
						var input = $(this);
						if (input.is("select") && (disableInputs || getValueFromElement(input) == "")) {
							if (input.is("[multiple]")) {
								inputValue = inputValue.split(",");
								if (disableInputs) {
									var html = "";
									for (var i = 0; i < inputValue.length; i++) {
										html += "<option value='" + inputValue[i] + "'>" + inputValue[i] + "</option>";
									}
									input.html(html);
								}
							} else {
								// Make only one option with the value, and select the value. Since it's disabled or have no value, it doesn't matter
								var displayName = context[inputName + ".displayName"];
								if (isStringEmpty(displayName)) {
									displayName = inputValue;
								}
								input.html("<option value='" + inputValue + "'>" + displayName + "</option>");
							}
						}

						// Set value
						setValueOfElement(this, inputValue);

						// Disable if need to
						if (disableInputs) {
							input.attr('disabled', 'disabled');
							input.data('final', true);
						}
					}
				}
			});

			// Set parsers on value changes and activate them on non empty fields
			// Relevant to predefined fields (see versionParsers in WorkflowsMng_renderWorkflowStepInput)
			newRow.find('span[data-parser]').each(function() {
				var span = $(this);
				var elementId = span.attr('data-element-id');
				var elem = $("#" + elementId);
				var parseElement = function () {
					var elementValue = getValueFromElement(elem);
					if (elementValue != undefined && elementValue.length > 0) {
						var parserFunction = $("body").data('parserJSFunction_' + elementId);
						var parsed = parserFunction(elementValue);
						if (parsed == undefined) {
							parsed = { parsedFieldName: "Parsed", parsedValue: "" };
						}
						var inputId = span.attr("data-id");
						var parsedInputHtml = "<input type='text' id='parsedVersion" + inputId + "' value='" + parsed.parsedValue + "'";
						var isDisabled = elem.attr('disabled') == 'disabled';

						// If file input, then disabled should be determined by the browse button
						if (elem.attr('id').indexOf("file") == 0) {
							isDisabled = elem.parent().find("button[id^='browse']").attr('disabled') == 'disabled';
						}

						if (isDisabled) {
							parsedInputHtml += " disabled='disabled'";
						}
						parsedInputHtml += "></input>";
						span.html("<table><tr><td style='border: 0px'>&nbsp;" + parsed.parsedFieldName +
								": </td><td style='border: 0px'>" + parsedInputHtml + "</td></tr></table>");
					} else {
						span.text("");
					}
				};
				elem.change(parseElement);
				parseElement();
			});

			// Trigger visibility/validation function of all inputs in the step when one step value changes
			var visibilityValidationUpdate = function() {
				// Extract current values for all fields
				var $this = $(this);
				var values = new Object();
				$this.closest("#tdArguments").find("input, select, textarea").each(function () {
					var input = $(this);
					var isParsed = input.closest("span[data-parser]").length > 0;
					var value = getValueFromElement(input);
					if (!isStringEmpty("" + value)) {
						var inputName = input.closest("[input-name]").attr('input-name');
						if (isParsed) {
							inputName += ".parsed";
						}
						values[inputName] = value;
					}
				});

				newRow.find("[data-visibility-function]").each(function () {
					var $this = $(this);
					var elementId = $this.attr('id');
					var func = $("body").data("visibilityJSFunction_" + elementId);
					if (func != undefined) {
						var result = func(values);
						if (result) {
							$this.closest("tr").removeClass("inactive");
						} else {
							$this.closest("tr").addClass("inactive");
						}
					}
				});

				if ($this.is('[data-validation-function]') && $this.data('visitedValidation') !== true) {
					// Check validation
					var elementId = $this.attr('id');
					var func = $("body").data("validationJSFunction_" + elementId);
					if (func != undefined) {
						var result = func(values);
						var message = "Invalid input";
						if (typeof result == 'string') {
							message = result;
						}
						if (result != undefined && result !== true && result !== "") {
							// Validation failed
							$this.data("visitedValidation", true);
							if ($this.is("[type='checkbox']")) {
								$this.prop("checked", !$this.prop("checked")).change();
							} else {
								setValueOfElement($this, "");
								$this.change();
							}
							UIUtility_showAlert(message, "Invalid input");
							$this.removeData("visitedValidation");
						}
					}
				}
			};
			newRow.find('input, select').not("input[type='text']").change(visibilityValidationUpdate).trigger('change');
			newRow.find('input[type="text"], textarea').focusout(visibilityValidationUpdate).trigger('focusout');

			// Trigger dependencies between input values
			newRow.find('tr[data-dependent-on-inputs]').each(function() {
				var tr = $(this);
				var args = tr.closest("#tdArguments");
				var dependentOnInputs = tr.attr('data-dependent-on-inputs').split(" ");

				var handler = function () {
					// Set timeout because we want the field to be set before we try to read it
					setTimeout(function () {
						// When a dependent input change, check if all dependencies exist
						var values = new Object();
						for (var j = 0; j < dependentOnInputs.length; j++) {
							var value = getValueFromElement(args.find("[input-name='" + dependentOnInputs[j] + "']").find("input, select"));
							if (isStringEmpty("" + value)) {
								// Not enough data yet
								return;
							} else {
								values[dependentOnInputs[j]] = value;
							}
						}

						// All data exists, request for input source and render field again
						WorkflowsMng_GetStepInputPossibleValues(tr.attr('input-id'), values, function (input) {
							var newTR = $(WorkflowsMng_renderWorkflowStepInput(input));

							// Autocomplete input
							var existingInput = tr.find("input[auto-complete-data]");
							newTR.find("input[auto-complete-data]").each(function () {
								var acData = $(this).attr('auto-complete-data');
								var existingValue = getValueFromElement(existingInput);
								existingInput.attr('auto-complete-data', acData)
									.val('').autocomplete("option", "source", acData.split(";"));

								// Set previous value if exists in the new data source
								if (acData.split(";").indexOf(existingValue) != -1) {
									existingInput.val(existingValue);
								}
							});

							// Select
							var existingSelect = tr.find("select");
							newTR.find("select").each(function () {
								// Get existing value
								var options = existingSelect.find("option");
								var existingValue = undefined;
								var selectedOption = options.find("[selected]");
								if (selectedOption.length > 0) {
									existingValue = selectedOption.text();
								}

								// Remove all options and set new values
								options.remove();
								existingSelect.append($(this).html());

								// Set previous value if exists in the new data source
								if (existingValue != undefined) {
									existingSelect.val(exitingValue);
								}
							});
							existingSelect.trigger("change");
						});
					}, 1);
				};

				// Go over dependent inputs
				for (var i = 0; i < dependentOnInputs.length; i++) {
					// Set change handler
					args.find("[input-name='" + dependentOnInputs[i] + "']").find("input[auto-complete-data], select").not("[disabled]").change(handler);
				}
			});

			// Make super user packages trigger a change in the sub packages inputs
			newRow.find("[data-input-source-type='SuperUserPackages']").change(function () {
				var input = $(this);
				GetWithFeedbackFuncs(
					'/packages/' + input.attr('data-input-source') + '/' + getValueFromElement(input),
					function (res) {
						try {
							var jsonResponse = JSON.parse(res);
							var tdArgs = input.closest("#tbodyWorkflowSteps").find("[id='tdArguments']")
							for (var i = 0; i < jsonResponse.packageContents.length; i++) {
								var name = jsonResponse.packageContents[i].name;
								var source = jsonResponse.packageContents[i].source;
								if (source == undefined) {
									continue;
								}
								var setInput = function (name, source) {
									var url = source.url;
									var lastSlashIndex = url.lastIndexOf("/");
									var value = url.substring(lastSlashIndex + 1);
									tdArgs.find("[input-name='" + name + "']").find("input, select").each(function () {
										var subPackageInput = $(this);
										setValueOfElement(subPackageInput, value);
									});
								}

								if (source.type == "user package") {
									// Get real data from server
									GetWithFeedbackFuncs(
											'/packages/' + source.url,
											function (res2) {
												try {
													var jsonResponse2 = JSON.parse(res2);
													for (var j = 0; j < jsonResponse2.packageContents.length; j++) {
														var name2 = jsonResponse2.packageContents[j].name;
														var source2 = jsonResponse2.packageContents[j].source;
														if (source2 == undefined) {
															continue;
														}
														setInput(name2, source2);
													}
												} catch (ex) {
													console.error("Can't parse: " + res);
												}
											},
											function (res) {
												UIUtility_showAlert("Failed to get internal package contents", "Error");
											});
								} else {
									setInput(name, source);
								}
							}
						} catch (ex) {
							console.error("Can't parse: " + res);
						}
					},
					function (res) {
						UIUtility_showAlert("Failed to get package contents", "Error");
					});
			});

			// Select boxes have a default value, lets simulate an actual selection so if there are dependent
			// inputs, they will respond. Do it on hidden selects too so they'll have an initial value
			newRow.find('select').trigger("change");
		});
	}
}

function WorkflowsMng_SetValues(values) {
	$('#tblWorkflowSteps tbody[id^="tbodyWorkflowSteps"] #tdArguments').find('input, select, textarea').each(function() {
		var input = $(this);
		if (input.closest("div#hiddenArgs").length > 0) {
			return;
		}

		var trInput = input.closest('tr');
		var inputName = trInput.attr('input-name');
		if (!isStringEmpty(inputName) && input.data('final') != true && input.is(":visible")) {
			var inputValue = values[inputName];
			if (!isStringEmpty("" + inputValue)) {
				setValueOfElement(this, inputValue);
				input.trigger("change");
			}
		}
	});
}

function WorkflowsMng_showRunWorkflowStatus() {
	// Show the notification
	$('#tdRunWorkflowStatus').attr('class', '');
	
	var selectedEffect 	= 'slide';
	var options		 	= {};

	IsWorkflowRunStatusToggled = !IsWorkflowRunStatusToggled;
}

function WorkflowsMng_updatePassedAgents(passedAgents) {
	// Sort
	passedAgents.sort(passedAgents);

	// Set in element
	var passedAgentsElem = $("#passedAgents");
	passedAgentsElem.data('passedAgents', passedAgents);
	if (passedAgents.length == 0) {
		passedAgentsElem.text("None");
	} else {
		passedAgentsElem.text(arrToString(passedAgents, ", ", ""));
	}

	// For closed loop, hide skip and show next in case there are passed agents, or oppositte
	if (isClosedLoop()) {
		if (passedAgents.length == 0) {
			$('#tdSkip').removeClass('inactive');
			$('#tdNext').addClass('inactive');
		} else {
			$('#tdSkip').addClass('inactive');
			$('#tdNext').removeClass('inactive');
			$('#btnNext').addClass('LMMainButton');
			$('#btnRunWorkflow').removeClass('LMMainButton');
		}
	}
}

function WorkflowsMng_validate(workflowInfo, cont) {
	// Show waiting dialog
	UIUtility_showAlert("Please wait ...", "Loading Validation")

	// Load information
	WorkflowsMng_getValidationInfo(workflowInfo.requestAsJson.agentNames, $("#hdnWorkflowId").val(), function (data) {
		data.agentsSetupParameters.sort();

		// Create agents setup parameters table header
		var html = "<h4 style='margin-top: 5px; margin-bottom: 10px'>Setup Parameters</h4><table class='hor-minimalist-d'><thead><tr><th>Agent</th>";
		for (var i = 0; i < data.agentsSetupParameters.length; i++) {
			html += "<th>" + data.agentsSetupParameters[i] + "</th>";
		}

		// Create agents setup parameters table body
		html += "</head></tbody>";
		for (var i = 0; i < workflowInfo.requestAsJson.agentNames.length; i++) {
			var agentName = workflowInfo.requestAsJson.agentNames[i];
			html += "<tr><td>" + agentName + "</td>";
			for (var j = 0; j < data.agentsSetupParameters.length; j++) {
				var setupParamValue = data.agentsSetupParameterValues[agentName][data.agentsSetupParameters[j]];
				html += "<td>" + (setupParamValue == undefined ? "-" : setupParamValue) + "</td>";
			}
			html += "</tr>";
		}
		html += "</tbody></table>";

		// Add inputs of enabled steps to validation
		var addedInput = false;
		var enabledSteps = workflowInfo.requestAsJson.enabledSteps;
		var workflowContent = WorkflowsMng_getWorkflowContent();
		for (var step = 0; step < enabledSteps.length; step++) {
			var addedInputForStep = false;
			var inputs = enabledSteps[step].stepInputs;
			for (var i = 0; i < data.inputIdsToValidate.length; i++) {
				for (var j = 0; j < inputs.length; j++) {
					if (inputs[j].stepInputId == data.inputIdsToValidate[i]) {
						if (!addedInput) {
							// First input, add header
							html += "<h4 style='margin-bottom: 0px'>Workflow Inputs</h4><div style='margin-left: 10px'><table>";
							addedInput = true;
						}

						if (!addedInputForStep) {
							// Add step name before inputs of this step
							var stepName = workflowContent.workflowSteps[parseInt(enabledSteps[step].workflowStepId)].stepName;
							html += "<tr><td colspan='2'><h5 style='margin-top: 10px; margin-bottom: 5px'>" + stepName + "</h5></td></tr>";
							addedInputForStep = true;
						}

						html += "<tr><td>&nbsp;&nbsp;&nbsp;" + $("tr[input-id='" + inputs[j].stepInputId + "'] > td:eq(0)").text()
								+ "</td><td style='padding-left: 5px'>" + inputs[j].stepInputValue;
						if (inputs[j].parsedValue != undefined) {
							html += "(" + inputs[j].parsedValue + ")";
						}
						html += "</td></tr>";
					}
				}
			}
		}
		html += "</div>";

		// Take 4/5 of the screen for dialog
		var width = Math.floor(window.innerWidth * (4.0 / 5));
		var height = Math.floor(window.innerHeight * (4.0 / 5));
		UIUtility_showConfirmDialog(html, "Workflow Validation", function () { cont(); }, width, height);

		// Remove waiting dialog
		$("#alertDialog").dialog("destroy").remove();
	});
}

/** javascripts/workflows/WorkflowsMonitoringRenderHelper.js **/
var WorkflowsMonitoring_HostStatuses = {} 

function WorkflowsMonitoring_initializeButtons() {
	UIUtility_initializeButton('btnViewWorkflowRun'	, 'ui-icon-zoomin');
	UIUtility_initializeButton('btnStopWorkflowRun'	, 'ui-icon-stop');
	UIUtility_initializeButton('btnDeleteQueuedWorkflow', 'ui-icon-trash');
	UIUtility_initializeButton('btnAttachToTask', 'ui-icon-link');
	UIUtility_initializeButton('btnSearchHistory'	, 'ui-icon-search');

	UIUtility_setButtonPadding('btnViewWorkflowRun');
	UIUtility_setButtonPadding('btnStopWorkflowRun');
	UIUtility_setButtonPadding('btnDeleteQueuedWorkflow');
	UIUtility_setButtonPadding('btnAttachToTask');

	// Initiailize next/previous buttons
	UIUtility_initializeButton("btnViewNextWorkflow", "ui-icon-arrowthick-1-w");
	UIUtility_initializeButton("btnViewPreviousWorkflow", "ui-icon-arrowthick-1-e");
}

function WorkflowsMonitoring_renderInputs(workflowRunDataAsJson) {
	// Inputs toggle
	UIUtility_initializeButton("toggleInputs", "ui-icon-plus");
	$("#toggleInputs").click(function () {
		var button = $(this);
		var table = button.parent().find("table:eq(0)");
		UIUtility_initializeButton('toggleInputs', (table.css('display') == 'none' ? 'ui-icon-minus' : 'ui-icon-plus'));
		table.toggle();
	});

	// Get some agent name
	var randomAgentName = Object.keys(workflowRunDataAsJson.hostsSteps)[0];

	var subSectionTemplate = '<div class="LMContentSection LMBorderedSection LMVerticalInsetSection">' +
		'<div class="LMSectionSubHeader LMSectionHeaderClickable">HEADER</div><div class="LMInsetSection">CONTENT</div>';
	var div = $("<div></div>");
	for (var i = 0; i < workflowRunDataAsJson.stepInputs.length; i++) {
		var stepInputs = workflowRunDataAsJson.stepInputs[i];

		// Skip step's inputs if it's skipped
		if (workflowRunDataAsJson.hostsSteps[randomAgentName][stepInputs.workflowStepId].stepStatus == "SKIPPED") {
			continue;
		}

		// Get all input names without workflowStepId and sort them
		inputNames = Object.keys(stepInputs);
		inputNames.splice(inputNames.indexOf("workflowStepId"), 1);
		inputNames.sort();

		if (inputNames.length > 0) {
			var stepName = workflowRunDataAsJson.workflowData.workflowSteps[stepInputs.workflowStepId].stepName;

			var content = "<table>";
			for (var j = 0; j < inputNames.length; j++) {
				var inputName = inputNames[j];

				// Add input
				var value = stepInputs[inputName].value;
				if (!isStringEmpty(stepInputs[inputName].parsedValue)) {
					value += " (" + stepInputs[inputName].parsedValue + ")";
				}
				content += "<tr><th style='padding-left: 10px; text-align: left;'>" + stepInputs[inputName].displayName + ":</th><td>" + value + "</td></tr>";
			}
			content += "</table>";
			div.append("<div>" + subSectionTemplate.replace("HEADER", stepName).replace("CONTENT", content) + "</div>");
		}
	}

	// Add if not empty
	$("#inputsContainer").remove();
	if (div.find("div").length > 0) {
		var section = '<div class="LMContentSection LMBorderedSection" style="min-width: 100%; margin-top: 20px;" id="inputsContainer">' +
			'<div class="LMSectionHeader LMSectionHeaderClickable">Inputs</div><div class="LMInsetSection inactive">' + div.html() + '</div>';
		$('#tblWorkflowHeader').after(section);

		// Header functionality
		$(".LMSectionHeader, .LMSectionSubHeader").each(setSectionToggle);
	}
}

function WorkflowsMonitoring_calculateETA(statistics) {
	// Find earliest in progress
	var firstInProgressIndex = Number.MAX_VALUE;
	var agentRow = undefined;
	var agentRows = $('#tblWorkflowRunHostsSteps tbody [data-agent-name]');
	agentRows.each(function () {
		var row = $(this);
		var firstInProgress = $(this).find("[step-status='INPROGRESS']:eq(0)");
		if (firstInProgress.length > 0) {
			var index = firstInProgress.index();
			if (index < firstInProgressIndex) {
				firstInProgressIndex = index;
				agentRow = row;
			}
		}
	});
	if (firstInProgressIndex == Number.MAX_VALUE) {
		return "N/A";
	}

	// Go through all columns after the step including the step
	var minETASecs = 0;
	var maxETASecs = 0;
	agentRow.find("> :gt(" + (firstInProgressIndex - 1) + ")").each(function () {
		// Look for statistics object for this column's step id
		var tdElem = $(this);
		var stepId = tdElem.attr('step-id');
		var statObj = undefined;
		for (var i = 0; i < statistics.length; i++) {
			if (statistics[i].stepId == stepId) {
				statObj = statistics[i];
				break;
			}
		}

		// If found, add to ETA vars
		var stepStatus = tdElem.attr("step-status");
		if (stepStatus == "INPROGRESS" || stepStatus == "ABORTING" || stepStatus == "IDLE") {
			if (statObj == undefined) {
				return { };
			} else {
				if (stepStatus == "IDLE") {
					// Didn't run yet, add whole step time
					minETASecs += statObj.minTimeInSecs;
					maxETASecs += statObj.maxTimeInSecs;
				} else {
					// Calculate how much percentage was completed
					var startTime = parseInt(tdElem.attr('step-raw-start-time'));
					var now = new Date().getTime();
					var avgStepTimeSecs = (statObj.minTimeInSecs + statObj.maxTimeInSecs) / 2;
					var completedPercentage = 1;
					if (avgStepTimeSecs > 0) {
						completedPercentage = ((now - startTime) / 1000) / avgStepTimeSecs;
						if (completedPercentage > 1) {
							completedPercentage = 1;
						}
					}
	
					// Add time
					minETASecs += Math.round((1 - completedPercentage) * statObj.minTimeInSecs);
					maxETASecs += Math.round((1 - completedPercentage) * statObj.maxTimeInSecs);
				}
			}
		}
	});

	if (minETASecs < 0) {
		minETASecs = 0;
	}
	if (maxETASecs < 0) {
		maxETASecs = 0;
	}

	return { minETASecs: minETASecs, maxETASecs: maxETASecs };
}

function WorkflowsMonitoring_renderWorkflowRun(workflowRunDataAsJson) {
	// Scroll container left in case it's already scrolled
	$("#workflowRunContent .LMHorizontalOverflowContainer").scrollLeft(0);

	// Fill the workflow name & start time & complete time
	var workflowHeader = $('#tblWorkflowHeader');
	workflowHeader.find('#tdWorkflowName').html(workflowRunDataAsJson.workflowData.workflowName);
	workflowHeader.find('#tdWorkflowStartTime').html(workflowRunDataAsJson.workflowStartTime);
	var endTime = workflowRunDataAsJson.workflowCompleteTime;
	if (isStringEmpty(endTime)) {
		endTime = "-";
	}
	workflowHeader.find('#tdWorkflowCompleteTime').html(endTime);
	workflowHeader.find('#tdWorkflowETA').html("-");
	workflowHeader.find("#tdWorkflowSubmitter").html(workflowRunDataAsJson.submitter)

	// Remove all input rows from before if there are any
	workflowHeader.find("tr[id='inputsContainer']").remove();

	// Add inputs
	if (workflowRunDataAsJson.stepInputs != undefined) {
		WorkflowsMonitoring_renderInputs(workflowRunDataAsJson);
	}

	// Reset the host statuses
	WorkflowsMonitoring_resetHostStatistics();

	// Get the workflow run hosts-steps table
	var tblWorkflowRunHostsSteps = $('#tblWorkflowRunHostsSteps');

	// Clear the header & body
	tblWorkflowRunHostsSteps.find('thead').html('');
	tblWorkflowRunHostsSteps.find('tbody').html('');
	
	// Extract the workflow data
	var workflowData = workflowRunDataAsJson.workflowData;
	
	// Update the hidden html input that indicates: an active workflow is in view
	$('#hdnActiveWorkflowRunId').val(workflowRunDataAsJson.workflowRunId);

	// Update URL bar with the current workflow run, so a refresh or copy of the link will open this workflow
	window.history.replaceState(undefined, "Workflows Monitoring: " + workflowRunDataAsJson.workflowData.workflowName,
			'/tasks/DisplayWorkflowRuns?workflowRunId=' + workflowRunDataAsJson.workflowRunId);

	// Extract the workflow step ids
	var workflowStepIds = workflowData.workflowSteps.workflowStepIds;

	// The thead as html
	var statsAsHtml = '<th></th>';
	var colNamesAsHtml = '<th>Agent / Step</th>';

	// Data row to be used in each host
	var dataRowAsHtml = '<th id="thHostIP"></th>';

	// Iterate over the steps to build the columns
	tblWorkflowRunHostsSteps.data('hasHostSteps', false);
	for (var stepIdIndex = 0; stepIdIndex < workflowStepIds.length; stepIdIndex++) {
		// The workflow step id
		var workflowStepId = workflowStepIds[stepIdIndex];
		
		// Extract the workflow step
		var workflowStep = workflowData.workflowSteps[workflowStepId];

		// Empty statistics
		var sharedCss = "min-width: 30px; max-width: 30px; display: inline-block; text-align: center;";
		var stepStats = "<span data-pass style='background-color: green; color: white; " + sharedCss + "'>-</span>";
		stepStats += "<span data-fail style='background-color: red; color: white; margin-left: 3px; " + sharedCss + "'>-</span>";
		stepStats += "<span data-other style='background-color: gray; color: white; margin-left: 3px; " + sharedCss + "'>-</span><br/>";
		statsAsHtml += '<th data-header-workflow-step-id="' + workflowStepId + '">' + stepStats + '</th>';

		// Prefix for where the step runs
		var stepPrefix;
		if (workflowStep.stepType == "Agent") {
			stepPrefix = "<span style='color: blue'>(A)</span><br />";
		} else if (workflowStep.stepType == "Host") {
			stepPrefix = "<span style='color: blue'>(H)</span><br />";
		} else {
			stepPrefix = "<span style='color: blue'>(LM)</span><br />";
		}

		// If this is a host step, save in the table that there are host steps
		if (workflowStep.stepType != "Agent") {
			tblWorkflowRunHostsSteps.data('hasHostSteps', true);
		}

		// Append the column to the header
		colNamesAsHtml += '<th style="min-width: 130px; max-width: 130px; word-break: break-word;">' + stepPrefix + workflowStep.stepName + '</th>';

		// Prepare a data row to be used in each agent
		dataRowAsHtml += '<td align="center" id="' + workflowStep.workflowStepId + '" title=""></td>';
	}

	// Append the header
	tblWorkflowRunHostsSteps.find('thead').html("<tr>" + statsAsHtml + "</tr><tr>" + colNamesAsHtml + "</tr>");
	
	// Extract the host ips
	var hostIps = workflowRunDataAsJson.hostIps;
	
	// Update the number of hosts
	$('#tblHostsStatistics').find('#tdTotalNumOfHosts').html(hostIps.length);
	
	// Store a list of host ips that include at least one failed step - this list will be used to sign the not started steps as discarded
	var failedHostIps = new Array();

	// Calculate agents count and names per IP for host steps
	var agentsByHostIp = new Object();
	for (var i = 0; i < hostIps.length; i++) {
		var hostIp = extractIPFromAgentName(hostIps[i]);
		var agents = agentsByHostIp[hostIp];
		if (agents == undefined) {
			agents = new Array();
			agentsByHostIp[hostIp] = agents;
		}
		agents.push(hostIps[i]);
	}

	// For every host step, make sure the status of the first agent is the relevant one from all the agents
	// More specifically, if there's a status which is not Discarded, take it
	for (var hostIp in agentsByHostIp) {
		var firstAgent = agentsByHostIp[hostIp][0];
		var firstAgentSteps = workflowRunDataAsJson.hostsSteps[firstAgent];

		// Go through all steps
		for (var stepIdIndex = 0; stepIdIndex < workflowStepIds.length; stepIdIndex++) {
			// Check that the step of the first agent is a host step, and that it's discarded (status should be taken from others)
			var workflowStepId = workflowStepIds[stepIdIndex];
			if (!firstAgentSteps[workflowStepId].runOnAgent && firstAgentSteps[workflowStepId].stepStatus == 'IDLE') {
				// Check all agents
				var agentNames = agentsByHostIp[hostIp];
				for (var i = 1; i < agentNames.length; i++) {
					var hostStepsAsJson = workflowRunDataAsJson.hostsSteps[agentNames[i]];
					var workflowStep = hostStepsAsJson[workflowStepId];
					if (workflowStep.stepStatus != 'IDLE') {
						// Replace first step
						firstAgentSteps[workflowStepId] = workflowStep;
						break;
					}
				}
			}
		}
	}

	// For every LM step, make sure the status of the first agent is the relevant one from all the agents
	// More specifically, if there's a status which is not Discarded, take it
	var firstAgentSteps = workflowRunDataAsJson.hostsSteps[hostIps[0]];
	for (var stepIdIndex = 0; stepIdIndex < workflowStepIds.length; stepIdIndex++) {
		// Check that the step of the first agent is a LM step, and that it's discarded (status should be taken from others)
		var workflowStepId = workflowStepIds[stepIdIndex];
		if (firstAgentSteps[workflowStepId].runOnLM && firstAgentSteps[workflowStepId].stepStatus == 'IDLE') {
			// Check all agents
			for (var i = 1; i < hostIps.length; i++) {
				var hostStepsAsJson = workflowRunDataAsJson.hostsSteps[hostIps[i]];
				var workflowStep = hostStepsAsJson[workflowStepId];
				if (workflowStep.stepStatus != 'IDLE') {
					// Replace first step
					firstAgentSteps[workflowStepId] = workflowStep;
					break;
				}
			}
		}
	}

	// Populate a row with the steps per agent
	for (var hostIpIndex = 0; hostIpIndex < hostIps.length; hostIpIndex++) {
		// Extract the current agent
		var hostIp = hostIps[hostIpIndex];

		// Extract the host steps data
		var hostStepsAsJson = workflowRunDataAsJson.hostsSteps[hostIp];

		// The row to add
		var rowToAddAsHtml = '<tr data-agent-name="' + hostIp + '" style="height: 30px">' + dataRowAsHtml + '</tr>';

		// Append the row
		tblWorkflowRunHostsSteps.find('tbody').append(rowToAddAsHtml);

		// Get a reference to the just added row
		var theAddedRow = tblWorkflowRunHostsSteps.find('tbody tr').last();

		// Populate the agent name
		theAddedRow.find('#thHostIP').html(hostIp == "127.0.0.1" ? "Lab Manager" : hostIp);

		// Check if host was already visited
		var actualHostIp = extractIPFromAgentName(hostIp);
		var agentsForIp = agentsByHostIp[actualHostIp];
		if (agentsForIp != undefined) {
			delete agentsByHostIp[actualHostIp];
		}

		// Iterate over the steps to populate the status of each step in the host 
		WorkflowsMonitoring_HostStatuses.hosts[hostIp] = {};
		WorkflowsMonitoring_HostStatuses.hosts[hostIp].highSeverityStepStatusId = -1;
		for (var stepIdIndex = 0; stepIdIndex < workflowStepIds.length; stepIdIndex++) {
			// The workflow step id
			var workflowStepId = workflowStepIds[stepIdIndex];

			// Extract the host workflow step
			var workflowStep = hostStepsAsJson[workflowStepId];

			// Extract the workflow step name
			var workflowStepName = workflowData.workflowSteps[workflowStepId].stepName;

			// Get the cell
			var theCell = theAddedRow.find('td[id="' + workflowStepId + '"]');

			// Workflow step content as html - set status + the spinner in case it's in 'In Progress' / 'Aborting'
			var workflowStepContentAsHtml = workflowStep.stepStatusDisplayName;
			if ('INPROGRESS' == workflowStep.stepStatus
					|| 'SUCCESS' == workflowStep.stepStatus
					|| 'FAILED' == workflowStep.stepStatus
					|| 'WARNING' == workflowStep.stepStatus
					|| 'ABORTING' == workflowStep.stepStatus
					|| 'ABORTED' == workflowStep.stepStatus) {

				if (workflowStep.hasLogs) {
					var viewLogAction = "javascript: WorkflowsMonitoring_viewLog('" + hostIp + "', " + workflowRunDataAsJson.workflowRunId + ", " + workflowStepId +
							", '" + replaceAll(workflowStepName, "'", "\\'") + "', " + workflowStep.runOnAgent + ", " + workflowStep.runOnLM + ");";

					workflowStepContentAsHtml = '<a class="urlLogLink" href="' + viewLogAction + '">' +	workflowStepContentAsHtml + '</a>';

					theCell.attr('log-url', viewLogAction);
				} else {
					workflowStepContentAsHtml = workflowStepContentAsHtml;
				}

				if (workflowStep.stepStatus == "INPROGRESS" || workflowStep.stepStatus == "ABORTING") {
					var spinner = (workflowStep.stepStatus == "ABORTING" ? "aborting" : "in-progress");
					workflowStepContentAsHtml += '&nbsp;<img id="" src="/assets/images/' + spinner + '-spinner.gif" style="vertical-align: middle; margin-top: -5px;" />';
				}
			}

			// Update the status display name
			theCell.html(workflowStepContentAsHtml);

			// Handle the background which is defined by the step status
			theCell.attr('class', 'WorkflowStatus' + workflowStep.stepStatus);

			// Keep the step name
			theCell.attr('step-name', workflowStepName);

			// Keep the info to be used in tooltip
			theCell.attr('step-status-id', workflowStep.stepStatusId);
			theCell.attr('step-status', workflowStep.stepStatus);
			theCell.attr('step-status-display-name', workflowStep.stepStatusDisplayName);
			theCell.attr('step-start-time', workflowStep.stepStartTime);
			theCell.attr('step-raw-start-time', workflowStep.stepRawStartTime);
			theCell.attr('step-end-time', workflowStep.stepEndTime);
			theCell.attr('step-duration', workflowStep.stepDuration);
			theCell.attr('step-exit-code', workflowStep.stepExitCode);
			theCell.attr('customized-exit-description', workflowStep.customizedExitDescription);
			theCell.attr('run-on-agent', workflowStep.runOnAgent);
			theCell.attr('run-on-LM', workflowStep.runOnLM);
			theCell.attr('can-run-on-failure', workflowStep.canRunOnFailure);
			theCell.attr('override-failure-status', workflowStep.overrideFailureStatus);
			theCell.attr('step-id', workflowData.workflowSteps[workflowStepId].stepId);
			theCell.attr('data-workflow-step-id', workflowStepId);
			theCell.attr('step-has-logs', workflowStep.hasLogs);

			switch (workflowStep.stepStatus) {
			case 'FAILED':
			case 'ABORTED':
				// Note that only one step can be failed per single host, therefore no need to check if the host ip already in the list
				failedHostIps.push(hostIp);
				break;

			case 'ABORTING':
				// Note that only one step can be failed per single host, therefore no need to check if the host ip already in the list
				failedHostIps.push(hostIp);
			case 'INPROGRESS':
				// Add stop button to in progress step
				theCell.append(WorkflowsMonitoring_createStopButton(workflowRunDataAsJson.workflowRunId, hostIp, workflowStep.runOnAgent, workflowStep.runOnLM));
				break;

			default:
				break;
			}

			// For host steps, we'd like to show one big step for all agents
			if (!workflowStep.runOnAgent) {
				if (agentsForIp == undefined) {
					// Hide the cell (not with class because class is used for other stuff)
					theCell.css("display", "none");
				} else {
					// If we have agents count, this is the first visit for the host, use rowspan
					theCell.attr('rowspan', agentsForIp.length);
				}
			}

			// For LM steps, we'd like to show one big step for all agents/hosts
			if (workflowStep.runOnLM) {
				if (hostIpIndex > 0) {
					// Hide the cell (not with class because class is used for other stuff)
					theCell.css("display", "none");
				} else {
					// If we have agents count, this is the first visit for the host, use rowspan
					theCell.attr('rowspan', hostIps.length);
				}
			}
		}
	}

	// Iterate over the failed host ips and steps and modify the 'Not started' to 'Discarded'
	for (var stepIdIndex = 0; stepIdIndex < workflowStepIds.length; stepIdIndex++) {
		// The workflow step id
		var workflowStepId = workflowStepIds[stepIdIndex];
		failedHostIps.forEach(function(failedHostIp) {
			WorkflowsMonitoring_signNotStartedStepsAsDiscarded(failedHostIp, workflowStepId);
		});
	}

	// Collect and update statistics for all agent names
	for (var hostIpIndex = 0; hostIpIndex < hostIps.length; hostIpIndex++) {
		WorkflowsMonitoring_collectAndUpdateHostStatisticsBasedOnWorkflowSteps(hostIps[hostIpIndex]);
	}
	WorkflowsMonitoring_collectAndUpdateStepStatistics();

	// Transpose table if not landscape mode
	if (workflowData.isVerticalViewingMode == true) {
		// Get all current elements into a tabular array
		var data = new Array();
		tblWorkflowRunHostsSteps.find("tr").each(function () {
			// Transform row HTML into span
			var row = $(this);
			var attributes = row.prop("attributes");

			var dataRow = new Array();
			row.children().each(function () {
				var col = $(this);
				var invisible = col.css('display') == "none";

				// Copy attributes from row
				$.each(attributes, function () {
					col.attr(this.name, this.value);
				});

				// Convert rowspan to colspan
				var rowspan = col.attr('rowspan');
				if (!isStringEmpty(rowspan)) {
					col.removeAttr('rowspan');
					col.attr('colspan', rowspan);
				}

				if (invisible) {
					col.css('display', 'none');
				}

				// Minimum width so we won't be too crowded with text
				col.css('min-width', '130px');
				col.css('word-break', 'break-word');

				dataRow.push(col);
			});
			data.push(dataRow);
		});

		// Clear existing header and create new one
		var thead = tblWorkflowRunHostsSteps.find("thead").empty();
		var tr = $("<tr />");
		for (var i = 0; i < data.length; i++) {
			if (data[i][0].text() == "Agent / Step") {
				data[i][0].text('Step / Agent');
				data[i][0].attr('colspan', '2');
			}
			tr.append(data[i][0]);
		}
		thead.append(tr);

		// Create data rows
		var tbody = tblWorkflowRunHostsSteps.find("tbody").empty();
		for (var j = 1; j < data[0].length; j++) {
			tbody.append("<tr />");
		}

		// First column
		for (var j = 1; j < data[0].length; j++) {
			// Split to 2 fields (for type, and name), and align both to left
			var cloned1 = data[0][j].css('min-width', '').css('max-width', '').css('text-align', 'left').clone();
			var cloned2 = cloned1.clone();
			cloned2.find("span, br").remove();
			var span = cloned1.find("span");
			cloned1.empty().append(span);
			tbody.find("tr:eq(" + (j - 1) + ")").append(cloned1).append(cloned2);
		}

		// Rest of the data
		for (var i = 1; i < data.length; i++) {
			for (var j = 1; j < data[i].length; j++) {
				tbody.find("tr:eq(" + (j - 1) + ")").append(data[i][j]);
			}
		}
	}

	var tempObj = new Object();
	tempObj.func = function () {
		if (workflowRunDataAsJson.statistics != undefined) {
			var eta = WorkflowsMonitoring_calculateETA(workflowRunDataAsJson.statistics);

			// Check if ETA is available
			var tdETA = $("#tdWorkflowETA");
			if (eta.maxETASecs == undefined) {
				tdETA.html("-");
				return;
			}

			tdETA.html(formatETA(eta.maxETASecs));
			if (eta.maxETASecs > 0) {
				setTimeout(tempObj.func, 2000);
			}
		}
	};
	tempObj.func();
}

function WorkflowsMonitoring_stopWrapper(workflowRunId, agentName, runOnAgent, runOnLM) {
	var agentsToAbort = [];
	var nonInProgressAgents = 0;
	if (agentName == undefined) {
		if ($("#hdnActiveWorkflowRunId").val() == "" + workflowRunId) {
			// Currently viewing this, let's get the agents to abort for later checking if they are all actually aborted
			$("#tblWorkflowRunHostsSteps > tbody #thHostIP").each(function () {
				agentsToAbort.push($(this).text().trim());
			});
		}
	} else {
		agentsToAbort.push(agentName);
	}
	for (var i = 0; i < agentsToAbort.length; i++) {
		var foundInProgress = false;
		var cells = WorkflowsMonitoring_getWorkflowStepCells(workflowRunId, agentsToAbort[i]);
		for (var j = 0; j < cells.length; j++) {
			var value = $(cells[j]).text().trim();
			if (value == "In Progress") {
				foundInProgress = true;
				break;
			}
		}
		if (!foundInProgress) {
			nonInProgressAgents++;
		}
	}
	WorkflowsMonitoring_stopWorkflowRun(workflowRunId, agentName, (nonInProgressAgents == agentsToAbort.length && agentsToAbort.length != 0), runOnAgent, runOnLM);
}

function WorkflowsMonitoring_createStopButton(workflowRunId, agentName, runOnAgent, runOnLM) {
	var stopButton =
		$("<button id='stopButton' style='margin-left: 10px; margin-top: -3px; width: 20px; height: 20px; " +
				"background-color: rgba(0, 0, 0, 0.3); display: inline !important' class='ui-icon ui-icon-stop'></button>");
	var generateSendStopFunction = function (workflowRunId, agentName, runOnAgent, runOnLM) {
		return function () {
			WorkflowsMonitoring_stopWrapper(workflowRunId, agentName, runOnAgent, runOnLM);
		};
	};
	stopButton.click(generateSendStopFunction(workflowRunId, agentName, runOnAgent, runOnLM));
	return stopButton;
}

function WorkflowsMonitoring_resetHostStatistics() {
	WorkflowsMonitoring_HostStatuses 			= {};
	WorkflowsMonitoring_HostStatuses.hosts 		= {};

	WorkflowsMonitoring_HostStatuses.IDLE 		= 0;
	WorkflowsMonitoring_HostStatuses.INPROGRESS = 0;
	WorkflowsMonitoring_HostStatuses.SUCCESS 	= 0;
	WorkflowsMonitoring_HostStatuses.WARNING 	= 0;
	WorkflowsMonitoring_HostStatuses.FAILED 	= 0;
	WorkflowsMonitoring_HostStatuses.ABORTING 	= 0;
	WorkflowsMonitoring_HostStatuses.ABORTED 	= 0;

	var tblStats = $('#tblHostsStatistics');
	tblStats.find('#tdTotalNumOfHosts').html('0');
	tblStats.find('#tdIDLE').html('0');
	tblStats.find('#tdINPROGRESS').html('0');
	tblStats.find('#tdWARNING').html('0');
	tblStats.find('#tdFAILED').html('0');
	tblStats.find('#tdSUCCESS').html('0');
	tblStats.find('#tdABORTING').html('0');
}

function WorkflowsMonitoring_collectAndUpdateHostStatisticsBasedOnWorkflowSteps(hostIp) {
	var theHostWorkflowStepsRow = $('#tblWorkflowRunHostsSteps tbody [data-agent-name="' + hostIp + '"]');
	theHostWorkflowStepsRow.find('[step-id]').each(function() {
		var workflowStepStatusId = $(this).attr('step-status-id');
		var workflowStepStatus 	= $(this).attr('step-status');
		var overrideFailureStatus = $(this).attr('override-failure-status');

		WorkflowsMonitoring_collectHostStatistics(hostIp, workflowStepStatusId, workflowStepStatus, overrideFailureStatus);
	});

	// Update the whole statistics of all hosts
	theHostWorkflowStepsRow.each(function () {
		WorkflowsMonitoring_updateHostStatistics($(this).attr('data-agent-name'));
	});
}

function WorkflowsMonitoring_collectHostStatistics(hostIp, workflowStepStatusId, workflowStepStatus, overrideFailureStatus) {
	if ('SKIPPED' != workflowStepStatus) {
		if (workflowStepStatus == 'INPROGRESS') {
			// No matter what other steps say, in progress stays in progress
			WorkflowsMonitoring_HostStatuses.hosts[hostIp].highSeverityStepStatusId = workflowStepStatusId;
			WorkflowsMonitoring_HostStatuses.hosts[hostIp].highSeverityStepStatus = workflowStepStatus;
			WorkflowsMonitoring_HostStatuses.hosts[hostIp].lastNonIdleStepStatus = workflowStepStatus;
			WorkflowsMonitoring_HostStatuses.hosts[hostIp].lastStepStatus = workflowStepStatus;
			return;
		}

		var isIdle = 'IDLE' == workflowStepStatus || 'DISCARDED' == workflowStepStatus;

		// Update the worst step status
		var highSeverityStepStatusId = WorkflowsMonitoring_HostStatuses.hosts[hostIp].highSeverityStepStatusId;
		if (workflowStepStatusId > highSeverityStepStatusId) {
			WorkflowsMonitoring_HostStatuses.hosts[hostIp].highSeverityStepStatusId 	= workflowStepStatusId;
			WorkflowsMonitoring_HostStatuses.hosts[hostIp].highSeverityStepStatus 		= workflowStepStatus;
		} else if (overrideFailureStatus == "true" && workflowStepStatusId < highSeverityStepStatusId && !isIdle) {
			// We're overriding something with a higher severity, if it's failure, change to warning
			if (WorkflowsMonitoring_HostStatuses.hosts[hostIp].highSeverityStepStatus == "FAILED") {
				workflowStepStatus = "WARNING";
				workflowStepStatusId--;
			}
			WorkflowsMonitoring_HostStatuses.hosts[hostIp].highSeverityStepStatusId 	= workflowStepStatusId;
			WorkflowsMonitoring_HostStatuses.hosts[hostIp].highSeverityStepStatus 		= workflowStepStatus;
		}

		// Maintain the last step that is not equal to idle
		if (!isIdle) {
			WorkflowsMonitoring_HostStatuses.hosts[hostIp].lastNonIdleStepStatus = workflowStepStatus;
		}

		// Maintain the last step
		WorkflowsMonitoring_HostStatuses.hosts[hostIp].lastStepStatus = workflowStepStatus;
	}
}

function WorkflowsMonitoring_collectAndUpdateStepStatistics() {
	// Get previous steps and reset it. We'll compare them later
	var oldSteps = WorkflowsMonitoring_HostStatuses.steps;
	WorkflowsMonitoring_HostStatuses.steps = {};

	// Collect
	$("#tblWorkflowRunHostsSteps > tbody [data-workflow-step-id]").each(function () {
		// If not visible then ignore
		// Check visibility with display property because initially the table is not visible
		var $this = $(this);
		if ($this.css('display') == "none") {
			return;
		}

		var workflowStepId = $this.attr('data-workflow-step-id');
		if (WorkflowsMonitoring_HostStatuses.steps[workflowStepId] == undefined) {
			WorkflowsMonitoring_HostStatuses.steps[workflowStepId] = new Object();
		}
		var field = undefined;
		switch ($this.attr('step-status')) {
			case "SUCCESS":
				field = "success";
				break;

			case "FAILED":
				field = "failed";
				break;

			case "INPROGRESS":
			case "WARNING":
			case "ABORTED":
			case "ABORTING":
				field = "other";
				break;

			// Skipped and idle shouldn't be counted
			case "IDLE":
			case "SKIPPED":
			default:
				break;
		}
		if (field != undefined) {
			if (WorkflowsMonitoring_HostStatuses.steps[workflowStepId][field] == undefined) {
				WorkflowsMonitoring_HostStatuses.steps[workflowStepId][field] = 1;
			} else {
				WorkflowsMonitoring_HostStatuses.steps[workflowStepId][field]++;
			}
		}
	});

	// Update
	WorkflowsMonitoring_updateStepsStatistics(oldSteps, WorkflowsMonitoring_HostStatuses.steps);
}

function WorkflowsMonitoring_updateStepsStatistics(oldSteps, newSteps) {
	// Build difference object. This will help us avoid unnecessary rendering work
	var diff = newSteps;
	if (oldSteps != undefined) {
		for (var oldWorkflowStepId in oldSteps) {
			if (oldSteps[oldWorkflowStepId].failed == newSteps[oldWorkflowStepId].failed &&
					oldSteps[oldWorkflowStepId].success == newSteps[oldWorkflowStepId].success &&
					oldSteps[oldWorkflowStepId].other == newSteps[oldWorkflowStepId].other) {
				delete diff[oldWorkflowStepId];
			}
		}
	}

	// Render differences
	for (var workflowStepId in diff) {
		if (diff[workflowStepId].failed == undefined && diff[workflowStepId].success == undefined &&
				diff[workflowStepId].other == undefined) {
			// Nothing to update, leave in default state
			continue;
		}

		var theStepCell = $('#tblWorkflowRunHostsSteps > thead [data-header-workflow-step-id="' + workflowStepId + '"]');
		theStepCell.find("[data-pass]").html(diff[workflowStepId].success == undefined ? 0 : diff[workflowStepId].success);
		theStepCell.find("[data-fail]").html(diff[workflowStepId].failed == undefined ? 0 : diff[workflowStepId].failed);
		theStepCell.find("[data-other]").html(diff[workflowStepId].other == undefined ? 0 : diff[workflowStepId].other);
	}
}

function WorkflowsMonitoring_updateHostStatistics(hostIp) {
	var hostStatistics = WorkflowsMonitoring_HostStatuses.hosts[hostIp];

	// Source status
	var hostSourceStatus 		= hostStatistics.currentStatus;

	// Destination status
	var hostDestinationStatus 	= null;

	if ('ABORTED' == hostStatistics.highSeverityStepStatus) {
		hostDestinationStatus = 'ABORTED';
	} else if ('ABORTING' == hostStatistics.highSeverityStepStatus) {
		hostDestinationStatus = 'ABORTING';
	} else if ('FAILED' == hostStatistics.highSeverityStepStatus) {
		hostDestinationStatus = 'FAILED';
	} else if ('WARNING' == hostStatistics.highSeverityStepStatus) {
		hostDestinationStatus = 'WARNING';
	} else if ('SUCCESS' == hostStatistics.lastStepStatus) {
		hostDestinationStatus = hostStatistics.highSeverityStepStatus;
	} else if ('INPROGRESS' == hostStatistics.lastNonIdleStepStatus) {
		hostDestinationStatus = 'INPROGRESS';
	} else {
		hostDestinationStatus = 'IDLE';
	}
		
	if (hostSourceStatus != hostDestinationStatus) {
		WorkflowsMonitoring_moveHostStatus(hostIp, hostSourceStatus, hostDestinationStatus);
	}
}

function WorkflowsMonitoring_moveHostStatus(hostIp, hostSourceStatus, hostDestinationStatus) {
	
	// Decrease the amount in the host source status
	WorkflowsMonitoring_updateHostStatusInHostStatistics(hostSourceStatus, -1);
	
	// Increase the amount in the host destination status
	WorkflowsMonitoring_updateHostStatusInHostStatistics(hostDestinationStatus, 1);
	
	// Update the current host destination status
	WorkflowsMonitoring_HostStatuses.hosts[hostIp].currentStatus = hostDestinationStatus;
}

function WorkflowsMonitoring_updateHostStatusInHostStatistics(status, numberToAdd) {
	if (!isStringEmpty(status)) {
		// Decrease the amount in the host source status
		var currentStatusNum = WorkflowsMonitoring_HostStatuses[status] + numberToAdd;
		WorkflowsMonitoring_HostStatuses[status] = currentStatusNum;
	
		// Update the UI
		$('#tblHostsStatistics').find('#td' + status).html(WorkflowsMonitoring_HostStatuses[status]);
	}
}

function WorkflowsMonitoring_populateNewActiveWorkflowRow(messageAsJson) {
	WorkflowsMonitoring_populateNewWorkflowRow(messageAsJson, true);

	prepareTableFiltersExt('tblActiveWorkflows', false);
}

function WorkflowsMonitoring_removeActiveWorkflowRow(messageAsJson) {
	// Remove row
	$("#tblActiveWorkflows > tbody > tr[id='queued" + messageAsJson.queuedWorkflowId + "']").remove();

	// Decide what to show - the message that indicates no workflow was found in the table
	if ($("#tblActiveWorkflows > tbody > tr").length == 0) {
		// Hide the table
		$('#tblActiveWorkflows').addClass('inactive');

		// Show no active workflows label
		$('#lblNoActiveWorkflow').attr('class', '');
	}
}

function WorkflowsMonitoring_populateNewWorkflowRowsInHistory(messageAsJson) {

	// Extract the workflows from the message
	var workflows = messageAsJson.workflows;

	// Populate all rows
	for (var workflowIndex = 0; workflowIndex < workflows.length; workflowIndex++) {
		WorkflowsMonitoring_populateNewWorkflowRow(workflows[workflowIndex], false);
	}

	prepareTableFiltersExt('tblActiveWorkflows', false);
}

function WorkflowsMonitoring_populateNewWorkflowRow(messageAsJson, isShowStop) {
	// Add "queued" to ID of queued workflows, so we'll ensure that the ID won't collide with workflowRunIds
	var isQueued = (messageAsJson.workflowRunId <= 0);
	var id = (isQueued ? ('queued' + messageAsJson.queuedWorkflowId) : messageAsJson.workflowRunId);

	var addedRow = $('#tblActiveWorkflows > tbody > tr[id="' + id + '"]');
	if (addedRow.length > 0) {
		// Already exists
		return;
	}

	// Get the template row and make it visible
	var addedRow = $($('#tblWorkflowTemplate > tbody').html());
	addedRow.removeClass("inactive");

	// Update ID and name
	addedRow.attr('id', id);
	addedRow.find('#tdWorkflowName').html(messageAsJson.workflowName);

	// Tags
	if (messageAsJson.tags != undefined) {
		var html = "	<div style='display: flex; flex-direction: row;' ";
		html += "onclick='WorkflowsMonitoring_onWorkflowRowClick($(event.target).closest(\"tr\"));'>";
		var filterValues = "";
		for (var i = 0; i < messageAsJson.tags.length; i++) {
			if (i > 0) {
				html += " ";
			}
			html += "<span class='BlueTag'>" + messageAsJson.tags[i] + "</span>&nbsp;";
			filterValues += messageAsJson.tags[i] + ";";
		}
		html += "</div>";
		addedRow.find("#tdTags").html(html).attr('data-filter-values', filterValues);
	}

	// Start time is relevant only if not a queued workflow
	if (!isQueued) {
		addedRow.find('#tdWorkflowStartTime').html(messageAsJson.workflowStartTime);
		addedRow.css("cursor", "pointer");
		addedRow.click(function (event) { WorkflowsMonitoring_onWorkflowRowClick($(event.target)); });
	}

	var isCompleted = !isStringEmpty(messageAsJson.workflowCompleteTime) && messageAsJson.workflowCompleteTime != "-";
	if (isCompleted) {
		addedRow.find('#tdWorkflowCompleteTime').html(messageAsJson.workflowCompleteTime);
		addedRow.find('#tdWorkflowETA').html("-");
	}
	addedRow.attr('data-timestamp', messageAsJson.workflowStartedTimestamp);

	var isUser = !isStringEmpty(messageAsJson.sendingUsername);
	if (isUser) {
		addedRow.find('#tdSendingUser').html(getDisplayName(messageAsJson.sendingUsername));
	} else {
		addedRow.find('#tdSendingUser').html("System");
	}

	// Status, highlight in progress rows
	var statusSpan = addedRow.find('#tdStatus > span');
	if (isQueued) {
		statusSpan.html("Queued");
		statusSpan.addClass("WorkflowStatusIDLE");
	} else {
		statusSpan.html(messageAsJson.status);
		if (messageAsJson.status == "In Progress" && !isCompleted) {
			statusSpan.addClass("WorkflowStatusINPROGRESS");
		}
	}

	var agentNamesTbody = addedRow.find('#tblSelectedHostIps tbody');
	var agentNamesDelimited = "";
	for (var hostIpIndex = 0; hostIpIndex < messageAsJson.workflowHostIps.length; hostIpIndex++) {
		// Extract the host ip
		var hostIp = messageAsJson.workflowHostIps[hostIpIndex];
		agentNamesTbody.append('<tr><td style="padding: 0px; border: 0px;">' + hostIp + '</td></tr>');

		if (!isStringEmpty(agentNamesDelimited)) {
			agentNamesDelimited += ";";
		}
		agentNamesDelimited += hostIp;
	}
	addedRow.find("#tdAgents").attr('data-filter-values', agentNamesDelimited);

	// Hosts count
	addedRow.find('#hostsCount').html(messageAsJson.workflowHostIps.length);

	if (!isShowStop || isQueued) {
		addedRow.find("#btnStopWorkflowRun").remove();
	}
	if (isQueued) {
		addedRow.find("#btnAttachToTask").remove();
	} else {
		addedRow.find("#btnDeleteQueuedWorkflow").remove();
	}

	// Add the template row to the right place
	if (isCompleted || !isShowStop) {
		var trs = $('#tblActiveWorkflows > tbody > tr');
		var time = messageAsJson.workflowStartedTimestamp;
		var added = false;
		for (var i = 0; i < trs.length; i++) {
			var tr = trs.eq(i);
			var curTime = parseInt(tr.attr('data-timestamp'));
			if (curTime > 0 && time >= curTime) {
				added = true;
				addedRow.insertBefore(tr);
				break;
			}
		}
		if (!added) {
			$('#tblActiveWorkflows > tbody').append(addedRow);
		}
	} else {
		$('#tblActiveWorkflows > tbody').prepend(addedRow);
	}
}

function WorkflowsMonitoring_signWorkflowAsCompleted(messageAsJson) {
	// Extract the workflow run id
	var workflowRunId = messageAsJson.workflowRunId;
	
	// Get the active workflow row
	var theActiveWorkflowRow = $('#tblActiveWorkflows tbody tr[id="' + workflowRunId + '"]'); 
	
	if (theActiveWorkflowRow != undefined) {
		// Update the complete time
		theActiveWorkflowRow.find('#tdWorkflowCompleteTime').html(messageAsJson.workflowCompletedTime);

		// Update status
		theActiveWorkflowRow.find('#tdStatus > span').html(messageAsJson.workflowStatus).removeClass("WorkflowStatusINPROGRESS").removeClass("WorkflowStatusIDLE");

		// Remove stop button and label
		theActiveWorkflowRow.find('#btnStopWorkflowRun').remove();

		// Update the metadata of the active workflow in case it's the same one
		var currentViewedWorkflowRunId = $('#hdnActiveWorkflowRunId').val();
		if (workflowRunId == currentViewedWorkflowRunId) {
			$('#tblWorkflowHeader').find('#tdWorkflowCompleteTime').html(messageAsJson.workflowCompletedTime);
		}

		// Remove all retry buttons
		$("[id='retryButton']").remove();
	}
}

function WorkflowsMonitoring_signWorkflowAgentAsNotStarted(workflowRunId, agentName, fromStart) {
	// Get the workflow step
	var theWorkflowStepCells = WorkflowsMonitoring_getWorkflowStepCells(workflowRunId, agentName);

	var foundFailed = false;
	for (var i = 0; i < theWorkflowStepCells.length; i++) {
		var theWorkflowStepCell = $(theWorkflowStepCells[i]);
		var status = theWorkflowStepCell.text();
		if (status == "Skipped") {
			continue;
		} else if (status == "Failed") {
			foundFailed = true;
		}

		// If we're start at the failed step, wait until we found the failed step before changing statuses
		if (!fromStart && !foundFailed) {
			continue;
		}

		theWorkflowStepCell.attr('log-url', '');

		theWorkflowStepCell.html("Not Started");

		// Modify the cell to not started
		theWorkflowStepCell.attr('class', 'WorkflowStatusIDLE');
		theWorkflowStepCell.attr('step-status', 'IDLE');
		theWorkflowStepCell.attr('step-status-display-name', 'Not Started');
		theWorkflowStepCell.attr('step-start-time', '');
		theWorkflowStepCell.attr('step-raw-start-time', '0');
		theWorkflowStepCell.attr('step-end-time', '');
		theWorkflowStepCell.attr('step-duration', '');
		theWorkflowStepCell.attr('step-exit-code', '');
		theWorkflowStepCell.attr('customized-exit-description', '');
	}

	// Modify the host status to not started
	WorkflowsMonitoring_collectAndUpdateHostStatisticsBasedOnWorkflowSteps(agentName);
	WorkflowsMonitoring_collectAndUpdateStepStatistics();
}

function WorkflowsMonitoring_signWorkflowStepAsStarted(messageAsJson) {
	// Extract the workflow run id
	var workflowRunId  = messageAsJson.workflowRunId;

	// Extract the host ip 
	var workflowHostIp = messageAsJson.workflowHostIp;

	// Extract the workflow step id
	var workflowStepId = messageAsJson.workflowStepId;

	// Get the workflow step
	var theWorkflowStepCell = WorkflowsMonitoring_getWorkflowStepCell(workflowRunId, workflowHostIp, workflowStepId);

	// If this is null, this means that the notification is not for the current viewed workflow run
	if (theWorkflowStepCell != null) {
		var runOnLM = theWorkflowStepCell.attr('run-on-LM') == 'true';
		var runOnAgent = messageAsJson.runOnAgent;
		var hasLogs = theWorkflowStepCell.attr('step-has-logs') == "true";
		if (hasLogs) {
			var viewLogAction = "javascript: WorkflowsMonitoring_viewLog('" + workflowHostIp + "', " + workflowRunId + ", " + workflowStepId +
				", '" + theWorkflowStepCell.attr('step-name') + "', " + runOnAgent + ", " + runOnLM + ");";

			// Update the status display name + show the spinner
			var spinner = (messageAsJson.workflowStepStatus == "ABORTING" ? "aborting" : "in-progress");
			var workflowStepContentAsHtml = 
				'<a class="urlLogLink" href="' + viewLogAction + '">' + messageAsJson.workflowStepStatusDisplayName +
				'</a>&nbsp;<img src="/assets/images/' + spinner + '-spinner.gif" style="vertical-align: middle; margin-top: -5px;" />';

			theWorkflowStepCell.attr('log-url', viewLogAction);
		} else {
			// Update the status display name + show the spinner
			var spinner = (messageAsJson.workflowStepStatus == "ABORTING" ? "aborting" : "in-progress");
			var workflowStepContentAsHtml = 
				messageAsJson.workflowStepStatusDisplayName + '&nbsp;<img src="/assets/images/' + spinner + '-spinner.gif" style="vertical-align: middle; margin-top: -5px;" />';
		}

		theWorkflowStepCell.html(workflowStepContentAsHtml);

		// Modify the cell to inprogress
		theWorkflowStepCell.attr('class', 'WorkflowStatus' + messageAsJson.workflowStepStatus);

		theWorkflowStepCell.attr('step-status-id', messageAsJson.workflowStepStatusId);
		theWorkflowStepCell.attr('step-status', messageAsJson.workflowStepStatus);
		theWorkflowStepCell.attr('step-status-display-name', messageAsJson.workflowStepStatusDisplayName);
		theWorkflowStepCell.attr('step-start-time', messageAsJson.workflowStartedTime);
		theWorkflowStepCell.attr('step-raw-start-time', messageAsJson.workflowRawStartedTime);

		// Add stop button, in case of a host step it will take the first agent's name
		theWorkflowStepCell.append(WorkflowsMonitoring_createStopButton(workflowRunId,
				$(theWorkflowStepCell[0]).parent().find("#thHostIP").text(), runOnAgent, runOnLM));

		// Modify the host status from idle to in progress
		WorkflowsMonitoring_collectAndUpdateHostStatisticsBasedOnWorkflowSteps(workflowHostIp);
		WorkflowsMonitoring_collectAndUpdateStepStatistics();

		// If aborted, sign all steps as discarded
		if (messageAsJson.workflowStepStatus == "ABORTED") {
			WorkflowsMonitoring_signNotStartedStepsAsDiscarded();
		}
	}
}

function WorkflowsMonitoring_signWorkflowStepAsCompleted(messageAsJson) {
	// Extract the workflow run id
	var workflowRunId  = messageAsJson.workflowRunId;
	
	// Extract the agent name
	var workflowAgentName = messageAsJson.workflowHostIp;
	
	// Extract the workflow step id
	var workflowStepId = messageAsJson.workflowStepId;
	
	// Get the workflow step
	var theWorkflowStepCell = WorkflowsMonitoring_getWorkflowStepCell(workflowRunId, workflowAgentName, workflowStepId);
	
	// If this is null, this means that the notification is not for the current viewed workflow run
	if (theWorkflowStepCell != null) {
		// Extract the status
		var workflowStepStatus = messageAsJson.workflowStepStatus;

		// Modify the background of the cell according to the status
		theWorkflowStepCell.attr('class', 'WorkflowStatus' + workflowStepStatus);

		// Update the status display name
		var viewLogAction = theWorkflowStepCell.attr('log-url');
		if (isStringEmpty(viewLogAction)) {
			theWorkflowStepCell.html(messageAsJson.workflowStepStatusDisplayName);
		} else {
			var workflowStepContentAsHtml = 
				'<a class="urlLogLink" href="' + viewLogAction + '">' +	messageAsJson.workflowStepStatusDisplayName + '</a>';
			theWorkflowStepCell.html(workflowStepContentAsHtml);
		}

		// Keep the info to be used in tooltip
		theWorkflowStepCell.attr('step-status-id', messageAsJson.workflowStepStatusId);
		theWorkflowStepCell.attr('step-status', messageAsJson.workflowStepStatus);
		theWorkflowStepCell.attr('step-status-display-name', messageAsJson.workflowStepStatusDisplayName);
		theWorkflowStepCell.attr('step-end-time', messageAsJson.workflowStepCompletedTime);
		theWorkflowStepCell.attr('step-duration', messageAsJson.workflowStepDuration);
		theWorkflowStepCell.attr('step-exit-code', messageAsJson.workflowStepExitCode);
		theWorkflowStepCell.attr('customized-exit-description', messageAsJson.customizedExitDescription);

		theWorkflowStepCell.each(function () {
			WorkflowsMonitoring_collectAndUpdateHostStatisticsBasedOnWorkflowSteps($(this).parent().attr('data-agent-name'));
		});
		WorkflowsMonitoring_collectAndUpdateStepStatistics();

		// If the step failed this means that all the 'Not Started' steps should be changed to discarded, and that retry should be shown
		if (messageAsJson.workflowStepStatus == 'FAILED' || messageAsJson.workflowStepStatus == 'ABORTED') {
			WorkflowsMonitoring_signNotStartedStepsAsDiscarded();
		}
	}
}

function WorkflowsMonitoring_showHideHosts(callingElement) {
	$(callingElement).parent().find("#showHostsEffect").toggle();
}

function WorkflowsMonitoring_getWorkflowStepCell(workflowRunId, workflowHostIp, workflowStepId) {
	var theWorkflowStepCell = null;
	// Check if the current viewed workflow run is the same one
	var currentViewedWorkflowRunId = $('#hdnActiveWorkflowRunId').val();
	if (workflowRunId == currentViewedWorkflowRunId) {
		// Locate the relevant row
		var theHostIpRow = $('#tblWorkflowRunHostsSteps > tbody [data-agent-name="' + workflowHostIp + '"]');

		// Locate the relevant cell
		theWorkflowStepCell = theHostIpRow.find('[id="' + workflowStepId + '"]').addBack('[id="' + workflowStepId + '"]');

		if (theWorkflowStepCell.attr('run-on-agent') == "false") {
			// Host step, return all relevant cells
			var hostIp = extractIPFromAgentName(workflowHostIp);
			var theHostIpRow = $('#tblWorkflowRunHostsSteps > tbody')
				.find('[data-agent-name^="' + hostIp + ':"], [data-agent-name="' + hostIp + '"]');
			theWorkflowStepCell = theHostIpRow.find('[id="' + workflowStepId + '"]').addBack('[id="' + workflowStepId + '"]');
		}

		if (theWorkflowStepCell.attr('run-on-LM') == "true") {
			// LM step, return all relevant cells
			theWorkflowStepCell = $('#tblWorkflowRunHostsSteps > tbody [id="' + workflowStepId + '"]');
		}
	}

	return theWorkflowStepCell;
}

function WorkflowsMonitoring_getWorkflowStepCells(workflowRunId, workflowHostIp) {
	// Check if the current viewed workflow run is the same one
	var currentViewedWorkflowRunId = $('#hdnActiveWorkflowRunId').val();
	if (workflowRunId == currentViewedWorkflowRunId) {
		// Locate the relevant row
		var theHostIpRow = $('#tblWorkflowRunHostsSteps tbody [data-agent-name="' + workflowHostIp + '"]');

		// Locate the relevant cells
		return theHostIpRow.find("[step-name]");
	}

	return [];
}

function WorkflowsMonitoring_renderWorkflowStepTooltip(theWorkflowStepCell) {
	
	var cell = $(theWorkflowStepCell);

	if (!cell.is("[step-id]")) {
		// No tooltip if it's not a step
		return undefined;
	}

	var stepStatusDisplayName 		= cell.attr('step-status-display-name');

	// If status is discarded, not started or skipped, don't show tooltip
	if (stepStatusDisplayName == "Not Started" || stepStatusDisplayName == "Discarded" || stepStatusDisplayName == "Skipped") {
		return undefined;
	}

	var stepStartTime 				= cell.attr('step-start-time');
	var stepEndTime 				= cell.attr('step-end-time');
	var stepDuration 				= cell.attr('step-duration');
	var stepExitCode 				= cell.attr('step-exit-code');
	var customizedExitDescription	= cell.attr('customized-exit-description');

	// Extract agent name
	var resource = cell.attr('data-agent-name');
	if (isStringEmpty(resource)) {
		resource = cell.closest("[data-agent-name]").attr('data-agent-name');
	}
	if (cell.attr('run-on-lm') == "false") {
		if (cell.attr('run-on-agent') == "false") {
			resource = resource.split(':')[0];
		}
	} else {
		resource = "Lab Manager";
	}

	var tooltipVal = '<table><tbody>';

	// Add resource
	tooltipVal += '<tr>';
	tooltipVal += '<th style="text-align:left">Resource: </th><td>' + resource + '</td>';
	tooltipVal += '</tr>';

	if (!isStringEmpty(stepStatusDisplayName)) {
		tooltipVal += '<tr>';
		tooltipVal += '<th style="text-align:left">Status: </th><td>' + stepStatusDisplayName + '</td>';
		tooltipVal += '</tr>';
	}

	if (!isStringEmpty(stepStartTime)) {
		tooltipVal += '<tr>';
		tooltipVal += '<th style="text-align:left">Start Time: </th><td>' + stepStartTime + '</td>';
		tooltipVal += '</tr>';
	}

	if (!isStringEmpty(stepEndTime)) {
		tooltipVal += '<tr>';
		tooltipVal += '<th style="text-align:left">End Time: </th><td>' + stepEndTime + '</td>';
		tooltipVal += '</tr>';
		tooltipVal += '<tr>';
		tooltipVal += '<th style="text-align:left">Duration: </th><td>' + stepDuration + '</td>';
		tooltipVal += '</tr>';
	}

	if (!isStringEmpty(stepExitCode)) {
		tooltipVal += '<tr>';
		tooltipVal += '<th style="text-align:left">Exit Code: </th><td>' + stepExitCode + '</td>';
		tooltipVal += '</tr>';

		// Extract the exit code description
		var exitCodeDescription;
		if (!isStringEmpty(customizedExitDescription)) {
			exitCodeDescription = customizedExitDescription;
		} else {
			exitCodeDescription = WorkflowsMonitoring_getExitCodeDescription(stepExitCode);
		}
		if (!isStringEmpty(exitCodeDescription)) {
			tooltipVal += '<tr>';
			tooltipVal += '<th style="text-align:left">Exit Description: </th><td style="word-break: break-all;">' + exitCodeDescription + '</td>';
			tooltipVal += '</tr>';
		}
	}

	tooltipVal += '</tbody></table>';

	return tooltipVal;
}

function WorkflowsMonitoring_getStatusCounters(selector) {
	var result = {
		IDLE: 0,
		INPROGRESS: 0,
		SKIPPED: 0,
		SUCCESS: 0,
		WARNING: 0,
		FAILED: 0,
		ABORTING: 0,
		ABORTED: 0,
		DISCARDED: 0,
		total: 0
	};
	selector.each(function () {
		var td = $(this);
		var status = td.attr('step-status');
		if (result[status] != undefined) {
			result[status]++;
		}
		result.total++;
	});
	result.failed = result.FAILED + result.ABORTING + result.ABORTED;
	result.discarded = result.DISCARDED + result.SKIPPED;
	return result;
}

function WorkflowsMonitoring_signNotStartedStepsAsDiscarded(agentName, stepId) {
	if (agentName == undefined) {
		// Do for every step and agent
		var stepIds = new Array();
		$('#tblWorkflowRunHostsSteps > tbody [step-name]').each(function () {
			var stepId = $(this).attr('id');
			if ($.inArray(stepId, stepIds) == -1) {
				stepIds.push(stepId);
			}
		});
		for (var i = 0; i < stepIds.length; i++) {
			var stepId = stepIds[i];
			$('#tblWorkflowRunHostsSteps > tbody [data-agent-name]').each(function () {
				var agentName = $(this).attr('data-agent-name');
				WorkflowsMonitoring_signNotStartedStepsAsDiscarded(agentName, stepId);
			})
		}
		return;
	}

	var isWorkflowOver = $("#tdWorkflowCompleteTime").text().trim() != "-";
	var hostIp = extractIPFromAgentName(agentName);

	// All cells that relate to the given agent
	var agentCells = $('#tblWorkflowRunHostsSteps > tbody [data-agent-name="' + agentName + '"]');

	// Go over the workflow step for that agent
	agentCells.find('[id="' + stepId + '"]').addBack('[id="' + stepId + '"]').each(function () {
		var td = $(this);

		// Extract flags
		var runOnLM = td.attr('run-on-LM') == 'true';
		var runOnAgent = td.attr('run-on-agent') == 'true' && !runOnLM;

		// If step is not idle or can run on failure, we'll never set it as discarded
		// If step is idle and workflow finished already, we don't care on whether it can potentially run on failure
		if (td.attr('step-status') == 'IDLE' && (td.attr('can-run-on-failure') == 'false' || isWorkflowOver)) {
			var checkPath = function (agentCells) {
				// Get the cells path of the current step in agent, and find the index of the current column in that path
				// We'll later go backwards on this path
				var index = -1;
				var agentChildren = (agentCells.is("tr") ? agentCells.children() : agentCells);
				for (var i = 0; i < agentChildren.length; i++) {
					if ($(agentChildren[i]).attr('step-id') == td.attr('step-id')) {
						index = i;
						break;
					}
				}
				if (index == -1) {
					return false;
				}

				var tdToCheck = $(agentChildren[--index]);
				var relevantTDsToCheck = tdToCheck;

				// Look previously on other steps to determine if this idle step is discarded
				// Generally - if it failed somewhere (and we can't execute on failure here), we consider it as discarded
				while (index > 0) {
					// Take step status from the correct cell - the first one of the host or of the entire workflow if LM step
					var tdToCheckId = tdToCheck.attr('id');
					if (tdToCheck.attr('run-on-LM') == 'true') {
						// LM step
						relevantTDsToCheck = $("#tblWorkflowRunHostsSteps > tbody [id='" + tdToCheckId + "']:first");
					} else if (tdToCheck.attr('run-on-agent') == 'false') {
						// Host step
						// Add the first TD, and select the first TD. This should handle the case in which the agent element is also the workflow step TD
						relevantTDsToCheck = $("#tblWorkflowRunHostsSteps > tbody")
							.find("[data-agent-name^='" + hostIp + ":'], [data-agent-name='" + hostIp + "']")
							.add("[id='" + tdToCheckId + "']:first")
							.find("[id='" + tdToCheckId + "']:first");
					}
	
					var failed = true;
					switch (relevantTDsToCheck.attr('step-status')) {
					case "SUCCESS":
					case "WARNING":
					case "IDLE":
					case "INPROGRESS":
					case "DISCARDED":
					case "SKIPPED":
						failed = false;
						tdToCheck = $(agentChildren[--index]);
						relevantTDsToCheck = tdToCheck;
						break;
					default:
						break;
					}
					if (failed) {
						break;
					}
				}
	
				// If no previous (which satisfies the previously written conditions), the step can still execute
				var discarded = false;
				if (tdToCheck.length > 0) {
					var counters = WorkflowsMonitoring_getStatusCounters(relevantTDsToCheck);
					discarded = (counters.total == counters.failed + counters.discarded);
				}

				return discarded;
			};

			var discarded = false;
			if (runOnLM) {
				// Find all agents which can have multiple paths to the LM step
				var allAgents = $('#tblWorkflowRunHostsSteps > tbody [data-agent-name]');

				// Check all paths, require that all of them will be true
				discarded = true;
				allAgents.each(function () {
					if (!checkPath($(this))) {
						discarded = false;
					}
				});
			} else {
				// Check single agent path
				// TODO maybe not good for host steps
				discarded = checkPath(agentCells);
			}
			if (discarded) {
				// Modify the background of the cell according to the status
				td.attr('class', 'WorkflowStatusDISCARDED');

				td.attr('step-status', 'DISCARDED');
				td.attr('step-status-display-name', 'Discarded');

				// Update the status display name
				td.html('Discarded');
			}
		}
	});
}

function WorkflowsMonitoring_viewLog(agentName, workflowRunId, workflowStepId, stepName, runOnAgent, runOnLM) {
	// Remove spaces from step name, the rest is escaped in the server
	var escapedStepName = replaceAll(stepName, " ", "");

	// Get IP according to execute on type
	var ip = (runOnLM ? getLMIP() : agentName.split(':')[0]);

	// Build exceute on str. Manually specifying the type will open faster
	var executeOnStr = "Auto";
	if (runOnLM != undefined && runOnAgent != undefined) {
		executeOnStr = (runOnLM ? "LabManager" : (runOnAgent ? "Agent" : "Host"));
	}

	// Build title
	var title = "Log for " + (runOnLM ? " lab manager" : (runOnAgent ? agentName : ip)) + ", step: " + stepName;

	// Open log viewer
	showLogViewerDialog(ip, title, "Workflow " + agentName + " " + executeOnStr + " " + workflowRunId + " " +
			workflowStepId + " " + escapedStepName);
}

function WorkflowsMonitoring_GetOldestVisibleWorkflowTimestamp() {
	return parseInt($("#tblActiveWorkflows > tbody > tr:last").attr('data-timestamp'));
}

function WorkflowsMonitoring_customSearchHistory() {
	// Build HTML
	var html = "<table style='width: 760px;'>";
	html += "<tr><td style='text-align: center;'>From</td><td style='text-align: center;'>To</td></tr>";
	html += "<tr><td style='text-align: center;'><input type='text' id='txtHistoryFrom' /></td>" +
				"<td style='text-align: center;'><input type='text' id='txtHistoryTo' /></td></tr>";

	UIUtility_showConfirmDialog(html, "Search History", function () {
		var from = $("#txtHistoryFrom").datetimepicker('getValue').getTime();
		var to = $("#txtHistoryTo").datetimepicker('getValue').getTime();
		if (to <= from) {
			UIUtility_showAlert("To date must be higher than from", "Error");
		} else {
			var diffHours = parseInt((to - from) / (3600 * 1000));
			WorkflowsMonitoring_sendGetHistoryWorkflows("time " + diffHours + " h", to);
		}
	}, 780, 500);

	// Start is now or earliest in the displayed history
	// End is 1 day before the start
	var startDate = new Date().getTime();
	var lastRow = $("#tblActiveWorkflows > tbody > tr:last");
	if (lastRow.length > 0) {
		var timestamp = parseInt(lastRow.attr('data-timestamp'));
		if (timestamp > 0) {
			startDate = timestamp;
		}
	}
	var endDate = startDate - 24 * 3600 * 1000;

	// Initialize UI components
	$("#txtHistoryFrom").val(endDate);
	$("#txtHistoryFrom").data('value', endDate);
	$("#txtHistoryFrom").datetimepicker({
   		format:'unixtime',
   		inline: true,
   		minDate: new Date(0),
   		maxDate: new Date(),
   		validateOnBlur: false,
   		value: endDate
   	});
	$("#txtHistoryTo").data('value', startDate);
	$("#txtHistoryTo").datetimepicker({
   		format:'unixtime',
   		inline: true,
   		minDate: new Date(0),
   		maxDate: new Date(),
   		validateOnBlur: false,
   		value: startDate
   	});
}

/** javascripts/workflows/WorkflowsEventsHelper.js **/
function WorkflowsMng_RunWorkflowRequest(isValid, requestAsJson, errorDescription) {
	this.isValid 			= isValid;
	this.requestAsJson 		= requestAsJson;
	this.errorDescription 	= errorDescription;
}

function WorkflowsMng_onRunWorkflow(enableQueueing, optCont) {
	// Default to no queueing
	if (enableQueueing == undefined) {
		enableQueueing = false;
	}

	// Perform a validation + populate a json to be sent to the server
	var workflow = WorkflowsMng_getWorkflowContent();
	var res = WorkflowsMng_validateAndPopulateRunWorkflowAsJson();

	if (!res.isValid) {
		// Show an error message + cancel the operation
		UIUtility_showAlert(res.errorDescription, "Error");
		return false;
	}

	var runWorkflow = function () {
		// Hide the status if shown
		if (IsWorkflowRunStatusToggled) {
			WorkflowsMng_showRunWorkflowStatus();
		}

		// Send a request to the server to run the workflow
		WorkflowsMng_sendRunWorkflow(res.requestAsJson, enableQueueing, optCont);
	}

	if (workflow.enableValidation) {
		WorkflowsMng_validate(res, runWorkflow);
		optCont(true);
	} else {
		runWorkflow();
	}

	return true;
}

function WorkflowsMng_getAgentNames() {
	var agentNames = [];
	$("#divAgentNames > div").each(function () {
		agentNames.push($(this).find("span:first").text().trim());
	});
	return agentNames;
}

function WorkflowsMng_validateAndPopulateRunWorkflowAsJson(forceAttributeInputsForDisabledSteps, isSkipEntireWorkflow) {
	var isValid 		= true;
	var errDescription	= '';
	var requestAsJson 	= {
		"workflowId": "",
		"agentNames": [],
		"enabledSteps": []
	};

	var hdnContext = $('#hdnContext');
	if (hdnContext != undefined) {
		var contextJson = hdnContext.data("context");
		if (contextJson != undefined) {
			var sessionUUID = contextJson['sessionUUID'];
			if (sessionUUID != undefined) {
				requestAsJson["sessionUUID"] = sessionUUID;
			}
		}
	}

	if (undefined == forceAttributeInputsForDisabledSteps) {
		forceAttributeInputsForDisabledSteps = false;
	}

	if (undefined == isSkipEntireWorkflow) {
		isSkipEntireWorkflow = false;
	}

	// Extract the workflow id
	var workflowId = $('#hdnWorkflowId').val();

	// Extract the context
	var context = $('#hdnContext').data('context');
	context.unparsed = new Object();

	// Make sure custom execution name isn't overriden
	var customExecutionName = context['customExecutionName'];

	// Check if this is auto deployment
	var isAutoDeployment = $('#hdnAutoDeployment').data('isAutoDeployment');
	if (isAutoDeployment == undefined) {
		isAutoDeployment = false;
	}
	requestAsJson.isAutoDeployment = isAutoDeployment;

	// Attach the workflow id to the request
	requestAsJson.workflowId = workflowId;

	// Extract the selected host ips 
	var selectedHostIps = WorkflowsMng_getAgentNames();
	
	// Make sure that at least one host ip is selected, if host IPs table exists (workflow running page)
	if (selectedHostIps.length <= 0 && $("#divAgentNames").length > 0) {
		// This is not valid
		isValid 		= false
		errDescription 	= 'No host IP was selected'; 
	}

	if (isValid) {
		
		// Attach the select agent names
		requestAsJson.agentNames = selectedHostIps; 
		requestAsJson.availableInputs = [];
		
		// Keep a flag that indicates if at least one step is enabled
		var enabledStepExist = false;
	
		// Iterate over the steps
		$('#tblWorkflowSteps > tbody > tr').each(function() {

			// Check if the step is enabled
			// If no enabled checkbox, assume it's enabled
			var chkEnabled = $(this).find('#chkEnable');
			var isEnabled = chkEnabled.length == 0 || chkEnabled.is(':checked');

			// Update the flag that indicates if an enabled step exist
			enabledStepExist |= isEnabled;

			// The step as json
			var theStepAsJson = {
					"workflowStepId": "",
					"stepInputs": []
			}
			
			// Extract the workflow step id
			var workflowStepId = this.id;

			// Update the step json with the workflow step id
			theStepAsJson.workflowStepId = workflowStepId;

			// Extract the input arguments values
			var wasValid = isValid;
			$(this).find('#tdArguments').find('tr').each(function() {
				// Store a reference to the row
				var theRow = $(this);

				// Argument linked customized attribute if there is any
				var inputCustomizedAttributeName = theRow.attr('input-customized-attribute-name');

				// Extract the step input name
				var stepInputName = theRow.attr('input-name')
				
				// The step input as json
				var theStepInputAsJson = {
						"stepInputId": "",
						"stepInputValue": ""
				}

				// Extract the input id
				var inputId = $(this).attr('input-id');

				// Get input element (original or parsed)
				var theInputsColumn = $(this).find('#tdInputValue');
				var parsedInput 	= $("#parsedVersion" + inputId);
				var isParsedValue 	= undefined != parsedInput && parsedInput.length != 0;

				// Extract the parsed value
				var theParsedValue = '';
				if (isParsedValue) {
					theParsedValue = getValueFromElement(parsedInput);
				}

				theInputsColumn.find('input, select, textarea').each(function() {
					// Get the input element
					var inputElem = $(this);

					// Extract the input value (make sure it's a string)
					var theInputValue = "" + getValueFromElement(inputElem);

					// Make sure that the value is not empty if it's visible to the user (not defined as hidden) and shouldn't be empty
					var canBeEmpty = !inputElem.is(":visible") || inputElem.is("[data-allow-empty]");
					if ((isStringEmpty(theInputValue) || (isParsedValue && isStringEmpty(theParsedValue))) && !canBeEmpty) {
						// Don't override an existing message
						var inputDisplayName = theRow.attr('input-display-name');
						if (isParsedValue) {
							inputDisplayName = "Parsed " + inputDisplayName + " version";
						}

						if ((isEnabled && !isSkipEntireWorkflow)
								|| (forceAttributeInputsForDisabledSteps && !isStringEmpty(inputCustomizedAttributeName))) {
							errDescription = inputDisplayName + ' is empty';
							isValid = false;
							return;
						}
					}

					// Update the json with input id, value and parsed value if exists
					theStepInputAsJson.stepInputId = inputId;
					if (isStringEmpty(theStepInputAsJson.stepInputValue)) {
						// So here will be the non-parsed value - since the parsed one is in the second row
						theStepInputAsJson.stepInputValue = theInputValue;
					}
					if (isParsedValue) {
						theStepInputAsJson.parsedValue = theParsedValue;
					}

					// Add the input to the step json
					theStepAsJson.stepInputs.push(theStepInputAsJson);
					requestAsJson.availableInputs.push(theStepInputAsJson);

					// Add the variable to the context in case of auto deployment
					if (isAutoDeployment) {
						var inputName = theRow.attr('input-name');
						context[inputName] = !isParsedValue ? theInputValue : theParsedValue;

						if (!isStringEmpty(inputCustomizedAttributeName)) {
							context[inputCustomizedAttributeName] = !isParsedValue ? theInputValue : theParsedValue;
						}

						if (inputElem.attr('id').indexOf("parsedVersion") != 0) {
							context.unparsed[inputName] = theInputValue;
						}
					}
				});
			});

			// This step is invalid
			if (!isValid && wasValid) {
				return;
			}

			// Add the step to the enabled steps in the request
			if (isEnabled) {
				requestAsJson.enabledSteps.push(theStepAsJson);
			}
		});

		if (!enabledStepExist && isStringEmpty(errDescription)) {
			errDescription = 'At least one step should be enabled';
		}

		if (!isSkipEntireWorkflow) {
			// Turn off the isValid flag if no step is enabled
			if (!enabledStepExist) {
				isValid = false;
			}
		}
	}

	// Set from before extracting workflow inputs
	context['customExecutionName'] = customExecutionName;

	// Save context
	$('#hdnContext').data('context', context);
	requestAsJson.context = context.unparsed;

	return new WorkflowsMng_RunWorkflowRequest(isValid, requestAsJson, errDescription);
}

function WorkflowsMonitoring_viewWorkflowRun(callingElement) {
	callingElement = $(callingElement);

	// Highlight this row and remove highlighting from other rows
	$(".LMTableRowHighlighted").removeClass("LMTableRowHighlighted");
	callingElement.closest("tr").addClass("LMTableRowHighlighted");

	// Get the containing row
	var theContainingRow = callingElement.closest('tr');
	
	// Extract the workflow run id
	var workflowRunId = theContainingRow.attr('id');

	// Send a request to load the workflow run data
	WorkflowsMonitoring_sendViewWorkflow(workflowRunId);
}

function WorkflowsMonitoring_stopWorkflowRun(workflowRunId, agentName, isAborting, runOnAgent) {
	var messages;
	var displayAgentName = ((runOnAgent == false && agentName != undefined) ? extractIPFromAgentName(agentName) : agentName);
	if (displayAgentName == undefined) {
		messages = ["Are you sure you want to " + (isAborting ? "forcefully" : "") + " stop the workflow?"];
	} else {
		messages = ["Are you sure you want to " + (isAborting ? "forcefully" : "") + " stop " + displayAgentName + "?"];
	}
	if (isAborting == true) {
		messages.push("Executing processes might be left running in the background");
	} else {
		messages.push("<input id='stop' type='radio' name='stopGroup' checked></input><label for='stop'>Stop after currently executing step/s complete</label>");
		messages.push("<input id='forceAbort' type='radio' name='stopGroup'></input><label for='forceAbort'>Stop and kill process</label>");
	}

	UIUtility_showConfirmDialog(
			messages,
			"Stop Workflow",
			function () {
				// Extract kill process (default to false)
				var killProcess = $("#forceAbort").prop("checked");
				if (killProcess == undefined) {
					killProcess = false;
				}

				// Send stop request
				WorkflowsMonitoring_sendStopWorkflowRun(workflowRunId, killProcess, killProcess, agentName);
			});
}

/**
 * Map from a message type to the belonging handler
 */
var WorkflowsMonitoring_handlers = {
		"WFStarted"			: "WorkflowsMonitoring_handleWorkflowStarted",
		"WFCompleted"		: "WorkflowsMonitoring_handleWorkflowCompleted",
		"WFStepStarted"		: "WorkflowsMonitoring_handleWorkflowStepStarted",
		"WFStepCompleted"	: "WorkflowsMonitoring_handleWorkflowStepCompleted",
		"WFDequeued"		: "WorkflowsMonitoring_handleWorkflowDequeued"
}

function WorkflowsMonitoring_notificationsHandler(event) {
	
	// Parse JSON
	var dataAsJson = JSON.parse(event.data);
	
	// Extract the message type to figure out which method to invoke
	var messageType = dataAsJson.workflowWSMessageType;
	
	// Extract the handler method name
	var handlerMethodName = WorkflowsMonitoring_handlers[messageType];
	
	// Invoke the method if found
	if (!isStringEmpty(handlerMethodName)) {
		invokeFunction(handlerMethodName, dataAsJson);
	} else {
		console.error('WorkflowsMonitoring_notificationsHandler - received unsupported message type [' + messageType + ']');		
	}
}

function WorkflowsMonitoring_handleWorkflowStarted(messageAsJson) {
	// Render a new row in the active workflows
	WorkflowsMonitoring_populateNewActiveWorkflowRow(messageAsJson);
} 

function WorkflowsMonitoring_handleWorkflowDequeued(messageAsJson) {
	WorkflowsMonitoring_removeActiveWorkflowRow(messageAsJson);
} 

function WorkflowsMonitoring_handleWorkflowCompleted(messageAsJson) {
	// Sign the workflow as completed
	WorkflowsMonitoring_signWorkflowAsCompleted(messageAsJson);
}

function WorkflowsMonitoring_handleWorkflowStepStarted(messageAsJson) {
	// Sign the workflow step as started
	WorkflowsMonitoring_signWorkflowStepAsStarted(messageAsJson);
}

function WorkflowsMonitoring_handleWorkflowStepCompleted(messageAsJson) {
	// Sign the workflow step as completed
	WorkflowsMonitoring_signWorkflowStepAsCompleted(messageAsJson);
}

function WorkflowsMng_onNextSkip() {
	var context = $("#hdnContext").data('context');
	var testPlanId = context['testPlanId'];
	var testPlanName = context['testPlanName'];
	var testSuiteId = context['testSuiteId'];
	var enableSendTestPlan = false;
	var forceAttributeInputsForDisabledSteps = true;
	var isSkipEntireWorkflow = true;
	var autoDeployment = true;

	// Validate & Collect the agent ids 
	var res = WorkflowsMng_validateAndPopulateRunWorkflowAsJson(forceAttributeInputsForDisabledSteps, isSkipEntireWorkflow);

	if (!res.isValid) {
		// Show an error message + cancel the operation
		$('#skipWorkflowErrorDialog').find('#lblSkipWorkflowErrDescription').html(res.errorDescription);
		$("#skipWorkflowErrorDialog").dialog("open");
		return;
	}
	
	// Open the validation window
	sendRequestToDisplayTestPlanValidationPage(
			testPlanId, 
			testPlanName, 
			testSuiteId,
			enableSendTestPlan,
			res.requestAsJson.agentNames, 
			autoDeployment,
			context.mergeTPExecutionId);
}

function WorkflowsMng_onNext() {
	// Extract the selected host ips 
	var selectedHostIps = WorkflowsMng_getAgentNames();

	var passedAgents = $("#passedAgents").data('passedAgents');
	if (passedAgents == undefined || selectedHostIps.length == passedAgents.length) {
		// No warning, just do next
		WorkflowsMng_performNext();
	} else {
		// Build hosts list HTML
		var agentsListHtml = "<ul>";
		for (var i = 0; i < passedAgents.length; i++) {
			agentsListHtml += "<li>" + passedAgents[i] + "</li>";
		}
		agentsListHtml += "</ul>";

		if (isClosedLoop()) {
			// Warning, show dialog with passed hosts
			$("#hostsListLabel").html(agentsListHtml);
			$("#nextWorkflowWarningDialog").dialog("open");
		} else {
			if (passedAgents.length == 0) {
				// Ask user if he's sure he wants to continue even though no agents passed the auto deployment
				UIUtility_showConfirmDialog([ "Do you want to continue with all agents, even though none of them passed the auto deployment?" ],
					"Continue with failed hosts",
					function () {
						// Override passed agents with everything, call next, and clean it
						$("#passedAgents").data('passedAgents', selectedHostIps);
						WorkflowsMng_performNext();
						WorkflowsMng_updatePassedAgents([]);
					});
			} else {
				// Ask user if he wants all agents to go to the next stage, or only those which passed the auto deployment
				var messages = [
				                "Do you want to continue with all agents, or only those which passed the auto deployment, which are:",
				                agentsListHtml
				                ];
				UIUtility_showConfirmDialog(messages, "Choose agents to continue with",
					{
						"All Agents": function () {
							// Replace passed agents with everything, do next, and restore passed agents
							$("#passedAgents").data('passedAgents', selectedHostIps);
							WorkflowsMng_performNext();
							$("#passedAgents").data('passedAgents', passedAgents);
						},
						"Passed Agents": WorkflowsMng_performNext
					});
			}
		}
	}
}

function WorkflowsMng_performNext() {
	var context = $("#hdnContext").data('context');
	var testPlanId = context['testPlanId'];
	var testPlanName = context['testPlanName'];
	var testSuiteId = context['testSuiteId'];
	var enableSendTestPlan = true;
	var forceAttributeInputsForDisabledSteps = true;
	var isSkipEntireWorkflow = !isClosedLoop();
	var autoDeployment = true;

	// Validate & Collect the agent ids 
	var res = WorkflowsMng_validateAndPopulateRunWorkflowAsJson(forceAttributeInputsForDisabledSteps, isSkipEntireWorkflow);
	
	if (!res.isValid) {
		// Show an error message + cancel the operation
		$('#skipWorkflowErrorDialog').find('#lblSkipWorkflowErrDescription').html(res.errorDescription);
		$("#skipWorkflowErrorDialog").dialog("open");
		return;
	}

	var passedAgents = $("#passedAgents").data('passedAgents');
	if (passedAgents == undefined) {
		passedAgents = res.requestAsJson.agentNames;
	}

	// Open the validation window
	sendRequestToDisplayTestPlanValidationPage(
			testPlanId, 
			testPlanName, 
			testSuiteId,
			enableSendTestPlan,
			passedAgents,
			autoDeployment,
			context.mergeTPExecutionId);
	
}

function WorkflowsMng_autofill() {
	var lastInputValues = $("#hdnWorkflowContent").data('lastInputValues');
	if (lastInputValues != undefined) {
		WorkflowsMng_SetValues(lastInputValues);
	}
}

function WorkflowsMng_export() {
	PostJsonToNewWindow('/tasks/GetExternalWorkflowJSON', WorkflowsMng_validateAndPopulateRunWorkflowAsJson(), '_self');
}

function WorkflowsMng_onLoad() {
	$("body").append('<input style="display: none" type="file" id="loadFile"></input>');
	$("#loadFile").change(WorkflowsMng_load);
	$("#loadFile").click();
}

function WorkflowsMng_load(event) {
	var file = event.target.files[0];
	if (file) {
		var reader = new FileReader();
		reader.onload = function (e) {
			$("#loadFile").remove();
			try {
				var contents = JSON.parse(e.target.result);

				// Validate workflow name
				var workflowContent = JSON.parse($("#hdnWorkflowContent").val());
				if (contents.workflowName != workflowContent.workflowName) {
					UIUtility_showAlert("Incorrect workflow: " + workflowContent.workflowName);
					return;
				}

				// Try setting enabled checkbox and inputs
				$("#tbodyWorkflowSteps > tr").each(function () {
					var row = $(this);
					var stepName = row.find("#tdStepName").attr('step-name');

					// Look for step name in file contents
					for (var i = 0; i < contents.steps.length; i++) {
						var step = contents.steps[i];
						if (step.stepName == stepName) {
							// Enabled checkbox
							row.find("#tdEnable input").prop("checked", step.isEnabled);

							// Arguments
							row.find("#tdArguments tr").each(function () {
								var argument = $(this);
								var inputName = argument.attr('input-name');

								// Look for input in file contents
								for (var j = 0; j < step.inputs.length; j++) {
									var input = step.inputs[j];
									if (input.inputName == inputName) {
										var argInput = argument.find("input, select");
										var value = input.inputValue;
										if (argInput.attr('type') == "checkbox") {
											argInput.prop("checked", (value == "true"));
										} else {
											argInput.val(value);
										}
									}
								}
							});
						}
					}
				});
			} catch (ex) {
				UIUtility_showAlert("Invalid JSON file: " + ex);
				console.error(ex);
			}
		}
		reader.readAsText(file);
	}
}

function WorkflowsMonitoring_deleteQueuedWorkflow(id) {
	UIUtility_showConfirmDialog("Are you sure you want to delete the queued workflow?", "Delete Queued Workflow", function () {
		// Remove "queued" from start of ID
		WorkflowsMonitoring_sendDeleteQueuedWorkflowRequest(id.substring(6));
	});
}

function WorkflowsMonitoring_getCurrentWorkflowRow() {
	// Get current workflow
	var workflowRunId = $("#hdnActiveWorkflowRunId").val();
	if (isStringEmpty(workflowRunId)) {
		UIUtility_showAlert("No current workflow", "Error");
		return undefined;
	}
	var workflowTR = $(".LMTableRowHighlighted[id='" + workflowRunId + "']");
	if (workflowTR.length == 0) {
		UIUtility_showAlert("Current workflow isn't selected from a list", "Error");
		return undefined;
	}
	return workflowTR;
}

function WorkflowsMonitoring_onWorkflowRowClick(elem) {
	if (elem.is("tr, td, .WorkflowStatusSpan")) {
		// If clicked on something that's not a td/tr but some special element, don't view the run
		WorkflowsMonitoring_viewWorkflowRun(elem);
	}
}

/** javascripts/workflows/WorkflowsRequestDispatcherHelper.js **/
function WorkflowsMng_sendLoadWorkflow(workflowId, workflowName, autoDeployment, hostIps, contextAsJson, sessionUUID, mergeTPExecId, sameWindow) {
	var windowName = undefined;
	var linkUrl = 
		'/tasks/DisplayWorkflow?workflowId=' + workflowId + 
		'&workflowName=' + workflowName + 
		'&autoDeployment=' + autoDeployment;

	if (sessionUUID != undefined) {
		linkUrl += "&sessionUUID=" + sessionUUID;
		windowName = "WorkflowRunning_" + sessionUUID;
	}

	var obj = {
		hostsDataAsJson: JSON.stringify({ hostsIps: hostIps }),
		contextDataAsJson: JSON.stringify(contextAsJson)
	}

	PostJsonToNewWindow(linkUrl, obj, (sameWindow ? "_self" : windowName));
}

function WorkflowsMng_sendLoadAutoDeploymentWorkflowFromTP(testPlanId, hostIps, contextAsJson, mergeTPExecId, target, forceWorkflowId) {
	var link = '/tasks/DisplayAutoDeploymentWorkflowForTP/' + testPlanId + "/" + insertReplacers(mergeTPExecId);

	var obj = {
		hostsDataAsJson: JSON.stringify({ hostsIps: hostIps }),
		contextDataAsJson: JSON.stringify(contextAsJson),
	};
	if (forceWorkflowId != undefined) {
		obj.forceWorkflowId = forceWorkflowId;
	}

	PostJsonToNewWindow(link, obj, (target == undefined ? "WorkflowRunning_" + generateUUID() : target));
}

function WorkflowsMng_sendRunWorkflow(runWorkflowRequestAsJson, enableQueueing, optCont) {

	// Prepare the request url
	var linkUrl = '/tasks/RunWorkflow/' + enableQueueing;

	pageLoading();

	// Show the 'Skip' button & hide the 'Next' button for closed loop
	if (isClosedLoop()) {
		$('#tdSkip').removeClass('inactive');
		$('#tdNext').addClass('inactive');
	}

	// Empty start and end times in the header
	$('#endTimeLabel').text("-");
	$('#startTimeLabel').text("-");

	// Disable running again until result is back
	$("#btnRunWorkflow").prop("disabled", true).addClass('ui-state-disabled');

	// Send the request
	var xmlhttp = PostJson(linkUrl, true, runWorkflowRequestAsJson);

	// Wait for the response
	xmlhttp.onreadystatechange=function() {
		var status 				= false;

		var viewWorkflowRunning = $('#btnViewWorkflowRunning');
		if (xmlhttp.readyState == 4) {
			if (xmlhttp.status == 200) {
				var statusDescription 	= '';
				
				// Parse to json
				var responseAsJson = JSON.parse(xmlhttp.responseText);

				status = responseAsJson.status;

				if (status) {
					// Show a message with a link to the monitoring
					statusDescription = 'Workflow sent';

					// If it's a queued workflow, set run ID to 1, it's irrelevant
					if (responseAsJson.queuedWorkflowId > 0) {
						responseAsJson.workflowRunId = -1;
					}

					// Attach the on click with the workflow run id & show the button
					if (viewWorkflowRunning.length > 0 && responseAsJson.workflowRunId != undefined) {
						UIUtility_initializeButton('btnViewWorkflowRunning', 'ui-icon-folder-open');
						viewWorkflowRunning.unbind('click');
						viewWorkflowRunning.click(function() { 
							WorkflowsMonitoring_displayWorkflowsMonitoringWithWorkflowRunId(responseAsJson.workflowRunId);
						});

						// Observe new workflow
						var socket = $('body').data('socket');
						WebSockets_ObserveEntity(socket, "WORKFLOW", responseAsJson.workflowRunId, WorkflowsMonitoring_createWorkflowSummaryMH());

						// If auto deployment and not add to execution, save inputs in session, clear the table and re-render it
						if ($("#hdnAutoDeployment").data('isAutoDeployment')) {
							var session = $("#hdnContext").data('context');
							if (session['mergeTPExecutionId'] == undefined) {
								for (var key in runWorkflowRequestAsJson.context) {
									session[key] = runWorkflowRequestAsJson.context[key];
								}
								$("#hdnContext").data('context', session);
								var originalCheckboxes = $('#tblWorkflowSteps tbody tr #chkEnable');
								$('#tblWorkflowSteps tbody tr').remove();
								WorkflowsMng_renderWorkflowContent();
								
								// Restore enabled checkboxes state
								var newCheckboxes = $('#tblWorkflowSteps tbody tr #chkEnable');
								for (var i = 0; i < newCheckboxes.length; i++) {
									$(newCheckboxes[i]).prop("checked", $(originalCheckboxes[i]).prop("checked"));
								}
							}
						}
					}
				} else {
					statusDescription =  responseAsJson.errDescription;
				}
			} else {
				console.log(xmlhttp.responseText);
				statusDescription = 'Failed to run the workflow due to unkown reason';

				// Allow to run again
				var runWorkflowButton = $("#btnRunWorkflow");
				if (runWorkflowButton.length > 0) {
					runWorkflowButton.prop("disabled", false).removeClass('ui-state-disabled');
				}
			}

			if (viewWorkflowRunning.length > 0) {
				if (!status) {
					viewWorkflowRunning.css('display', 'none');
				} else {
					viewWorkflowRunning.css('display', 'inline');
					UIUtility_initializeButton('btnViewWorkflowRunning'	, 'ui-icon-folder-open');
				}
				if ($("#actionResultSummary").length > 0) {
					updateUIWithUserMessage('#actionResultSummary', status, statusDescription);

					if (status == false) {
						// Allow to run again
						var runWorkflowButton = $("#btnRunWorkflow");
						if (runWorkflowButton.length > 0) {
							runWorkflowButton.prop("disabled", false).removeClass('ui-state-disabled');
						}
					}
				} else {
					UIUtility_showAlert(statusDescription, "Error");
				}

				// Slide the notification & provide a link
				WorkflowsMng_showRunWorkflowStatus();
			}

			pageFinishedLoading();

			if (optCont != undefined) {
				optCont(status);
			}
		}
	};
}

function WorkflowsMonitoring_createWorkflowSummaryMH() {
	$("#actionResultSummary").data('updated', false);
	return function (data) {
		// In case the workflow finished before socket registration, the first update might be of null state, in this case - treat like failure
		// Unless already received another state before
		if (!$("#actionResultSummary").data('updated') && data.STATE === null) {
			data.STATE = "Failed";
		}

		// Update the UI
		if (data.STATE != undefined) {
			// Check if this is auto deployment
			var isAutoDeployment = $('#hdnAutoDeployment').data('isAutoDeployment');

			var isFinished = false;
			var success = true;
			var resultAsHtml = "";
			if (data.STATE == "Success") {
				resultAsHtml += 'The workflow completed with status: <span class="WorkflowStatusSUCCESS">&nbspSuccess&nbsp</span><br/>';
				resultAsHtml += 'All agents passed successfully.<br/>';

				// Allow to run again
				$("#btnRunWorkflow").prop("disabled", false).removeClass('ui-state-disabled');

				// Hide the 'Skip' button & show the 'Next' button (relevant for closed loop)
				if (isClosedLoop()) {
					$('#tdSkip').addClass('inactive');
					$('#tdNext').removeClass('inactive');
				}

				isFinished = true;
			} else if (data.STATE == "In Progress") {
				// Show view button
				$('#btnViewWorkflowRunning').removeClass('inactive');

				// Simulate in progress
				resultAsHtml += 'The workflow has started.<br/>';
			} else if (data.STATE == "Failed") {
				// Simulate total failure
				resultAsHtml += 'The workflow completed with status: <span class="WorkflowStatusFAILED">&nbspFailed&nbsp</span><br/>';
				resultAsHtml += 'All agents failed.<br/>';

				// Allow to run again
				$("#btnRunWorkflow").prop("disabled", false).removeClass('ui-state-disabled');

				success = false;
				isFinished = true;
			} else if (data.STATE == "Warning") {
				// Simulate partial success
				resultAsHtml += 'The workflow completed with status: <span class="WorkflowStatusWARNING">&nbspWarning&nbsp</span><br/>';

				// Hide the 'Skip' button & show the 'Next' button (relevant for closed loop)
				if (isClosedLoop()) {
					$('#tdSkip').addClass('inactive');
					$('#tdNext').removeClass('inactive');
				}

				// Allow to run again
				$("#btnRunWorkflow").prop("disabled", false).removeClass('ui-state-disabled');
				isFinished = true;
			}

			// Show workflow passed hosts in message if relevant
			if (data.PASSED_HOSTS != undefined) {
				var passedAgents = JSON.parse(data.PASSED_HOSTS);
				if (passedAgents.length > 0) {
					$("#divAgentNames > div").each(function () {
						var $this = $(this);
						var hostIp = $this.find("span:first").text().trim();
						if ($.inArray(hostIp, passedAgents) != -1) {
							$this.find("#txtHostIp").html("<span>" + hostIp + "</span> <span class='UserMessageSuccess'>(Passed)</span>");
						}
					})
				}
			}

			if (resultAsHtml != "") {
				updateUIWithUserMessage('#actionResultSummary', success, resultAsHtml);
				$("#actionResultSummary").data('updated', true);
			}

			if (isFinished) {
				// Query session for passed agents in case we're in auto deployment
				if ($('#hdnAutoDeployment').data('isAutoDeployment')) {
					PostJsonWithJsonFeedbackFuncs(
							'/getSession',
							true,
							{ sessionUUID: $('#hdnContext').data("context").sessionUUID },
							function (session) {
								var passedAgents = [];
								if (session.passedAgents != undefined) {
									passedAgents = session.passedAgents;
								}
								WorkflowsMng_updatePassedAgents(passedAgents);
							},
							function (text) { UIUtility_showAlert("Can't get auto deployment's passed agents: " + text); });
				}

				// Jump to first (run) panel
				$("#tabs").tabs('option', 'active', 0);
			}
		}
		if (data.END_TIME != undefined) {
			$('#endTimeLabel').text(data.END_TIME);
		}
		if (data.START_TIME != undefined) {
			$('#startTimeLabel').text(data.START_TIME);
		}
	};
}

/**
 * Initializes a generic web socket which can be later used for observing the workflow entity.
 */
function WorkflowsMonitoring_initGenericWebSocket() {
	var socket = WebSockets_Open(function (event) {
		WebSockets_ConnectFields(event.target, ["STATE", "PASSED_HOSTS"]);
	});
	$('body').data('socket', socket);
}

function WorkflowsMonitoring_displayWorkflowsMonitoringWithWorkflowRunId(workflowRunId) {

	// Prepare the request url
	var linkUrl = '/tasks/DisplayWorkflowRuns?workflowRunId=' + workflowRunId;
	
	OpenNewTab(linkUrl)
}

function WorkflowsMonitoring_sendViewWorkflow(workflowRunId) {
	
	// Prepare the request url
	var linkUrl = '/tasks/ViewWorkflowRun?workflowRunId=' + workflowRunId;

	pageLoading();

	// Send the request
	var xmlhttp = Get(linkUrl);

	// Wait for the response
	xmlhttp.onreadystatechange=function() {
		if (xmlhttp.readyState == 4) {
			if (xmlhttp.status == 200) {

				pageFinishedLoading();
				
				// Parse to json
				var responseAsJson = JSON.parse(xmlhttp.responseText);
				
				// Render the workflow run data
				WorkflowsMonitoring_renderWorkflowRun(responseAsJson);
				
				// Show the workflow run view
				$('#workflowRunContent').removeClass("inactive");
				$('#navButtons').removeClass("inactive");
			}
		}
	};
} 

function WorkflowsMonitoring_sendGetHistoryWorkflows(timeRangeType, startingAt) {
	pageLoading();

	// Prepare the request url
	var linkUrl = '/tasks/GetHistoryWorkflows?timeRangeType=' + timeRangeType;
	if (startingAt != undefined) {
		linkUrl += "&startingAt=" + startingAt;
	}
	
	// Send the request
	var xmlhttp = Get(linkUrl);
	
	// Wait for the response
	xmlhttp.onreadystatechange=function() {
		if (xmlhttp.readyState == 4) {
			if (xmlhttp.status == 200) {

				// Parse to json
				var responseAsJson = JSON.parse(xmlhttp.responseText);
				
				// Render the workflow runs data
				WorkflowsMonitoring_populateNewWorkflowRowsInHistory(responseAsJson);

				relayoutStretchContainers();
			}
			
			pageFinishedLoading();
		}
	};
}

function WorkflowsMonitoring_sendStopWorkflowRun(workflowRunId, abort, killProcess, agentName, optSuccessFunc, optFailureFunc) {
	// Prepare the request url
	var linkUrl = '/tasks/StopWorkflowRun?workflowRunId=' + workflowRunId + "&abort=" + abort + "&killProcess=" + killProcess + "&agentName="
	if (agentName != undefined) {
		linkUrl += agentName;
	}

	// Send the request
	var xmlhttp = Get(linkUrl, optSuccessFunc, optFailureFunc);

	// Wait for the response
	if (optSuccessFunc == undefined && optFailureFunc == undefined) {
		xmlhttp.onreadystatechange=function() {
			if (xmlhttp.readyState == 4) {
				if (xmlhttp.status != 200) {
					UIUtility_showAlert(xmlhttp.responseText, "Error");
				}
			}
		};
	}
}

function WorkflowsMng_getValidationInfo(agentNames, workflowId, contOpt) {
	PostJsonWithJsonFeedbackFuncs('/tasks/GetWorkflowValidationInfo', true, { agentNames: agentNames, workflowId: workflowId },
		function (result) {
			if (contOpt != undefined) {
				contOpt(result);
			}
		},
		function (error) {
			UIUtility_showAlert(error, "Error");
		});
}

function WorkflowsMonitoring_sendDeleteQueuedWorkflowRequest(id) {
	PostJsonWithJsonFeedbackFuncs('/tasks/DeleteQueuedWorkflow/' + id, true, { },
			function (result) {
			},
			function (error) {
				UIUtility_showAlert(error, "Error");
			});
}

function WorkflowsMng_GetStepInputPossibleValues(inputId, dependencyValues, successCont) {
	PostJsonWithJsonFeedbackFuncs('/tasks/GetStepInputPossibleValues', true, {
				inputId: inputId,
				dependencyValues: dependencyValues
			},
			successCont,
			function (error) {
				UIUtility_showAlert(error, "Error");
			});
}

/** javascripts/ui-controls/jquery.multiple.select.js **/
/**
 * @author zhixin wen <wenzhixin2010@gmail.com>
 * @version 1.2.1
 *
 * http://wenzhixin.net.cn/p/multiple-select/
 */

(function ($) {

    'use strict';

    // it only does '%s', and return '' when arguments are undefined
    var sprintf = function (str) {
        var args = arguments,
            flag = true,
            i = 1;

        str = str.replace(/%s/g, function () {
            var arg = args[i++];

            if (typeof arg === 'undefined') {
                flag = false;
                return '';
            }
            return arg;
        });
        return flag ? str : '';
    };

    var removeDiacritics = function (str) {
        var defaultDiacriticsRemovalMap = [
            {'base':'A', 'letters':/[\u0041\u24B6\uFF21\u00C0\u00C1\u00C2\u1EA6\u1EA4\u1EAA\u1EA8\u00C3\u0100\u0102\u1EB0\u1EAE\u1EB4\u1EB2\u0226\u01E0\u00C4\u01DE\u1EA2\u00C5\u01FA\u01CD\u0200\u0202\u1EA0\u1EAC\u1EB6\u1E00\u0104\u023A\u2C6F]/g},
            {'base':'AA','letters':/[\uA732]/g},
            {'base':'AE','letters':/[\u00C6\u01FC\u01E2]/g},
            {'base':'AO','letters':/[\uA734]/g},
            {'base':'AU','letters':/[\uA736]/g},
            {'base':'AV','letters':/[\uA738\uA73A]/g},
            {'base':'AY','letters':/[\uA73C]/g},
            {'base':'B', 'letters':/[\u0042\u24B7\uFF22\u1E02\u1E04\u1E06\u0243\u0182\u0181]/g},
            {'base':'C', 'letters':/[\u0043\u24B8\uFF23\u0106\u0108\u010A\u010C\u00C7\u1E08\u0187\u023B\uA73E]/g},
            {'base':'D', 'letters':/[\u0044\u24B9\uFF24\u1E0A\u010E\u1E0C\u1E10\u1E12\u1E0E\u0110\u018B\u018A\u0189\uA779]/g},
            {'base':'DZ','letters':/[\u01F1\u01C4]/g},
            {'base':'Dz','letters':/[\u01F2\u01C5]/g},
            {'base':'E', 'letters':/[\u0045\u24BA\uFF25\u00C8\u00C9\u00CA\u1EC0\u1EBE\u1EC4\u1EC2\u1EBC\u0112\u1E14\u1E16\u0114\u0116\u00CB\u1EBA\u011A\u0204\u0206\u1EB8\u1EC6\u0228\u1E1C\u0118\u1E18\u1E1A\u0190\u018E]/g},
            {'base':'F', 'letters':/[\u0046\u24BB\uFF26\u1E1E\u0191\uA77B]/g},
            {'base':'G', 'letters':/[\u0047\u24BC\uFF27\u01F4\u011C\u1E20\u011E\u0120\u01E6\u0122\u01E4\u0193\uA7A0\uA77D\uA77E]/g},
            {'base':'H', 'letters':/[\u0048\u24BD\uFF28\u0124\u1E22\u1E26\u021E\u1E24\u1E28\u1E2A\u0126\u2C67\u2C75\uA78D]/g},
            {'base':'I', 'letters':/[\u0049\u24BE\uFF29\u00CC\u00CD\u00CE\u0128\u012A\u012C\u0130\u00CF\u1E2E\u1EC8\u01CF\u0208\u020A\u1ECA\u012E\u1E2C\u0197]/g},
            {'base':'J', 'letters':/[\u004A\u24BF\uFF2A\u0134\u0248]/g},
            {'base':'K', 'letters':/[\u004B\u24C0\uFF2B\u1E30\u01E8\u1E32\u0136\u1E34\u0198\u2C69\uA740\uA742\uA744\uA7A2]/g},
            {'base':'L', 'letters':/[\u004C\u24C1\uFF2C\u013F\u0139\u013D\u1E36\u1E38\u013B\u1E3C\u1E3A\u0141\u023D\u2C62\u2C60\uA748\uA746\uA780]/g},
            {'base':'LJ','letters':/[\u01C7]/g},
            {'base':'Lj','letters':/[\u01C8]/g},
            {'base':'M', 'letters':/[\u004D\u24C2\uFF2D\u1E3E\u1E40\u1E42\u2C6E\u019C]/g},
            {'base':'N', 'letters':/[\u004E\u24C3\uFF2E\u01F8\u0143\u00D1\u1E44\u0147\u1E46\u0145\u1E4A\u1E48\u0220\u019D\uA790\uA7A4]/g},
            {'base':'NJ','letters':/[\u01CA]/g},
            {'base':'Nj','letters':/[\u01CB]/g},
            {'base':'O', 'letters':/[\u004F\u24C4\uFF2F\u00D2\u00D3\u00D4\u1ED2\u1ED0\u1ED6\u1ED4\u00D5\u1E4C\u022C\u1E4E\u014C\u1E50\u1E52\u014E\u022E\u0230\u00D6\u022A\u1ECE\u0150\u01D1\u020C\u020E\u01A0\u1EDC\u1EDA\u1EE0\u1EDE\u1EE2\u1ECC\u1ED8\u01EA\u01EC\u00D8\u01FE\u0186\u019F\uA74A\uA74C]/g},
            {'base':'OI','letters':/[\u01A2]/g},
            {'base':'OO','letters':/[\uA74E]/g},
            {'base':'OU','letters':/[\u0222]/g},
            {'base':'P', 'letters':/[\u0050\u24C5\uFF30\u1E54\u1E56\u01A4\u2C63\uA750\uA752\uA754]/g},
            {'base':'Q', 'letters':/[\u0051\u24C6\uFF31\uA756\uA758\u024A]/g},
            {'base':'R', 'letters':/[\u0052\u24C7\uFF32\u0154\u1E58\u0158\u0210\u0212\u1E5A\u1E5C\u0156\u1E5E\u024C\u2C64\uA75A\uA7A6\uA782]/g},
            {'base':'S', 'letters':/[\u0053\u24C8\uFF33\u1E9E\u015A\u1E64\u015C\u1E60\u0160\u1E66\u1E62\u1E68\u0218\u015E\u2C7E\uA7A8\uA784]/g},
            {'base':'T', 'letters':/[\u0054\u24C9\uFF34\u1E6A\u0164\u1E6C\u021A\u0162\u1E70\u1E6E\u0166\u01AC\u01AE\u023E\uA786]/g},
            {'base':'TZ','letters':/[\uA728]/g},
            {'base':'U', 'letters':/[\u0055\u24CA\uFF35\u00D9\u00DA\u00DB\u0168\u1E78\u016A\u1E7A\u016C\u00DC\u01DB\u01D7\u01D5\u01D9\u1EE6\u016E\u0170\u01D3\u0214\u0216\u01AF\u1EEA\u1EE8\u1EEE\u1EEC\u1EF0\u1EE4\u1E72\u0172\u1E76\u1E74\u0244]/g},
            {'base':'V', 'letters':/[\u0056\u24CB\uFF36\u1E7C\u1E7E\u01B2\uA75E\u0245]/g},
            {'base':'VY','letters':/[\uA760]/g},
            {'base':'W', 'letters':/[\u0057\u24CC\uFF37\u1E80\u1E82\u0174\u1E86\u1E84\u1E88\u2C72]/g},
            {'base':'X', 'letters':/[\u0058\u24CD\uFF38\u1E8A\u1E8C]/g},
            {'base':'Y', 'letters':/[\u0059\u24CE\uFF39\u1EF2\u00DD\u0176\u1EF8\u0232\u1E8E\u0178\u1EF6\u1EF4\u01B3\u024E\u1EFE]/g},
            {'base':'Z', 'letters':/[\u005A\u24CF\uFF3A\u0179\u1E90\u017B\u017D\u1E92\u1E94\u01B5\u0224\u2C7F\u2C6B\uA762]/g},
            {'base':'a', 'letters':/[\u0061\u24D0\uFF41\u1E9A\u00E0\u00E1\u00E2\u1EA7\u1EA5\u1EAB\u1EA9\u00E3\u0101\u0103\u1EB1\u1EAF\u1EB5\u1EB3\u0227\u01E1\u00E4\u01DF\u1EA3\u00E5\u01FB\u01CE\u0201\u0203\u1EA1\u1EAD\u1EB7\u1E01\u0105\u2C65\u0250]/g},
            {'base':'aa','letters':/[\uA733]/g},
            {'base':'ae','letters':/[\u00E6\u01FD\u01E3]/g},
            {'base':'ao','letters':/[\uA735]/g},
            {'base':'au','letters':/[\uA737]/g},
            {'base':'av','letters':/[\uA739\uA73B]/g},
            {'base':'ay','letters':/[\uA73D]/g},
            {'base':'b', 'letters':/[\u0062\u24D1\uFF42\u1E03\u1E05\u1E07\u0180\u0183\u0253]/g},
            {'base':'c', 'letters':/[\u0063\u24D2\uFF43\u0107\u0109\u010B\u010D\u00E7\u1E09\u0188\u023C\uA73F\u2184]/g},
            {'base':'d', 'letters':/[\u0064\u24D3\uFF44\u1E0B\u010F\u1E0D\u1E11\u1E13\u1E0F\u0111\u018C\u0256\u0257\uA77A]/g},
            {'base':'dz','letters':/[\u01F3\u01C6]/g},
            {'base':'e', 'letters':/[\u0065\u24D4\uFF45\u00E8\u00E9\u00EA\u1EC1\u1EBF\u1EC5\u1EC3\u1EBD\u0113\u1E15\u1E17\u0115\u0117\u00EB\u1EBB\u011B\u0205\u0207\u1EB9\u1EC7\u0229\u1E1D\u0119\u1E19\u1E1B\u0247\u025B\u01DD]/g},
            {'base':'f', 'letters':/[\u0066\u24D5\uFF46\u1E1F\u0192\uA77C]/g},
            {'base':'g', 'letters':/[\u0067\u24D6\uFF47\u01F5\u011D\u1E21\u011F\u0121\u01E7\u0123\u01E5\u0260\uA7A1\u1D79\uA77F]/g},
            {'base':'h', 'letters':/[\u0068\u24D7\uFF48\u0125\u1E23\u1E27\u021F\u1E25\u1E29\u1E2B\u1E96\u0127\u2C68\u2C76\u0265]/g},
            {'base':'hv','letters':/[\u0195]/g},
            {'base':'i', 'letters':/[\u0069\u24D8\uFF49\u00EC\u00ED\u00EE\u0129\u012B\u012D\u00EF\u1E2F\u1EC9\u01D0\u0209\u020B\u1ECB\u012F\u1E2D\u0268\u0131]/g},
            {'base':'j', 'letters':/[\u006A\u24D9\uFF4A\u0135\u01F0\u0249]/g},
            {'base':'k', 'letters':/[\u006B\u24DA\uFF4B\u1E31\u01E9\u1E33\u0137\u1E35\u0199\u2C6A\uA741\uA743\uA745\uA7A3]/g},
            {'base':'l', 'letters':/[\u006C\u24DB\uFF4C\u0140\u013A\u013E\u1E37\u1E39\u013C\u1E3D\u1E3B\u017F\u0142\u019A\u026B\u2C61\uA749\uA781\uA747]/g},
            {'base':'lj','letters':/[\u01C9]/g},
            {'base':'m', 'letters':/[\u006D\u24DC\uFF4D\u1E3F\u1E41\u1E43\u0271\u026F]/g},
            {'base':'n', 'letters':/[\u006E\u24DD\uFF4E\u01F9\u0144\u00F1\u1E45\u0148\u1E47\u0146\u1E4B\u1E49\u019E\u0272\u0149\uA791\uA7A5]/g},
            {'base':'nj','letters':/[\u01CC]/g},
            {'base':'o', 'letters':/[\u006F\u24DE\uFF4F\u00F2\u00F3\u00F4\u1ED3\u1ED1\u1ED7\u1ED5\u00F5\u1E4D\u022D\u1E4F\u014D\u1E51\u1E53\u014F\u022F\u0231\u00F6\u022B\u1ECF\u0151\u01D2\u020D\u020F\u01A1\u1EDD\u1EDB\u1EE1\u1EDF\u1EE3\u1ECD\u1ED9\u01EB\u01ED\u00F8\u01FF\u0254\uA74B\uA74D\u0275]/g},
            {'base':'oi','letters':/[\u01A3]/g},
            {'base':'ou','letters':/[\u0223]/g},
            {'base':'oo','letters':/[\uA74F]/g},
            {'base':'p','letters':/[\u0070\u24DF\uFF50\u1E55\u1E57\u01A5\u1D7D\uA751\uA753\uA755]/g},
            {'base':'q','letters':/[\u0071\u24E0\uFF51\u024B\uA757\uA759]/g},
            {'base':'r','letters':/[\u0072\u24E1\uFF52\u0155\u1E59\u0159\u0211\u0213\u1E5B\u1E5D\u0157\u1E5F\u024D\u027D\uA75B\uA7A7\uA783]/g},
            {'base':'s','letters':/[\u0073\u24E2\uFF53\u00DF\u015B\u1E65\u015D\u1E61\u0161\u1E67\u1E63\u1E69\u0219\u015F\u023F\uA7A9\uA785\u1E9B]/g},
            {'base':'t','letters':/[\u0074\u24E3\uFF54\u1E6B\u1E97\u0165\u1E6D\u021B\u0163\u1E71\u1E6F\u0167\u01AD\u0288\u2C66\uA787]/g},
            {'base':'tz','letters':/[\uA729]/g},
            {'base':'u','letters':/[\u0075\u24E4\uFF55\u00F9\u00FA\u00FB\u0169\u1E79\u016B\u1E7B\u016D\u00FC\u01DC\u01D8\u01D6\u01DA\u1EE7\u016F\u0171\u01D4\u0215\u0217\u01B0\u1EEB\u1EE9\u1EEF\u1EED\u1EF1\u1EE5\u1E73\u0173\u1E77\u1E75\u0289]/g},
            {'base':'v','letters':/[\u0076\u24E5\uFF56\u1E7D\u1E7F\u028B\uA75F\u028C]/g},
            {'base':'vy','letters':/[\uA761]/g},
            {'base':'w','letters':/[\u0077\u24E6\uFF57\u1E81\u1E83\u0175\u1E87\u1E85\u1E98\u1E89\u2C73]/g},
            {'base':'x','letters':/[\u0078\u24E7\uFF58\u1E8B\u1E8D]/g},
            {'base':'y','letters':/[\u0079\u24E8\uFF59\u1EF3\u00FD\u0177\u1EF9\u0233\u1E8F\u00FF\u1EF7\u1E99\u1EF5\u01B4\u024F\u1EFF]/g},
            {'base':'z','letters':/[\u007A\u24E9\uFF5A\u017A\u1E91\u017C\u017E\u1E93\u1E95\u01B6\u0225\u0240\u2C6C\uA763]/g}
        ];

        for (var i = 0; i < defaultDiacriticsRemovalMap.length; i++) {
            str = str.replace(defaultDiacriticsRemovalMap[i].letters, defaultDiacriticsRemovalMap[i].base);
        }

        return str;

   };

    function MultipleSelect($el, options) {
        var that = this,
            name = $el.attr('name') || options.name || '';

        this.options = options;

        // hide select element
        this.$el = $el.hide();

        // label element
        this.$label = this.$el.closest('label');
        if (this.$label.length === 0 && this.$el.attr('id')) {
            this.$label = $(sprintf('label[for="%s"]', this.$el.attr('id').replace(/:/g, '\\:')));
        }

        // restore class and title from select element
        this.$parent = $(sprintf(
            '<div class="ms-parent %s" %s/>',
            $el.attr('class') || '',
            sprintf('title="%s"', $el.attr('title'))));

        // add placeholder to choice button
        this.$choice = $(sprintf([
                '<button type="button" class="ms-choice">',
                '<span class="placeholder">%s</span>',
                '<div></div>',
                '</button>'
            ].join(''),
            this.options.placeholder));

        // default position is bottom
        this.$drop = $(sprintf('<div class="ms-drop %s"%s></div>',
            this.options.position,
            sprintf(' style="width: %s"', this.options.dropWidth)));

        this.$el.after(this.$parent);
        this.$parent.append(this.$choice);
        this.$parent.append(this.$drop);

        if (this.$el.prop('disabled')) {
            this.$choice.addClass('disabled');
        }
        this.$parent.css('width',
            this.options.width ||
            this.$el.css('width') ||
            this.$el.outerWidth() + 20);

        this.selectAllName = 'data-name="selectAll' + name + '"';
        this.selectGroupName = 'data-name="selectGroup' + name + '"';
        this.selectItemName = 'data-name="selectItem' + name + '"';

        if (!this.options.keepOpen) {
            $(document).click(function (e) {
                if ($(e.target)[0] === that.$choice[0] ||
                    $(e.target).parents('.ms-choice')[0] === that.$choice[0]) {
                    return;
                }
                if (($(e.target)[0] === that.$drop[0] ||
                    $(e.target).parents('.ms-drop')[0] !== that.$drop[0] && e.target !== $el[0]) &&
                    that.options.isOpen) {
                    that.close();
                }
            });
        }
    }

    MultipleSelect.prototype = {
        constructor: MultipleSelect,

        init: function () {
            var that = this,
                $ul = $('<ul></ul>');

            this.$drop.html('');

            if (this.options.filter) {
                this.$drop.append([
                    '<div class="ms-search">',
                    '<input type="text" autocomplete="off" autocorrect="off" autocapitilize="off" spellcheck="false">',
                    '</div>'].join('')
                );
            }

            if (this.options.selectAll && !this.options.single) {
                $ul.append([
                    '<li class="ms-select-all">',
                    '<label>',
                    sprintf('<input type="checkbox" %s /> ', this.selectAllName),
                    this.options.selectAllDelimiter[0],
                    this.options.selectAllText,
                    this.options.selectAllDelimiter[1],
                    '</label>',
                    '</li>'
                ].join(''));
            }

            $.each(this.$el.children(), function (i, elm) {
                $ul.append(that.optionToHtml(i, elm));
            });
            $ul.append(sprintf('<li class="ms-no-results">%s</li>', this.options.noMatchesFound));
            this.$drop.append($ul);

            this.$drop.find('ul').css('max-height', this.options.maxHeight + 'px');
            this.$drop.find('.multiple').css('width', this.options.multipleWidth + 'px');

            this.$searchInput = this.$drop.find('.ms-search input');
            this.$selectAll = this.$drop.find('input[' + this.selectAllName + ']');
            this.$selectGroups = this.$drop.find('input[' + this.selectGroupName + ']');
            this.$selectItems = this.$drop.find('input[' + this.selectItemName + ']:enabled');
            this.$disableItems = this.$drop.find('input[' + this.selectItemName + ']:disabled');
            this.$noResults = this.$drop.find('.ms-no-results');

            this.events();
            this.updateSelectAll(true);
            this.update(true);

            if (this.options.isOpen) {
                this.open();
            }
        },

        optionToHtml: function (i, elm, group, groupDisabled) {
            var that = this,
                $elm = $(elm),
                classes = $elm.attr('class') || '',
                title = sprintf('title="%s"', $elm.attr('title')),
                multiple = this.options.multiple ? 'multiple' : '',
                disabled,
                type = this.options.single ? 'radio' : 'checkbox';

            if ($elm.is('option')) {
                var value = $elm.val(),
                    text = that.options.textTemplate($elm),
                    selected = $elm.prop('selected'),
                    style = sprintf('style="%s"', this.options.styler(value)),
                    $el;

                disabled = groupDisabled || $elm.prop('disabled');

                $el = $([
                    sprintf('<li class="%s %s" %s %s>', multiple, classes, title, style),
                    sprintf('<label class="%s">', disabled ? 'disabled' : ''),
                    sprintf('<input type="%s" %s%s%s%s>',
                        type, this.selectItemName,
                        selected ? ' checked="checked"' : '',
                        disabled ? ' disabled="disabled"' : '',
                        sprintf(' data-group="%s"', group)),
                    sprintf('<span>%s</span>', text),
                    '</label>',
                    '</li>'
                ].join(''));
                $el.find('input').val(value);
                return $el;
            }
            if ($elm.is('optgroup')) {
                var label = that.options.labelTemplate($elm),
                    $group = $('<div/>');

                group = 'group_' + i;
                disabled = $elm.prop('disabled');

                $group.append([
                    '<li class="group">',
                    sprintf('<label class="optgroup %s" data-group="%s">', disabled ? 'disabled' : '', group),
                    this.options.hideOptgroupCheckboxes || this.options.single ? '' :
                        sprintf('<input type="checkbox" %s %s>',
                        this.selectGroupName, disabled ? 'disabled="disabled"' : ''),
                    label,
                    '</label>',
                    '</li>'
                ].join(''));

                $.each($elm.children(), function (i, elm) {
                    $group.append(that.optionToHtml(i, elm, group, disabled));
                });
                return $group.html();
            }
        },

        events: function () {
            var that = this,
                toggleOpen = function (e) {
                    e.preventDefault();
                    that[that.options.isOpen ? 'close' : 'open']();
                };

            if (this.$label) {
                this.$label.off('click').on('click', function (e) {
                    if (e.target.nodeName.toLowerCase() !== 'label' || e.target !== this) {
                        return;
                    }
                    toggleOpen(e);
                    if (!that.options.filter || !that.options.isOpen) {
                        that.focus();
                    }
                    e.stopPropagation(); // Causes lost focus otherwise
                });
            }

            this.$choice.off('click').on('click', toggleOpen)
                .off('focus').on('focus', this.options.onFocus)
                .off('blur').on('blur', this.options.onBlur);

            this.$parent.off('keydown').on('keydown', function (e) {
                switch (e.which) {
                    case 27: // esc key
                        that.close();
                        that.$choice.focus();
                        break;
                }
            });

            this.$searchInput.off('keydown').on('keydown',function (e) {
                // Ensure shift-tab causes lost focus from filter as with clicking away
                if (e.keyCode === 9 && e.shiftKey) {
                    that.close();
                }
            }).off('keyup').on('keyup', function (e) {
                // enter or space
                // Avoid selecting/deselecting if no choices made
                if (that.options.filterAcceptOnEnter && (e.which === 13 || e.which == 32) && that.$searchInput.val()) {
                    that.$selectAll.click();
                    that.close();
                    that.focus();
                    return;
                }
                that.filter();
            });

            this.$selectAll.off('click').on('click', function () {
                var checked = $(this).prop('checked'),
                    $items = that.$selectItems.filter(':visible');

                if ($items.length === that.$selectItems.length) {
                    that[checked ? 'checkAll' : 'uncheckAll']();
                } else { // when the filter option is true
                    that.$selectGroups.prop('checked', checked);
                    $items.prop('checked', checked);
                    that.options[checked ? 'onCheckAll' : 'onUncheckAll']();
                    that.update();
                }
            });
            this.$selectGroups.off('click').on('click', function () {
                var group = $(this).parent().attr('data-group'),
                    $items = that.$selectItems.filter(':visible'),
                    $children = $items.filter(sprintf('[data-group="%s"]', group)),
                    checked = $children.length !== $children.filter(':checked').length;

                $children.prop('checked', checked);
                that.updateSelectAll();
                that.update();
                that.options.onOptgroupClick({
                    label: $(this).parent().text(),
                    checked: checked,
                    children: $children.get(),
                    instance: that
                });
            });
            this.$selectItems.off('click').on('click', function () {
                that.updateSelectAll();
                that.update();
                that.updateOptGroupSelect();
                that.options.onClick({
                    label: $(this).parent().text(),
                    value: $(this).val(),
                    checked: $(this).prop('checked'),
                    instance: that
                });

                if (that.options.single && that.options.isOpen && !that.options.keepOpen) {
                    that.close();
                }

                if (that.options.single) {
                    var clickedVal = $(this).val();
                    that.$selectItems.filter(function() {
                        return $(this).val() !== clickedVal;
                    }).each(function() {
                        $(this).prop('checked', false);
                    });
                    that.update();
                }
            });
        },

        open: function () {
            if (this.$choice.hasClass('disabled')) {
                return;
            }
            this.options.isOpen = true;
            this.$choice.find('>div').addClass('open');
            this.$drop[this.animateMethod('show')]();

            // fix filter bug: no results show
            this.$selectAll.parent().show();
            this.$noResults.hide();

            // Fix #77: 'All selected' when no options
            if (!this.$el.children().length) {
                this.$selectAll.parent().hide();
                this.$noResults.show();
            }

            if (this.options.container) {
                var offset = this.$drop.offset();
                this.$drop.appendTo($(this.options.container));
                this.$drop.offset({
                    top: offset.top,
                    left: offset.left
                });
            }

            if (this.options.filter) {
                this.$searchInput.val('');
                this.$searchInput.focus();
                this.filter();
            }
            this.options.onOpen();
        },

        close: function () {
            this.options.isOpen = false;
            this.$choice.find('>div').removeClass('open');
            this.$drop[this.animateMethod('hide')]();
            if (this.options.container) {
                this.$parent.append(this.$drop);
                this.$drop.css({
                    'top': 'auto',
                    'left': 'auto'
                });
            }
            this.options.onClose();
        },

        animateMethod: function (method) {
            var methods = {
                show: {
                    fade: 'fadeIn',
                    slide: 'slideDown'
                },
                hide: {
                    fade: 'fadeOut',
                    slide: 'slideUp'
                }
            };

            return methods[method][this.options.animate] || method;
        },

        update: function (isInit) {
            var selects = this.options.displayValues ? this.getSelects() : this.getSelects('text'),
                $span = this.$choice.find('>span'),
                sl = selects.length;

            if (sl === 0) {
                $span.addClass('placeholder').html(this.options.placeholder);
            } else if (this.options.allSelected && sl === this.$selectItems.length + this.$disableItems.length) {
                $span.removeClass('placeholder').html(this.options.allSelected);
            } else if (this.options.ellipsis && sl > this.options.minimumCountSelected) {
                $span.removeClass('placeholder').text(selects.slice(0, this.options.minimumCountSelected)
                    .join(this.options.delimiter) + '...');
            } else if (this.options.countSelected && sl > this.options.minimumCountSelected) {
                $span.removeClass('placeholder').html(this.options.countSelected
                    .replace('#', selects.length)
                    .replace('%', this.$selectItems.length + this.$disableItems.length));
            } else {
                $span.removeClass('placeholder').text(selects.join(this.options.delimiter));
            }

            if (this.options.addTitle) {
                $span.prop('title', this.getSelects('text'));
            }

            // set selects to select
            this.$el.val(this.getSelects()).trigger('change');

            // add selected class to selected li
            this.$drop.find('li').removeClass('selected');
            this.$drop.find('input:checked').each(function () {
                $(this).parents('li').first().addClass('selected');
            });

            // trigger <select> change event
            if (!isInit) {
                this.$el.trigger('change');
            }
        },

        updateSelectAll: function (isInit) {
            var $items = this.$selectItems;

            if (!isInit) {
                $items = $items.filter(':visible');
            }
            this.$selectAll.prop('checked', $items.length &&
                $items.length === $items.filter(':checked').length);
            if (!isInit && this.$selectAll.prop('checked')) {
                this.options.onCheckAll();
            }
        },

        updateOptGroupSelect: function () {
            var $items = this.$selectItems.filter(':visible');
            $.each(this.$selectGroups, function (i, val) {
                var group = $(val).parent().attr('data-group'),
                    $children = $items.filter(sprintf('[data-group="%s"]', group));
                $(val).prop('checked', $children.length &&
                    $children.length === $children.filter(':checked').length);
            });
        },

        //value or text, default: 'value'
        getSelects: function (type) {
            var that = this,
                texts = [],
                values = [];
            this.$drop.find(sprintf('input[%s]:checked', this.selectItemName)).each(function () {
                texts.push($(this).parents('li').first().text());
                values.push($(this).val());
            });

            if (type === 'text' && this.$selectGroups.length) {
                texts = [];
                this.$selectGroups.each(function () {
                    var html = [],
                        text = $.trim($(this).parent().text()),
                        group = $(this).parent().data('group'),
                        $children = that.$drop.find(sprintf('[%s][data-group="%s"]', that.selectItemName, group)),
                        $selected = $children.filter(':checked');

                    if (!$selected.length) {
                        return;
                    }

                    html.push('[');
                    html.push(text);
                    if ($children.length > $selected.length) {
                        var list = [];
                        $selected.each(function () {
                            list.push($(this).parent().text());
                        });
                        html.push(': ' + list.join(', '));
                    }
                    html.push(']');
                    texts.push(html.join(''));
                });
            }
            return type === 'text' ? texts : values;
        },

        setSelects: function (values) {
            var that = this;
            this.$selectItems.prop('checked', false);
            this.$disableItems.prop('checked', false);
            $.each(values, function (i, value) {
                that.$selectItems.filter(sprintf('[value="%s"]', value)).prop('checked', true);
                that.$disableItems.filter(sprintf('[value="%s"]', value)).prop('checked', true);
            });
            this.$selectAll.prop('checked', this.$selectItems.length ===
                this.$selectItems.filter(':checked').length + this.$disableItems.filter(':checked').length);

            $.each(that.$selectGroups, function (i, val) {
                var group = $(val).parent().attr('data-group'),
                    $children = that.$selectItems.filter('[data-group="' + group + '"]');
                $(val).prop('checked', $children.length &&
                    $children.length === $children.filter(':checked').length);
            });

            this.update();
        },

        enable: function () {
            this.$choice.removeClass('disabled');
        },

        disable: function () {
            this.$choice.addClass('disabled');
        },

        checkAll: function () {
            this.$selectItems.prop('checked', true);
            this.$selectGroups.prop('checked', true);
            this.$selectAll.prop('checked', true);
            this.update();
            this.options.onCheckAll();
        },

        uncheckAll: function () {
            this.$selectItems.prop('checked', false);
            this.$selectGroups.prop('checked', false);
            this.$selectAll.prop('checked', false);
            this.update();
            this.options.onUncheckAll();
        },

        focus: function () {
            this.$choice.focus();
            this.options.onFocus();
        },

        blur: function () {
            this.$choice.blur();
            this.options.onBlur();
        },

        refresh: function () {
            this.init();
        },

        filter: function () {
            var that = this,
                text = $.trim(this.$searchInput.val()).toLowerCase();

            if (text.length === 0) {
                this.$selectAll.parent().show();
                this.$selectItems.parent().show();
                this.$disableItems.parent().show();
                this.$selectGroups.parent().show();
                this.$noResults.hide();
            } else {
                this.$selectItems.each(function () {
                    var $parent = $(this).parent();
                    $parent[removeDiacritics($parent.text().toLowerCase()).indexOf(removeDiacritics(text)) < 0 ? 'hide' : 'show']();
                });
                this.$disableItems.parent().hide();
                this.$selectGroups.each(function () {
                    var $parent = $(this).parent();
                    var group = $parent.attr('data-group'),
                        $items = that.$selectItems.filter(':visible');
                    $parent[$items.filter(sprintf('[data-group="%s"]', group)).length ? 'show' : 'hide']();
                });

                //Check if no matches found
                if (this.$selectItems.parent().filter(':visible').length) {
                    this.$selectAll.parent().show();
                    this.$noResults.hide();
                } else {
                    this.$selectAll.parent().hide();
                    this.$noResults.show();
                }
            }
            this.updateOptGroupSelect();
            this.updateSelectAll();
            this.options.onFilter(text);
        }
    };

    $.fn.multipleSelect = function () {
        var option = arguments[0],
            args = arguments,

            value,
            allowedMethods = [
                'getSelects', 'setSelects',
                'enable', 'disable',
                'open', 'close',
                'checkAll', 'uncheckAll',
                'focus', 'blur',
                'refresh', 'close'
            ];

        this.each(function () {
            var $this = $(this),
                data = $this.data('multipleSelect'),
                options = $.extend({}, $.fn.multipleSelect.defaults,
                    $this.data(), typeof option === 'object' && option);

            if (!data) {
                data = new MultipleSelect($this, options);
                $this.data('multipleSelect', data);
            }

            if (typeof option === 'string') {
                if ($.inArray(option, allowedMethods) < 0) {
                    throw 'Unknown method: ' + option;
                }
                value = data[option](args[1]);
            } else {
                data.init();
                if (args[1]) {
                    value = data[args[1]].apply(data, [].slice.call(args, 2));
                }
            }
        });

        return typeof value !== 'undefined' ? value : this;
    };

    $.fn.multipleSelect.defaults = {
        name: '',
        isOpen: false,
        placeholder: '',
        selectAll: true,
        selectAllDelimiter: ['[', ']'],
        minimumCountSelected: 3,
        ellipsis: false,
        multiple: false,
        multipleWidth: 80,
        single: false,
        filter: false,
        width: undefined,
        dropWidth: undefined,
        maxHeight: 250,
        container: null,
        position: 'bottom',
        keepOpen: false,
        animate: 'none', // 'none', 'fade', 'slide'
        displayValues: false,
        delimiter: ', ',
        addTitle: false,
        filterAcceptOnEnter: false,
        hideOptgroupCheckboxes: false,

        selectAllText: 'Select all',
        allSelected: 'All selected',
        countSelected: '# of % selected',
        noMatchesFound: 'No matches found',

        styler: function () {
            return false;
        },
        textTemplate: function ($elm) {
            return $elm.html();
        },
        labelTemplate: function ($elm) {
            return $elm.attr('label');
        },

        onOpen: function () {
            return false;
        },
        onClose: function () {
            return false;
        },
        onCheckAll: function () {
            return false;
        },
        onUncheckAll: function () {
            return false;
        },
        onFocus: function () {
            return false;
        },
        onBlur: function () {
            return false;
        },
        onOptgroupClick: function () {
            return false;
        },
        onClick: function () {
            return false;
        },
        onFilter: function () {
            return false;
        }
    };
})(jQuery);
/** javascripts/utilities/ComboboxAutocomplete.js **/
(function( $ ) {
    $.widget( "custom.combobox", {
      _create: function() {
        this.wrapper = $( "<span>" )
          .addClass( "custom-combobox" )
          .insertAfter( this.element );
 
        this.element.hide();
        this._createAutocomplete();
        this._createShowAllButton();
      },
 
      _createAutocomplete: function() {
        var selected = this.element.children( ":selected" ),
          value = selected.val() ? selected.text() : "";
 
        this.input = $( "<input>" )
          .appendTo( this.wrapper )
          .val( value )
          .attr( "title", "" )
          .addClass( "custom-combobox-input ui-widget ui-widget-content ui-state-default ui-corner-left" )
          .autocomplete({
            delay: 0,
            minLength: 0,
            source: $.proxy( this, "_source" )//,
//            select: function( event, ui ) {
//                ui.item.option.selected = true;
//                //select.val( ui.item.option.value );
//                this._trigger( "selected", event, {
//                   item: ui.item.option
//                });
//             }
          })
          .tooltip({
            tooltipClass: "ui-state-highlight"
          });
 
        this._on( this.input, {
          autocompleteselect: function( event, ui ) {
            ui.item.option.selected = true;
            this._trigger( "select", event, {
              item: ui.item.option
            });
          },
 
          autocompletechange: "_removeIfInvalid"
        });
      },
 
      _createShowAllButton: function() {
        var input = this.input,
          wasOpen = false;
 
        $( "<a>" )
          .attr( "tabIndex", -1 )
//        .attr( "title", "Show All Items" )  It's ugly and annoying (by omer)
          .tooltip()
          .appendTo( this.wrapper )
          .button({
            icons: {
              primary: "ui-icon-triangle-1-s"
            },
            text: false
          })
          .removeClass( "ui-corner-all" )
          .addClass( "custom-combobox-toggle ui-corner-right" )
          .mousedown(function() {
            wasOpen = input.autocomplete( "widget" ).is( ":visible" );
          })
          .click(function() {
            input.focus();
 
            // Close if already visible
            if ( wasOpen ) {
              return;
            }
 
            // Pass empty string as value to search for, displaying all results
            input.autocomplete( "search", "" );
          });
      },
 
      _source: function( request, response ) {
        var matcher = new RegExp( $.ui.autocomplete.escapeRegex(request.term), "i" );
        response( this.element.children( "option" ).map(function() {
          var text = $( this ).text();
          if ( this.value && ( !request.term || matcher.test(text) ) )
            return {
              label: text,
              value: text,
              option: this
            };
        }) );
      },
 
      _removeIfInvalid: function( event, ui ) {
 
        // Selected an item, nothing to do
        if ( ui.item ) {
          return;
        }
 
        // Search for a match (case-insensitive)
        var value = this.input.val(),
          valueLowerCase = value.toLowerCase(),
          valid = false;
        this.element.children( "option" ).each(function() {
          if ( $( this ).text().toLowerCase() === valueLowerCase ) {
            this.selected = valid = true;
            return false;
          }
        });
 
        // Found a match, nothing to do
        if ( valid ) {
          return;
        }
 
        // Remove invalid value
        this.input
          .val( "" )
          .attr( "title", value + " didn't match any item" )
          .tooltip( "open" );
        this.element.val( "" );
        this._delay(function() {
          this.input.tooltip( "close" ).attr( "title", "" );
        }, 2500 );
        this.input.data( "ui-autocomplete" ).term = "";
      },
 
      _destroy: function() {
        this.wrapper.remove();
        this.element.show();
      },

      setValue : function(value) {
    	    this.element.val(value);
    	    this.input.val(value);
      }
    });
})( jQuery );
/** javascripts/WebSockets.js **/
/**
 * Implementation of a basic web sockets framework which works together with the generic updates mechanism.
 * 
 * Basic use case:
 * 
 *	 // Open socket
 *   var socket = WebSockets_Open(function (event) {
 *      // Socket opened, send entity registration message
 *   	WebSockets_ObserveEntity(event.target, "AGENT", "17.78.139.245",
 *   		function (data) {
 *   			// Do something with data (JSON)
 *   		});
 *   });
 */

function WebSockets_GetGenericUpdatesWebSocketURL() {
	if (window.location.protocol == "https:") {
		return 'wss://' + window.location.host + '/genericUpdatesWebSocket';
	} else {
		return 'ws://' + window.location.host + '/genericUpdatesWebSocket';
	}
}

/**
 * Opens a websocket.
 */
function WebSockets_Open(onopen) {
	var WS = window['MozWebSocket'] ? MozWebSocket : WebSocket;
	var socket = new WS(WebSockets_GetGenericUpdatesWebSocketURL());

	// Create socket container
	var socketContainer = { socket: socket };
	socket.container = socketContainer;

	socket.onmessage = function (event) {
		// event.target is the socket
		var socket = event.target;

		// Data is a string, parse to JSON
		var data = JSON.parse(event.data);

		// Save last message receival time
		$("#connectionStatus").data('lastMessageReceivedAt', new Date());

		// Process data
		WebSockets_ProcessData(socket, data);
	};

	socket.onopen = function (event) {
		var connectionStatus = $("#connectionStatus");
		connectionStatus.find("#red, #gray").addClass("inactive");
		connectionStatus.find("#green").removeClass("inactive");

		onopen(event);

		// If there are some buffered on open events, do them now
		var bufferedOnOpen = event.target.bufferedOnOpen;
		if (bufferedOnOpen != undefined) {
			for (var i = 0; i < bufferedOnOpen.length; i++) {
				bufferedOnOpen[i]();
			}
			event.target.bufferedOnOpen = undefined;
		}
	}

	socket.onclose = function (event) {
		var connectionStatus = $("#connectionStatus");
		connectionStatus.find("#green, #gray").addClass("inactive");
		connectionStatus.find("#red").removeClass("inactive");

		// Try reconnecting every 10 seconds
		var socket = event.target;
		if (socket.userClosing != true) {
			setTimeout(function () {
				newSocket = WebSockets_Open(function (evt) {
					// Replace in container
					socket.container.socket = evt.target;
					evt.target.container = socket.container;

					// Call original onopen handler
					socket.onopen(evt);
				});
			}, 10000);
		}
	}

	socket.messageHandlers = new Object();

	return socketContainer;
}

function WebSockets_UnwrapContainer(container) {
	if (container.socket == undefined) {
		return container;
	} else {
		return container.socket;
	}
}

/**
 * Buffers the given update on the socket. If the same property (and entity) is updated twice,
 * the older value will be replaced by the newer value. Assumes the update is of a single entity (from a message handler).
 */
function WebSockets_BufferUpdate(socket, update) {
	// Unwrap container
	socket = WebSockets_UnwrapContainer(socket);

	// Make sure buffered updates object exists
	if (socket.bufferedUpdates == undefined) {
		socket.bufferedUpdates = new Object();
	}

	// Wrap in entity type and ID like in an update from the server
	var wrappedUpdate = new Object();
	wrappedUpdate[update.type] = new Object();
	wrappedUpdate[update.type][update.id] = update;

	// Add to current buffer object
	jQuery.extend(socket.bufferedUpdates, wrappedUpdate);
}

/**
 * Flushes any updates previously buffered (according to set message handlers).
 */
function WebSockets_FlushUpdates(socket) {
	// Unwrap container
	socket = WebSockets_UnwrapContainer(socket);

	var bufferedUpdates = socket.bufferedUpdates;
	if (bufferedUpdates != undefined) {
		// Clear old object
		socket.bufferedUpdates = undefined;

		// Process object
		WebSockets_ProcessData(socket, bufferedUpdates);
	}
}

function WebSockets_SafeHandleMessage(messageHandler, data, entityType, entityId) {
	// Prepare data
	data[entityType][entityId].id = entityId;
	data[entityType][entityId].type = entityType;

	// Safely call message handler and catch errors
	try {
		messageHandler(data[entityType][entityId]);
	} catch (err) {
		console.error(err);
		console.log("Causing object:");
		console.log(data[entityType][entityId]);
	}
}

function WebSockets_ProcessData(socket, data) {
	// Socket is not a container, but the real socket object

	// The data contains a command entry (which should contain "UPDATE")
	var messageHandlers = socket.messageHandlers;
	if (data.command == "UPDATE") {
		// For every entity (type and ID)
		for (entityType in data) {
			if (entityType != "command") {
				for (entityId in data[entityType]) {
					// Check if message handler exists
					if (messageHandlers[entityType] != undefined) {
						// Call message handler with the data relevant to this entity
						if (messageHandlers[entityType][entityId] != undefined) {
							var messageHandler = messageHandlers[entityType][entityId];
							WebSockets_SafeHandleMessage(messageHandler, data, entityType, entityId);
						} else if (messageHandlers[entityType]["*"] != undefined) {
							var messageHandler = messageHandlers[entityType]["*"];
							WebSockets_SafeHandleMessage(messageHandler, data, entityType, entityId);
						}
					}
				}
			}
		}
	} else if (data.command == "LM_VERSION") {
		var lmVersionElem = $("#lmVersion");
		var lmVersion = lmVersionElem.text().trim();
		if (!isStringEmpty(lmVersion) && lmVersion != data.version) {
			lmVersionElem.html(data.version);
			UIUtility_showAlert("Your lab manager was upgraded to " + data.version, "Lab Manager Upgrade");
		}
	}
}

/**
 * Sets a message handler to the given entity.
 * For each entity, only the last message handler will run.
 */
function WebSockets_SetMessageHandler(socket, entityType, entityId, messageHandler) {
	// Unwrap container
	socket = WebSockets_UnwrapContainer(socket);

	// If there are no message handlers for this type, create an object for it
	if (socket.messageHandlers[entityType] == undefined) {
		socket.messageHandlers[entityType] = new Object();
	}

	// Add the message handler to the entity
	socket.messageHandlers[entityType][entityId] = messageHandler;
}

/**
 * Observes an entity in the given web socket.
 * The message handler will receive only updates on the relevant entity.
 * You can use * as the entityId variable for any entity of the given type.
 * If already registered to the entity, the current state won't be resent.
 * 
 * @param optionalSendCurrentState
 * 		Lets you choose whether you want to immediately receive the current entity state for unregistered entities.
 * 		Defaults to true.
 * @param optionalForceSendCurrentState
 * 		Will always send the current state, even if the entity was already registered to.
 * 		Defaults to false.
 */
function WebSockets_ObserveEntity(socket, entityType, entityIdOrIds, messageHandler, optionalSendCurrentState, optionalForceSendCurrentState) {
	// Unwrap container
	socket = WebSockets_UnwrapContainer(socket);

	// If we got a single entity ID, convert to array
	var entityIds = Array.isArray(entityIdOrIds) ? entityIdOrIds : [entityIdOrIds];

	// Buffer request if not open yet
	if (socket.readyState != 1) {
		if (socket.bufferedOnOpen == undefined) {
			socket.bufferedOnOpen = [];
		}
		socket.bufferedOnOpen.push(function () {
			WebSockets_ObserveEntity(socket, entityType, entityIds, messageHandler, optionalSendCurrentState, optionalForceSendCurrentState);
		});
		return;
	}

	if (optionalSendCurrentState == undefined) {
		optionalSendCurrentState = true;
	}
	if (optionalForceSendCurrentState == undefined) {
		optionalForceSendCurrentState = false;
	}
	WebSockets_SetMessageHandler(socket.container, entityType, entityIds, messageHandler);
	socket.send(JSON.stringify({
		'command': 'REGISTER',
		'entityType': entityType,
		'entityIds': entityIds,
		'sendCurrentState': optionalSendCurrentState,
		'forceSendCurrentState': optionalForceSendCurrentState
	}));
}

/**
 * Observes an entity in the given web socket.
 * The message handler will receive only updates on the relevant entity.
 * You can use * as the entityIdPart variable for any entity of the given type.
 * If already registered to the partial entity (exact same selector), the current state won't be resent.
 * 
 * @param optionalSendCurrentState
 * 		Lets you choose whether you want to immediately receive the current entity state for unregistered entities.
 * 		Defaults to true.
 * @param optionalForceSendCurrentState
 * 		Will always send the current state, even if the entity was already registered to.
 * 		Defaults to false.
 */
function WebSockets_ObserveEntities(socket, entityType, entityIdPart, partIndex, messageHandler, optionalSendCurrentState, optionalForceSendCurrentState) {
	// Unwrap container
	socket = WebSockets_UnwrapContainer(socket);

	// Buffer request if not open yet
	if (socket.readyState != 1) {
		if (socket.bufferedOnOpen == undefined) {
			socket.bufferedOnOpen = [];
		}
		socket.bufferedOnOpen.push(function () {
			WebSockets_ObserveEntities(socket, entityType, entityIdPart, partIndex, messageHandler, optionalSendCurrentState, optionalForceSendCurrentState);
		});
		return;
	}

	if (optionalSendCurrentState == undefined) {
		optionalSendCurrentState = true;
	}
	if (optionalForceSendCurrentState == undefined) {
		optionalForceSendCurrentState = false;
	}
	WebSockets_SetMessageHandler(socket, entityType, "*", messageHandler);
	socket.send(JSON.stringify({
		'command': 'REGISTER_PARTIAL',
		'entityType': entityType,
		'entityId': entityIdPart,
		'partIndex': partIndex,
		'sendCurrentState': optionalSendCurrentState,
		'forceSendCurrentState': optionalForceSendCurrentState
	}));
}

/**
 * Requests all information that the web server holds about the given entity to be resent.
 * Assumes a message handler is already set (because the entity is observed, or
 * WebSockets_SetMessageHandler was called).
 */
function WebSockets_RequestEntityInformation(socket, entityType, entityId) {
	// Unwrap container
	socket = WebSockets_UnwrapContainer(socket);

	// Buffer request if not open yet
	if (socket.readyState != 1) {
		if (socket.bufferedOnOpen == undefined) {
			socket.bufferedOnOpen = [];
		}
		socket.bufferedOnOpen.push(function () { WebSockets_RequestEntityInformation(socket, entityType, entityId); });
		return;
	}

	socket.send(JSON.stringify({
		'command': 'REQUEST_INFO',
		'entityType': entityType,
		'entityId': entityId
	}));
}

/**
 * Requests all information that the web server holds about the given entities to be resent.
 * You can use * as the entityIdPart variable for any entity of the given type.
 * Assumes a message handler is already set (because the entity is observed, or
 * WebSockets_SetMessageHandler was called).
 */
function WebSockets_RequestEntitiesInformation(socket, entityType, entityIdPart, partIndex) {
	// Unwrap container
	socket = WebSockets_UnwrapContainer(socket);

	// Buffer request if not open yet
	if (socket.readyState != 1) {
		if (socket.bufferedOnOpen == undefined) {
			socket.bufferedOnOpen = [];
		}
		socket.bufferedOnOpen.push(function () { WebSockets_RequestEntitiesInformation(socket, entityType, entityIdPart, partIndex); });
		return;
	}

	socket.send(JSON.stringify({
		'command': 'REQUEST_INFO_PARTIAL',
		'entityType': entityType,
		'entityId': entityIdPart,
		'partIndex': partIndex
	}));
}

/**
 * Any update to a field from the given fields array, will be sent together with the latest
 * value of the other fields.
 * This helps avoid field dependencies which might require saving data on the client.
 * Connecting already connected fields will only enlarge the existing connected set.
 */
function WebSockets_ConnectFields(socket, fields) {
	// Unwrap container
	socket = WebSockets_UnwrapContainer(socket);

	socket.send(JSON.stringify({
		'command': 'CONNECT_FIELDS',
		'fields': fields
	}));
}

/**
 * This will request all updates since a given timestamp, which is limited to 10 seconds, and
 * is available only if requested by the page generation, and until this request is done.
 */
function WebSockets_RequestDataSinceTimestamp(socket, timestamp) {
	// Unwrap container
	socket = WebSockets_UnwrapContainer(socket);

	socket.send(JSON.stringify({
		'command': 'REQUEST_DATA_SINCE_TIMESTAMP',
		'timestamp': timestamp
	}));
}

/**
 * Unregister to entity updates, or to all entities updates.
 */
function WebSockets_Unregister(socket, entityType, entityId) {
	// Unwrap container
	socket = WebSockets_UnwrapContainer(socket);

	if (entityType == undefined || entityId == undefined) {
		socket.send(JSON.stringify({ 'command': 'UNREGISTER' }));
	} else {
		socket.send(JSON.stringify({
			'command': 'UNREGISTER',
			'entityType': entityType,
			'entityId': entityId
		}));
	}
}

/**
 * Closes the web socket.
 */
function WebSockets_Close(socket)
{
	// Unwrap container
	socket = WebSockets_UnwrapContainer(socket);

	socket.userClosing = true;
	socket.close();
}

/**
 * Generates a generic identifier to be used when the ID is not a simple one,
 * but consists of a few entities.
 * Should be used together with GenericUpdateIdentifier class.
 * Note that this is a varargs function, despite of it not having any parameters in its signature.
 */
function WebSockets_GenerateGenericIdentifier()
{
	var result = "[";
	for (var i = 0; i < arguments.length; i++) {
		if (i > 0) {
			result += ", ";
		}
		result += arguments[i];
	}
	result += "]";
	return result;
}

function WebSockets_ParseGenericIdentifier(id) {
	id = replaceAll(id, "[", "");
	id = replaceAll(id, "]", "");
	var arr = id.split(",");
	for (var i = 0; i < arr.length; i++) {
		arr[i] = arr[i].trim();
	}
	return arr;
}

/** javascripts/ui-controls/term.js **/
/**
 * term.js - an xterm emulator
 * Copyright (c) 2012-2013, Christopher Jeffrey (MIT License)
 * https://github.com/chjj/term.js
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *
 * Originally forked from (with the author's permission):
 *   Fabrice Bellard's javascript vt100 for jslinux:
 *   http://bellard.org/jslinux/
 *   Copyright (c) 2011 Fabrice Bellard
 *   The original design remains. The terminal itself
 *   has been extended to include xterm CSI codes, among
 *   other features.
 */

;(function() {

/**
 * Terminal Emulation References:
 *   http://vt100.net/
 *   http://invisible-island.net/xterm/ctlseqs/ctlseqs.txt
 *   http://invisible-island.net/xterm/ctlseqs/ctlseqs.html
 *   http://invisible-island.net/vttest/
 *   http://www.inwap.com/pdp10/ansicode.txt
 *   http://linux.die.net/man/4/console_codes
 *   http://linux.die.net/man/7/urxvt
 */

'use strict';

/**
 * Shared
 */

var window = this
  , document = this.document;

/**
 * EventEmitter
 */

function EventEmitter() {
  this._events = this._events || {};
}

EventEmitter.prototype.addListener = function(type, listener) {
  this._events[type] = this._events[type] || [];
  this._events[type].push(listener);
};

EventEmitter.prototype.on = EventEmitter.prototype.addListener;

EventEmitter.prototype.removeListener = function(type, listener) {
  if (!this._events[type]) return;

  var obj = this._events[type]
    , i = obj.length;

  while (i--) {
    if (obj[i] === listener || obj[i].listener === listener) {
      obj.splice(i, 1);
      return;
    }
  }
};

EventEmitter.prototype.off = EventEmitter.prototype.removeListener;

EventEmitter.prototype.removeAllListeners = function(type) {
  if (this._events[type]) delete this._events[type];
};

EventEmitter.prototype.once = function(type, listener) {
  function on() {
    var args = Array.prototype.slice.call(arguments);
    this.removeListener(type, on);
    return listener.apply(this, args);
  }
  on.listener = listener;
  return this.on(type, on);
};

EventEmitter.prototype.emit = function(type) {
  if (!this._events[type]) return;

  var args = Array.prototype.slice.call(arguments, 1)
    , obj = this._events[type]
    , l = obj.length
    , i = 0;

  for (; i < l; i++) {
    obj[i].apply(this, args);
  }
};

EventEmitter.prototype.listeners = function(type) {
  return this._events[type] = this._events[type] || [];
};

/**
 * States
 */

var normal = 0
  , escaped = 1
  , csi = 2
  , osc = 3
  , charset = 4
  , dcs = 5
  , ignore = 6;

/**
 * Terminal
 */

function Terminal(options) {
  var self = this;

  if (!(this instanceof Terminal)) {
    return new Terminal(arguments[0], arguments[1], arguments[2]);
  }

  EventEmitter.call(this);

  if (typeof options === 'number') {
    options = {
      cols: arguments[0],
      rows: arguments[1],
      handler: arguments[2]
    };
  }

  options = options || {};

  each(keys(Terminal.defaults), function(key) {
    if (options[key] == null) {
      options[key] = Terminal.options[key];
      // Legacy:
      if (Terminal[key] !== Terminal.defaults[key]) {
        options[key] = Terminal[key];
      }
    }
    self[key] = options[key];
  });

  if (options.colors.length === 8) {
    options.colors = options.colors.concat(Terminal._colors.slice(8));
  } else if (options.colors.length === 16) {
    options.colors = options.colors.concat(Terminal._colors.slice(16));
  } else if (options.colors.length === 10) {
    options.colors = options.colors.slice(0, -2).concat(
      Terminal._colors.slice(8, -2), options.colors.slice(-2));
  } else if (options.colors.length === 18) {
    options.colors = options.colors.slice(0, -2).concat(
      Terminal._colors.slice(16, -2), options.colors.slice(-2));
  }
  this.colors = options.colors;

  this.options = options;

  // this.context = options.context || window;
  // this.document = options.document || document;
  this.parent = options.body || options.parent
    || (document ? document.getElementsByTagName('body')[0] : null);

  this.cols = options.cols || options.geometry[0];
  this.rows = options.rows || options.geometry[1];

  if (options.handler) {
    this.on('data', options.handler);
  }

  this.ybase = 0;
  this.ydisp = 0;
  this.x = 0;
  this.y = 0;
  this.cursorState = 0;
  this.cursorHidden = false;
  this.convertEol;
  this.state = 0;
  this.queue = '';
  this.scrollTop = 0;
  this.scrollBottom = this.rows - 1;

  // modes
  this.applicationKeypad = false;
  this.applicationCursor = false;
  this.originMode = false;
  this.insertMode = false;
  this.wraparoundMode = false;
  this.normal = null;

  // select modes
  this.prefixMode = false;
  this.selectMode = false;
  this.visualMode = false;
  this.searchMode = false;
  this.searchDown;
  this.entry = '';
  this.entryPrefix = 'Search: ';
  this._real;
  this._selected;
  this._textarea;

  // charset
  this.charset = null;
  this.gcharset = null;
  this.glevel = 0;
  this.charsets = [null];

  // mouse properties
  this.decLocator;
  this.x10Mouse;
  this.vt200Mouse;
  this.vt300Mouse;
  this.normalMouse;
  this.mouseEvents;
  this.sendFocus;
  this.utfMouse;
  this.sgrMouse;
  this.urxvtMouse;

  // misc
  this.element;
  this.children;
  this.refreshStart;
  this.refreshEnd;
  this.savedX;
  this.savedY;
  this.savedCols;

  // stream
  this.readable = true;
  this.writable = true;

  this.defAttr = (0 << 18) | (257 << 9) | (256 << 0);
  this.curAttr = this.defAttr;

  this.params = [];
  this.currentParam = 0;
  this.prefix = '';
  this.postfix = '';

  this.lines = [];
  var i = this.rows;
  while (i--) {
    this.lines.push(this.blankLine());
  }

  this.tabs;
  this.setupStops();
}

inherits(Terminal, EventEmitter);

// back_color_erase feature for xterm.
Terminal.prototype.eraseAttr = function() {
  // if (this.is('screen')) return this.defAttr;
  return (this.defAttr & ~0x1ff) | (this.curAttr & 0x1ff);
};

/**
 * Colors
 */

// Colors 0-15
Terminal.tangoColors = [
  // dark:
  '#2e3436',
  '#cc0000',
  '#4e9a06',
  '#c4a000',
  '#3465a4',
  '#75507b',
  '#06989a',
  '#d3d7cf',
  // bright:
  '#555753',
  '#ef2929',
  '#8ae234',
  '#fce94f',
  '#729fcf',
  '#ad7fa8',
  '#34e2e2',
  '#eeeeec'
];

Terminal.xtermColors = [
  // dark:
  '#000000', // black
  '#cd0000', // red3
  '#00cd00', // green3
  '#cdcd00', // yellow3
  '#0000ee', // blue2
  '#cd00cd', // magenta3
  '#00cdcd', // cyan3
  '#e5e5e5', // gray90
  // bright:
  '#7f7f7f', // gray50
  '#ff0000', // red
  '#00ff00', // green
  '#ffff00', // yellow
  '#5c5cff', // rgb:5c/5c/ff
  '#ff00ff', // magenta
  '#00ffff', // cyan
  '#ffffff'  // white
];

// Colors 0-15 + 16-255
// Much thanks to TooTallNate for writing this.
Terminal.colors = (function() {
  var colors = Terminal.tangoColors.slice()
    , r = [0x00, 0x5f, 0x87, 0xaf, 0xd7, 0xff]
    , i;

  // 16-231
  i = 0;
  for (; i < 216; i++) {
    out(r[(i / 36) % 6 | 0], r[(i / 6) % 6 | 0], r[i % 6]);
  }

  // 232-255 (grey)
  i = 0;
  for (; i < 24; i++) {
    r = 8 + i * 10;
    out(r, r, r);
  }

  function out(r, g, b) {
    colors.push('#' + hex(r) + hex(g) + hex(b));
  }

  function hex(c) {
    c = c.toString(16);
    return c.length < 2 ? '0' + c : c;
  }

  return colors;
})();

// Default BG/FG
Terminal.colors[256] = '#000000';
Terminal.colors[257] = '#ffffff';

Terminal._colors = Terminal.colors.slice();

Terminal.vcolors = (function() {
  var out = []
    , colors = Terminal.colors
    , i = 0
    , color;

  for (; i < 256; i++) {
    color = parseInt(colors[i].substring(1), 16);
    out.push([
      (color >> 16) & 0xff,
      (color >> 8) & 0xff,
      color & 0xff
    ]);
  }

  return out;
})();

/**
 * Options
 */

Terminal.defaults = {
  colors: Terminal.colors,
  convertEol: false,
  termName: 'xterm',
  geometry: [80, 24],
  cursorBlink: true,
  visualBell: false,
  popOnBell: false,
  scrollback: 1000,
  screenKeys: false,
  debug: false,
  useStyle: false
  // programFeatures: false,
  // focusKeys: false,
};

Terminal.options = {};

each(keys(Terminal.defaults), function(key) {
  Terminal[key] = Terminal.defaults[key];
  Terminal.options[key] = Terminal.defaults[key];
});

/**
 * Focused Terminal
 */

Terminal.focus = null;

Terminal.prototype.focus = function() {
  if (Terminal.focus === this) return;

  if (Terminal.focus) {
    Terminal.focus.blur();

    // Remove content editable
    this.element.setAttribute('contenteditable', 'false');
  } else {
	// Add content editable
	this.element.setAttribute('contenteditable', 'true');
  }

  if (this.sendFocus) this.send('\x1b[I');
  this.showCursor();

  // try {
  //   this.element.focus();
  // } catch (e) {
  //   ;
  // }

  // this.emit('focus');

  Terminal.focus = this;
};

Terminal.prototype.blur = function() {
  if (Terminal.focus !== this) return;

  this.cursorState = 0;
  this.refresh(this.y, this.y);
  if (this.sendFocus) this.send('\x1b[O');

  // try {
  //   this.element.blur();
  // } catch (e) {
  //   ;
  // }

  // this.emit('blur');

  // Remove content editable
  this.element.setAttribute('contenteditable', 'false');

  Terminal.focus = null;
};

/**
 * Initialize global behavior
 */

Terminal.prototype.initGlobal = function() {
  var document = this.document;

  Terminal._boundDocs = Terminal._boundDocs || [];
  if (~indexOf(Terminal._boundDocs, document)) {
    return;
  }
  Terminal._boundDocs.push(document);

  Terminal.bindPaste(document);

  Terminal.bindKeys(document);

  Terminal.bindCopy(document);

  if (this.isMobile) {
    this.fixMobile(document);
  }

  if (this.useStyle) {
    Terminal.insertStyle(document, this.colors[256], this.colors[257]);
  }
};

/**
 * Bind to paste event
 */

Terminal.bindPaste = function(document) {
  var window = document.defaultView;
  on(window, 'paste', function(ev) {
	if ($(ev.target).is("[type='search']")) {
		// Paste into search box, don't do anything
		return;
	}

	var term = Terminal.focus;
    if (!term) return;
    if (ev.clipboardData) {
      term.send(ev.clipboardData.getData('text/plain'));
    } else if (term.context.clipboardData) {
      term.send(term.context.clipboardData.getData('Text'));
    }
    return cancel(ev);
  });
};

/**
 * Global Events for key handling
 */

Terminal.bindKeys = function(document) {
  // We should only need to check `target === body` below,
  // but we can check everything for good measure.
  on(document, 'keydown', function(ev) {
    if (!Terminal.focus) return;
    var target = ev.target || ev.srcElement;
    if (!target) return;
    if (target === Terminal.focus.element
        || target === Terminal.focus.context
        || target === Terminal.focus.document
        || target === Terminal.focus.body
        || target === Terminal._textarea
        || target === Terminal.focus.parent) {
      return Terminal.focus.keyDown(ev);
    }
  }, true);

  on(document, 'keypress', function(ev) {
    if (!Terminal.focus) return;
    var target = ev.target || ev.srcElement;
    if (!target) return;
    if (target === Terminal.focus.element
        || target === Terminal.focus.context
        || target === Terminal.focus.document
        || target === Terminal.focus.body
        || target === Terminal._textarea
        || target === Terminal.focus.parent) {
      return Terminal.focus.keyPress(ev);
    }
  }, true);

  // If we click somewhere other than a
  // terminal, unfocus the terminal.
  on(document, 'mousedown', function(ev) {
    if (!Terminal.focus) return;

    var el = ev.target || ev.srcElement;
    if (!el) return;

    do {
      if (el === Terminal.focus.element) return;
    } while (el = el.parentNode);

    // Omer: For some reason this makes trouble with focusing on a search field
    // Terminal.focus.blur();
  });
};

/**
 * Copy Selection w/ Ctrl-C (Select Mode)
 */

Terminal.bindCopy = function(document) {
  var window = document.defaultView;

  // if (!('onbeforecopy' in document)) {
  //   // Copies to *only* the clipboard.
  //   on(window, 'copy', function fn(ev) {
  //     var term = Terminal.focus;
  //     if (!term) return;
  //     if (!term._selected) return;
  //     var text = term.grabText(
  //       term._selected.x1, term._selected.x2,
  //       term._selected.y1, term._selected.y2);
  //     term.emit('copy', text);
  //     ev.clipboardData.setData('text/plain', text);
  //   });
  //   return;
  // }

  // Copies to primary selection *and* clipboard.
  // NOTE: This may work better on capture phase,
  // or using the `beforecopy` event.
  on(window, 'copy', function(ev) {
    var term = Terminal.focus;
    if (!term) return;
    if (!term._selected) return;
    var textarea = term.getCopyTextarea();
    var text = term.grabText(
      term._selected.x1, term._selected.x2,
      term._selected.y1, term._selected.y2);
    term.emit('copy', text);
    textarea.focus();
    textarea.textContent = text;
    textarea.value = text;
    textarea.setSelectionRange(0, text.length);
    setTimeout(function() {
      term.element.focus();
      term.focus();
    }, 1);
  });
};

/**
 * Fix Mobile
 */

Terminal.prototype.fixMobile = function(document) {
  var self = this;

  var textarea = document.createElement('textarea');
  textarea.style.position = 'absolute';
  textarea.style.left = '-32000px';
  textarea.style.top = '-32000px';
  textarea.style.width = '0px';
  textarea.style.height = '0px';
  textarea.style.opacity = '0';
  textarea.style.backgroundColor = 'transparent';
  textarea.style.borderStyle = 'none';
  textarea.style.outlineStyle = 'none';
  textarea.autocapitalize = 'none';
  textarea.autocorrect = 'off';

  document.getElementsByTagName('body')[0].appendChild(textarea);

  Terminal._textarea = textarea;

  setTimeout(function() {
    textarea.focus();
  }, 1000);

  if (this.isAndroid) {
    on(textarea, 'change', function() {
      var value = textarea.textContent || textarea.value;
      textarea.value = '';
      textarea.textContent = '';
      self.send(value + '\r');
    });
  }
};

/**
 * Insert a default style
 */

Terminal.insertStyle = function(document, bg, fg) {
  var style = document.getElementById('term-style');
  if (style) return;

  var head = document.getElementsByTagName('head')[0];
  if (!head) return;

  var style = document.createElement('style');
  style.id = 'term-style';

  // textContent doesn't work well with IE for <style> elements.
  style.innerHTML = ''
    + '.terminal {\n'
    + '  float: left;\n'
    + '  border: ' + bg + ' solid 5px;\n'
    + '  font-family: "DejaVu Sans Mono", "Liberation Mono", monospace;\n'
    + '  font-size: 11px;\n'
    + '  color: ' + fg + ';\n'
    + '  background: ' + bg + ';\n'
    + '}\n'
    + '\n'
    + '.terminal-cursor {\n'
    + '  color: ' + bg + ';\n'
    + '  background: ' + fg + ';\n'
    + '}\n';

  // var out = '';
  // each(Terminal.colors, function(color, i) {
  //   if (i === 256) {
  //     out += '\n.term-bg-color-default { background-color: ' + color + '; }';
  //   }
  //   if (i === 257) {
  //     out += '\n.term-fg-color-default { color: ' + color + '; }';
  //   }
  //   out += '\n.term-bg-color-' + i + ' { background-color: ' + color + '; }';
  //   out += '\n.term-fg-color-' + i + ' { color: ' + color + '; }';
  // });
  // style.innerHTML += out + '\n';

  head.insertBefore(style, head.firstChild);
};

/**
 * Open Terminal
 */

Terminal.prototype.open = function(parent) {
  var self = this
    , i = 0
    , div;

  this.parent = parent || this.parent;

  if (!this.parent) {
    throw new Error('Terminal requires a parent element.');
  }

  // Grab global elements.
  this.context = this.parent.ownerDocument.defaultView;
  this.document = this.parent.ownerDocument;
  this.body = this.document.getElementsByTagName('body')[0];

  // Parse user-agent strings.
  if (this.context.navigator && this.context.navigator.userAgent) {
    this.isMac = !!~this.context.navigator.userAgent.indexOf('Mac');
    this.isIpad = !!~this.context.navigator.userAgent.indexOf('iPad');
    this.isIphone = !!~this.context.navigator.userAgent.indexOf('iPhone');
    this.isAndroid = !!~this.context.navigator.userAgent.indexOf('Android');
    this.isMobile = this.isIpad || this.isIphone || this.isAndroid;
    this.isMSIE = !!~this.context.navigator.userAgent.indexOf('MSIE');
  }

  // Create our main terminal element.
  this.element = this.document.createElement('div');
  this.element.className = 'terminal';
  this.element.style.outline = 'none';
  this.element.setAttribute('tabindex', 0);
  this.element.setAttribute('spellcheck', 'false');
  this.element.style.backgroundColor = this.colors[256];
  this.element.style.color = this.colors[257];

  // Create the lines for our terminal.
  this.children = [];
  for (; i < this.rows; i++) {
    div = this.document.createElement('div');
    this.element.appendChild(div);
    this.children.push(div);
  }
  this.parent.appendChild(this.element);

  // Draw the screen.
  this.refresh(0, this.rows - 1);

  if (!('useEvents' in this.options) || this.options.useEvents) {
    // Initialize global actions that
    // need to be taken on the document.
    this.initGlobal();
  }

  if (!('useFocus' in this.options) || this.options.useFocus) {
    // Ensure there is a Terminal.focus.
    this.focus();

    // Start blinking the cursor.
    this.startBlink();

    // Bind to DOM events related
    // to focus and paste behavior.
    on(this.element, 'focus', function() {
      self.focus();
      if (self.isMobile) {
        Terminal._textarea.focus();
      }
    });

    // This causes slightly funky behavior.
    // on(this.element, 'blur', function() {
    //   self.blur();
    // });

    on(this.element, 'mousedown', function() {
      self.focus();
    });

    on(this.element, 'mousedown', function(ev) {
      var button = ev.button != null
        ? +ev.button
        : ev.which != null
          ? ev.which - 1
          : null;

      // Empty selection (after event dispatches)
      var window = ev.view;
      setTimeout(function () {
    	  // Select current line's last character (which should be the carret so it'll be hidden)
    	  var range = document.createRange();
    	  range.setStart(self.children[self.y], 1);
    	  range.collapse(true);
    	  var selection = window.getSelection();
    	  selection.removeAllRanges();
    	  selection.addRange(range);
      }, 1);

      if (button !== 2) return;
    }, true);
  }

  if (!('useMouse' in this.options) || this.options.useMouse) {
    // Listen for mouse events and translate
    // them into terminal mouse protocols.
    this.bindMouse();
  }

  // this.emit('open');

  if (!('useFocus' in this.options) || this.options.useFocus) {
      // This can be useful for pasting,
      // as well as the iPad fix.
      setTimeout(function() {
        self.element.focus();
      }, 100);
  }

  // Figure out whether boldness affects
  // the character width of monospace fonts.
  if (Terminal.brokenBold == null) {
    Terminal.brokenBold = isBoldBroken(this.document);
  }
};

// XTerm mouse events
// http://invisible-island.net/xterm/ctlseqs/ctlseqs.html#Mouse%20Tracking
// To better understand these
// the xterm code is very helpful:
// Relevant files:
//   button.c, charproc.c, misc.c
// Relevant functions in xterm/button.c:
//   BtnCode, EmitButtonCode, EditorButton, SendMousePosition
Terminal.prototype.bindMouse = function() {
  var el = this.element
    , self = this
    , pressed = 32;

  var wheelEvent = 'onmousewheel' in this.context
    ? 'mousewheel'
    : 'DOMMouseScroll';

  // mouseup, mousedown, mousewheel
  // left click: ^[[M 3<^[[M#3<
  // mousewheel up: ^[[M`3>
  function sendButton(ev) {
    var button
      , pos;

    // get the xterm-style button
    button = getButton(ev);

    // get mouse coordinates
    pos = getCoords(ev);
    if (!pos) return;

    sendEvent(button, pos);

    switch (ev.type) {
      case 'mousedown':
        pressed = button;
        break;
      case 'mouseup':
        // keep it at the left
        // button, just in case.
        pressed = 32;
        break;
      case wheelEvent:
        // nothing. don't
        // interfere with
        // `pressed`.
        break;
    }
  }

  // motion example of a left click:
  // ^[[M 3<^[[M@4<^[[M@5<^[[M@6<^[[M@7<^[[M#7<
  function sendMove(ev) {
    var button = pressed
      , pos;

    pos = getCoords(ev);
    if (!pos) return;

    // buttons marked as motions
    // are incremented by 32
    button += 32;

    sendEvent(button, pos);
  }

  // encode button and
  // position to characters
  function encode(data, ch) {
    if (!self.utfMouse) {
      if (ch === 255) return data.push(0);
      if (ch > 127) ch = 127;
      data.push(ch);
    } else {
      if (ch === 2047) return data.push(0);
      if (ch < 127) {
        data.push(ch);
      } else {
        if (ch > 2047) ch = 2047;
        data.push(0xC0 | (ch >> 6));
        data.push(0x80 | (ch & 0x3F));
      }
    }
  }

  // send a mouse event:
  // regular/utf8: ^[[M Cb Cx Cy
  // urxvt: ^[[ Cb ; Cx ; Cy M
  // sgr: ^[[ Cb ; Cx ; Cy M/m
  // vt300: ^[[ 24(1/3/5)~ [ Cx , Cy ] \r
  // locator: CSI P e ; P b ; P r ; P c ; P p & w
  function sendEvent(button, pos) {
    // self.emit('mouse', {
    //   x: pos.x - 32,
    //   y: pos.x - 32,
    //   button: button
    // });

    if (self.vt300Mouse) {
      // NOTE: Unstable.
      // http://www.vt100.net/docs/vt3xx-gp/chapter15.html
      button &= 3;
      pos.x -= 32;
      pos.y -= 32;
      var data = '\x1b[24';
      if (button === 0) data += '1';
      else if (button === 1) data += '3';
      else if (button === 2) data += '5';
      else if (button === 3) return;
      else data += '0';
      data += '~[' + pos.x + ',' + pos.y + ']\r';
      self.send(data);
      return;
    }

    if (self.decLocator) {
      // NOTE: Unstable.
      button &= 3;
      pos.x -= 32;
      pos.y -= 32;
      if (button === 0) button = 2;
      else if (button === 1) button = 4;
      else if (button === 2) button = 6;
      else if (button === 3) button = 3;
      self.send('\x1b['
        + button
        + ';'
        + (button === 3 ? 4 : 0)
        + ';'
        + pos.y
        + ';'
        + pos.x
        + ';'
        + (pos.page || 0)
        + '&w');
      return;
    }

    if (self.urxvtMouse) {
      pos.x -= 32;
      pos.y -= 32;
      pos.x++;
      pos.y++;
      self.send('\x1b[' + button + ';' + pos.x + ';' + pos.y + 'M');
      return;
    }

    if (self.sgrMouse) {
      pos.x -= 32;
      pos.y -= 32;
      self.send('\x1b[<'
        + ((button & 3) === 3 ? button & ~3 : button)
        + ';'
        + pos.x
        + ';'
        + pos.y
        + ((button & 3) === 3 ? 'm' : 'M'));
      return;
    }

    var data = [];

    encode(data, button);
    encode(data, pos.x);
    encode(data, pos.y);

    self.send('\x1b[M' + String.fromCharCode.apply(String, data));
  }

  function getButton(ev) {
    var button
      , shift
      , meta
      , ctrl
      , mod;

    // two low bits:
    // 0 = left
    // 1 = middle
    // 2 = right
    // 3 = release
    // wheel up/down:
    // 1, and 2 - with 64 added
    switch (ev.type) {
      case 'mousedown':
        button = ev.button != null
          ? +ev.button
          : ev.which != null
            ? ev.which - 1
            : null;

        if (self.isMSIE) {
          button = button === 1 ? 0 : button === 4 ? 1 : button;
        }
        break;
      case 'mouseup':
        button = 3;
        break;
      case 'DOMMouseScroll':
        button = ev.detail < 0
          ? 64
          : 65;
        break;
      case 'mousewheel':
        button = ev.wheelDeltaY > 0
          ? 64
          : 65;
        break;
    }

    // next three bits are the modifiers:
    // 4 = shift, 8 = meta, 16 = control
    shift = ev.shiftKey ? 4 : 0;
    meta = ev.metaKey ? 8 : 0;
    ctrl = ev.ctrlKey ? 16 : 0;
    mod = shift | meta | ctrl;

    // no mods
    if (self.vt200Mouse) {
      // ctrl only
      mod &= ctrl;
    } else if (!self.normalMouse) {
      mod = 0;
    }

    // increment to SP
    button = (32 + (mod << 2)) + button;

    return button;
  }

  // mouse coordinates measured in cols/rows
  function getCoords(ev) {
    var x, y, w, h, el;

    // ignore browsers without pageX for now
    if (ev.pageX == null) return;

    x = ev.pageX;
    y = ev.pageY;
    el = self.element;

    // should probably check offsetParent
    // but this is more portable
    while (el && el !== self.document.documentElement) {
      x -= el.offsetLeft;
      y -= el.offsetTop;
      el = 'offsetParent' in el
        ? el.offsetParent
        : el.parentNode;
    }

    // convert to cols/rows
    w = self.element.clientWidth;
    h = self.element.clientHeight;
    x = Math.round((x / w) * self.cols);
    y = Math.round((y / h) * self.rows);

    // be sure to avoid sending
    // bad positions to the program
    if (x < 0) x = 0;
    if (x > self.cols) x = self.cols;
    if (y < 0) y = 0;
    if (y > self.rows) y = self.rows;

    // xterm sends raw bytes and
    // starts at 32 (SP) for each.
    x += 32;
    y += 32;

    return {
      x: x,
      y: y,
      type: ev.type === wheelEvent
        ? 'mousewheel'
        : ev.type
    };
  }

  on(el, 'mousedown', function(ev) {
    if (!self.mouseEvents) return;

    // send the button
    sendButton(ev);

    // ensure focus
    self.focus();

    // fix for odd bug
    //if (self.vt200Mouse && !self.normalMouse) {
    if (self.vt200Mouse) {
      sendButton({ __proto__: ev, type: 'mouseup' });
      return cancel(ev);
    }

    // bind events
    if (self.normalMouse) on(self.document, 'mousemove', sendMove);

    // x10 compatibility mode can't send button releases
    if (!self.x10Mouse) {
      on(self.document, 'mouseup', function up(ev) {
        sendButton(ev);
        if (self.normalMouse) off(self.document, 'mousemove', sendMove);
        off(self.document, 'mouseup', up);
        return cancel(ev);
      });
    }

    return cancel(ev);
  });

  //if (self.normalMouse) {
  //  on(self.document, 'mousemove', sendMove);
  //}

  on(el, wheelEvent, function(ev) {
    if (!self.mouseEvents) return;
    if (self.x10Mouse
        || self.vt300Mouse
        || self.decLocator) return;
    sendButton(ev);
    return cancel(ev);
  });

  // allow mousewheel scrolling in
  // the shell for example
  on(el, wheelEvent, function(ev) {
    if (self.mouseEvents) return;
    if (self.applicationKeypad) return;
    if (ev.type === 'DOMMouseScroll') {
      self.scrollDisp(ev.detail < 0 ? -1 : 1);
    } else {
      // Added by Omer: calculate amount by the magnitude of wheel delta, to support trackpad acceleration
      var amount = Math.abs(Math.round(ev.wheelDeltaY / 10));
      self.scrollDisp((ev.wheelDeltaY > 0 ? -1 : 1) * amount);
    }
    return cancel(ev);
  });
};

/**
 * Destroy Terminal
 */

Terminal.prototype.destroy = function() {
  this.readable = false;
  this.writable = false;
  this._events = {};
  this.handler = function() {};
  this.write = function() {};
  if (this.element.parentNode) {
    this.element.parentNode.removeChild(this.element);
  }
  //this.emit('close');
};

/**
 * Rendering Engine
 */

// In the screen buffer, each character
// is stored as a an array with a character
// and a 32-bit integer.
// First value: a utf-16 character.
// Second value:
// Next 9 bits: background color (0-511).
// Next 9 bits: foreground color (0-511).
// Next 14 bits: a mask for misc. flags:
//   1=bold, 2=underline, 4=blink, 8=inverse, 16=invisible

Terminal.prototype.refresh = function(start, end) {
  var x
    , y
    , i
    , line
    , out
    , ch
    , width
    , data
    , attr
    , bg
    , fg
    , flags
    , row
    , parent;

  if (end - start >= this.rows / 2) {
    parent = this.element.parentNode;
    if (parent) parent.removeChild(this.element);
  }

  width = this.cols;
  y = start;

  if (end >= this.lines.length) {
    this.log('`end` is too large. Most likely a bad CSR.');
    end = this.lines.length - 1;
  }

  for (; y <= end; y++) {
    row = y + this.ydisp;

    line = this.lines[row];
    out = '';

    if (y === this.y
        && this.cursorState
        && (this.ydisp === this.ybase || this.selectMode)
        && !this.cursorHidden) {
      x = this.x;
    } else {
      x = -1;
    }

    attr = this.defAttr;
    i = 0;

    for (; i < width; i++) {
      data = line[i][0];
      ch = line[i][1];

      if (i === x) data = -1;

      if (data !== attr) {
        if (attr !== this.defAttr) {
          out += '</span>';
        }
        if (data !== this.defAttr) {
          if (data === -1) {
            out += '<span class="reverse-video terminal-cursor">';
          } else {
            out += '<span style="';

            bg = data & 0x1ff;
            fg = (data >> 9) & 0x1ff;
            flags = data >> 18;

            // bold
            if (flags & 1) {
              if (!Terminal.brokenBold) {
                out += 'font-weight:bold;';
              }
              // See: XTerm*boldColors
              if (fg < 8) fg += 8;
            }

            // underline
            if (flags & 2) {
              out += 'text-decoration:underline;';
            }

            // blink
            if (flags & 4) {
              if (flags & 2) {
                out = out.slice(0, -1);
                out += ' blink;';
              } else {
                out += 'text-decoration:blink;';
              }
            }

            // inverse
            if (flags & 8) {
              bg = (data >> 9) & 0x1ff;
              fg = data & 0x1ff;
              // Should inverse just be before the
              // above boldColors effect instead?
              if ((flags & 1) && fg < 8) fg += 8;
            }

            // invisible
            if (flags & 16) {
              out += 'visibility:hidden;';
            }

            // out += '" class="'
            //   + 'term-bg-color-' + bg
            //   + ' '
            //   + 'term-fg-color-' + fg
            //   + '">';

            if (bg !== 256) {
              out += 'background-color:'
                + this.colors[bg]
                + ';';
            }

            if (fg !== 257) {
              out += 'color:'
                + this.colors[fg]
                + ';';
            }

            out += '">';
          }
        }
      }

      switch (ch) {
        case '&':
          out += '&amp;';
          break;
        case '<':
          out += '&lt;';
          break;
        case '>':
          out += '&gt;';
          break;
        default:
          if (ch <= ' ') {
            out += '&nbsp;';
          } else {
            if (isWide(ch)) i++;
            out += ch;
          }
          break;
      }

      attr = data;
    }

    if (attr !== this.defAttr) {
      out += '</span>';
    }

    this.children[y].innerHTML = out;
  }

  if (parent) parent.appendChild(this.element);

  // Empty selection (after event dispatches)
  var self = this;
  var window = self.element.ownerDocument.defaultView;
  if (window != undefined) {
	  setTimeout(function () {
		  // Select current line's last character (which should be the carret so it'll be hidden)
		  var range = document.createRange();
		  range.setStart(self.children[self.y], 1);
		  range.setEnd(self.children[self.y], 1);
		  var selection = window.getSelection();
		  selection.removeAllRanges();
		  selection.addRange(range);
	  }, 1);
  }

  this.emit("refresh");
};

Terminal.prototype._cursorBlink = function() {
  if (Terminal.focus !== this) return;
  this.cursorState ^= 1;
  this.refresh(this.y, this.y);
};

Terminal.prototype.showCursor = function() {
  if (!this.cursorState) {
    this.cursorState = 1;
    this.refresh(this.y, this.y);
  } else {
    // Temporarily disabled:
    // this.refreshBlink();
  }
};

Terminal.prototype.startBlink = function() {
  if (!this.cursorBlink) return;
  var self = this;
  this._blinker = function() {
    self._cursorBlink();
  };
  this._blink = setInterval(this._blinker, 500);
};

Terminal.prototype.refreshBlink = function() {
  if (!this.cursorBlink) return;
  clearInterval(this._blink);
  this._blink = setInterval(this._blinker, 500);
};

Terminal.prototype.scroll = function() {
  var row;

  if (++this.ybase === this.scrollback) {
    this.ybase = this.ybase / 2 | 0;
    this.lines = this.lines.slice(-(this.ybase + this.rows) + 1);
  }

  this.ydisp = this.ybase;

  // last line
  row = this.ybase + this.rows - 1;

  // subtract the bottom scroll region
  row -= this.rows - 1 - this.scrollBottom;

  if (row === this.lines.length) {
    // potential optimization:
    // pushing is faster than splicing
    // when they amount to the same
    // behavior.
    this.lines.push(this.blankLine());
  } else {
    // add our new line
    this.lines.splice(row, 0, this.blankLine());
  }

  if (this.scrollTop !== 0) {
    if (this.ybase !== 0) {
      this.ybase--;
      this.ydisp = this.ybase;
    }
    this.lines.splice(this.ybase + this.scrollTop, 1);
  }

  // this.maxRange();
  this.updateRange(this.scrollTop);
  this.updateRange(this.scrollBottom);
};

Terminal.prototype.scrollDisp = function(disp) {
  this.ydisp += disp;

  if (this.ydisp > this.ybase) {
    this.ydisp = this.ybase;
  } else if (this.ydisp < 0) {
    this.ydisp = 0;
  }

  this.refresh(0, this.rows - 1);
};

Terminal.prototype.write = function(data) {
  var l = data.length
    , i = 0
    , j
    , cs
    , ch;

  this.refreshStart = this.y;
  this.refreshEnd = this.y;

  if (this.ybase !== this.ydisp) {
    this.ydisp = this.ybase;
    this.maxRange();
  }

  // this.log(JSON.stringify(data.replace(/\x1b/g, '^[')));

  for (; i < l; i++) {
    ch = data[i];
    switch (this.state) {
      case normal:
        switch (ch) {
          // '\0'
          // case '\0':
          // case '\200':
          //   break;

          // '\a'
          case '\x07':
            this.bell();
            break;

          // '\n', '\v', '\f'
          case '\n':
          case '\x0b':
          case '\x0c':
            if (this.convertEol) {
              this.x = 0;
            }
            // TODO: Implement eat_newline_glitch.
            // if (this.realX >= this.cols) break;
            // this.realX = 0;
            this.y++;
            if (this.y > this.scrollBottom) {
              this.y--;
              this.scroll();
            }
            break;

          // '\r'
          case '\r':
            this.x = 0;
            break;

          // '\b'
          case '\x08':
            if (this.x > 0) {
              this.x--;
            }
            break;

          // '\t'
          case '\t':
            this.x = this.nextStop();
            break;

          // shift out
          case '\x0e':
            this.setgLevel(1);
            break;

          // shift in
          case '\x0f':
            this.setgLevel(0);
            break;

          // '\e'
          case '\x1b':
            this.state = escaped;
            break;

          default:
            // ' '
            if (ch >= ' ') {
              if (this.charset && this.charset[ch]) {
                ch = this.charset[ch];
              }

              if (this.x >= this.cols) {
                this.x = 0;
                this.y++;
                if (this.y > this.scrollBottom) {
                  this.y--;
                  this.scroll();
                }
              }

              this.lines[this.y + this.ybase][this.x] = [this.curAttr, ch];
              this.x++;
              this.updateRange(this.y);

              if (isWide(ch)) {
                j = this.y + this.ybase;
                if (this.cols < 2 || this.x >= this.cols) {
                  this.lines[j][this.x - 1] = [this.curAttr, ' '];
                  break;
                }
                this.lines[j][this.x] = [this.curAttr, ' '];
                this.x++;
              }
            }
            break;
        }
        break;
      case escaped:
        switch (ch) {
          // ESC [ Control Sequence Introducer ( CSI is 0x9b).
          case '[':
            this.params = [];
            this.currentParam = 0;
            this.state = csi;
            break;

          // ESC ] Operating System Command ( OSC is 0x9d).
          case ']':
            this.params = [];
            this.currentParam = 0;
            this.state = osc;
            break;

          // ESC P Device Control String ( DCS is 0x90).
          case 'P':
            this.params = [];
            this.currentParam = 0;
            this.state = dcs;
            break;

          // ESC _ Application Program Command ( APC is 0x9f).
          case '_':
            this.state = ignore;
            break;

          // ESC ^ Privacy Message ( PM is 0x9e).
          case '^':
            this.state = ignore;
            break;

          // ESC c Full Reset (RIS).
          case 'c':
            this.reset();
            break;

          // ESC E Next Line ( NEL is 0x85).
          // ESC D Index ( IND is 0x84).
          case 'E':
            this.x = 0;
            ;
          case 'D':
            this.index();
            break;

          // ESC M Reverse Index ( RI is 0x8d).
          case 'M':
            this.reverseIndex();
            break;

          // ESC % Select default/utf-8 character set.
          // @ = default, G = utf-8
          case '%':
            //this.charset = null;
            this.setgLevel(0);
            this.setgCharset(0, Terminal.charsets.US);
            this.state = normal;
            i++;
            break;

          // ESC (,),*,+,-,. Designate G0-G2 Character Set.
          case '(': // <-- this seems to get all the attention
          case ')':
          case '*':
          case '+':
          case '-':
          case '.':
            switch (ch) {
              case '(':
                this.gcharset = 0;
                break;
              case ')':
                this.gcharset = 1;
                break;
              case '*':
                this.gcharset = 2;
                break;
              case '+':
                this.gcharset = 3;
                break;
              case '-':
                this.gcharset = 1;
                break;
              case '.':
                this.gcharset = 2;
                break;
            }
            this.state = charset;
            break;

          // Designate G3 Character Set (VT300).
          // A = ISO Latin-1 Supplemental.
          // Not implemented.
          case '/':
            this.gcharset = 3;
            this.state = charset;
            i--;
            break;

          // ESC N
          // Single Shift Select of G2 Character Set
          // ( SS2 is 0x8e). This affects next character only.
          case 'N':
            break;
          // ESC O
          // Single Shift Select of G3 Character Set
          // ( SS3 is 0x8f). This affects next character only.
          case 'O':
            break;
          // ESC n
          // Invoke the G2 Character Set as GL (LS2).
          case 'n':
            this.setgLevel(2);
            break;
          // ESC o
          // Invoke the G3 Character Set as GL (LS3).
          case 'o':
            this.setgLevel(3);
            break;
          // ESC |
          // Invoke the G3 Character Set as GR (LS3R).
          case '|':
            this.setgLevel(3);
            break;
          // ESC }
          // Invoke the G2 Character Set as GR (LS2R).
          case '}':
            this.setgLevel(2);
            break;
          // ESC ~
          // Invoke the G1 Character Set as GR (LS1R).
          case '~':
            this.setgLevel(1);
            break;

          // ESC 7 Save Cursor (DECSC).
          case '7':
            this.saveCursor();
            this.state = normal;
            break;

          // ESC 8 Restore Cursor (DECRC).
          case '8':
            this.restoreCursor();
            this.state = normal;
            break;

          // ESC # 3 DEC line height/width
          case '#':
            this.state = normal;
            i++;
            break;

          // ESC H Tab Set (HTS is 0x88).
          case 'H':
            this.tabSet();
            break;

          // ESC = Application Keypad (DECPAM).
          case '=':
            this.log('Serial port requested application keypad.');
            this.applicationKeypad = true;
            this.state = normal;
            break;

          // ESC > Normal Keypad (DECPNM).
          case '>':
            this.log('Switching back to normal keypad.');
            this.applicationKeypad = false;
            this.state = normal;
            break;

          default:
            this.state = normal;
            this.error('Unknown ESC control: %s.', ch);
            break;
        }
        break;

      case charset:
        switch (ch) {
          case '0': // DEC Special Character and Line Drawing Set.
            cs = Terminal.charsets.SCLD;
            break;
          case 'A': // UK
            cs = Terminal.charsets.UK;
            break;
          case 'B': // United States (USASCII).
            cs = Terminal.charsets.US;
            break;
          case '4': // Dutch
            cs = Terminal.charsets.Dutch;
            break;
          case 'C': // Finnish
          case '5':
            cs = Terminal.charsets.Finnish;
            break;
          case 'R': // French
            cs = Terminal.charsets.French;
            break;
          case 'Q': // FrenchCanadian
            cs = Terminal.charsets.FrenchCanadian;
            break;
          case 'K': // German
            cs = Terminal.charsets.German;
            break;
          case 'Y': // Italian
            cs = Terminal.charsets.Italian;
            break;
          case 'E': // NorwegianDanish
          case '6':
            cs = Terminal.charsets.NorwegianDanish;
            break;
          case 'Z': // Spanish
            cs = Terminal.charsets.Spanish;
            break;
          case 'H': // Swedish
          case '7':
            cs = Terminal.charsets.Swedish;
            break;
          case '=': // Swiss
            cs = Terminal.charsets.Swiss;
            break;
          case '/': // ISOLatin (actually /A)
            cs = Terminal.charsets.ISOLatin;
            i++;
            break;
          default: // Default
            cs = Terminal.charsets.US;
            break;
        }
        this.setgCharset(this.gcharset, cs);
        this.gcharset = null;
        this.state = normal;
        break;

      case osc:
        // OSC Ps ; Pt ST
        // OSC Ps ; Pt BEL
        //   Set Text Parameters.
        if (ch === '\x1b' || ch === '\x07') {
          if (ch === '\x1b') i++;

          this.params.push(this.currentParam);

          switch (this.params[0]) {
            case 0:
            case 1:
            case 2:
              if (this.params[1]) {
                this.title = this.params[1];
                this.handleTitle(this.title);
              }
              break;
            case 3:
              // set X property
              break;
            case 4:
            case 5:
              // change dynamic colors
              break;
            case 10:
            case 11:
            case 12:
            case 13:
            case 14:
            case 15:
            case 16:
            case 17:
            case 18:
            case 19:
              // change dynamic ui colors
              break;
            case 46:
              // change log file
              break;
            case 50:
              // dynamic font
              break;
            case 51:
              // emacs shell
              break;
            case 52:
              // manipulate selection data
              break;
            case 104:
            case 105:
            case 110:
            case 111:
            case 112:
            case 113:
            case 114:
            case 115:
            case 116:
            case 117:
            case 118:
              // reset colors
              break;
          }

          this.params = [];
          this.currentParam = 0;
          this.state = normal;
        } else {
          if (!this.params.length) {
            if (ch >= '0' && ch <= '9') {
              this.currentParam =
                this.currentParam * 10 + ch.charCodeAt(0) - 48;
            } else if (ch === ';') {
              this.params.push(this.currentParam);
              this.currentParam = '';
            }
          } else {
            this.currentParam += ch;
          }
        }
        break;

      case csi:
        // '?', '>', '!'
        if (ch === '?' || ch === '>' || ch === '!') {
          this.prefix = ch;
          break;
        }

        // 0 - 9
        if (ch >= '0' && ch <= '9') {
          this.currentParam = this.currentParam * 10 + ch.charCodeAt(0) - 48;
          break;
        }

        // '$', '"', ' ', '\''
        if (ch === '$' || ch === '"' || ch === ' ' || ch === '\'') {
          this.postfix = ch;
          break;
        }

        this.params.push(this.currentParam);
        this.currentParam = 0;

        // ';'
        if (ch === ';') break;

        this.state = normal;

        switch (ch) {
          // CSI Ps A
          // Cursor Up Ps Times (default = 1) (CUU).
          case 'A':
            this.cursorUp(this.params);
            break;

          // CSI Ps B
          // Cursor Down Ps Times (default = 1) (CUD).
          case 'B':
            this.cursorDown(this.params);
            break;

          // CSI Ps C
          // Cursor Forward Ps Times (default = 1) (CUF).
          case 'C':
            this.cursorForward(this.params);
            break;

          // CSI Ps D
          // Cursor Backward Ps Times (default = 1) (CUB).
          case 'D':
            this.cursorBackward(this.params);
            break;

          // CSI Ps ; Ps H
          // Cursor Position [row;column] (default = [1,1]) (CUP).
          case 'H':
            this.cursorPos(this.params);
            break;

          // CSI Ps J  Erase in Display (ED).
          case 'J':
            this.eraseInDisplay(this.params);
            break;

          // CSI Ps K  Erase in Line (EL).
          case 'K':
            this.eraseInLine(this.params);
            break;

          // CSI Pm m  Character Attributes (SGR).
          case 'm':
            if (!this.prefix) {
              this.charAttributes(this.params);
            }
            break;

          // CSI Ps n  Device Status Report (DSR).
          case 'n':
            if (!this.prefix) {
              this.deviceStatus(this.params);
            }
            break;

          /**
           * Additions
           */

          // CSI Ps @
          // Insert Ps (Blank) Character(s) (default = 1) (ICH).
          case '@':
            this.insertChars(this.params);
            break;

          // CSI Ps E
          // Cursor Next Line Ps Times (default = 1) (CNL).
          case 'E':
            this.cursorNextLine(this.params);
            break;

          // CSI Ps F
          // Cursor Preceding Line Ps Times (default = 1) (CNL).
          case 'F':
            this.cursorPrecedingLine(this.params);
            break;

          // CSI Ps G
          // Cursor Character Absolute  [column] (default = [row,1]) (CHA).
          case 'G':
            this.cursorCharAbsolute(this.params);
            break;

          // CSI Ps L
          // Insert Ps Line(s) (default = 1) (IL).
          case 'L':
            this.insertLines(this.params);
            break;

          // CSI Ps M
          // Delete Ps Line(s) (default = 1) (DL).
          case 'M':
            this.deleteLines(this.params);
            break;

          // CSI Ps P
          // Delete Ps Character(s) (default = 1) (DCH).
          case 'P':
            this.deleteChars(this.params);
            break;

          // CSI Ps X
          // Erase Ps Character(s) (default = 1) (ECH).
          case 'X':
            this.eraseChars(this.params);
            break;

          // CSI Pm `  Character Position Absolute
          //   [column] (default = [row,1]) (HPA).
          case '`':
            this.charPosAbsolute(this.params);
            break;

          // 141 61 a * HPR -
          // Horizontal Position Relative
          case 'a':
            this.HPositionRelative(this.params);
            break;

          // CSI P s c
          // Send Device Attributes (Primary DA).
          // CSI > P s c
          // Send Device Attributes (Secondary DA)
          case 'c':
            this.sendDeviceAttributes(this.params);
            break;

          // CSI Pm d
          // Line Position Absolute  [row] (default = [1,column]) (VPA).
          case 'd':
            this.linePosAbsolute(this.params);
            break;

          // 145 65 e * VPR - Vertical Position Relative
          case 'e':
            this.VPositionRelative(this.params);
            break;

          // CSI Ps ; Ps f
          //   Horizontal and Vertical Position [row;column] (default =
          //   [1,1]) (HVP).
          case 'f':
            this.HVPosition(this.params);
            break;

          // CSI Pm h  Set Mode (SM).
          // CSI ? Pm h - mouse escape codes, cursor escape codes
          case 'h':
            this.setMode(this.params);
            break;

          // CSI Pm l  Reset Mode (RM).
          // CSI ? Pm l
          case 'l':
            this.resetMode(this.params);
            break;

          // CSI Ps ; Ps r
          //   Set Scrolling Region [top;bottom] (default = full size of win-
          //   dow) (DECSTBM).
          // CSI ? Pm r
          case 'r':
            this.setScrollRegion(this.params);
            break;

          // CSI s
          //   Save cursor (ANSI.SYS).
          case 's':
            this.saveCursor(this.params);
            break;

          // CSI u
          //   Restore cursor (ANSI.SYS).
          case 'u':
            this.restoreCursor(this.params);
            break;

          /**
           * Lesser Used
           */

          // CSI Ps I
          // Cursor Forward Tabulation Ps tab stops (default = 1) (CHT).
          case 'I':
            this.cursorForwardTab(this.params);
            break;

          // CSI Ps S  Scroll up Ps lines (default = 1) (SU).
          case 'S':
            this.scrollUp(this.params);
            break;

          // CSI Ps T  Scroll down Ps lines (default = 1) (SD).
          // CSI Ps ; Ps ; Ps ; Ps ; Ps T
          // CSI > Ps; Ps T
          case 'T':
            // if (this.prefix === '>') {
            //   this.resetTitleModes(this.params);
            //   break;
            // }
            // if (this.params.length > 2) {
            //   this.initMouseTracking(this.params);
            //   break;
            // }
            if (this.params.length < 2 && !this.prefix) {
              this.scrollDown(this.params);
            }
            break;

          // CSI Ps Z
          // Cursor Backward Tabulation Ps tab stops (default = 1) (CBT).
          case 'Z':
            this.cursorBackwardTab(this.params);
            break;

          // CSI Ps b  Repeat the preceding graphic character Ps times (REP).
          case 'b':
            this.repeatPrecedingCharacter(this.params);
            break;

          // CSI Ps g  Tab Clear (TBC).
          case 'g':
            this.tabClear(this.params);
            break;

          // CSI Pm i  Media Copy (MC).
          // CSI ? Pm i
          // case 'i':
          //   this.mediaCopy(this.params);
          //   break;

          // CSI Pm m  Character Attributes (SGR).
          // CSI > Ps; Ps m
          // case 'm': // duplicate
          //   if (this.prefix === '>') {
          //     this.setResources(this.params);
          //   } else {
          //     this.charAttributes(this.params);
          //   }
          //   break;

          // CSI Ps n  Device Status Report (DSR).
          // CSI > Ps n
          // case 'n': // duplicate
          //   if (this.prefix === '>') {
          //     this.disableModifiers(this.params);
          //   } else {
          //     this.deviceStatus(this.params);
          //   }
          //   break;

          // CSI > Ps p  Set pointer mode.
          // CSI ! p   Soft terminal reset (DECSTR).
          // CSI Ps$ p
          //   Request ANSI mode (DECRQM).
          // CSI ? Ps$ p
          //   Request DEC private mode (DECRQM).
          // CSI Ps ; Ps " p
          case 'p':
            switch (this.prefix) {
              // case '>':
              //   this.setPointerMode(this.params);
              //   break;
              case '!':
                this.softReset(this.params);
                break;
              // case '?':
              //   if (this.postfix === '$') {
              //     this.requestPrivateMode(this.params);
              //   }
              //   break;
              // default:
              //   if (this.postfix === '"') {
              //     this.setConformanceLevel(this.params);
              //   } else if (this.postfix === '$') {
              //     this.requestAnsiMode(this.params);
              //   }
              //   break;
            }
            break;

          // CSI Ps q  Load LEDs (DECLL).
          // CSI Ps SP q
          // CSI Ps " q
          // case 'q':
          //   if (this.postfix === ' ') {
          //     this.setCursorStyle(this.params);
          //     break;
          //   }
          //   if (this.postfix === '"') {
          //     this.setCharProtectionAttr(this.params);
          //     break;
          //   }
          //   this.loadLEDs(this.params);
          //   break;

          // CSI Ps ; Ps r
          //   Set Scrolling Region [top;bottom] (default = full size of win-
          //   dow) (DECSTBM).
          // CSI ? Pm r
          // CSI Pt; Pl; Pb; Pr; Ps$ r
          // case 'r': // duplicate
          //   if (this.prefix === '?') {
          //     this.restorePrivateValues(this.params);
          //   } else if (this.postfix === '$') {
          //     this.setAttrInRectangle(this.params);
          //   } else {
          //     this.setScrollRegion(this.params);
          //   }
          //   break;

          // CSI s     Save cursor (ANSI.SYS).
          // CSI ? Pm s
          // case 's': // duplicate
          //   if (this.prefix === '?') {
          //     this.savePrivateValues(this.params);
          //   } else {
          //     this.saveCursor(this.params);
          //   }
          //   break;

          // CSI Ps ; Ps ; Ps t
          // CSI Pt; Pl; Pb; Pr; Ps$ t
          // CSI > Ps; Ps t
          // CSI Ps SP t
          // case 't':
          //   if (this.postfix === '$') {
          //     this.reverseAttrInRectangle(this.params);
          //   } else if (this.postfix === ' ') {
          //     this.setWarningBellVolume(this.params);
          //   } else {
          //     if (this.prefix === '>') {
          //       this.setTitleModeFeature(this.params);
          //     } else {
          //       this.manipulateWindow(this.params);
          //     }
          //   }
          //   break;

          // CSI u     Restore cursor (ANSI.SYS).
          // CSI Ps SP u
          // case 'u': // duplicate
          //   if (this.postfix === ' ') {
          //     this.setMarginBellVolume(this.params);
          //   } else {
          //     this.restoreCursor(this.params);
          //   }
          //   break;

          // CSI Pt; Pl; Pb; Pr; Pp; Pt; Pl; Pp$ v
          // case 'v':
          //   if (this.postfix === '$') {
          //     this.copyRectagle(this.params);
          //   }
          //   break;

          // CSI Pt ; Pl ; Pb ; Pr ' w
          // case 'w':
          //   if (this.postfix === '\'') {
          //     this.enableFilterRectangle(this.params);
          //   }
          //   break;

          // CSI Ps x  Request Terminal Parameters (DECREQTPARM).
          // CSI Ps x  Select Attribute Change Extent (DECSACE).
          // CSI Pc; Pt; Pl; Pb; Pr$ x
          // case 'x':
          //   if (this.postfix === '$') {
          //     this.fillRectangle(this.params);
          //   } else {
          //     this.requestParameters(this.params);
          //     //this.__(this.params);
          //   }
          //   break;

          // CSI Ps ; Pu ' z
          // CSI Pt; Pl; Pb; Pr$ z
          // case 'z':
          //   if (this.postfix === '\'') {
          //     this.enableLocatorReporting(this.params);
          //   } else if (this.postfix === '$') {
          //     this.eraseRectangle(this.params);
          //   }
          //   break;

          // CSI Pm ' {
          // CSI Pt; Pl; Pb; Pr$ {
          // case '{':
          //   if (this.postfix === '\'') {
          //     this.setLocatorEvents(this.params);
          //   } else if (this.postfix === '$') {
          //     this.selectiveEraseRectangle(this.params);
          //   }
          //   break;

          // CSI Ps ' |
          // case '|':
          //   if (this.postfix === '\'') {
          //     this.requestLocatorPosition(this.params);
          //   }
          //   break;

          // CSI P m SP }
          // Insert P s Column(s) (default = 1) (DECIC), VT420 and up.
          // case '}':
          //   if (this.postfix === ' ') {
          //     this.insertColumns(this.params);
          //   }
          //   break;

          // CSI P m SP ~
          // Delete P s Column(s) (default = 1) (DECDC), VT420 and up
          // case '~':
          //   if (this.postfix === ' ') {
          //     this.deleteColumns(this.params);
          //   }
          //   break;

          default:
            this.error('Unknown CSI code: %s.', ch);
            break;
        }

        this.prefix = '';
        this.postfix = '';
        break;

      case dcs:
        if (ch === '\x1b' || ch === '\x07') {
          if (ch === '\x1b') i++;

          switch (this.prefix) {
            // User-Defined Keys (DECUDK).
            case '':
              break;

            // Request Status String (DECRQSS).
            // test: echo -e '\eP$q"p\e\\'
            case '$q':
              var pt = this.currentParam
                , valid = false;

              switch (pt) {
                // DECSCA
                case '"q':
                  pt = '0"q';
                  break;

                // DECSCL
                case '"p':
                  pt = '61"p';
                  break;

                // DECSTBM
                case 'r':
                  pt = ''
                    + (this.scrollTop + 1)
                    + ';'
                    + (this.scrollBottom + 1)
                    + 'r';
                  break;

                // SGR
                case 'm':
                  pt = '0m';
                  break;

                default:
                  this.error('Unknown DCS Pt: %s.', pt);
                  pt = '';
                  break;
              }

              this.send('\x1bP' + +valid + '$r' + pt + '\x1b\\');
              break;

            // Set Termcap/Terminfo Data (xterm, experimental).
            case '+p':
              break;

            // Request Termcap/Terminfo String (xterm, experimental)
            // Regular xterm does not even respond to this sequence.
            // This can cause a small glitch in vim.
            // test: echo -ne '\eP+q6b64\e\\'
            case '+q':
              var pt = this.currentParam
                , valid = false;

              this.send('\x1bP' + +valid + '+r' + pt + '\x1b\\');
              break;

            default:
              this.error('Unknown DCS prefix: %s.', this.prefix);
              break;
          }

          this.currentParam = 0;
          this.prefix = '';
          this.state = normal;
        } else if (!this.currentParam) {
          if (!this.prefix && ch !== '$' && ch !== '+') {
            this.currentParam = ch;
          } else if (this.prefix.length === 2) {
            this.currentParam = ch;
          } else {
            this.prefix += ch;
          }
        } else {
          this.currentParam += ch;
        }
        break;

      case ignore:
        // For PM and APC.
        if (ch === '\x1b' || ch === '\x07') {
          if (ch === '\x1b') i++;
          this.state = normal;
        }
        break;
    }
  }

  this.updateRange(this.y);
  this.refresh(this.refreshStart, this.refreshEnd);
};

Terminal.prototype.writeln = function(data) {
  this.write(data + '\r\n');
};

// Key Resources:
// https://developer.mozilla.org/en-US/docs/DOM/KeyboardEvent
Terminal.prototype.keyDown = function(ev) {
  var self = this
    , key;

  switch (ev.keyCode) {
    // backspace
    case 8:
      if (ev.shiftKey) {
        key = '\x08'; // ^H
        break;
      }
      key = '\x7f'; // ^?
      break;
    // tab
    case 9:
      if (ev.shiftKey) {
        key = '\x1b[Z';
        break;
      }
      key = '\t';
      break;
    // return/enter
    case 13:
      key = '\r';
      break;
    // escape
    case 27:
      key = '\x1b';
      break;
    // left-arrow
    case 37:
      if (this.applicationCursor) {
        key = '\x1bOD'; // SS3 as ^[O for 7-bit
        //key = '\x8fD'; // SS3 as 0x8f for 8-bit
        break;
      }
      key = '\x1b[D';
      break;
    // right-arrow
    case 39:
      if (this.applicationCursor) {
        key = '\x1bOC';
        break;
      }
      key = '\x1b[C';
      break;
    // up-arrow
    case 38:
      if (this.applicationCursor) {
        key = '\x1bOA';
        break;
      }
      if (ev.ctrlKey) {
        this.scrollDisp(-1);
        return cancel(ev);
      } else {
        key = '\x1b[A';
      }
      break;
    // down-arrow
    case 40:
      if (this.applicationCursor) {
        key = '\x1bOB';
        break;
      }
      if (ev.ctrlKey) {
        this.scrollDisp(1);
        return cancel(ev);
      } else {
        key = '\x1b[B';
      }
      break;
    // delete
    case 46:
      key = '\x1b[3~';
      break;
    // insert
    case 45:
      key = '\x1b[2~';
      break;
    // home
    case 36:
      if (this.applicationKeypad) {
        key = '\x1bOH';
        break;
      }
      key = '\x1bOH';
      break;
    // end
    case 35:
      if (this.applicationKeypad) {
        key = '\x1bOF';
        break;
      }
      key = '\x1bOF';
      break;
    // page up
    case 33:
      if (ev.shiftKey) {
        this.scrollDisp(-(this.rows - 1));
        return cancel(ev);
      } else {
        key = '\x1b[5~';
      }
      break;
    // page down
    case 34:
      if (ev.shiftKey) {
        this.scrollDisp(this.rows - 1);
        return cancel(ev);
      } else {
        key = '\x1b[6~';
      }
      break;
    // F1
    case 112:
      key = '\x1bOP';
      break;
    // F2
    case 113:
      key = '\x1bOQ';
      break;
    // F3
    case 114:
      key = '\x1bOR';
      break;
    // F4
    case 115:
      key = '\x1bOS';
      break;
    // F5
    case 116:
      key = '\x1b[15~';
      break;
    // F6
    case 117:
      key = '\x1b[17~';
      break;
    // F7
    case 118:
      key = '\x1b[18~';
      break;
    // F8
    case 119:
      key = '\x1b[19~';
      break;
    // F9
    case 120:
      key = '\x1b[20~';
      break;
    // F10
    case 121:
      key = '\x1b[21~';
      break;
    // F11
    case 122:
      key = '\x1b[23~';
      break;
    // F12
    case 123:
      key = '\x1b[24~';
      break;
    default:
      // a-z and space
      if (ev.ctrlKey) {
        if (ev.keyCode >= 65 && ev.keyCode <= 90) {
          // Ctrl-A
          if (this.screenKeys) {
            if (!this.prefixMode && !this.selectMode && ev.keyCode === 65) {
              this.enterPrefix();
              return cancel(ev);
            }
          }
          // Ctrl-V
          if (this.prefixMode && ev.keyCode === 86) {
            this.leavePrefix();
            return;
          }
          // Ctrl-C
          if ((this.prefixMode || this.selectMode) && ev.keyCode === 67) {
            if (this.visualMode) {
              setTimeout(function() {
                self.leaveVisual();
              }, 1);
            }
            return;
          }
          key = String.fromCharCode(ev.keyCode - 64);
        } else if (ev.keyCode === 32) {
          // NUL
          key = String.fromCharCode(0);
        } else if (ev.keyCode >= 51 && ev.keyCode <= 55) {
          // escape, file sep, group sep, record sep, unit sep
          key = String.fromCharCode(ev.keyCode - 51 + 27);
        } else if (ev.keyCode === 56) {
          // delete
          key = String.fromCharCode(127);
        } else if (ev.keyCode === 219) {
          // ^[ - escape
          key = String.fromCharCode(27);
        } else if (ev.keyCode === 221) {
          // ^] - group sep
          key = String.fromCharCode(29);
        }
      } else if (ev.altKey) {
		  if (ev.keyCode >= 65 && ev.keyCode <= 90) {
			  key = '\x1b' + String.fromCharCode(ev.keyCode + 32);
		  } else if (ev.keyCode === 192) {
			  key = '\x1b`';
		  } else if (ev.keyCode >= 48 && ev.keyCode <= 57) {
			  key = '\x1b' + (ev.keyCode - 48);
		  }
      }
      break;
  }

  if (!key) return true;

  if (this.prefixMode) {
    this.leavePrefix();
    return cancel(ev);
  }

  if (this.selectMode) {
    this.keySelect(ev, key);
    return cancel(ev);
  }

  this.emit('keydown', ev);
  this.emit('key', key, ev);

  this.showCursor();
  this.handler(key);

  return cancel(ev);
};

Terminal.prototype.setgLevel = function(g) {
  this.glevel = g;
  this.charset = this.charsets[g];
};

Terminal.prototype.setgCharset = function(g, charset) {
  this.charsets[g] = charset;
  if (this.glevel === g) {
    this.charset = charset;
  }
};

Terminal.prototype.keyPress = function(ev) {
  var key;

  // Don't cancel command
  if (this.isMac && ev.metaKey) {
	  return true;
  }

  cancel(ev);

  if (ev.charCode) {
    key = ev.charCode;
  } else if (ev.which == null) {
    key = ev.keyCode;
  } else if (ev.which !== 0 && ev.charCode !== 0) {
    key = ev.which;
  } else {
    return false;
  }

  if (!key || ev.ctrlKey || ev.altKey || ev.metaKey) return false;

  key = String.fromCharCode(key);

  if (this.prefixMode) {
    this.leavePrefix();
    this.keyPrefix(ev, key);
    return false;
  }

  if (this.selectMode) {
    this.keySelect(ev, key);
    return false;
  }

  this.emit('keypress', key, ev);
  this.emit('key', key, ev);

  this.showCursor();
  this.handler(key);

  return false;
};

Terminal.prototype.send = function(data) {
  var self = this;

  if (!this.queue) {
    setTimeout(function() {
      self.handler(self.queue);
      self.queue = '';
    }, 1);
  }

  this.queue += data;
};

Terminal.prototype.bell = function() {
  this.emit('bell');
  if (!this.visualBell) return;
  var self = this;
  this.element.style.borderColor = 'white';
  setTimeout(function() {
    self.element.style.borderColor = '';
  }, 10);
  if (this.popOnBell) this.focus();
};

Terminal.prototype.log = function() {
  if (!this.debug) return;
  if (!this.context.console || !this.context.console.log) return;
  var args = Array.prototype.slice.call(arguments);
  this.context.console.log.apply(this.context.console, args);
};

Terminal.prototype.error = function() {
  if (!this.debug) return;
  if (!this.context.console || !this.context.console.error) return;
  var args = Array.prototype.slice.call(arguments);
  this.context.console.error.apply(this.context.console, args);
};

Terminal.prototype.resize = function(x, y) {
  var line
    , el
    , i
    , j
    , ch;

  if (x < 1) x = 1;
  if (y < 1) y = 1;

  // resize cols
  j = this.cols;
  if (j < x) {
    ch = [this.defAttr, ' ']; // does xterm use the default attr?
    i = this.lines.length;
    while (i--) {
      while (this.lines[i].length < x) {
        this.lines[i].push(ch);
      }
    }
  } else if (j > x) {
    i = this.lines.length;
    while (i--) {
      while (this.lines[i].length > x) {
        this.lines[i].pop();
      }
    }
  }
  this.setupStops(j);
  this.cols = x;

  // resize rows
  j = this.rows;
  if (j < y) {
    el = this.element;
    while (j++ < y) {
      if (this.lines.length < y + this.ybase) {
        this.lines.push(this.blankLine());
      }
      if (this.children.length < y) {
        line = this.document.createElement('div');
        el.appendChild(line);
        this.children.push(line);
      }
    }
  } else if (j > y) {
    while (j-- > y) {
      if (this.lines.length > y + this.ybase) {
        this.lines.pop();
      }
      if (this.children.length > y) {
        el = this.children.pop();
        if (!el) continue;
        el.parentNode.removeChild(el);
      }
    }
  }
  this.rows = y;

  // make sure the cursor stays on screen
  if (this.y >= y) this.y = y - 1;
  if (this.x >= x) this.x = x - 1;

  this.scrollTop = 0;
  this.scrollBottom = y - 1;

  this.refresh(0, this.rows - 1);

  // it's a real nightmare trying
  // to resize the original
  // screen buffer. just set it
  // to null for now.
  this.normal = null;
};

Terminal.prototype.updateRange = function(y) {
  if (y < this.refreshStart) this.refreshStart = y;
  if (y > this.refreshEnd) this.refreshEnd = y;
  // if (y > this.refreshEnd) {
  //   this.refreshEnd = y;
  //   if (y > this.rows - 1) {
  //     this.refreshEnd = this.rows - 1;
  //   }
  // }
};

Terminal.prototype.maxRange = function() {
  this.refreshStart = 0;
  this.refreshEnd = this.rows - 1;
};

Terminal.prototype.setupStops = function(i) {
  if (i != null) {
    if (!this.tabs[i]) {
      i = this.prevStop(i);
    }
  } else {
    this.tabs = {};
    i = 0;
  }

  for (; i < this.cols; i += 8) {
    this.tabs[i] = true;
  }
};

Terminal.prototype.prevStop = function(x) {
  if (x == null) x = this.x;
  while (!this.tabs[--x] && x > 0);
  return x >= this.cols
    ? this.cols - 1
    : x < 0 ? 0 : x;
};

Terminal.prototype.nextStop = function(x) {
  if (x == null) x = this.x;
  while (!this.tabs[++x] && x < this.cols);
  return x >= this.cols
    ? this.cols - 1
    : x < 0 ? 0 : x;
};

Terminal.prototype.eraseRight = function(x, y) {
  var line = this.lines[this.ybase + y]
    , ch = [this.eraseAttr(), ' ']; // xterm


  for (; x < this.cols; x++) {
    line[x] = ch;
  }

  this.updateRange(y);
};

Terminal.prototype.eraseLeft = function(x, y) {
  var line = this.lines[this.ybase + y]
    , ch = [this.eraseAttr(), ' ']; // xterm

  x++;
  while (x--) line[x] = ch;

  this.updateRange(y);
};

Terminal.prototype.eraseLine = function(y) {
  this.eraseRight(0, y);
};

Terminal.prototype.blankLine = function(cur) {
  var attr = cur
    ? this.eraseAttr()
    : this.defAttr;

  var ch = [attr, ' ']
    , line = []
    , i = 0;

  for (; i < this.cols; i++) {
    line[i] = ch;
  }

  return line;
};

Terminal.prototype.ch = function(cur) {
  return cur
    ? [this.eraseAttr(), ' ']
    : [this.defAttr, ' '];
};

Terminal.prototype.is = function(term) {
  var name = this.termName;
  return (name + '').indexOf(term) === 0;
};

Terminal.prototype.handler = function(data) {
  this.emit('data', data);
};

Terminal.prototype.handleTitle = function(title) {
  this.emit('title', title);
};

/**
 * ESC
 */

// ESC D Index (IND is 0x84).
Terminal.prototype.index = function() {
  this.y++;
  if (this.y > this.scrollBottom) {
    this.y--;
    this.scroll();
  }
  this.state = normal;
};

// ESC M Reverse Index (RI is 0x8d).
Terminal.prototype.reverseIndex = function() {
  var j;
  this.y--;
  if (this.y < this.scrollTop) {
    this.y++;
    // possibly move the code below to term.reverseScroll();
    // test: echo -ne '\e[1;1H\e[44m\eM\e[0m'
    // blankLine(true) is xterm/linux behavior
    this.lines.splice(this.y + this.ybase, 0, this.blankLine(true));
    j = this.rows - 1 - this.scrollBottom;
    this.lines.splice(this.rows - 1 + this.ybase - j + 1, 1);
    // this.maxRange();
    this.updateRange(this.scrollTop);
    this.updateRange(this.scrollBottom);
  }
  this.state = normal;
};

// ESC c Full Reset (RIS).
Terminal.prototype.reset = function() {
  this.options.rows = this.rows;
  this.options.cols = this.cols;
  Terminal.call(this, this.options);
  this.refresh(0, this.rows - 1);
};

// ESC H Tab Set (HTS is 0x88).
Terminal.prototype.tabSet = function() {
  this.tabs[this.x] = true;
  this.state = normal;
};

/**
 * CSI
 */

// CSI Ps A
// Cursor Up Ps Times (default = 1) (CUU).
Terminal.prototype.cursorUp = function(params) {
  var param = params[0];
  if (param < 1) param = 1;
  this.y -= param;
  if (this.y < 0) this.y = 0;
};

// CSI Ps B
// Cursor Down Ps Times (default = 1) (CUD).
Terminal.prototype.cursorDown = function(params) {
  var param = params[0];
  if (param < 1) param = 1;
  this.y += param;
  if (this.y >= this.rows) {
    this.y = this.rows - 1;
  }
};

// CSI Ps C
// Cursor Forward Ps Times (default = 1) (CUF).
Terminal.prototype.cursorForward = function(params) {
  var param = params[0];
  if (param < 1) param = 1;
  this.x += param;
  if (this.x >= this.cols) {
    this.x = this.cols - 1;
  }
};

// CSI Ps D
// Cursor Backward Ps Times (default = 1) (CUB).
Terminal.prototype.cursorBackward = function(params) {
  var param = params[0];
  if (param < 1) param = 1;
  this.x -= param;
  if (this.x < 0) this.x = 0;
};

// CSI Ps ; Ps H
// Cursor Position [row;column] (default = [1,1]) (CUP).
Terminal.prototype.cursorPos = function(params) {
  var row, col;

  row = params[0] - 1;

  if (params.length >= 2) {
    col = params[1] - 1;
  } else {
    col = 0;
  }

  if (row < 0) {
    row = 0;
  } else if (row >= this.rows) {
    row = this.rows - 1;
  }

  if (col < 0) {
    col = 0;
  } else if (col >= this.cols) {
    col = this.cols - 1;
  }

  this.x = col;
  this.y = row;
};

// CSI Ps J  Erase in Display (ED).
//     Ps = 0  -> Erase Below (default).
//     Ps = 1  -> Erase Above.
//     Ps = 2  -> Erase All.
//     Ps = 3  -> Erase Saved Lines (xterm).
// CSI ? Ps J
//   Erase in Display (DECSED).
//     Ps = 0  -> Selective Erase Below (default).
//     Ps = 1  -> Selective Erase Above.
//     Ps = 2  -> Selective Erase All.
Terminal.prototype.eraseInDisplay = function(params) {
  var j;
  switch (params[0]) {
    case 0:
      this.eraseRight(this.x, this.y);
      j = this.y + 1;
      for (; j < this.rows; j++) {
        this.eraseLine(j);
      }
      break;
    case 1:
      this.eraseLeft(this.x, this.y);
      j = this.y;
      while (j--) {
        this.eraseLine(j);
      }
      break;
    case 2:
      j = this.rows;
      while (j--) this.eraseLine(j);
      break;
    case 3:
      ; // no saved lines
      break;
  }
};

// CSI Ps K  Erase in Line (EL).
//     Ps = 0  -> Erase to Right (default).
//     Ps = 1  -> Erase to Left.
//     Ps = 2  -> Erase All.
// CSI ? Ps K
//   Erase in Line (DECSEL).
//     Ps = 0  -> Selective Erase to Right (default).
//     Ps = 1  -> Selective Erase to Left.
//     Ps = 2  -> Selective Erase All.
Terminal.prototype.eraseInLine = function(params) {
  switch (params[0]) {
    case 0:
      this.eraseRight(this.x, this.y);
      break;
    case 1:
      this.eraseLeft(this.x, this.y);
      break;
    case 2:
      this.eraseLine(this.y);
      break;
  }
};

// CSI Pm m  Character Attributes (SGR).
//     Ps = 0  -> Normal (default).
//     Ps = 1  -> Bold.
//     Ps = 4  -> Underlined.
//     Ps = 5  -> Blink (appears as Bold).
//     Ps = 7  -> Inverse.
//     Ps = 8  -> Invisible, i.e., hidden (VT300).
//     Ps = 2 2  -> Normal (neither bold nor faint).
//     Ps = 2 4  -> Not underlined.
//     Ps = 2 5  -> Steady (not blinking).
//     Ps = 2 7  -> Positive (not inverse).
//     Ps = 2 8  -> Visible, i.e., not hidden (VT300).
//     Ps = 3 0  -> Set foreground color to Black.
//     Ps = 3 1  -> Set foreground color to Red.
//     Ps = 3 2  -> Set foreground color to Green.
//     Ps = 3 3  -> Set foreground color to Yellow.
//     Ps = 3 4  -> Set foreground color to Blue.
//     Ps = 3 5  -> Set foreground color to Magenta.
//     Ps = 3 6  -> Set foreground color to Cyan.
//     Ps = 3 7  -> Set foreground color to White.
//     Ps = 3 9  -> Set foreground color to default (original).
//     Ps = 4 0  -> Set background color to Black.
//     Ps = 4 1  -> Set background color to Red.
//     Ps = 4 2  -> Set background color to Green.
//     Ps = 4 3  -> Set background color to Yellow.
//     Ps = 4 4  -> Set background color to Blue.
//     Ps = 4 5  -> Set background color to Magenta.
//     Ps = 4 6  -> Set background color to Cyan.
//     Ps = 4 7  -> Set background color to White.
//     Ps = 4 9  -> Set background color to default (original).

//   If 16-color support is compiled, the following apply.  Assume
//   that xterm's resources are set so that the ISO color codes are
//   the first 8 of a set of 16.  Then the aixterm colors are the
//   bright versions of the ISO colors:
//     Ps = 9 0  -> Set foreground color to Black.
//     Ps = 9 1  -> Set foreground color to Red.
//     Ps = 9 2  -> Set foreground color to Green.
//     Ps = 9 3  -> Set foreground color to Yellow.
//     Ps = 9 4  -> Set foreground color to Blue.
//     Ps = 9 5  -> Set foreground color to Magenta.
//     Ps = 9 6  -> Set foreground color to Cyan.
//     Ps = 9 7  -> Set foreground color to White.
//     Ps = 1 0 0  -> Set background color to Black.
//     Ps = 1 0 1  -> Set background color to Red.
//     Ps = 1 0 2  -> Set background color to Green.
//     Ps = 1 0 3  -> Set background color to Yellow.
//     Ps = 1 0 4  -> Set background color to Blue.
//     Ps = 1 0 5  -> Set background color to Magenta.
//     Ps = 1 0 6  -> Set background color to Cyan.
//     Ps = 1 0 7  -> Set background color to White.

//   If xterm is compiled with the 16-color support disabled, it
//   supports the following, from rxvt:
//     Ps = 1 0 0  -> Set foreground and background color to
//     default.

//   If 88- or 256-color support is compiled, the following apply.
//     Ps = 3 8  ; 5  ; Ps -> Set foreground color to the second
//     Ps.
//     Ps = 4 8  ; 5  ; Ps -> Set background color to the second
//     Ps.
Terminal.prototype.charAttributes = function(params) {
  // Optimize a single SGR0.
  if (params.length === 1 && params[0] === 0) {
    this.curAttr = this.defAttr;
    return;
  }

  var l = params.length
    , i = 0
    , flags = this.curAttr >> 18
    , fg = (this.curAttr >> 9) & 0x1ff
    , bg = this.curAttr & 0x1ff
    , p;

  for (; i < l; i++) {
    p = params[i];
    if (p >= 30 && p <= 37) {
      // fg color 8
      fg = p - 30;
    } else if (p >= 40 && p <= 47) {
      // bg color 8
      bg = p - 40;
    } else if (p >= 90 && p <= 97) {
      // fg color 16
      p += 8;
      fg = p - 90;
    } else if (p >= 100 && p <= 107) {
      // bg color 16
      p += 8;
      bg = p - 100;
    } else if (p === 0) {
      // default
      flags = this.defAttr >> 18;
      fg = (this.defAttr >> 9) & 0x1ff;
      bg = this.defAttr & 0x1ff;
      // flags = 0;
      // fg = 0x1ff;
      // bg = 0x1ff;
    } else if (p === 1) {
      // bold text
      flags |= 1;
    } else if (p === 4) {
      // underlined text
      flags |= 2;
    } else if (p === 5) {
      // blink
      flags |= 4;
    } else if (p === 7) {
      // inverse and positive
      // test with: echo -e '\e[31m\e[42mhello\e[7mworld\e[27mhi\e[m'
      flags |= 8;
    } else if (p === 8) {
      // invisible
      flags |= 16;
    } else if (p === 22) {
      // not bold
      flags &= ~1;
    } else if (p === 24) {
      // not underlined
      flags &= ~2;
    } else if (p === 25) {
      // not blink
      flags &= ~4;
    } else if (p === 27) {
      // not inverse
      flags &= ~8;
    } else if (p === 28) {
      // not invisible
      flags &= ~16;
    } else if (p === 39) {
      // reset fg
      fg = (this.defAttr >> 9) & 0x1ff;
    } else if (p === 49) {
      // reset bg
      bg = this.defAttr & 0x1ff;
    } else if (p === 38) {
      // fg color 256
      if (params[i + 1] === 2) {
        i += 2;
        fg = matchColor(
          params[i] & 0xff,
          params[i + 1] & 0xff,
          params[i + 2] & 0xff);
        if (fg === -1) fg = 0x1ff;
        i += 2;
      } else if (params[i + 1] === 5) {
        i += 2;
        p = params[i] & 0xff;
        fg = p;
      }
    } else if (p === 48) {
      // bg color 256
      if (params[i + 1] === 2) {
        i += 2;
        bg = matchColor(
          params[i] & 0xff,
          params[i + 1] & 0xff,
          params[i + 2] & 0xff);
        if (bg === -1) bg = 0x1ff;
        i += 2;
      } else if (params[i + 1] === 5) {
        i += 2;
        p = params[i] & 0xff;
        bg = p;
      }
    } else if (p === 100) {
      // reset fg/bg
      fg = (this.defAttr >> 9) & 0x1ff;
      bg = this.defAttr & 0x1ff;
    } else {
      this.error('Unknown SGR attribute: %d.', p);
    }
  }

  this.curAttr = (flags << 18) | (fg << 9) | bg;
};

// CSI Ps n  Device Status Report (DSR).
//     Ps = 5  -> Status Report.  Result (``OK'') is
//   CSI 0 n
//     Ps = 6  -> Report Cursor Position (CPR) [row;column].
//   Result is
//   CSI r ; c R
// CSI ? Ps n
//   Device Status Report (DSR, DEC-specific).
//     Ps = 6  -> Report Cursor Position (CPR) [row;column] as CSI
//     ? r ; c R (assumes page is zero).
//     Ps = 1 5  -> Report Printer status as CSI ? 1 0  n  (ready).
//     or CSI ? 1 1  n  (not ready).
//     Ps = 2 5  -> Report UDK status as CSI ? 2 0  n  (unlocked)
//     or CSI ? 2 1  n  (locked).
//     Ps = 2 6  -> Report Keyboard status as
//   CSI ? 2 7  ;  1  ;  0  ;  0  n  (North American).
//   The last two parameters apply to VT400 & up, and denote key-
//   board ready and LK01 respectively.
//     Ps = 5 3  -> Report Locator status as
//   CSI ? 5 3  n  Locator available, if compiled-in, or
//   CSI ? 5 0  n  No Locator, if not.
Terminal.prototype.deviceStatus = function(params) {
  if (!this.prefix) {
    switch (params[0]) {
      case 5:
        // status report
        this.send('\x1b[0n');
        break;
      case 6:
        // cursor position
        this.send('\x1b['
          + (this.y + 1)
          + ';'
          + (this.x + 1)
          + 'R');
        break;
    }
  } else if (this.prefix === '?') {
    // modern xterm doesnt seem to
    // respond to any of these except ?6, 6, and 5
    switch (params[0]) {
      case 6:
        // cursor position
        this.send('\x1b[?'
          + (this.y + 1)
          + ';'
          + (this.x + 1)
          + 'R');
        break;
      case 15:
        // no printer
        // this.send('\x1b[?11n');
        break;
      case 25:
        // dont support user defined keys
        // this.send('\x1b[?21n');
        break;
      case 26:
        // north american keyboard
        // this.send('\x1b[?27;1;0;0n');
        break;
      case 53:
        // no dec locator/mouse
        // this.send('\x1b[?50n');
        break;
    }
  }
};

/**
 * Additions
 */

// CSI Ps @
// Insert Ps (Blank) Character(s) (default = 1) (ICH).
Terminal.prototype.insertChars = function(params) {
  var param, row, j, ch;

  param = params[0];
  if (param < 1) param = 1;

  row = this.y + this.ybase;
  j = this.x;
  ch = [this.eraseAttr(), ' ']; // xterm

  while (param-- && j < this.cols) {
    this.lines[row].splice(j++, 0, ch);
    this.lines[row].pop();
  }
};

// CSI Ps E
// Cursor Next Line Ps Times (default = 1) (CNL).
// same as CSI Ps B ?
Terminal.prototype.cursorNextLine = function(params) {
  var param = params[0];
  if (param < 1) param = 1;
  this.y += param;
  if (this.y >= this.rows) {
    this.y = this.rows - 1;
  }
  this.x = 0;
};

// CSI Ps F
// Cursor Preceding Line Ps Times (default = 1) (CNL).
// reuse CSI Ps A ?
Terminal.prototype.cursorPrecedingLine = function(params) {
  var param = params[0];
  if (param < 1) param = 1;
  this.y -= param;
  if (this.y < 0) this.y = 0;
  this.x = 0;
};

// CSI Ps G
// Cursor Character Absolute  [column] (default = [row,1]) (CHA).
Terminal.prototype.cursorCharAbsolute = function(params) {
  var param = params[0];
  if (param < 1) param = 1;
  this.x = param - 1;
};

// CSI Ps L
// Insert Ps Line(s) (default = 1) (IL).
Terminal.prototype.insertLines = function(params) {
  var param, row, j;

  param = params[0];
  if (param < 1) param = 1;
  row = this.y + this.ybase;

  j = this.rows - 1 - this.scrollBottom;
  j = this.rows - 1 + this.ybase - j + 1;

  while (param--) {
    // test: echo -e '\e[44m\e[1L\e[0m'
    // blankLine(true) - xterm/linux behavior
    this.lines.splice(row, 0, this.blankLine(true));
    this.lines.splice(j, 1);
  }

  // this.maxRange();
  this.updateRange(this.y);
  this.updateRange(this.scrollBottom);
};

// CSI Ps M
// Delete Ps Line(s) (default = 1) (DL).
Terminal.prototype.deleteLines = function(params) {
  var param, row, j;

  param = params[0];
  if (param < 1) param = 1;
  row = this.y + this.ybase;

  j = this.rows - 1 - this.scrollBottom;
  j = this.rows - 1 + this.ybase - j;

  while (param--) {
    // test: echo -e '\e[44m\e[1M\e[0m'
    // blankLine(true) - xterm/linux behavior
    this.lines.splice(j + 1, 0, this.blankLine(true));
    this.lines.splice(row, 1);
  }

  // this.maxRange();
  this.updateRange(this.y);
  this.updateRange(this.scrollBottom);
};

// CSI Ps P
// Delete Ps Character(s) (default = 1) (DCH).
Terminal.prototype.deleteChars = function(params) {
  var param, row, ch;

  param = params[0];
  if (param < 1) param = 1;

  row = this.y + this.ybase;
  ch = [this.eraseAttr(), ' ']; // xterm

  while (param--) {
    this.lines[row].splice(this.x, 1);
    this.lines[row].push(ch);
  }
};

// CSI Ps X
// Erase Ps Character(s) (default = 1) (ECH).
Terminal.prototype.eraseChars = function(params) {
  var param, row, j, ch;

  param = params[0];
  if (param < 1) param = 1;

  row = this.y + this.ybase;
  j = this.x;
  ch = [this.eraseAttr(), ' ']; // xterm

  while (param-- && j < this.cols) {
    this.lines[row][j++] = ch;
  }
};

// CSI Pm `  Character Position Absolute
//   [column] (default = [row,1]) (HPA).
Terminal.prototype.charPosAbsolute = function(params) {
  var param = params[0];
  if (param < 1) param = 1;
  this.x = param - 1;
  if (this.x >= this.cols) {
    this.x = this.cols - 1;
  }
};

// 141 61 a * HPR -
// Horizontal Position Relative
// reuse CSI Ps C ?
Terminal.prototype.HPositionRelative = function(params) {
  var param = params[0];
  if (param < 1) param = 1;
  this.x += param;
  if (this.x >= this.cols) {
    this.x = this.cols - 1;
  }
};

// CSI Ps c  Send Device Attributes (Primary DA).
//     Ps = 0  or omitted -> request attributes from terminal.  The
//     response depends on the decTerminalID resource setting.
//     -> CSI ? 1 ; 2 c  (``VT100 with Advanced Video Option'')
//     -> CSI ? 1 ; 0 c  (``VT101 with No Options'')
//     -> CSI ? 6 c  (``VT102'')
//     -> CSI ? 6 0 ; 1 ; 2 ; 6 ; 8 ; 9 ; 1 5 ; c  (``VT220'')
//   The VT100-style response parameters do not mean anything by
//   themselves.  VT220 parameters do, telling the host what fea-
//   tures the terminal supports:
//     Ps = 1  -> 132-columns.
//     Ps = 2  -> Printer.
//     Ps = 6  -> Selective erase.
//     Ps = 8  -> User-defined keys.
//     Ps = 9  -> National replacement character sets.
//     Ps = 1 5  -> Technical characters.
//     Ps = 2 2  -> ANSI color, e.g., VT525.
//     Ps = 2 9  -> ANSI text locator (i.e., DEC Locator mode).
// CSI > Ps c
//   Send Device Attributes (Secondary DA).
//     Ps = 0  or omitted -> request the terminal's identification
//     code.  The response depends on the decTerminalID resource set-
//     ting.  It should apply only to VT220 and up, but xterm extends
//     this to VT100.
//     -> CSI  > Pp ; Pv ; Pc c
//   where Pp denotes the terminal type
//     Pp = 0  -> ``VT100''.
//     Pp = 1  -> ``VT220''.
//   and Pv is the firmware version (for xterm, this was originally
//   the XFree86 patch number, starting with 95).  In a DEC termi-
//   nal, Pc indicates the ROM cartridge registration number and is
//   always zero.
// More information:
//   xterm/charproc.c - line 2012, for more information.
//   vim responds with ^[[?0c or ^[[?1c after the terminal's response (?)
Terminal.prototype.sendDeviceAttributes = function(params) {
  if (params[0] > 0) return;

  if (!this.prefix) {
    if (this.is('xterm')
        || this.is('rxvt-unicode')
        || this.is('screen')) {
      this.send('\x1b[?1;2c');
    } else if (this.is('linux')) {
      this.send('\x1b[?6c');
    }
  } else if (this.prefix === '>') {
    // xterm and urxvt
    // seem to spit this
    // out around ~370 times (?).
    if (this.is('xterm')) {
      this.send('\x1b[>0;276;0c');
    } else if (this.is('rxvt-unicode')) {
      this.send('\x1b[>85;95;0c');
    } else if (this.is('linux')) {
      // not supported by linux console.
      // linux console echoes parameters.
      this.send(params[0] + 'c');
    } else if (this.is('screen')) {
      this.send('\x1b[>83;40003;0c');
    }
  }
};

// CSI Pm d
// Line Position Absolute  [row] (default = [1,column]) (VPA).
Terminal.prototype.linePosAbsolute = function(params) {
  var param = params[0];
  if (param < 1) param = 1;
  this.y = param - 1;
  if (this.y >= this.rows) {
    this.y = this.rows - 1;
  }
};

// 145 65 e * VPR - Vertical Position Relative
// reuse CSI Ps B ?
Terminal.prototype.VPositionRelative = function(params) {
  var param = params[0];
  if (param < 1) param = 1;
  this.y += param;
  if (this.y >= this.rows) {
    this.y = this.rows - 1;
  }
};

// CSI Ps ; Ps f
//   Horizontal and Vertical Position [row;column] (default =
//   [1,1]) (HVP).
Terminal.prototype.HVPosition = function(params) {
  if (params[0] < 1) params[0] = 1;
  if (params[1] < 1) params[1] = 1;

  this.y = params[0] - 1;
  if (this.y >= this.rows) {
    this.y = this.rows - 1;
  }

  this.x = params[1] - 1;
  if (this.x >= this.cols) {
    this.x = this.cols - 1;
  }
};

// CSI Pm h  Set Mode (SM).
//     Ps = 2  -> Keyboard Action Mode (AM).
//     Ps = 4  -> Insert Mode (IRM).
//     Ps = 1 2  -> Send/receive (SRM).
//     Ps = 2 0  -> Automatic Newline (LNM).
// CSI ? Pm h
//   DEC Private Mode Set (DECSET).
//     Ps = 1  -> Application Cursor Keys (DECCKM).
//     Ps = 2  -> Designate USASCII for character sets G0-G3
//     (DECANM), and set VT100 mode.
//     Ps = 3  -> 132 Column Mode (DECCOLM).
//     Ps = 4  -> Smooth (Slow) Scroll (DECSCLM).
//     Ps = 5  -> Reverse Video (DECSCNM).
//     Ps = 6  -> Origin Mode (DECOM).
//     Ps = 7  -> Wraparound Mode (DECAWM).
//     Ps = 8  -> Auto-repeat Keys (DECARM).
//     Ps = 9  -> Send Mouse X & Y on button press.  See the sec-
//     tion Mouse Tracking.
//     Ps = 1 0  -> Show toolbar (rxvt).
//     Ps = 1 2  -> Start Blinking Cursor (att610).
//     Ps = 1 8  -> Print form feed (DECPFF).
//     Ps = 1 9  -> Set print extent to full screen (DECPEX).
//     Ps = 2 5  -> Show Cursor (DECTCEM).
//     Ps = 3 0  -> Show scrollbar (rxvt).
//     Ps = 3 5  -> Enable font-shifting functions (rxvt).
//     Ps = 3 8  -> Enter Tektronix Mode (DECTEK).
//     Ps = 4 0  -> Allow 80 -> 132 Mode.
//     Ps = 4 1  -> more(1) fix (see curses resource).
//     Ps = 4 2  -> Enable Nation Replacement Character sets (DECN-
//     RCM).
//     Ps = 4 4  -> Turn On Margin Bell.
//     Ps = 4 5  -> Reverse-wraparound Mode.
//     Ps = 4 6  -> Start Logging.  This is normally disabled by a
//     compile-time option.
//     Ps = 4 7  -> Use Alternate Screen Buffer.  (This may be dis-
//     abled by the titeInhibit resource).
//     Ps = 6 6  -> Application keypad (DECNKM).
//     Ps = 6 7  -> Backarrow key sends backspace (DECBKM).
//     Ps = 1 0 0 0  -> Send Mouse X & Y on button press and
//     release.  See the section Mouse Tracking.
//     Ps = 1 0 0 1  -> Use Hilite Mouse Tracking.
//     Ps = 1 0 0 2  -> Use Cell Motion Mouse Tracking.
//     Ps = 1 0 0 3  -> Use All Motion Mouse Tracking.
//     Ps = 1 0 0 4  -> Send FocusIn/FocusOut events.
//     Ps = 1 0 0 5  -> Enable Extended Mouse Mode.
//     Ps = 1 0 1 0  -> Scroll to bottom on tty output (rxvt).
//     Ps = 1 0 1 1  -> Scroll to bottom on key press (rxvt).
//     Ps = 1 0 3 4  -> Interpret "meta" key, sets eighth bit.
//     (enables the eightBitInput resource).
//     Ps = 1 0 3 5  -> Enable special modifiers for Alt and Num-
//     Lock keys.  (This enables the numLock resource).
//     Ps = 1 0 3 6  -> Send ESC   when Meta modifies a key.  (This
//     enables the metaSendsEscape resource).
//     Ps = 1 0 3 7  -> Send DEL from the editing-keypad Delete
//     key.
//     Ps = 1 0 3 9  -> Send ESC  when Alt modifies a key.  (This
//     enables the altSendsEscape resource).
//     Ps = 1 0 4 0  -> Keep selection even if not highlighted.
//     (This enables the keepSelection resource).
//     Ps = 1 0 4 1  -> Use the CLIPBOARD selection.  (This enables
//     the selectToClipboard resource).
//     Ps = 1 0 4 2  -> Enable Urgency window manager hint when
//     Control-G is received.  (This enables the bellIsUrgent
//     resource).
//     Ps = 1 0 4 3  -> Enable raising of the window when Control-G
//     is received.  (enables the popOnBell resource).
//     Ps = 1 0 4 7  -> Use Alternate Screen Buffer.  (This may be
//     disabled by the titeInhibit resource).
//     Ps = 1 0 4 8  -> Save cursor as in DECSC.  (This may be dis-
//     abled by the titeInhibit resource).
//     Ps = 1 0 4 9  -> Save cursor as in DECSC and use Alternate
//     Screen Buffer, clearing it first.  (This may be disabled by
//     the titeInhibit resource).  This combines the effects of the 1
//     0 4 7  and 1 0 4 8  modes.  Use this with terminfo-based
//     applications rather than the 4 7  mode.
//     Ps = 1 0 5 0  -> Set terminfo/termcap function-key mode.
//     Ps = 1 0 5 1  -> Set Sun function-key mode.
//     Ps = 1 0 5 2  -> Set HP function-key mode.
//     Ps = 1 0 5 3  -> Set SCO function-key mode.
//     Ps = 1 0 6 0  -> Set legacy keyboard emulation (X11R6).
//     Ps = 1 0 6 1  -> Set VT220 keyboard emulation.
//     Ps = 2 0 0 4  -> Set bracketed paste mode.
// Modes:
//   http://vt100.net/docs/vt220-rm/chapter4.html
Terminal.prototype.setMode = function(params) {
  if (typeof params === 'object') {
    var l = params.length
      , i = 0;

    for (; i < l; i++) {
      this.setMode(params[i]);
    }

    return;
  }

  if (!this.prefix) {
    switch (params) {
      case 4:
        this.insertMode = true;
        break;
      case 20:
        //this.convertEol = true;
        break;
    }
  } else if (this.prefix === '?') {
    switch (params) {
      case 1:
        this.applicationCursor = true;
        break;
      case 2:
        this.setgCharset(0, Terminal.charsets.US);
        this.setgCharset(1, Terminal.charsets.US);
        this.setgCharset(2, Terminal.charsets.US);
        this.setgCharset(3, Terminal.charsets.US);
        // set VT100 mode here
        break;
      case 3: // 132 col mode
        this.savedCols = this.cols;
        this.resize(132, this.rows);
        break;
      case 6:
        this.originMode = true;
        break;
      case 7:
        this.wraparoundMode = true;
        break;
      case 12:
        // this.cursorBlink = true;
        break;
      case 66:
        this.log('Serial port requested application keypad.');
        this.applicationKeypad = true;
        break;
      case 9: // X10 Mouse
        // no release, no motion, no wheel, no modifiers.
      case 1000: // vt200 mouse
        // no motion.
        // no modifiers, except control on the wheel.
      case 1002: // button event mouse
      case 1003: // any event mouse
        // any event - sends motion events,
        // even if there is no button held down.
        this.x10Mouse = params === 9;
        this.vt200Mouse = params === 1000;
        this.normalMouse = params > 1000;
        this.mouseEvents = true;
        this.element.style.cursor = 'default';
        this.log('Binding to mouse events.');
        break;
      case 1004: // send focusin/focusout events
        // focusin: ^[[I
        // focusout: ^[[O
        this.sendFocus = true;
        break;
      case 1005: // utf8 ext mode mouse
        this.utfMouse = true;
        // for wide terminals
        // simply encodes large values as utf8 characters
        break;
      case 1006: // sgr ext mode mouse
        this.sgrMouse = true;
        // for wide terminals
        // does not add 32 to fields
        // press: ^[[<b;x;yM
        // release: ^[[<b;x;ym
        break;
      case 1015: // urxvt ext mode mouse
        this.urxvtMouse = true;
        // for wide terminals
        // numbers for fields
        // press: ^[[b;x;yM
        // motion: ^[[b;x;yT
        break;
      case 25: // show cursor
        this.cursorHidden = false;
        break;
      case 1049: // alt screen buffer cursor
        //this.saveCursor();
        ; // FALL-THROUGH
      case 47: // alt screen buffer
      case 1047: // alt screen buffer
        if (!this.normal) {
          var normal = {
            lines: this.lines,
            ybase: this.ybase,
            ydisp: this.ydisp,
            x: this.x,
            y: this.y,
            scrollTop: this.scrollTop,
            scrollBottom: this.scrollBottom,
            tabs: this.tabs
            // XXX save charset(s) here?
            // charset: this.charset,
            // glevel: this.glevel,
            // charsets: this.charsets
          };
          this.reset();
          this.normal = normal;
          this.showCursor();
        }
        break;
    }
  }
};

// CSI Pm l  Reset Mode (RM).
//     Ps = 2  -> Keyboard Action Mode (AM).
//     Ps = 4  -> Replace Mode (IRM).
//     Ps = 1 2  -> Send/receive (SRM).
//     Ps = 2 0  -> Normal Linefeed (LNM).
// CSI ? Pm l
//   DEC Private Mode Reset (DECRST).
//     Ps = 1  -> Normal Cursor Keys (DECCKM).
//     Ps = 2  -> Designate VT52 mode (DECANM).
//     Ps = 3  -> 80 Column Mode (DECCOLM).
//     Ps = 4  -> Jump (Fast) Scroll (DECSCLM).
//     Ps = 5  -> Normal Video (DECSCNM).
//     Ps = 6  -> Normal Cursor Mode (DECOM).
//     Ps = 7  -> No Wraparound Mode (DECAWM).
//     Ps = 8  -> No Auto-repeat Keys (DECARM).
//     Ps = 9  -> Don't send Mouse X & Y on button press.
//     Ps = 1 0  -> Hide toolbar (rxvt).
//     Ps = 1 2  -> Stop Blinking Cursor (att610).
//     Ps = 1 8  -> Don't print form feed (DECPFF).
//     Ps = 1 9  -> Limit print to scrolling region (DECPEX).
//     Ps = 2 5  -> Hide Cursor (DECTCEM).
//     Ps = 3 0  -> Don't show scrollbar (rxvt).
//     Ps = 3 5  -> Disable font-shifting functions (rxvt).
//     Ps = 4 0  -> Disallow 80 -> 132 Mode.
//     Ps = 4 1  -> No more(1) fix (see curses resource).
//     Ps = 4 2  -> Disable Nation Replacement Character sets (DEC-
//     NRCM).
//     Ps = 4 4  -> Turn Off Margin Bell.
//     Ps = 4 5  -> No Reverse-wraparound Mode.
//     Ps = 4 6  -> Stop Logging.  (This is normally disabled by a
//     compile-time option).
//     Ps = 4 7  -> Use Normal Screen Buffer.
//     Ps = 6 6  -> Numeric keypad (DECNKM).
//     Ps = 6 7  -> Backarrow key sends delete (DECBKM).
//     Ps = 1 0 0 0  -> Don't send Mouse X & Y on button press and
//     release.  See the section Mouse Tracking.
//     Ps = 1 0 0 1  -> Don't use Hilite Mouse Tracking.
//     Ps = 1 0 0 2  -> Don't use Cell Motion Mouse Tracking.
//     Ps = 1 0 0 3  -> Don't use All Motion Mouse Tracking.
//     Ps = 1 0 0 4  -> Don't send FocusIn/FocusOut events.
//     Ps = 1 0 0 5  -> Disable Extended Mouse Mode.
//     Ps = 1 0 1 0  -> Don't scroll to bottom on tty output
//     (rxvt).
//     Ps = 1 0 1 1  -> Don't scroll to bottom on key press (rxvt).
//     Ps = 1 0 3 4  -> Don't interpret "meta" key.  (This disables
//     the eightBitInput resource).
//     Ps = 1 0 3 5  -> Disable special modifiers for Alt and Num-
//     Lock keys.  (This disables the numLock resource).
//     Ps = 1 0 3 6  -> Don't send ESC  when Meta modifies a key.
//     (This disables the metaSendsEscape resource).
//     Ps = 1 0 3 7  -> Send VT220 Remove from the editing-keypad
//     Delete key.
//     Ps = 1 0 3 9  -> Don't send ESC  when Alt modifies a key.
//     (This disables the altSendsEscape resource).
//     Ps = 1 0 4 0  -> Do not keep selection when not highlighted.
//     (This disables the keepSelection resource).
//     Ps = 1 0 4 1  -> Use the PRIMARY selection.  (This disables
//     the selectToClipboard resource).
//     Ps = 1 0 4 2  -> Disable Urgency window manager hint when
//     Control-G is received.  (This disables the bellIsUrgent
//     resource).
//     Ps = 1 0 4 3  -> Disable raising of the window when Control-
//     G is received.  (This disables the popOnBell resource).
//     Ps = 1 0 4 7  -> Use Normal Screen Buffer, clearing screen
//     first if in the Alternate Screen.  (This may be disabled by
//     the titeInhibit resource).
//     Ps = 1 0 4 8  -> Restore cursor as in DECRC.  (This may be
//     disabled by the titeInhibit resource).
//     Ps = 1 0 4 9  -> Use Normal Screen Buffer and restore cursor
//     as in DECRC.  (This may be disabled by the titeInhibit
//     resource).  This combines the effects of the 1 0 4 7  and 1 0
//     4 8  modes.  Use this with terminfo-based applications rather
//     than the 4 7  mode.
//     Ps = 1 0 5 0  -> Reset terminfo/termcap function-key mode.
//     Ps = 1 0 5 1  -> Reset Sun function-key mode.
//     Ps = 1 0 5 2  -> Reset HP function-key mode.
//     Ps = 1 0 5 3  -> Reset SCO function-key mode.
//     Ps = 1 0 6 0  -> Reset legacy keyboard emulation (X11R6).
//     Ps = 1 0 6 1  -> Reset keyboard emulation to Sun/PC style.
//     Ps = 2 0 0 4  -> Reset bracketed paste mode.
Terminal.prototype.resetMode = function(params) {
  if (typeof params === 'object') {
    var l = params.length
      , i = 0;

    for (; i < l; i++) {
      this.resetMode(params[i]);
    }

    return;
  }

  if (!this.prefix) {
    switch (params) {
      case 4:
        this.insertMode = false;
        break;
      case 20:
        //this.convertEol = false;
        break;
    }
  } else if (this.prefix === '?') {
    switch (params) {
      case 1:
        this.applicationCursor = false;
        break;
      case 3:
        if (this.cols === 132 && this.savedCols) {
          this.resize(this.savedCols, this.rows);
        }
        delete this.savedCols;
        break;
      case 6:
        this.originMode = false;
        break;
      case 7:
        this.wraparoundMode = false;
        break;
      case 12:
        // this.cursorBlink = false;
        break;
      case 66:
        this.log('Switching back to normal keypad.');
        this.applicationKeypad = false;
        break;
      case 9: // X10 Mouse
      case 1000: // vt200 mouse
      case 1002: // button event mouse
      case 1003: // any event mouse
        this.x10Mouse = false;
        this.vt200Mouse = false;
        this.normalMouse = false;
        this.mouseEvents = false;
        this.element.style.cursor = '';
        break;
      case 1004: // send focusin/focusout events
        this.sendFocus = false;
        break;
      case 1005: // utf8 ext mode mouse
        this.utfMouse = false;
        break;
      case 1006: // sgr ext mode mouse
        this.sgrMouse = false;
        break;
      case 1015: // urxvt ext mode mouse
        this.urxvtMouse = false;
        break;
      case 25: // hide cursor
        this.cursorHidden = true;
        break;
      case 1049: // alt screen buffer cursor
        ; // FALL-THROUGH
      case 47: // normal screen buffer
      case 1047: // normal screen buffer - clearing it first
        if (this.normal) {
          this.lines = this.normal.lines;
          this.ybase = this.normal.ybase;
          this.ydisp = this.normal.ydisp;
          this.x = this.normal.x;
          this.y = this.normal.y;
          this.scrollTop = this.normal.scrollTop;
          this.scrollBottom = this.normal.scrollBottom;
          this.tabs = this.normal.tabs;
          this.normal = null;
          // if (params === 1049) {
          //   this.x = this.savedX;
          //   this.y = this.savedY;
          // }
          this.refresh(0, this.rows - 1);
          this.showCursor();
        }
        break;
    }
  }
};

// CSI Ps ; Ps r
//   Set Scrolling Region [top;bottom] (default = full size of win-
//   dow) (DECSTBM).
// CSI ? Pm r
Terminal.prototype.setScrollRegion = function(params) {
  if (this.prefix) return;
  this.scrollTop = (params[0] || 1) - 1;
  this.scrollBottom = (params[1] || this.rows) - 1;
  this.x = 0;
  this.y = 0;
};

// CSI s
//   Save cursor (ANSI.SYS).
Terminal.prototype.saveCursor = function(params) {
  this.savedX = this.x;
  this.savedY = this.y;
};

// CSI u
//   Restore cursor (ANSI.SYS).
Terminal.prototype.restoreCursor = function(params) {
  this.x = this.savedX || 0;
  this.y = this.savedY || 0;
};

/**
 * Lesser Used
 */

// CSI Ps I
//   Cursor Forward Tabulation Ps tab stops (default = 1) (CHT).
Terminal.prototype.cursorForwardTab = function(params) {
  var param = params[0] || 1;
  while (param--) {
    this.x = this.nextStop();
  }
};

// CSI Ps S  Scroll up Ps lines (default = 1) (SU).
Terminal.prototype.scrollUp = function(params) {
  var param = params[0] || 1;
  while (param--) {
    this.lines.splice(this.ybase + this.scrollTop, 1);
    this.lines.splice(this.ybase + this.scrollBottom, 0, this.blankLine());
  }
  // this.maxRange();
  this.updateRange(this.scrollTop);
  this.updateRange(this.scrollBottom);
};

// CSI Ps T  Scroll down Ps lines (default = 1) (SD).
Terminal.prototype.scrollDown = function(params) {
  var param = params[0] || 1;
  while (param--) {
    this.lines.splice(this.ybase + this.scrollBottom, 1);
    this.lines.splice(this.ybase + this.scrollTop, 0, this.blankLine());
  }
  // this.maxRange();
  this.updateRange(this.scrollTop);
  this.updateRange(this.scrollBottom);
};

// CSI Ps ; Ps ; Ps ; Ps ; Ps T
//   Initiate highlight mouse tracking.  Parameters are
//   [func;startx;starty;firstrow;lastrow].  See the section Mouse
//   Tracking.
Terminal.prototype.initMouseTracking = function(params) {
  // Relevant: DECSET 1001
};

// CSI > Ps; Ps T
//   Reset one or more features of the title modes to the default
//   value.  Normally, "reset" disables the feature.  It is possi-
//   ble to disable the ability to reset features by compiling a
//   different default for the title modes into xterm.
//     Ps = 0  -> Do not set window/icon labels using hexadecimal.
//     Ps = 1  -> Do not query window/icon labels using hexadeci-
//     mal.
//     Ps = 2  -> Do not set window/icon labels using UTF-8.
//     Ps = 3  -> Do not query window/icon labels using UTF-8.
//   (See discussion of "Title Modes").
Terminal.prototype.resetTitleModes = function(params) {
  ;
};

// CSI Ps Z  Cursor Backward Tabulation Ps tab stops (default = 1) (CBT).
Terminal.prototype.cursorBackwardTab = function(params) {
  var param = params[0] || 1;
  while (param--) {
    this.x = this.prevStop();
  }
};

// CSI Ps b  Repeat the preceding graphic character Ps times (REP).
Terminal.prototype.repeatPrecedingCharacter = function(params) {
  var param = params[0] || 1
    , line = this.lines[this.ybase + this.y]
    , ch = line[this.x - 1] || [this.defAttr, ' '];

  while (param--) line[this.x++] = ch;
};

// CSI Ps g  Tab Clear (TBC).
//     Ps = 0  -> Clear Current Column (default).
//     Ps = 3  -> Clear All.
// Potentially:
//   Ps = 2  -> Clear Stops on Line.
//   http://vt100.net/annarbor/aaa-ug/section6.html
Terminal.prototype.tabClear = function(params) {
  var param = params[0];
  if (param <= 0) {
    delete this.tabs[this.x];
  } else if (param === 3) {
    this.tabs = {};
  }
};

// CSI Pm i  Media Copy (MC).
//     Ps = 0  -> Print screen (default).
//     Ps = 4  -> Turn off printer controller mode.
//     Ps = 5  -> Turn on printer controller mode.
// CSI ? Pm i
//   Media Copy (MC, DEC-specific).
//     Ps = 1  -> Print line containing cursor.
//     Ps = 4  -> Turn off autoprint mode.
//     Ps = 5  -> Turn on autoprint mode.
//     Ps = 1  0  -> Print composed display, ignores DECPEX.
//     Ps = 1  1  -> Print all pages.
Terminal.prototype.mediaCopy = function(params) {
  ;
};

// CSI > Ps; Ps m
//   Set or reset resource-values used by xterm to decide whether
//   to construct escape sequences holding information about the
//   modifiers pressed with a given key.  The first parameter iden-
//   tifies the resource to set/reset.  The second parameter is the
//   value to assign to the resource.  If the second parameter is
//   omitted, the resource is reset to its initial value.
//     Ps = 1  -> modifyCursorKeys.
//     Ps = 2  -> modifyFunctionKeys.
//     Ps = 4  -> modifyOtherKeys.
//   If no parameters are given, all resources are reset to their
//   initial values.
Terminal.prototype.setResources = function(params) {
  ;
};

// CSI > Ps n
//   Disable modifiers which may be enabled via the CSI > Ps; Ps m
//   sequence.  This corresponds to a resource value of "-1", which
//   cannot be set with the other sequence.  The parameter identi-
//   fies the resource to be disabled:
//     Ps = 1  -> modifyCursorKeys.
//     Ps = 2  -> modifyFunctionKeys.
//     Ps = 4  -> modifyOtherKeys.
//   If the parameter is omitted, modifyFunctionKeys is disabled.
//   When modifyFunctionKeys is disabled, xterm uses the modifier
//   keys to make an extended sequence of functions rather than
//   adding a parameter to each function key to denote the modi-
//   fiers.
Terminal.prototype.disableModifiers = function(params) {
  ;
};

// CSI > Ps p
//   Set resource value pointerMode.  This is used by xterm to
//   decide whether to hide the pointer cursor as the user types.
//   Valid values for the parameter:
//     Ps = 0  -> never hide the pointer.
//     Ps = 1  -> hide if the mouse tracking mode is not enabled.
//     Ps = 2  -> always hide the pointer.  If no parameter is
//     given, xterm uses the default, which is 1 .
Terminal.prototype.setPointerMode = function(params) {
  ;
};

// CSI ! p   Soft terminal reset (DECSTR).
// http://vt100.net/docs/vt220-rm/table4-10.html
Terminal.prototype.softReset = function(params) {
  this.cursorHidden = false;
  this.insertMode = false;
  this.originMode = false;
  this.wraparoundMode = false; // autowrap
  this.applicationKeypad = false; // ?
  this.applicationCursor = false;
  this.scrollTop = 0;
  this.scrollBottom = this.rows - 1;
  this.curAttr = this.defAttr;
  this.x = this.y = 0; // ?
  this.charset = null;
  this.glevel = 0; // ??
  this.charsets = [null]; // ??
};

// CSI Ps$ p
//   Request ANSI mode (DECRQM).  For VT300 and up, reply is
//     CSI Ps; Pm$ y
//   where Ps is the mode number as in RM, and Pm is the mode
//   value:
//     0 - not recognized
//     1 - set
//     2 - reset
//     3 - permanently set
//     4 - permanently reset
Terminal.prototype.requestAnsiMode = function(params) {
  ;
};

// CSI ? Ps$ p
//   Request DEC private mode (DECRQM).  For VT300 and up, reply is
//     CSI ? Ps; Pm$ p
//   where Ps is the mode number as in DECSET, Pm is the mode value
//   as in the ANSI DECRQM.
Terminal.prototype.requestPrivateMode = function(params) {
  ;
};

// CSI Ps ; Ps " p
//   Set conformance level (DECSCL).  Valid values for the first
//   parameter:
//     Ps = 6 1  -> VT100.
//     Ps = 6 2  -> VT200.
//     Ps = 6 3  -> VT300.
//   Valid values for the second parameter:
//     Ps = 0  -> 8-bit controls.
//     Ps = 1  -> 7-bit controls (always set for VT100).
//     Ps = 2  -> 8-bit controls.
Terminal.prototype.setConformanceLevel = function(params) {
  ;
};

// CSI Ps q  Load LEDs (DECLL).
//     Ps = 0  -> Clear all LEDS (default).
//     Ps = 1  -> Light Num Lock.
//     Ps = 2  -> Light Caps Lock.
//     Ps = 3  -> Light Scroll Lock.
//     Ps = 2  1  -> Extinguish Num Lock.
//     Ps = 2  2  -> Extinguish Caps Lock.
//     Ps = 2  3  -> Extinguish Scroll Lock.
Terminal.prototype.loadLEDs = function(params) {
  ;
};

// CSI Ps SP q
//   Set cursor style (DECSCUSR, VT520).
//     Ps = 0  -> blinking block.
//     Ps = 1  -> blinking block (default).
//     Ps = 2  -> steady block.
//     Ps = 3  -> blinking underline.
//     Ps = 4  -> steady underline.
Terminal.prototype.setCursorStyle = function(params) {
  ;
};

// CSI Ps " q
//   Select character protection attribute (DECSCA).  Valid values
//   for the parameter:
//     Ps = 0  -> DECSED and DECSEL can erase (default).
//     Ps = 1  -> DECSED and DECSEL cannot erase.
//     Ps = 2  -> DECSED and DECSEL can erase.
Terminal.prototype.setCharProtectionAttr = function(params) {
  ;
};

// CSI ? Pm r
//   Restore DEC Private Mode Values.  The value of Ps previously
//   saved is restored.  Ps values are the same as for DECSET.
Terminal.prototype.restorePrivateValues = function(params) {
  ;
};

// CSI Pt; Pl; Pb; Pr; Ps$ r
//   Change Attributes in Rectangular Area (DECCARA), VT400 and up.
//     Pt; Pl; Pb; Pr denotes the rectangle.
//     Ps denotes the SGR attributes to change: 0, 1, 4, 5, 7.
// NOTE: xterm doesn't enable this code by default.
Terminal.prototype.setAttrInRectangle = function(params) {
  var t = params[0]
    , l = params[1]
    , b = params[2]
    , r = params[3]
    , attr = params[4];

  var line
    , i;

  for (; t < b + 1; t++) {
    line = this.lines[this.ybase + t];
    for (i = l; i < r; i++) {
      line[i] = [attr, line[i][1]];
    }
  }

  // this.maxRange();
  this.updateRange(params[0]);
  this.updateRange(params[2]);
};

// CSI ? Pm s
//   Save DEC Private Mode Values.  Ps values are the same as for
//   DECSET.
Terminal.prototype.savePrivateValues = function(params) {
  ;
};

// CSI Ps ; Ps ; Ps t
//   Window manipulation (from dtterm, as well as extensions).
//   These controls may be disabled using the allowWindowOps
//   resource.  Valid values for the first (and any additional
//   parameters) are:
//     Ps = 1  -> De-iconify window.
//     Ps = 2  -> Iconify window.
//     Ps = 3  ;  x ;  y -> Move window to [x, y].
//     Ps = 4  ;  height ;  width -> Resize the xterm window to
//     height and width in pixels.
//     Ps = 5  -> Raise the xterm window to the front of the stack-
//     ing order.
//     Ps = 6  -> Lower the xterm window to the bottom of the
//     stacking order.
//     Ps = 7  -> Refresh the xterm window.
//     Ps = 8  ;  height ;  width -> Resize the text area to
//     [height;width] in characters.
//     Ps = 9  ;  0  -> Restore maximized window.
//     Ps = 9  ;  1  -> Maximize window (i.e., resize to screen
//     size).
//     Ps = 1 0  ;  0  -> Undo full-screen mode.
//     Ps = 1 0  ;  1  -> Change to full-screen.
//     Ps = 1 1  -> Report xterm window state.  If the xterm window
//     is open (non-iconified), it returns CSI 1 t .  If the xterm
//     window is iconified, it returns CSI 2 t .
//     Ps = 1 3  -> Report xterm window position.  Result is CSI 3
//     ; x ; y t
//     Ps = 1 4  -> Report xterm window in pixels.  Result is CSI
//     4  ;  height ;  width t
//     Ps = 1 8  -> Report the size of the text area in characters.
//     Result is CSI  8  ;  height ;  width t
//     Ps = 1 9  -> Report the size of the screen in characters.
//     Result is CSI  9  ;  height ;  width t
//     Ps = 2 0  -> Report xterm window's icon label.  Result is
//     OSC  L  label ST
//     Ps = 2 1  -> Report xterm window's title.  Result is OSC  l
//     label ST
//     Ps = 2 2  ;  0  -> Save xterm icon and window title on
//     stack.
//     Ps = 2 2  ;  1  -> Save xterm icon title on stack.
//     Ps = 2 2  ;  2  -> Save xterm window title on stack.
//     Ps = 2 3  ;  0  -> Restore xterm icon and window title from
//     stack.
//     Ps = 2 3  ;  1  -> Restore xterm icon title from stack.
//     Ps = 2 3  ;  2  -> Restore xterm window title from stack.
//     Ps >= 2 4  -> Resize to Ps lines (DECSLPP).
Terminal.prototype.manipulateWindow = function(params) {
  ;
};

// CSI Pt; Pl; Pb; Pr; Ps$ t
//   Reverse Attributes in Rectangular Area (DECRARA), VT400 and
//   up.
//     Pt; Pl; Pb; Pr denotes the rectangle.
//     Ps denotes the attributes to reverse, i.e.,  1, 4, 5, 7.
// NOTE: xterm doesn't enable this code by default.
Terminal.prototype.reverseAttrInRectangle = function(params) {
  ;
};

// CSI > Ps; Ps t
//   Set one or more features of the title modes.  Each parameter
//   enables a single feature.
//     Ps = 0  -> Set window/icon labels using hexadecimal.
//     Ps = 1  -> Query window/icon labels using hexadecimal.
//     Ps = 2  -> Set window/icon labels using UTF-8.
//     Ps = 3  -> Query window/icon labels using UTF-8.  (See dis-
//     cussion of "Title Modes")
Terminal.prototype.setTitleModeFeature = function(params) {
  ;
};

// CSI Ps SP t
//   Set warning-bell volume (DECSWBV, VT520).
//     Ps = 0  or 1  -> off.
//     Ps = 2 , 3  or 4  -> low.
//     Ps = 5 , 6 , 7 , or 8  -> high.
Terminal.prototype.setWarningBellVolume = function(params) {
  ;
};

// CSI Ps SP u
//   Set margin-bell volume (DECSMBV, VT520).
//     Ps = 1  -> off.
//     Ps = 2 , 3  or 4  -> low.
//     Ps = 0 , 5 , 6 , 7 , or 8  -> high.
Terminal.prototype.setMarginBellVolume = function(params) {
  ;
};

// CSI Pt; Pl; Pb; Pr; Pp; Pt; Pl; Pp$ v
//   Copy Rectangular Area (DECCRA, VT400 and up).
//     Pt; Pl; Pb; Pr denotes the rectangle.
//     Pp denotes the source page.
//     Pt; Pl denotes the target location.
//     Pp denotes the target page.
// NOTE: xterm doesn't enable this code by default.
Terminal.prototype.copyRectangle = function(params) {
  ;
};

// CSI Pt ; Pl ; Pb ; Pr ' w
//   Enable Filter Rectangle (DECEFR), VT420 and up.
//   Parameters are [top;left;bottom;right].
//   Defines the coordinates of a filter rectangle and activates
//   it.  Anytime the locator is detected outside of the filter
//   rectangle, an outside rectangle event is generated and the
//   rectangle is disabled.  Filter rectangles are always treated
//   as "one-shot" events.  Any parameters that are omitted default
//   to the current locator position.  If all parameters are omit-
//   ted, any locator motion will be reported.  DECELR always can-
//   cels any prevous rectangle definition.
Terminal.prototype.enableFilterRectangle = function(params) {
  ;
};

// CSI Ps x  Request Terminal Parameters (DECREQTPARM).
//   if Ps is a "0" (default) or "1", and xterm is emulating VT100,
//   the control sequence elicits a response of the same form whose
//   parameters describe the terminal:
//     Ps -> the given Ps incremented by 2.
//     Pn = 1  <- no parity.
//     Pn = 1  <- eight bits.
//     Pn = 1  <- 2  8  transmit 38.4k baud.
//     Pn = 1  <- 2  8  receive 38.4k baud.
//     Pn = 1  <- clock multiplier.
//     Pn = 0  <- STP flags.
Terminal.prototype.requestParameters = function(params) {
  ;
};

// CSI Ps x  Select Attribute Change Extent (DECSACE).
//     Ps = 0  -> from start to end position, wrapped.
//     Ps = 1  -> from start to end position, wrapped.
//     Ps = 2  -> rectangle (exact).
Terminal.prototype.selectChangeExtent = function(params) {
  ;
};

// CSI Pc; Pt; Pl; Pb; Pr$ x
//   Fill Rectangular Area (DECFRA), VT420 and up.
//     Pc is the character to use.
//     Pt; Pl; Pb; Pr denotes the rectangle.
// NOTE: xterm doesn't enable this code by default.
Terminal.prototype.fillRectangle = function(params) {
  var ch = params[0]
    , t = params[1]
    , l = params[2]
    , b = params[3]
    , r = params[4];

  var line
    , i;

  for (; t < b + 1; t++) {
    line = this.lines[this.ybase + t];
    for (i = l; i < r; i++) {
      line[i] = [line[i][0], String.fromCharCode(ch)];
    }
  }

  // this.maxRange();
  this.updateRange(params[1]);
  this.updateRange(params[3]);
};

// CSI Ps ; Pu ' z
//   Enable Locator Reporting (DECELR).
//   Valid values for the first parameter:
//     Ps = 0  -> Locator disabled (default).
//     Ps = 1  -> Locator enabled.
//     Ps = 2  -> Locator enabled for one report, then disabled.
//   The second parameter specifies the coordinate unit for locator
//   reports.
//   Valid values for the second parameter:
//     Pu = 0  <- or omitted -> default to character cells.
//     Pu = 1  <- device physical pixels.
//     Pu = 2  <- character cells.
Terminal.prototype.enableLocatorReporting = function(params) {
  var val = params[0] > 0;
  //this.mouseEvents = val;
  //this.decLocator = val;
};

// CSI Pt; Pl; Pb; Pr$ z
//   Erase Rectangular Area (DECERA), VT400 and up.
//     Pt; Pl; Pb; Pr denotes the rectangle.
// NOTE: xterm doesn't enable this code by default.
Terminal.prototype.eraseRectangle = function(params) {
  var t = params[0]
    , l = params[1]
    , b = params[2]
    , r = params[3];

  var line
    , i
    , ch;

  ch = [this.eraseAttr(), ' ']; // xterm?

  for (; t < b + 1; t++) {
    line = this.lines[this.ybase + t];
    for (i = l; i < r; i++) {
      line[i] = ch;
    }
  }

  // this.maxRange();
  this.updateRange(params[0]);
  this.updateRange(params[2]);
};

// CSI Pm ' {
//   Select Locator Events (DECSLE).
//   Valid values for the first (and any additional parameters)
//   are:
//     Ps = 0  -> only respond to explicit host requests (DECRQLP).
//                (This is default).  It also cancels any filter
//   rectangle.
//     Ps = 1  -> report button down transitions.
//     Ps = 2  -> do not report button down transitions.
//     Ps = 3  -> report button up transitions.
//     Ps = 4  -> do not report button up transitions.
Terminal.prototype.setLocatorEvents = function(params) {
  ;
};

// CSI Pt; Pl; Pb; Pr$ {
//   Selective Erase Rectangular Area (DECSERA), VT400 and up.
//     Pt; Pl; Pb; Pr denotes the rectangle.
Terminal.prototype.selectiveEraseRectangle = function(params) {
  ;
};

// CSI Ps ' |
//   Request Locator Position (DECRQLP).
//   Valid values for the parameter are:
//     Ps = 0 , 1 or omitted -> transmit a single DECLRP locator
//     report.

//   If Locator Reporting has been enabled by a DECELR, xterm will
//   respond with a DECLRP Locator Report.  This report is also
//   generated on button up and down events if they have been
//   enabled with a DECSLE, or when the locator is detected outside
//   of a filter rectangle, if filter rectangles have been enabled
//   with a DECEFR.

//     -> CSI Pe ; Pb ; Pr ; Pc ; Pp &  w

//   Parameters are [event;button;row;column;page].
//   Valid values for the event:
//     Pe = 0  -> locator unavailable - no other parameters sent.
//     Pe = 1  -> request - xterm received a DECRQLP.
//     Pe = 2  -> left button down.
//     Pe = 3  -> left button up.
//     Pe = 4  -> middle button down.
//     Pe = 5  -> middle button up.
//     Pe = 6  -> right button down.
//     Pe = 7  -> right button up.
//     Pe = 8  -> M4 button down.
//     Pe = 9  -> M4 button up.
//     Pe = 1 0  -> locator outside filter rectangle.
//   ``button'' parameter is a bitmask indicating which buttons are
//     pressed:
//     Pb = 0  <- no buttons down.
//     Pb & 1  <- right button down.
//     Pb & 2  <- middle button down.
//     Pb & 4  <- left button down.
//     Pb & 8  <- M4 button down.
//   ``row'' and ``column'' parameters are the coordinates of the
//     locator position in the xterm window, encoded as ASCII deci-
//     mal.
//   The ``page'' parameter is not used by xterm, and will be omit-
//   ted.
Terminal.prototype.requestLocatorPosition = function(params) {
  ;
};

// CSI P m SP }
// Insert P s Column(s) (default = 1) (DECIC), VT420 and up.
// NOTE: xterm doesn't enable this code by default.
Terminal.prototype.insertColumns = function() {
  var param = params[0]
    , l = this.ybase + this.rows
    , ch = [this.eraseAttr(), ' '] // xterm?
    , i;

  while (param--) {
    for (i = this.ybase; i < l; i++) {
      this.lines[i].splice(this.x + 1, 0, ch);
      this.lines[i].pop();
    }
  }

  this.maxRange();
};

// CSI P m SP ~
// Delete P s Column(s) (default = 1) (DECDC), VT420 and up
// NOTE: xterm doesn't enable this code by default.
Terminal.prototype.deleteColumns = function() {
  var param = params[0]
    , l = this.ybase + this.rows
    , ch = [this.eraseAttr(), ' '] // xterm?
    , i;

  while (param--) {
    for (i = this.ybase; i < l; i++) {
      this.lines[i].splice(this.x, 1);
      this.lines[i].push(ch);
    }
  }

  this.maxRange();
};

/**
 * Prefix/Select/Visual/Search Modes
 */

Terminal.prototype.enterPrefix = function() {
  this.prefixMode = true;
};

Terminal.prototype.leavePrefix = function() {
  this.prefixMode = false;
};

Terminal.prototype.enterSelect = function() {
  this._real = {
    x: this.x,
    y: this.y,
    ydisp: this.ydisp,
    ybase: this.ybase,
    cursorHidden: this.cursorHidden,
    lines: this.copyBuffer(this.lines),
    write: this.write
  };
  this.write = function() {};
  this.selectMode = true;
  this.visualMode = false;
  this.cursorHidden = false;
  this.refresh(this.y, this.y);
};

Terminal.prototype.leaveSelect = function() {
  this.x = this._real.x;
  this.y = this._real.y;
  this.ydisp = this._real.ydisp;
  this.ybase = this._real.ybase;
  this.cursorHidden = this._real.cursorHidden;
  this.lines = this._real.lines;
  this.write = this._real.write;
  delete this._real;
  this.selectMode = false;
  this.visualMode = false;
  this.refresh(0, this.rows - 1);
};

Terminal.prototype.enterVisual = function() {
  this._real.preVisual = this.copyBuffer(this.lines);
  this.selectText(this.x, this.x, this.ydisp + this.y, this.ydisp + this.y);
  this.visualMode = true;
};

Terminal.prototype.leaveVisual = function() {
  this.lines = this._real.preVisual;
  delete this._real.preVisual;
  delete this._selected;
  this.visualMode = false;
  this.refresh(0, this.rows - 1);
};

Terminal.prototype.enterSearch = function(down) {
  this.entry = '';
  this.searchMode = true;
  this.searchDown = down;
  this._real.preSearch = this.copyBuffer(this.lines);
  this._real.preSearchX = this.x;
  this._real.preSearchY = this.y;

  var bottom = this.ydisp + this.rows - 1;
  for (var i = 0; i < this.entryPrefix.length; i++) {
    //this.lines[bottom][i][0] = (this.defAttr & ~0x1ff) | 4;
    //this.lines[bottom][i][1] = this.entryPrefix[i];
    this.lines[bottom][i] = [
      (this.defAttr & ~0x1ff) | 4,
      this.entryPrefix[i]
    ];
  }

  this.y = this.rows - 1;
  this.x = this.entryPrefix.length;

  this.refresh(this.rows - 1, this.rows - 1);
};

Terminal.prototype.leaveSearch = function() {
  this.searchMode = false;

  if (this._real.preSearch) {
    this.lines = this._real.preSearch;
    this.x = this._real.preSearchX;
    this.y = this._real.preSearchY;
    delete this._real.preSearch;
    delete this._real.preSearchX;
    delete this._real.preSearchY;
  }

  this.refresh(this.rows - 1, this.rows - 1);
};

Terminal.prototype.copyBuffer = function(lines) {
  var lines = lines || this.lines
    , out = [];

  for (var y = 0; y < lines.length; y++) {
    out[y] = [];
    for (var x = 0; x < lines[y].length; x++) {
      out[y][x] = [lines[y][x][0], lines[y][x][1]];
    }
  }

  return out;
};

Terminal.prototype.getCopyTextarea = function(text) {
  var textarea = this._copyTextarea
    , document = this.document;

  if (!textarea) {
    textarea = document.createElement('textarea');
    textarea.style.position = 'absolute';
    textarea.style.left = '-32000px';
    textarea.style.top = '-32000px';
    textarea.style.width = '0px';
    textarea.style.height = '0px';
    textarea.style.opacity = '0';
    textarea.style.backgroundColor = 'transparent';
    textarea.style.borderStyle = 'none';
    textarea.style.outlineStyle = 'none';

    document.getElementsByTagName('body')[0].appendChild(textarea);

    this._copyTextarea = textarea;
  }

  return textarea;
};

// NOTE: Only works for primary selection on X11.
// Non-X11 users should use Ctrl-C instead.
Terminal.prototype.copyText = function(text) {
  var self = this
    , textarea = this.getCopyTextarea();

  this.emit('copy', text);

  textarea.focus();
  textarea.textContent = text;
  textarea.value = text;
  textarea.setSelectionRange(0, text.length);

  setTimeout(function() {
    self.element.focus();
    self.focus();
  }, 1);
};

Terminal.prototype.selectText = function(x1, x2, y1, y2) {
  var ox1
    , ox2
    , oy1
    , oy2
    , tmp
    , x
    , y
    , xl
    , attr;

  if (this._selected) {
    ox1 = this._selected.x1;
    ox2 = this._selected.x2;
    oy1 = this._selected.y1;
    oy2 = this._selected.y2;

    if (oy2 < oy1) {
      tmp = ox2;
      ox2 = ox1;
      ox1 = tmp;
      tmp = oy2;
      oy2 = oy1;
      oy1 = tmp;
    }

    if (ox2 < ox1 && oy1 === oy2) {
      tmp = ox2;
      ox2 = ox1;
      ox1 = tmp;
    }

    for (y = oy1; y <= oy2; y++) {
      x = 0;
      xl = this.cols - 1;
      if (y === oy1) {
        x = ox1;
      }
      if (y === oy2) {
        xl = ox2;
      }
      for (; x <= xl; x++) {
        if (this.lines[y][x].old != null) {
          //this.lines[y][x][0] = this.lines[y][x].old;
          //delete this.lines[y][x].old;
          attr = this.lines[y][x].old;
          delete this.lines[y][x].old;
          this.lines[y][x] = [attr, this.lines[y][x][1]];
        }
      }
    }

    y1 = this._selected.y1;
    x1 = this._selected.x1;
  }

  y1 = Math.max(y1, 0);
  y1 = Math.min(y1, this.ydisp + this.rows - 1);

  y2 = Math.max(y2, 0);
  y2 = Math.min(y2, this.ydisp + this.rows - 1);

  this._selected = { x1: x1, x2: x2, y1: y1, y2: y2 };

  if (y2 < y1) {
    tmp = x2;
    x2 = x1;
    x1 = tmp;
    tmp = y2;
    y2 = y1;
    y1 = tmp;
  }

  if (x2 < x1 && y1 === y2) {
    tmp = x2;
    x2 = x1;
    x1 = tmp;
  }

  for (y = y1; y <= y2; y++) {
    x = 0;
    xl = this.cols - 1;
    if (y === y1) {
      x = x1;
    }
    if (y === y2) {
      xl = x2;
    }
    for (; x <= xl; x++) {
      //this.lines[y][x].old = this.lines[y][x][0];
      //this.lines[y][x][0] &= ~0x1ff;
      //this.lines[y][x][0] |= (0x1ff << 9) | 4;
      attr = this.lines[y][x][0];
      this.lines[y][x] = [
        (attr & ~0x1ff) | ((0x1ff << 9) | 4),
        this.lines[y][x][1]
      ];
      this.lines[y][x].old = attr;
    }
  }

  y1 = y1 - this.ydisp;
  y2 = y2 - this.ydisp;

  y1 = Math.max(y1, 0);
  y1 = Math.min(y1, this.rows - 1);

  y2 = Math.max(y2, 0);
  y2 = Math.min(y2, this.rows - 1);

  //this.refresh(y1, y2);
  this.refresh(0, this.rows - 1);
};

Terminal.prototype.grabText = function(x1, x2, y1, y2) {
  var out = ''
    , buf = ''
    , ch
    , x
    , y
    , xl
    , tmp;

  if (y2 < y1) {
    tmp = x2;
    x2 = x1;
    x1 = tmp;
    tmp = y2;
    y2 = y1;
    y1 = tmp;
  }

  if (x2 < x1 && y1 === y2) {
    tmp = x2;
    x2 = x1;
    x1 = tmp;
  }

  for (y = y1; y <= y2; y++) {
    x = 0;
    xl = this.cols - 1;
    if (y === y1) {
      x = x1;
    }
    if (y === y2) {
      xl = x2;
    }
    for (; x <= xl; x++) {
      ch = this.lines[y][x][1];
      if (ch === ' ') {
        buf += ch;
        continue;
      }
      if (buf) {
        out += buf;
        buf = '';
      }
      out += ch;
      if (isWide(ch)) x++;
    }
    buf = '';
    out += '\n';
  }

  // If we're not at the end of the
  // line, don't add a newline.
  for (x = x2, y = y2; x < this.cols; x++) {
    if (this.lines[y][x][1] !== ' ') {
      out = out.slice(0, -1);
      break;
    }
  }

  return out;
};

Terminal.prototype.keyPrefix = function(ev, key) {
  if (key === 'k' || key === '&') {
    this.destroy();
  } else if (key === 'p' || key === ']') {
    this.emit('request paste');
  } else if (key === 'c') {
    this.emit('request create');
  } else if (key >= '0' && key <= '9') {
    key = +key - 1;
    if (!~key) key = 9;
    this.emit('request term', key);
  } else if (key === 'n') {
    this.emit('request term next');
  } else if (key === 'P') {
    this.emit('request term previous');
  } else if (key === ':') {
    this.emit('request command mode');
  } else if (key === '[') {
    this.enterSelect();
  }
};

Terminal.prototype.keySelect = function(ev, key) {
  this.showCursor();

  if (this.searchMode || key === 'n' || key === 'N') {
    return this.keySearch(ev, key);
  }

  if (key === '\x04') { // ctrl-d
    var y = this.ydisp + this.y;
    if (this.ydisp === this.ybase) {
      // Mimic vim behavior
      this.y = Math.min(this.y + (this.rows - 1) / 2 | 0, this.rows - 1);
      this.refresh(0, this.rows - 1);
    } else {
      this.scrollDisp((this.rows - 1) / 2 | 0);
    }
    if (this.visualMode) {
      this.selectText(this.x, this.x, y, this.ydisp + this.y);
    }
    return;
  }

  if (key === '\x15') { // ctrl-u
    var y = this.ydisp + this.y;
    if (this.ydisp === 0) {
      // Mimic vim behavior
      this.y = Math.max(this.y - (this.rows - 1) / 2 | 0, 0);
      this.refresh(0, this.rows - 1);
    } else {
      this.scrollDisp(-(this.rows - 1) / 2 | 0);
    }
    if (this.visualMode) {
      this.selectText(this.x, this.x, y, this.ydisp + this.y);
    }
    return;
  }

  if (key === '\x06') { // ctrl-f
    var y = this.ydisp + this.y;
    this.scrollDisp(this.rows - 1);
    if (this.visualMode) {
      this.selectText(this.x, this.x, y, this.ydisp + this.y);
    }
    return;
  }

  if (key === '\x02') { // ctrl-b
    var y = this.ydisp + this.y;
    this.scrollDisp(-(this.rows - 1));
    if (this.visualMode) {
      this.selectText(this.x, this.x, y, this.ydisp + this.y);
    }
    return;
  }

  if (key === 'k' || key === '\x1b[A') {
    var y = this.ydisp + this.y;
    this.y--;
    if (this.y < 0) {
      this.y = 0;
      this.scrollDisp(-1);
    }
    if (this.visualMode) {
      this.selectText(this.x, this.x, y, this.ydisp + this.y);
    } else {
      this.refresh(this.y, this.y + 1);
    }
    return;
  }

  if (key === 'j' || key === '\x1b[B') {
    var y = this.ydisp + this.y;
    this.y++;
    if (this.y >= this.rows) {
      this.y = this.rows - 1;
      this.scrollDisp(1);
    }
    if (this.visualMode) {
      this.selectText(this.x, this.x, y, this.ydisp + this.y);
    } else {
      this.refresh(this.y - 1, this.y);
    }
    return;
  }

  if (key === 'h' || key === '\x1b[D') {
    var x = this.x;
    this.x--;
    if (this.x < 0) {
      this.x = 0;
    }
    if (this.visualMode) {
      this.selectText(x, this.x, this.ydisp + this.y, this.ydisp + this.y);
    } else {
      this.refresh(this.y, this.y);
    }
    return;
  }

  if (key === 'l' || key === '\x1b[C') {
    var x = this.x;
    this.x++;
    if (this.x >= this.cols) {
      this.x = this.cols - 1;
    }
    if (this.visualMode) {
      this.selectText(x, this.x, this.ydisp + this.y, this.ydisp + this.y);
    } else {
      this.refresh(this.y, this.y);
    }
    return;
  }

  if (key === 'v' || key === ' ') {
    if (!this.visualMode) {
      this.enterVisual();
    } else {
      this.leaveVisual();
    }
    return;
  }

  if (key === 'y') {
    if (this.visualMode) {
      var text = this.grabText(
        this._selected.x1, this._selected.x2,
        this._selected.y1, this._selected.y2);
      this.copyText(text);
      this.leaveVisual();
      // this.leaveSelect();
    }
    return;
  }

  if (key === 'q' || key === '\x1b') {
    if (this.visualMode) {
      this.leaveVisual();
    } else {
      this.leaveSelect();
    }
    return;
  }

  if (key === 'w' || key === 'W') {
    var ox = this.x;
    var oy = this.y;
    var oyd = this.ydisp;

    var x = this.x;
    var y = this.y;
    var yb = this.ydisp;
    var saw_space = false;

    for (;;) {
      var line = this.lines[yb + y];
      while (x < this.cols) {
        if (line[x][1] <= ' ') {
          saw_space = true;
        } else if (saw_space) {
          break;
        }
        x++;
      }
      if (x >= this.cols) x = this.cols - 1;
      if (x === this.cols - 1 && line[x][1] <= ' ') {
        x = 0;
        if (++y >= this.rows) {
          y--;
          if (++yb > this.ybase) {
            yb = this.ybase;
            x = this.x;
            break;
          }
        }
        continue;
      }
      break;
    }

    this.x = x, this.y = y;
    this.scrollDisp(-this.ydisp + yb);

    if (this.visualMode) {
      this.selectText(ox, this.x, oy + oyd, this.ydisp + this.y);
    }
    return;
  }

  if (key === 'b' || key === 'B') {
    var ox = this.x;
    var oy = this.y;
    var oyd = this.ydisp;

    var x = this.x;
    var y = this.y;
    var yb = this.ydisp;

    for (;;) {
      var line = this.lines[yb + y];
      var saw_space = x > 0 && line[x][1] > ' ' && line[x - 1][1] > ' ';
      while (x >= 0) {
        if (line[x][1] <= ' ') {
          if (saw_space && (x + 1 < this.cols && line[x + 1][1] > ' ')) {
            x++;
            break;
          } else {
            saw_space = true;
          }
        }
        x--;
      }
      if (x < 0) x = 0;
      if (x === 0 && (line[x][1] <= ' ' || !saw_space)) {
        x = this.cols - 1;
        if (--y < 0) {
          y++;
          if (--yb < 0) {
            yb++;
            x = 0;
            break;
          }
        }
        continue;
      }
      break;
    }

    this.x = x, this.y = y;
    this.scrollDisp(-this.ydisp + yb);

    if (this.visualMode) {
      this.selectText(ox, this.x, oy + oyd, this.ydisp + this.y);
    }
    return;
  }

  if (key === 'e' || key === 'E') {
    var x = this.x + 1;
    var y = this.y;
    var yb = this.ydisp;
    if (x >= this.cols) x--;

    for (;;) {
      var line = this.lines[yb + y];
      while (x < this.cols) {
        if (line[x][1] <= ' ') {
          x++;
        } else {
          break;
        }
      }
      while (x < this.cols) {
        if (line[x][1] <= ' ') {
          if (x - 1 >= 0 && line[x - 1][1] > ' ') {
            x--;
            break;
          }
        }
        x++;
      }
      if (x >= this.cols) x = this.cols - 1;
      if (x === this.cols - 1 && line[x][1] <= ' ') {
        x = 0;
        if (++y >= this.rows) {
          y--;
          if (++yb > this.ybase) {
            yb = this.ybase;
            break;
          }
        }
        continue;
      }
      break;
    }

    this.x = x, this.y = y;
    this.scrollDisp(-this.ydisp + yb);

    if (this.visualMode) {
      this.selectText(ox, this.x, oy + oyd, this.ydisp + this.y);
    }
    return;
  }

  if (key === '^' || key === '0') {
    var ox = this.x;

    if (key === '0') {
      this.x = 0;
    } else if (key === '^') {
      var line = this.lines[this.ydisp + this.y];
      var x = 0;
      while (x < this.cols) {
        if (line[x][1] > ' ') {
          break;
        }
        x++;
      }
      if (x >= this.cols) x = this.cols - 1;
      this.x = x;
    }

    if (this.visualMode) {
      this.selectText(ox, this.x, this.ydisp + this.y, this.ydisp + this.y);
    } else {
      this.refresh(this.y, this.y);
    }
    return;
  }

  if (key === '$') {
    var ox = this.x;
    var line = this.lines[this.ydisp + this.y];
    var x = this.cols - 1;
    while (x >= 0) {
      if (line[x][1] > ' ') {
        if (this.visualMode && x < this.cols - 1) x++;
        break;
      }
      x--;
    }
    if (x < 0) x = 0;
    this.x = x;
    if (this.visualMode) {
      this.selectText(ox, this.x, this.ydisp + this.y, this.ydisp + this.y);
    } else {
      this.refresh(this.y, this.y);
    }
    return;
  }

  if (key === 'g' || key === 'G') {
    var ox = this.x;
    var oy = this.y;
    var oyd = this.ydisp;
    if (key === 'g') {
      this.x = 0, this.y = 0;
      this.scrollDisp(-this.ydisp);
    } else if (key === 'G') {
      this.x = 0, this.y = this.rows - 1;
      this.scrollDisp(this.ybase);
    }
    if (this.visualMode) {
      this.selectText(ox, this.x, oy + oyd, this.ydisp + this.y);
    }
    return;
  }

  if (key === 'H' || key === 'M' || key === 'L') {
    var ox = this.x;
    var oy = this.y;
    if (key === 'H') {
      this.x = 0, this.y = 0;
    } else if (key === 'M') {
      this.x = 0, this.y = this.rows / 2 | 0;
    } else if (key === 'L') {
      this.x = 0, this.y = this.rows - 1;
    }
    if (this.visualMode) {
      this.selectText(ox, this.x, this.ydisp + oy, this.ydisp + this.y);
    } else {
      this.refresh(oy, oy);
      this.refresh(this.y, this.y);
    }
    return;
  }

  if (key === '{' || key === '}') {
    var ox = this.x;
    var oy = this.y;
    var oyd = this.ydisp;

    var line;
    var saw_full = false;
    var found = false;
    var first_is_space = -1;
    var y = this.y + (key === '{' ? -1 : 1);
    var yb = this.ydisp;
    var i;

    if (key === '{') {
      if (y < 0) {
        y++;
        if (yb > 0) yb--;
      }
    } else if (key === '}') {
      if (y >= this.rows) {
        y--;
        if (yb < this.ybase) yb++;
      }
    }

    for (;;) {
      line = this.lines[yb + y];

      for (i = 0; i < this.cols; i++) {
        if (line[i][1] > ' ') {
          if (first_is_space === -1) {
            first_is_space = 0;
          }
          saw_full = true;
          break;
        } else if (i === this.cols - 1) {
          if (first_is_space === -1) {
            first_is_space = 1;
          } else if (first_is_space === 0) {
            found = true;
          } else if (first_is_space === 1) {
            if (saw_full) found = true;
          }
          break;
        }
      }

      if (found) break;

      if (key === '{') {
        y--;
        if (y < 0) {
          y++;
          if (yb > 0) yb--;
          else break;
        }
      } else if (key === '}') {
        y++;
        if (y >= this.rows) {
          y--;
          if (yb < this.ybase) yb++;
          else break;
        }
      }
    }

    if (!found) {
      if (key === '{') {
        y = 0;
        yb = 0;
      } else if (key === '}') {
        y = this.rows - 1;
        yb = this.ybase;
      }
    }

    this.x = 0, this.y = y;
    this.scrollDisp(-this.ydisp + yb);

    if (this.visualMode) {
      this.selectText(ox, this.x, oy + oyd, this.ydisp + this.y);
    }
    return;
  }

  if (key === '/' || key === '?') {
    if (!this.visualMode) {
      this.enterSearch(key === '/');
    }
    return;
  }

  return false;
};

Terminal.prototype.keySearch = function(ev, key) {
  if (key === '\x1b') {
    this.leaveSearch();
    return;
  }

  if (key === '\r' || (!this.searchMode && (key === 'n' || key === 'N'))) {
    this.leaveSearch();

    var entry = this.entry;

    if (!entry) {
      this.refresh(0, this.rows - 1);
      return;
    }

    var ox = this.x;
    var oy = this.y;
    var oyd = this.ydisp;

    var line;
    var found = false;
    var wrapped = false;
    var x = this.x + 1;
    var y = this.ydisp + this.y;
    var yb, i;
    var up = key === 'N'
      ? this.searchDown
      : !this.searchDown;

    for (;;) {
      line = this.lines[y];

      while (x < this.cols) {
        for (i = 0; i < entry.length; i++) {
          if (x + i >= this.cols) break;
          if (line[x + i][1] !== entry[i]) {
            break;
          } else if (line[x + i][1] === entry[i] && i === entry.length - 1) {
            found = true;
            break;
          }
        }
        if (found) break;
        x += i + 1;
      }
      if (found) break;

      x = 0;

      if (!up) {
        y++;
        if (y > this.ybase + this.rows - 1) {
          if (wrapped) break;
          // this.setMessage('Search wrapped. Continuing at TOP.');
          wrapped = true;
          y = 0;
        }
      } else {
        y--;
        if (y < 0) {
          if (wrapped) break;
          // this.setMessage('Search wrapped. Continuing at BOTTOM.');
          wrapped = true;
          y = this.ybase + this.rows - 1;
        }
      }
    }

    if (found) {
      if (y - this.ybase < 0) {
        yb = y;
        y = 0;
        if (yb > this.ybase) {
          y = yb - this.ybase;
          yb = this.ybase;
        }
      } else {
        yb = this.ybase;
        y -= this.ybase;
      }

      this.x = x, this.y = y;
      this.scrollDisp(-this.ydisp + yb);

      if (this.visualMode) {
        this.selectText(ox, this.x, oy + oyd, this.ydisp + this.y);
      }
      return;
    }

    // this.setMessage("No matches found.");
    this.refresh(0, this.rows - 1);

    return;
  }

  if (key === '\b' || key === '\x7f') {
    if (this.entry.length === 0) return;
    var bottom = this.ydisp + this.rows - 1;
    this.entry = this.entry.slice(0, -1);
    var i = this.entryPrefix.length + this.entry.length;
    //this.lines[bottom][i][1] = ' ';
    this.lines[bottom][i] = [
      this.lines[bottom][i][0],
      ' '
    ];
    this.x--;
    this.refresh(this.rows - 1, this.rows - 1);
    this.refresh(this.y, this.y);
    return;
  }

  if (key.length === 1 && key >= ' ' && key <= '~') {
    var bottom = this.ydisp + this.rows - 1;
    this.entry += key;
    var i = this.entryPrefix.length + this.entry.length - 1;
    //this.lines[bottom][i][0] = (this.defAttr & ~0x1ff) | 4;
    //this.lines[bottom][i][1] = key;
    this.lines[bottom][i] = [
      (this.defAttr & ~0x1ff) | 4,
      key
    ];
    this.x++;
    this.refresh(this.rows - 1, this.rows - 1);
    this.refresh(this.y, this.y);
    return;
  }

  return false;
};

/**
 * Character Sets
 */

Terminal.charsets = {};

// DEC Special Character and Line Drawing Set.
// http://vt100.net/docs/vt102-ug/table5-13.html
// A lot of curses apps use this if they see TERM=xterm.
// testing: echo -e '\e(0a\e(B'
// The xterm output sometimes seems to conflict with the
// reference above. xterm seems in line with the reference
// when running vttest however.
// The table below now uses xterm's output from vttest.
Terminal.charsets.SCLD = { // (0
  '`': '\u25c6', // '‚óÜ'
  'a': '\u2592', // '‚ñí'
  'b': '\u0009', // '\t'
  'c': '\u000c', // '\f'
  'd': '\u000d', // '\r'
  'e': '\u000a', // '\n'
  'f': '\u00b0', // '¬∞'
  'g': '\u00b1', // '¬±'
  'h': '\u2424', // '\u2424' (NL)
  'i': '\u000b', // '\v'
  'j': '\u2518', // '‚îò'
  'k': '\u2510', // '‚îê'
  'l': '\u250c', // '‚îå'
  'm': '\u2514', // '‚îî'
  'n': '\u253c', // '‚îº'
  'o': '\u23ba', // '‚é∫'
  'p': '\u23bb', // '‚éª'
  'q': '\u2500', // '‚îÄ'
  'r': '\u23bc', // '‚éº'
  's': '\u23bd', // '‚éΩ'
  't': '\u251c', // '‚îú'
  'u': '\u2524', // '‚î§'
  'v': '\u2534', // '‚î¥'
  'w': '\u252c', // '‚î¨'
  'x': '\u2502', // '‚îÇ'
  'y': '\u2264', // '‚â§'
  'z': '\u2265', // '‚â•'
  '{': '\u03c0', // 'œÄ'
  '|': '\u2260', // '‚â†'
  '}': '\u00a3', // '¬£'
  '~': '\u00b7'  // '¬∑'
};

Terminal.charsets.UK = null; // (A
Terminal.charsets.US = null; // (B (USASCII)
Terminal.charsets.Dutch = null; // (4
Terminal.charsets.Finnish = null; // (C or (5
Terminal.charsets.French = null; // (R
Terminal.charsets.FrenchCanadian = null; // (Q
Terminal.charsets.German = null; // (K
Terminal.charsets.Italian = null; // (Y
Terminal.charsets.NorwegianDanish = null; // (E or (6
Terminal.charsets.Spanish = null; // (Z
Terminal.charsets.Swedish = null; // (H or (7
Terminal.charsets.Swiss = null; // (=
Terminal.charsets.ISOLatin = null; // /A

/**
 * Helpers
 */

function on(el, type, handler, capture) {
  el.addEventListener(type, handler, capture || false);
}

function off(el, type, handler, capture) {
  el.removeEventListener(type, handler, capture || false);
}

function cancel(ev) {
  if (ev.preventDefault) ev.preventDefault();
  ev.returnValue = false;
  if (ev.stopPropagation) ev.stopPropagation();
  ev.cancelBubble = true;
  return false;
}

function inherits(child, parent) {
  function f() {
    this.constructor = child;
  }
  f.prototype = parent.prototype;
  child.prototype = new f;
}

// if bold is broken, we can't
// use it in the terminal.
function isBoldBroken(document) {
  var body = document.getElementsByTagName('body')[0];
  var terminal = document.createElement('div');
  terminal.className = 'terminal';
  var line = document.createElement('div');
  var el = document.createElement('span');
  el.innerHTML = 'hello world';
  line.appendChild(el);
  terminal.appendChild(line);
  body.appendChild(terminal);
  var w1 = el.scrollWidth;
  el.style.fontWeight = 'bold';
  var w2 = el.scrollWidth;
  body.removeChild(terminal);
  return w1 !== w2;
}

var String = this.String;
var setTimeout = this.setTimeout;
var setInterval = this.setInterval;

function indexOf(obj, el) {
  var i = obj.length;
  while (i--) {
    if (obj[i] === el) return i;
  }
  return -1;
}

function isWide(ch) {
  if (ch <= '\uff00') return false;
  return (ch >= '\uff01' && ch <= '\uffbe')
      || (ch >= '\uffc2' && ch <= '\uffc7')
      || (ch >= '\uffca' && ch <= '\uffcf')
      || (ch >= '\uffd2' && ch <= '\uffd7')
      || (ch >= '\uffda' && ch <= '\uffdc')
      || (ch >= '\uffe0' && ch <= '\uffe6')
      || (ch >= '\uffe8' && ch <= '\uffee');
}

function matchColor(r1, g1, b1) {
  var hash = (r1 << 16) | (g1 << 8) | b1;

  if (matchColor._cache[hash] != null) {
    return matchColor._cache[hash];
  }

  var ldiff = Infinity
    , li = -1
    , i = 0
    , c
    , r2
    , g2
    , b2
    , diff;

  for (; i < Terminal.vcolors.length; i++) {
    c = Terminal.vcolors[i];
    r2 = c[0];
    g2 = c[1];
    b2 = c[2];

    diff = matchColor.distance(r1, g1, b1, r2, g2, b2);

    if (diff === 0) {
      li = i;
      break;
    }

    if (diff < ldiff) {
      ldiff = diff;
      li = i;
    }
  }

  return matchColor._cache[hash] = li;
}

matchColor._cache = {};

// http://stackoverflow.com/questions/1633828
matchColor.distance = function(r1, g1, b1, r2, g2, b2) {
  return Math.pow(30 * (r1 - r2), 2)
    + Math.pow(59 * (g1 - g2), 2)
    + Math.pow(11 * (b1 - b2), 2);
};

function each(obj, iter, con) {
  if (obj.forEach) return obj.forEach(iter, con);
  for (var i = 0; i < obj.length; i++) {
    iter.call(con, obj[i], i, obj);
  }
}

function keys(obj) {
  if (Object.keys) return Object.keys(obj);
  var key, keys = [];
  for (key in obj) {
    if (Object.prototype.hasOwnProperty.call(obj, key)) {
      keys.push(key);
    }
  }
  return keys;
}

/**
 * Expose
 */

Terminal.EventEmitter = EventEmitter;
Terminal.inherits = inherits;
Terminal.on = on;
Terminal.off = off;
Terminal.cancel = cancel;

if (typeof module !== 'undefined') {
  module.exports = Terminal;
} else {
  this.Terminal = Terminal;
}

}).call(function() {
  return this || (typeof window !== 'undefined' ? window : global);
}());

/** javascripts/ui-controls/jquery.shorten.js **/
/*
 * jQuery Shorten plugin 1.1.0
 *
 * Copyright (c) 2014 Viral Patel
 * http://viralpatel.net
 *
 * Licensed under the MIT license:
 *   http://www.opensource.org/licenses/mit-license.php
 */

/*
** updated by Jeff Richardson
** Updated to use strict,
** IE 7 has a "bug" It is returning underfined when trying to reference string characters in this format
** content[i]. IE 7 allows content.charAt(i) This works fine in all modern browsers.
** I've also added brackets where they werent added just for readability (mostly for me).
*/

(function($) {
    $.fn.shorten = function(settings) {
        "use strict";

        var config = {
            showChars: "auto",
            ellipsesText: "...",
            moreText: "More",
            lessText: "Less",
            errMsg: null,
            force: false,
            rowsCount: 1
        };

        if (settings) {
            $.extend(config, settings);
        }

        if ($(this).data('jquery.shorten') && !config.force) {
            return false;
        }
        $(this).data('jquery.shorten', true);

        var doc = $(document);
        if (!doc.data('shortenAttached')) {
        	doc.data('shortenAttached', true);

        	doc.off("click", '.morelink');
	        doc.on({
	            click: function() {
	
	                var $this = $(this);
	                if ($this.hasClass('less')) {
	                    $this.removeClass('less');
	                    $this.html(config.moreText);
	                    $this.parent().prev().prev().show(); // shortcontent
	                    $this.parent().prev().hide(); // allcontent
	                    if (config.onLess != undefined) {
	                    	config.onLess($this.parent().parent());
	                    }
	                } else {
	                    $this.addClass('less');
	                    $this.html(config.lessText);
	                    $this.parent().prev().prev().hide(); // shortcontent
	                    $this.parent().prev().show(); // allcontent
	                    if (config.onMore != undefined) {
	                    	config.onMore($this.parent().parent());
	                    }
	                }
	                return false;
	            }
	        }, '.morelink');
        }

        return this.each(function() {
            var $this = $(this);

            var content = $this.html().trim();
            var contentlen = $this.text().length;

            // Calculate how many characters to show if showChars is set to auto
            var showChars = config.showChars;

            if (config.showChars == "auto") {
            	// Reset to max
            	showChars = contentlen;

            	// Look for actual width in attribute, if can't find then check actual width function
                // and if it's zero (maybe not displayed), try taking the max-width property
            	// The attribute saves us some performance issues with width/css functions in jQuery
                var parent = $this.parent();
                var actualWidth = parent.attr('data-width');
                if (isStringEmpty(actualWidth)) {
                	actualWidth = parent.width();
                	if (actualWidth == 0) {
                		actualWidth = replaceAll(parent.css('max-width'), "px", "");
                		if (isStringEmpty(actualWidth)) {
                			actualWidth = 0;
                		}
                	}
                }

                // Calculate container width, remove 8 pixels for every extra row
                var containerWidth = actualWidth * config.rowsCount - (config.rowsCount - 1) * 8;
                var newLinesCount = count(content, "<br");

                // Get from cache
                var body = $("body");
                var shortenCache = body.data('shortenCache');
                if (shortenCache == undefined) {
                	shortenCache = new Object();
                }
                var key = content.length + "_" + newLinesCount;
                var cachedValue = shortenCache[key];
                if (cachedValue == undefined) {
	                // Get canvas, create if can't find one
	            	body.append("<canvas style='display: none'></canvas>");
	            	var canvas = body.find("> canvas");
	                var context = canvas[0].getContext("2d");
	                context.font = '10pt sans-serif';

	                if (context.measureText(content).width > containerWidth || newLinesCount >= config.rowsCount) {
		                // Initial guess
		            	showChars = Math.floor(containerWidth / 6);

		            	// Lower as needed
		                while (showChars > 0) {
		                	var partialContent = content.substr(0, showChars);
		                	if (context.measureText(partialContent).width < containerWidth
		                			&& count(partialContent, "<br") < config.rowsCount) {
		                		break;
		                	} else {
		                		showChars -= 5;
		                	}
		                }

		                // Remove chars for "... More"
		                showChars -= 8;
		                if (showChars < 0) {
		                	showChars = 0;
		                }
		            }

	                // Remove canvas
	                canvas.remove();

	                // Save in cache
	                shortenCache[key] = showChars;
	                body.data('shortenCache', shortenCache);
                } else {
                	showChars = cachedValue;
                }
            } else {
            	var tooMuchNewLineIndex = getOccurrenceIndex(content.substring(0, config.showChars), "<br", config.rowsCount - 1);
            	if (tooMuchNewLineIndex >= 0) {
            		// There are too much new lines, let's cut it
            		showChars = Math.max(0, tooMuchNewLineIndex);
            	} else {
            		showChars = config.showChars;
            	}
            }

            if (contentlen > showChars) {
                var c = content.substr(0, showChars);
                if (c.indexOf('<') >= 0) // If there's HTML don't want to cut it
                {
                    var inTag = false; // I'm in a tag?
                    var bag = ''; // Put the characters to be shown here
                    var countChars = 0; // Current bag size
                    var openTags = []; // Stack for opened tags, so I can close them later
                    var tagName = null;

                    for (var i = 0, r = 0; r <= showChars; i++) {
                        if (content[i] == '<' && !inTag) {
                            inTag = true;

                            // This could be "tag" or "/tag"
                            tagName = content.substring(i + 1, content.indexOf('>', i));

                            // If its a closing tag
                            if (tagName[0] == '/') {


                                if (tagName != '/' + openTags[0]) {
                                    config.errMsg = 'ERROR en HTML: the top of the stack should be the tag that closes';
                                } else {
                                    openTags.shift(); // Pops the last tag from the open tag stack (the tag is closed in the retult HTML!)
                                }

                            } else {
                                // There are some nasty tags that don't have a close tag like <br/>
                                if (tagName.toLowerCase() != 'br') {
                                    openTags.unshift(tagName); // Add to start the name of the tag that opens
                                }
                            }
                        }
                        if (inTag && content[i] == '>') {
                            inTag = false;
                        }

                        if (inTag) { bag += content.charAt(i); } // Add tag name chars to the result
                        else {
                            r++;
                            if (countChars <= showChars) {
                                bag += content.charAt(i); // Fix to ie 7 not allowing you to reference string characters using the []
                                countChars++;
                            } else // Now I have the characters needed
                            {
                                if (openTags.length > 0) // I have unclosed tags
                                {
                                    //console.log('They were open tags');
                                    //console.log(openTags);
                                    for (j = 0; j < openTags.length; j++) {
                                        //console.log('Cierro tag ' + openTags[j]);
                                        bag += '</' + openTags[j] + '>'; // Close all tags that were opened

                                        // You could shift the tag from the stack to check if you end with an empty stack, that means you have closed all open tags
                                    }
                                    break;
                                }
                            }
                        }
                    }
                    c = $('<div/>').html(bag + '<span class="ellip">' + config.ellipsesText + '</span>').html();
                }else{
                    c+=config.ellipsesText;
                }

                var html = '<span class="shortcontent">' + c +
                    '</span><span class="allcontent">' + content +
                    '</span><span>&nbsp;<a href="javascript://nop/" class="morelink">' + config.moreText + '</a></span>';

                $this.html(html);
                $this.find(".allcontent").hide(); // Hide all text
                $('.shortcontent p:last', $this).css('margin-bottom', 0); //Remove bottom margin on last paragraph as it's likely shortened
            }
        });

    };

})(jQuery);
/** javascripts/ui-controls/selectizejs/selectize.js **/
/*! selectize.js - v0.12.1 | https://github.com/brianreavis/selectize.js | Apache License (v2) */
!function(a,b){"function"==typeof define&&define.amd?define("sifter",b):"object"==typeof exports?module.exports=b():a.Sifter=b()}(this,function(){var a=function(a,b){this.items=a,this.settings=b||{diacritics:!0}};a.prototype.tokenize=function(a){if(a=d(String(a||"").toLowerCase()),!a||!a.length)return[];var b,c,f,h,i=[],j=a.split(/ +/);for(b=0,c=j.length;c>b;b++){if(f=e(j[b]),this.settings.diacritics)for(h in g)g.hasOwnProperty(h)&&(f=f.replace(new RegExp(h,"g"),g[h]));i.push({string:j[b],regex:new RegExp(f,"i")})}return i},a.prototype.iterator=function(a,b){var c;c=f(a)?Array.prototype.forEach||function(a){for(var b=0,c=this.length;c>b;b++)a(this[b],b,this)}:function(a){for(var b in this)this.hasOwnProperty(b)&&a(this[b],b,this)},c.apply(a,[b])},a.prototype.getScoreFunction=function(a,b){var c,d,e,f;c=this,a=c.prepareSearch(a,b),e=a.tokens,d=a.options.fields,f=e.length;var g=function(a,b){var c,d;return a?(a=String(a||""),d=a.search(b.regex),-1===d?0:(c=b.string.length/a.length,0===d&&(c+=.5),c)):0},h=function(){var a=d.length;return a?1===a?function(a,b){return g(b[d[0]],a)}:function(b,c){for(var e=0,f=0;a>e;e++)f+=g(c[d[e]],b);return f/a}:function(){return 0}}();return f?1===f?function(a){return h(e[0],a)}:"and"===a.options.conjunction?function(a){for(var b,c=0,d=0;f>c;c++){if(b=h(e[c],a),0>=b)return 0;d+=b}return d/f}:function(a){for(var b=0,c=0;f>b;b++)c+=h(e[b],a);return c/f}:function(){return 0}},a.prototype.getSortFunction=function(a,c){var d,e,f,g,h,i,j,k,l,m,n;if(f=this,a=f.prepareSearch(a,c),n=!a.query&&c.sort_empty||c.sort,l=function(a,b){return"$score"===a?b.score:f.items[b.id][a]},h=[],n)for(d=0,e=n.length;e>d;d++)(a.query||"$score"!==n[d].field)&&h.push(n[d]);if(a.query){for(m=!0,d=0,e=h.length;e>d;d++)if("$score"===h[d].field){m=!1;break}m&&h.unshift({field:"$score",direction:"desc"})}else for(d=0,e=h.length;e>d;d++)if("$score"===h[d].field){h.splice(d,1);break}for(k=[],d=0,e=h.length;e>d;d++)k.push("desc"===h[d].direction?-1:1);return i=h.length,i?1===i?(g=h[0].field,j=k[0],function(a,c){return j*b(l(g,a),l(g,c))}):function(a,c){var d,e,f;for(d=0;i>d;d++)if(f=h[d].field,e=k[d]*b(l(f,a),l(f,c)))return e;return 0}:null},a.prototype.prepareSearch=function(a,b){if("object"==typeof a)return a;b=c({},b);var d=b.fields,e=b.sort,g=b.sort_empty;return d&&!f(d)&&(b.fields=[d]),e&&!f(e)&&(b.sort=[e]),g&&!f(g)&&(b.sort_empty=[g]),{options:b,query:String(a||"").toLowerCase(),tokens:this.tokenize(a),total:0,items:[]}},a.prototype.search=function(a,b){var c,d,e,f,g=this;return d=this.prepareSearch(a,b),b=d.options,a=d.query,f=b.score||g.getScoreFunction(d),a.length?g.iterator(g.items,function(a,e){c=f(a),(b.filter===!1||c>0)&&d.items.push({score:c,id:e})}):g.iterator(g.items,function(a,b){d.items.push({score:1,id:b})}),e=g.getSortFunction(d,b),e&&d.items.sort(e),d.total=d.items.length,"number"==typeof b.limit&&(d.items=d.items.slice(0,b.limit)),d};var b=function(a,b){return"number"==typeof a&&"number"==typeof b?a>b?1:b>a?-1:0:(a=h(String(a||"")),b=h(String(b||"")),a>b?1:b>a?-1:0)},c=function(a){var b,c,d,e;for(b=1,c=arguments.length;c>b;b++)if(e=arguments[b])for(d in e)e.hasOwnProperty(d)&&(a[d]=e[d]);return a},d=function(a){return(a+"").replace(/^\s+|\s+$|/g,"")},e=function(a){return(a+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},f=Array.isArray||$&&$.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},g={a:"[a√Ä√Å√Ç√É√Ñ√Ö√†√°√¢√£√§√•ƒÄƒÅƒÖƒÑ]",c:"[c√á√ßƒáƒÜƒçƒå]",d:"[dƒëƒêƒèƒé]",e:"[e√à√â√ä√ã√®√©√™√´ƒõƒöƒíƒìƒôƒò]",i:"[i√å√ç√é√è√¨√≠√Æ√Øƒ™ƒ´]",l:"[l≈Ç≈Å]",n:"[n√ë√±≈à≈á≈Ñ≈É]",o:"[o√í√ì√î√ï√ï√ñ√ò√≤√≥√¥√µ√∂√∏≈å≈ç]",r:"[r≈ô≈ò]",s:"[s≈†≈°≈õ≈ö]",t:"[t≈•≈§]",u:"[u√ô√ö√õ√ú√π√∫√ª√º≈Ø≈Æ≈™≈´]",y:"[y≈∏√ø√Ω√ù]",z:"[z≈Ω≈æ≈º≈ª≈∫≈π]"},h=function(){var a,b,c,d,e="",f={};for(c in g)if(g.hasOwnProperty(c))for(d=g[c].substring(2,g[c].length-1),e+=d,a=0,b=d.length;b>a;a++)f[d.charAt(a)]=c;var h=new RegExp("["+e+"]","g");return function(a){return a.replace(h,function(a){return f[a]}).toLowerCase()}}();return a}),function(a,b){"function"==typeof define&&define.amd?define("microplugin",b):"object"==typeof exports?module.exports=b():a.MicroPlugin=b()}(this,function(){var a={};a.mixin=function(a){a.plugins={},a.prototype.initializePlugins=function(a){var c,d,e,f=this,g=[];if(f.plugins={names:[],settings:{},requested:{},loaded:{}},b.isArray(a))for(c=0,d=a.length;d>c;c++)"string"==typeof a[c]?g.push(a[c]):(f.plugins.settings[a[c].name]=a[c].options,g.push(a[c].name));else if(a)for(e in a)a.hasOwnProperty(e)&&(f.plugins.settings[e]=a[e],g.push(e));for(;g.length;)f.require(g.shift())},a.prototype.loadPlugin=function(b){var c=this,d=c.plugins,e=a.plugins[b];if(!a.plugins.hasOwnProperty(b))throw new Error('Unable to find "'+b+'" plugin');d.requested[b]=!0,d.loaded[b]=e.fn.apply(c,[c.plugins.settings[b]||{}]),d.names.push(b)},a.prototype.require=function(a){var b=this,c=b.plugins;if(!b.plugins.loaded.hasOwnProperty(a)){if(c.requested[a])throw new Error('Plugin has circular dependency ("'+a+'")');b.loadPlugin(a)}return c.loaded[a]},a.define=function(b,c){a.plugins[b]={name:b,fn:c}}};var b={isArray:Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}};return a}),function(a,b){"function"==typeof define&&define.amd?define("selectize",["jquery","sifter","microplugin"],b):"object"==typeof exports?module.exports=b(require("jquery"),require("sifter"),require("microplugin")):a.Selectize=b(a.jQuery,a.Sifter,a.MicroPlugin)}(this,function(a,b,c){"use strict";var d=function(a,b){if("string"!=typeof b||b.length){var c="string"==typeof b?new RegExp(b,"i"):b,d=function(a){var b=0;if(3===a.nodeType){var e=a.data.search(c);if(e>=0&&a.data.length>0){var f=a.data.match(c),g=document.createElement("span");g.className="highlight";var h=a.splitText(e),i=(h.splitText(f[0].length),h.cloneNode(!0));g.appendChild(i),h.parentNode.replaceChild(g,h),b=1}}else if(1===a.nodeType&&a.childNodes&&!/(script|style)/i.test(a.tagName))for(var j=0;j<a.childNodes.length;++j)j+=d(a.childNodes[j]);return b};return a.each(function(){d(this)})}},e=function(){};e.prototype={on:function(a,b){this._events=this._events||{},this._events[a]=this._events[a]||[],this._events[a].push(b)},off:function(a,b){var c=arguments.length;return 0===c?delete this._events:1===c?delete this._events[a]:(this._events=this._events||{},void(a in this._events!=!1&&this._events[a].splice(this._events[a].indexOf(b),1)))},trigger:function(a){if(this._events=this._events||{},a in this._events!=!1)for(var b=0;b<this._events[a].length;b++)this._events[a][b].apply(this,Array.prototype.slice.call(arguments,1))}},e.mixin=function(a){for(var b=["on","off","trigger"],c=0;c<b.length;c++)a.prototype[b[c]]=e.prototype[b[c]]};var f=/Mac/.test(navigator.userAgent),g=65,h=13,i=27,j=37,k=38,l=80,m=39,n=40,o=78,p=8,q=46,r=16,s=f?91:17,t=f?18:17,u=9,v=1,w=2,x=!/android/i.test(window.navigator.userAgent)&&!!document.createElement("form").validity,y=function(a){return"undefined"!=typeof a},z=function(a){return"undefined"==typeof a||null===a?null:"boolean"==typeof a?a?"1":"0":a+""},A=function(a){return(a+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},B=function(a){return(a+"").replace(/\$/g,"$$$$")},C={};C.before=function(a,b,c){var d=a[b];a[b]=function(){return c.apply(a,arguments),d.apply(a,arguments)}},C.after=function(a,b,c){var d=a[b];a[b]=function(){var b=d.apply(a,arguments);return c.apply(a,arguments),b}};var D=function(a){var b=!1;return function(){b||(b=!0,a.apply(this,arguments))}},E=function(a,b){var c;return function(){var d=this,e=arguments;window.clearTimeout(c),c=window.setTimeout(function(){a.apply(d,e)},b)}},F=function(a,b,c){var d,e=a.trigger,f={};a.trigger=function(){var c=arguments[0];return-1===b.indexOf(c)?e.apply(a,arguments):void(f[c]=arguments)},c.apply(a,[]),a.trigger=e;for(d in f)f.hasOwnProperty(d)&&e.apply(a,f[d])},G=function(a,b,c,d){a.on(b,c,function(b){for(var c=b.target;c&&c.parentNode!==a[0];)c=c.parentNode;return b.currentTarget=c,d.apply(this,[b])})},H=function(a){var b={};if("selectionStart"in a)b.start=a.selectionStart,b.length=a.selectionEnd-b.start;else if(document.selection){a.focus();var c=document.selection.createRange(),d=document.selection.createRange().text.length;c.moveStart("character",-a.value.length),b.start=c.text.length-d,b.length=d}return b},I=function(a,b,c){var d,e,f={};if(c)for(d=0,e=c.length;e>d;d++)f[c[d]]=a.css(c[d]);else f=a.css();b.css(f)},J=function(b,c){if(!b)return 0;var d=a("<test>").css({position:"absolute",top:-99999,left:-99999,width:"auto",padding:0,whiteSpace:"pre"}).text(b).appendTo("body");I(c,d,["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"]);var e=d.width();return d.remove(),e},K=function(a){var b=null,c=function(c,d){var e,f,g,h,i,j,k,l;c=c||window.event||{},d=d||{},c.metaKey||c.altKey||(d.force||a.data("grow")!==!1)&&(e=a.val(),c.type&&"keydown"===c.type.toLowerCase()&&(f=c.keyCode,g=f>=97&&122>=f||f>=65&&90>=f||f>=48&&57>=f||32===f,f===q||f===p?(l=H(a[0]),l.length?e=e.substring(0,l.start)+e.substring(l.start+l.length):f===p&&l.start?e=e.substring(0,l.start-1)+e.substring(l.start+1):f===q&&"undefined"!=typeof l.start&&(e=e.substring(0,l.start)+e.substring(l.start+1))):g&&(j=c.shiftKey,k=String.fromCharCode(c.keyCode),k=j?k.toUpperCase():k.toLowerCase(),e+=k)),h=a.attr("placeholder"),!e&&h&&(e=h),i=J(e,a)+4,i!==b&&(b=i,a.width(i),a.triggerHandler("resize")))};a.on("keydown keyup update blur",c),c()},L=function(c,d){var e,f,g,h,i=this;h=c[0],h.selectize=i;var j=window.getComputedStyle&&window.getComputedStyle(h,null);if(g=j?j.getPropertyValue("direction"):h.currentStyle&&h.currentStyle.direction,g=g||c.parents("[dir]:first").attr("dir")||"",a.extend(i,{order:0,settings:d,$input:c,tabIndex:c.attr("tabindex")||"",tagType:"select"===h.tagName.toLowerCase()?v:w,rtl:/rtl/i.test(g),eventNS:".selectize"+ ++L.count,highlightedValue:null,isOpen:!1,isDisabled:!1,isRequired:c.is("[required]"),isInvalid:!1,isLocked:!1,isFocused:!1,isInputHidden:!1,isSetup:!1,isShiftDown:!1,isCmdDown:!1,isCtrlDown:!1,ignoreFocus:!1,ignoreBlur:!1,ignoreHover:!1,hasOptions:!1,currentResults:null,lastValue:"",caretPos:0,loading:0,loadedSearches:{},$activeOption:null,$activeItems:[],optgroups:{},options:{},userOptions:{},items:[],renderCache:{},onSearchChange:null===d.loadThrottle?i.onSearchChange:E(i.onSearchChange,d.loadThrottle)}),i.sifter=new b(this.options,{diacritics:d.diacritics}),i.settings.options){for(e=0,f=i.settings.options.length;f>e;e++)i.registerOption(i.settings.options[e]);delete i.settings.options}if(i.settings.optgroups){for(e=0,f=i.settings.optgroups.length;f>e;e++)i.registerOptionGroup(i.settings.optgroups[e]);delete i.settings.optgroups}i.settings.mode=i.settings.mode||(1===i.settings.maxItems?"single":"multi"),"boolean"!=typeof i.settings.hideSelected&&(i.settings.hideSelected="multi"===i.settings.mode),i.initializePlugins(i.settings.plugins),i.setupCallbacks(),i.setupTemplates(),i.setup()};return e.mixin(L),c.mixin(L),a.extend(L.prototype,{setup:function(){var b,c,d,e,g,h,i,j,k,l=this,m=l.settings,n=l.eventNS,o=a(window),p=a(document),q=l.$input;if(i=l.settings.mode,j=q.attr("class")||"",b=a("<div>").addClass(m.wrapperClass).addClass(j).addClass(i),c=a("<div>").addClass(m.inputClass).addClass("items").appendTo(b),d=a('<input type="text" autocomplete="off" />').appendTo(c).attr("tabindex",q.is(":disabled")?"-1":l.tabIndex),h=a(m.dropdownParent||b),e=a("<div>").addClass(m.dropdownClass).addClass(i).hide().appendTo(h),g=a("<div>").addClass(m.dropdownContentClass).appendTo(e),l.settings.copyClassesToDropdown&&e.addClass(j),b.css({width:q[0].style.width}),l.plugins.names.length&&(k="plugin-"+l.plugins.names.join(" plugin-"),b.addClass(k),e.addClass(k)),(null===m.maxItems||m.maxItems>1)&&l.tagType===v&&q.attr("multiple","multiple"),l.settings.placeholder&&d.attr("placeholder",m.placeholder),!l.settings.splitOn&&l.settings.delimiter){var u=l.settings.delimiter.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");l.settings.splitOn=new RegExp("\\s*"+u+"+\\s*")}q.attr("autocorrect")&&d.attr("autocorrect",q.attr("autocorrect")),q.attr("autocapitalize")&&d.attr("autocapitalize",q.attr("autocapitalize")),l.$wrapper=b,l.$control=c,l.$control_input=d,l.$dropdown=e,l.$dropdown_content=g,e.on("mouseenter","[data-selectable]",function(){return l.onOptionHover.apply(l,arguments)}),e.on("mousedown click","[data-selectable]",function(){return l.onOptionSelect.apply(l,arguments)}),G(c,"mousedown","*:not(input)",function(){return l.onItemSelect.apply(l,arguments)}),K(d),c.on({mousedown:function(){return l.onMouseDown.apply(l,arguments)},click:function(){return l.onClick.apply(l,arguments)}}),d.on({mousedown:function(a){a.stopPropagation()},keydown:function(){return l.onKeyDown.apply(l,arguments)},keyup:function(){return l.onKeyUp.apply(l,arguments)},keypress:function(){return l.onKeyPress.apply(l,arguments)},resize:function(){l.positionDropdown.apply(l,[])},blur:function(){return l.onBlur.apply(l,arguments)},focus:function(){return l.ignoreBlur=!1,l.onFocus.apply(l,arguments)},paste:function(){return l.onPaste.apply(l,arguments)}}),p.on("keydown"+n,function(a){l.isCmdDown=a[f?"metaKey":"ctrlKey"],l.isCtrlDown=a[f?"altKey":"ctrlKey"],l.isShiftDown=a.shiftKey}),p.on("keyup"+n,function(a){a.keyCode===t&&(l.isCtrlDown=!1),a.keyCode===r&&(l.isShiftDown=!1),a.keyCode===s&&(l.isCmdDown=!1)}),p.on("mousedown"+n,function(a){if(l.isFocused){if(a.target===l.$dropdown[0]||a.target.parentNode===l.$dropdown[0])return!1;l.$control.has(a.target).length||a.target===l.$control[0]||l.blur(a.target)}}),o.on(["scroll"+n,"resize"+n].join(" "),function(){l.isOpen&&l.positionDropdown.apply(l,arguments)}),o.on("mousemove"+n,function(){l.ignoreHover=!1}),this.revertSettings={$children:q.children().detach(),tabindex:q.attr("tabindex")},q.attr("tabindex",-1).hide().after(l.$wrapper),a.isArray(m.items)&&(l.setValue(m.items),delete m.items),x&&q.on("invalid"+n,function(a){a.preventDefault(),l.isInvalid=!0,l.refreshState()}),l.updateOriginalInput(),l.refreshItems(),l.refreshState(),l.updatePlaceholder(),l.isSetup=!0,q.is(":disabled")&&l.disable(),l.on("change",this.onChange),q.data("selectize",l),q.addClass("selectized"),l.trigger("initialize"),m.preload===!0&&l.onSearchChange("")},setupTemplates:function(){var b=this,c=b.settings.labelField,d=b.settings.optgroupLabelField,e={optgroup:function(a){return'<div class="optgroup">'+a.html+"</div>"},optgroup_header:function(a,b){return'<div class="optgroup-header">'+b(a[d])+"</div>"},option:function(a,b){return'<div class="option">'+b(a[c])+"</div>"},item:function(a,b){return'<div class="item">'+b(a[c])+"</div>"},option_create:function(a,b){return'<div class="create">Add <strong>'+b(a.input)+"</strong>&hellip;</div>"}};b.settings.render=a.extend({},e,b.settings.render)},setupCallbacks:function(){var a,b,c={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(a in c)c.hasOwnProperty(a)&&(b=this.settings[c[a]],b&&this.on(a,b))},onClick:function(a){var b=this;b.isFocused||(b.focus(),a.preventDefault())},onMouseDown:function(b){{var c=this,d=b.isDefaultPrevented();a(b.target)}if(c.isFocused){if(b.target!==c.$control_input[0])return"single"===c.settings.mode?c.isOpen?c.close():c.open():d||c.setActiveItem(null),!1}else d||window.setTimeout(function(){c.focus()},0)},onChange:function(){this.$input.trigger("change")},onPaste:function(b){var c=this;c.isFull()||c.isInputHidden||c.isLocked?b.preventDefault():c.settings.splitOn&&setTimeout(function(){for(var b=a.trim(c.$control_input.val()||"").split(c.settings.splitOn),d=0,e=b.length;e>d;d++)c.createItem(b[d])},0)},onKeyPress:function(a){if(this.isLocked)return a&&a.preventDefault();var b=String.fromCharCode(a.keyCode||a.which);return this.settings.create&&"multi"===this.settings.mode&&b===this.settings.delimiter?(this.createItem(),a.preventDefault(),!1):void 0},onKeyDown:function(a){var b=(a.target===this.$control_input[0],this);if(b.isLocked)return void(a.keyCode!==u&&a.preventDefault());switch(a.keyCode){case g:if(b.isCmdDown)return void b.selectAll();break;case i:return void(b.isOpen&&(a.preventDefault(),a.stopPropagation(),b.close()));case o:if(!a.ctrlKey||a.altKey)break;case n:if(!b.isOpen&&b.hasOptions)b.open();else if(b.$activeOption){b.ignoreHover=!0;var c=b.getAdjacentOption(b.$activeOption,1);c.length&&b.setActiveOption(c,!0,!0)}return void a.preventDefault();case l:if(!a.ctrlKey||a.altKey)break;case k:if(b.$activeOption){b.ignoreHover=!0;var d=b.getAdjacentOption(b.$activeOption,-1);d.length&&b.setActiveOption(d,!0,!0)}return void a.preventDefault();case h:return void(b.isOpen&&b.$activeOption&&(b.onOptionSelect({currentTarget:b.$activeOption}),a.preventDefault()));case j:return void b.advanceSelection(-1,a);case m:return void b.advanceSelection(1,a);case u:return b.settings.selectOnTab&&b.isOpen&&b.$activeOption&&(b.onOptionSelect({currentTarget:b.$activeOption}),b.isFull()||a.preventDefault()),void(b.settings.create&&b.createItem()&&a.preventDefault());case p:case q:return void b.deleteSelection(a)}return!b.isFull()&&!b.isInputHidden||(f?a.metaKey:a.ctrlKey)?void 0:void a.preventDefault()},onKeyUp:function(a){var b=this;if(b.isLocked)return a&&a.preventDefault();var c=b.$control_input.val()||"";b.lastValue!==c&&(b.lastValue=c,b.onSearchChange(c),b.refreshOptions(),b.trigger("type",c))},onSearchChange:function(a){var b=this,c=b.settings.load;c&&(b.loadedSearches.hasOwnProperty(a)||(b.loadedSearches[a]=!0,b.load(function(d){c.apply(b,[a,d])})))},onFocus:function(a){var b=this,c=b.isFocused;return b.isDisabled?(b.blur(),a&&a.preventDefault(),!1):void(b.ignoreFocus||(b.isFocused=!0,"focus"===b.settings.preload&&b.onSearchChange(""),c||b.trigger("focus"),b.$activeItems.length||(b.showInput(),b.setActiveItem(null),b.refreshOptions(!!b.settings.openOnFocus)),b.refreshState()))},onBlur:function(a,b){var c=this;if(c.isFocused&&(c.isFocused=!1,!c.ignoreFocus)){if(!c.ignoreBlur&&document.activeElement===c.$dropdown_content[0])return c.ignoreBlur=!0,void c.onFocus(a);var d=function(){c.close(),c.setTextboxValue(""),c.setActiveItem(null),c.setActiveOption(null),c.setCaret(c.items.length),c.refreshState(),(b||document.body).focus(),c.ignoreFocus=!1,c.trigger("blur")};c.ignoreFocus=!0,c.settings.create&&c.settings.createOnBlur?c.createItem(null,!1,d):d()}},onOptionHover:function(a){this.ignoreHover||this.setActiveOption(a.currentTarget,!1)},onOptionSelect:function(b){var c,d,e=this;b.preventDefault&&(b.preventDefault(),b.stopPropagation()),d=a(b.currentTarget),d.hasClass("create")?e.createItem(null,function(){e.settings.closeAfterSelect&&e.close()}):(c=d.attr("data-value"),"undefined"!=typeof c&&(e.lastQuery=null,e.setTextboxValue(""),e.addItem(c),e.settings.closeAfterSelect?e.close():!e.settings.hideSelected&&b.type&&/mouse/.test(b.type)&&e.setActiveOption(e.getOption(c))))},onItemSelect:function(a){var b=this;b.isLocked||"multi"===b.settings.mode&&(a.preventDefault(),b.setActiveItem(a.currentTarget,a))},load:function(a){var b=this,c=b.$wrapper.addClass(b.settings.loadingClass);b.loading++,a.apply(b,[function(a){b.loading=Math.max(b.loading-1,0),a&&a.length&&(b.addOption(a),b.refreshOptions(b.isFocused&&!b.isInputHidden)),b.loading||c.removeClass(b.settings.loadingClass),b.trigger("load",a)}])},setTextboxValue:function(a){var b=this.$control_input,c=b.val()!==a;c&&(b.val(a).triggerHandler("update"),this.lastValue=a)},getValue:function(){return this.tagType===v&&this.$input.attr("multiple")?this.items:this.items.join(this.settings.delimiter)},setValue:function(a,b){var c=b?[]:["change"];F(this,c,function(){this.clear(b),this.addItems(a,b)})},setActiveItem:function(b,c){var d,e,f,g,h,i,j,k,l=this;if("single"!==l.settings.mode){if(b=a(b),!b.length)return a(l.$activeItems).removeClass("active"),l.$activeItems=[],void(l.isFocused&&l.showInput());if(d=c&&c.type.toLowerCase(),"mousedown"===d&&l.isShiftDown&&l.$activeItems.length){for(k=l.$control.children(".active:last"),g=Array.prototype.indexOf.apply(l.$control[0].childNodes,[k[0]]),h=Array.prototype.indexOf.apply(l.$control[0].childNodes,[b[0]]),g>h&&(j=g,g=h,h=j),e=g;h>=e;e++)i=l.$control[0].childNodes[e],-1===l.$activeItems.indexOf(i)&&(a(i).addClass("active"),l.$activeItems.push(i));c.preventDefault()}else"mousedown"===d&&l.isCtrlDown||"keydown"===d&&this.isShiftDown?b.hasClass("active")?(f=l.$activeItems.indexOf(b[0]),l.$activeItems.splice(f,1),b.removeClass("active")):l.$activeItems.push(b.addClass("active")[0]):(a(l.$activeItems).removeClass("active"),l.$activeItems=[b.addClass("active")[0]]);l.hideInput(),this.isFocused||l.focus()}},setActiveOption:function(b,c,d){var e,f,g,h,i,j=this;j.$activeOption&&j.$activeOption.removeClass("active"),j.$activeOption=null,b=a(b),b.length&&(j.$activeOption=b.addClass("active"),(c||!y(c))&&(e=j.$dropdown_content.height(),f=j.$activeOption.outerHeight(!0),c=j.$dropdown_content.scrollTop()||0,g=j.$activeOption.offset().top-j.$dropdown_content.offset().top+c,h=g,i=g-e+f,g+f>e+c?j.$dropdown_content.stop().animate({scrollTop:i},d?j.settings.scrollDuration:0):c>g&&j.$dropdown_content.stop().animate({scrollTop:h},d?j.settings.scrollDuration:0)))},selectAll:function(){var a=this;"single"!==a.settings.mode&&(a.$activeItems=Array.prototype.slice.apply(a.$control.children(":not(input)").addClass("active")),a.$activeItems.length&&(a.hideInput(),a.close()),a.focus())},hideInput:function(){var a=this;a.setTextboxValue(""),a.$control_input.css({opacity:0,position:"absolute",left:a.rtl?1e4:-1e4}),a.isInputHidden=!0},showInput:function(){this.$control_input.css({opacity:1,position:"relative",left:0}),this.isInputHidden=!1},focus:function(){var a=this;a.isDisabled||(a.ignoreFocus=!0,a.$control_input[0].focus(),window.setTimeout(function(){a.ignoreFocus=!1,a.onFocus()},0))},blur:function(a){this.$control_input[0].blur(),this.onBlur(null,a)},getScoreFunction:function(a){return this.sifter.getScoreFunction(a,this.getSearchOptions())},getSearchOptions:function(){var a=this.settings,b=a.sortField;return"string"==typeof b&&(b=[{field:b}]),{fields:a.searchField,conjunction:a.searchConjunction,sort:b}},search:function(b){var c,d,e,f=this,g=f.settings,h=this.getSearchOptions();if(g.score&&(e=f.settings.score.apply(this,[b]),"function"!=typeof e))throw new Error('Selectize "score" setting must be a function that returns a function');if(b!==f.lastQuery?(f.lastQuery=b,d=f.sifter.search(b,a.extend(h,{score:e})),f.currentResults=d):d=a.extend(!0,{},f.currentResults),g.hideSelected)for(c=d.items.length-1;c>=0;c--)-1!==f.items.indexOf(z(d.items[c].id))&&d.items.splice(c,1);return d},refreshOptions:function(b){var c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;"undefined"==typeof b&&(b=!0);var t=this,u=a.trim(t.$control_input.val()),v=t.search(u),w=t.$dropdown_content,x=t.$activeOption&&z(t.$activeOption.attr("data-value"));for(g=v.items.length,"number"==typeof t.settings.maxOptions&&(g=Math.min(g,t.settings.maxOptions)),h={},i=[],c=0;g>c;c++)for(j=t.options[v.items[c].id],k=t.render("option",j),l=j[t.settings.optgroupField]||"",m=a.isArray(l)?l:[l],e=0,f=m&&m.length;f>e;e++)l=m[e],t.optgroups.hasOwnProperty(l)||(l=""),h.hasOwnProperty(l)||(h[l]=[],i.push(l)),h[l].push(k);for(this.settings.lockOptgroupOrder&&i.sort(function(a,b){var c=t.optgroups[a].$order||0,d=t.optgroups[b].$order||0;return c-d}),n=[],c=0,g=i.length;g>c;c++)l=i[c],t.optgroups.hasOwnProperty(l)&&h[l].length?(o=t.render("optgroup_header",t.optgroups[l])||"",o+=h[l].join(""),n.push(t.render("optgroup",a.extend({},t.optgroups[l],{html:o})))):n.push(h[l].join(""));if(w.html(n.join("")),t.settings.highlight&&v.query.length&&v.tokens.length)for(c=0,g=v.tokens.length;g>c;c++)d(w,v.tokens[c].regex);if(!t.settings.hideSelected)for(c=0,g=t.items.length;g>c;c++)t.getOption(t.items[c]).addClass("selected");p=t.canCreate(u),p&&(w.prepend(t.render("option_create",{input:u})),s=a(w[0].childNodes[0])),t.hasOptions=v.items.length>0||p,t.hasOptions?(v.items.length>0?(r=x&&t.getOption(x),r&&r.length?q=r:"single"===t.settings.mode&&t.items.length&&(q=t.getOption(t.items[0])),q&&q.length||(q=s&&!t.settings.addPrecedence?t.getAdjacentOption(s,1):w.find("[data-selectable]:first"))):q=s,t.setActiveOption(q),b&&!t.isOpen&&t.open()):(t.setActiveOption(null),b&&t.isOpen&&t.close())},addOption:function(b){var c,d,e,f=this;if(a.isArray(b))for(c=0,d=b.length;d>c;c++)f.addOption(b[c]);else(e=f.registerOption(b))&&(f.userOptions[e]=!0,f.lastQuery=null,f.trigger("option_add",e,b))},registerOption:function(a){var b=z(a[this.settings.valueField]);return!b||this.options.hasOwnProperty(b)?!1:(a.$order=a.$order||++this.order,this.options[b]=a,b)},registerOptionGroup:function(a){var b=z(a[this.settings.optgroupValueField]);return b?(a.$order=a.$order||++this.order,this.optgroups[b]=a,b):!1},addOptionGroup:function(a,b){b[this.settings.optgroupValueField]=a,(a=this.registerOptionGroup(b))&&this.trigger("optgroup_add",a,b)},removeOptionGroup:function(a){this.optgroups.hasOwnProperty(a)&&(delete this.optgroups[a],this.renderCache={},this.trigger("optgroup_remove",a))},clearOptionGroups:function(){this.optgroups={},this.renderCache={},this.trigger("optgroup_clear")},updateOption:function(b,c){var d,e,f,g,h,i,j,k=this;if(b=z(b),f=z(c[k.settings.valueField]),null!==b&&k.options.hasOwnProperty(b)){if("string"!=typeof f)throw new Error("Value must be set in option data");j=k.options[b].$order,f!==b&&(delete k.options[b],g=k.items.indexOf(b),-1!==g&&k.items.splice(g,1,f)),c.$order=c.$order||j,k.options[f]=c,h=k.renderCache.item,i=k.renderCache.option,h&&(delete h[b],delete h[f]),i&&(delete i[b],delete i[f]),-1!==k.items.indexOf(f)&&(d=k.getItem(b),e=a(k.render("item",c)),d.hasClass("active")&&e.addClass("active"),d.replaceWith(e)),k.lastQuery=null,k.isOpen&&k.refreshOptions(!1)}},removeOption:function(a,b){var c=this;a=z(a);var d=c.renderCache.item,e=c.renderCache.option;d&&delete d[a],e&&delete e[a],delete c.userOptions[a],delete c.options[a],c.lastQuery=null,c.trigger("option_remove",a),c.removeItem(a,b)},clearOptions:function(){var a=this;a.loadedSearches={},a.userOptions={},a.renderCache={},a.options=a.sifter.items={},a.lastQuery=null,a.trigger("option_clear"),a.clear()},getOption:function(a){return this.getElementWithValue(a,this.$dropdown_content.find("[data-selectable]"))},getAdjacentOption:function(b,c){var d=this.$dropdown.find("[data-selectable]"),e=d.index(b)+c;return e>=0&&e<d.length?d.eq(e):a()},getElementWithValue:function(b,c){if(b=z(b),"undefined"!=typeof b&&null!==b)for(var d=0,e=c.length;e>d;d++)if(c[d].getAttribute("data-value")===b)return a(c[d]);return a()},getItem:function(a){return this.getElementWithValue(a,this.$control.children())},addItems:function(b,c){for(var d=a.isArray(b)?b:[b],e=0,f=d.length;f>e;e++)this.isPending=f-1>e,this.addItem(d[e],c)},addItem:function(b,c){var d=c?[]:["change"];F(this,d,function(){var d,e,f,g,h,i=this,j=i.settings.mode;return b=z(b),-1!==i.items.indexOf(b)?void("single"===j&&i.close()):void(i.options.hasOwnProperty(b)&&("single"===j&&i.clear(c),"multi"===j&&i.isFull()||(d=a(i.render("item",i.options[b])),h=i.isFull(),i.items.splice(i.caretPos,0,b),i.insertAtCaret(d),(!i.isPending||!h&&i.isFull())&&i.refreshState(),i.isSetup&&(f=i.$dropdown_content.find("[data-selectable]"),i.isPending||(e=i.getOption(b),g=i.getAdjacentOption(e,1).attr("data-value"),i.refreshOptions(i.isFocused&&"single"!==j),g&&i.setActiveOption(i.getOption(g))),!f.length||i.isFull()?i.close():i.positionDropdown(),i.updatePlaceholder(),i.trigger("item_add",b,d),i.updateOriginalInput({silent:c})))))})},removeItem:function(a,b){var c,d,e,f=this;c="object"==typeof a?a:f.getItem(a),a=z(c.attr("data-value")),d=f.items.indexOf(a),-1!==d&&(c.remove(),c.hasClass("active")&&(e=f.$activeItems.indexOf(c[0]),f.$activeItems.splice(e,1)),f.items.splice(d,1),f.lastQuery=null,!f.settings.persist&&f.userOptions.hasOwnProperty(a)&&f.removeOption(a,b),d<f.caretPos&&f.setCaret(f.caretPos-1),f.refreshState(),f.updatePlaceholder(),f.updateOriginalInput({silent:b}),f.positionDropdown(),f.trigger("item_remove",a,c))},createItem:function(b,c){var d=this,e=d.caretPos;b=b||a.trim(d.$control_input.val()||"");var f=arguments[arguments.length-1];if("function"!=typeof f&&(f=function(){}),"boolean"!=typeof c&&(c=!0),!d.canCreate(b))return f(),!1;d.lock();var g="function"==typeof d.settings.create?this.settings.create:function(a){var b={};return b[d.settings.labelField]=a,b[d.settings.valueField]=a,b},h=D(function(a){if(d.unlock(),!a||"object"!=typeof a)return f();var b=z(a[d.settings.valueField]);return"string"!=typeof b?f():(d.setTextboxValue(""),d.addOption(a),d.setCaret(e),d.addItem(b),d.refreshOptions(c&&"single"!==d.settings.mode),void f(a))}),i=g.apply(this,[b,h]);return"undefined"!=typeof i&&h(i),!0},refreshItems:function(){this.lastQuery=null,this.isSetup&&this.addItem(this.items),this.refreshState(),this.updateOriginalInput()},refreshState:function(){var a,b=this;b.isRequired&&(b.items.length&&(b.isInvalid=!1),b.$control_input.prop("required",a)),b.refreshClasses()},refreshClasses:function(){var b=this,c=b.isFull(),d=b.isLocked;b.$wrapper.toggleClass("rtl",b.rtl),b.$control.toggleClass("focus",b.isFocused).toggleClass("disabled",b.isDisabled).toggleClass("required",b.isRequired).toggleClass("invalid",b.isInvalid).toggleClass("locked",d).toggleClass("full",c).toggleClass("not-full",!c).toggleClass("input-active",b.isFocused&&!b.isInputHidden).toggleClass("dropdown-active",b.isOpen).toggleClass("has-options",!a.isEmptyObject(b.options)).toggleClass("has-items",b.items.length>0),b.$control_input.data("grow",!c&&!d)},isFull:function(){return null!==this.settings.maxItems&&this.items.length>=this.settings.maxItems},updateOriginalInput:function(a){var b,c,d,e,f=this;if(a=a||{},f.tagType===v){for(d=[],b=0,c=f.items.length;c>b;b++)e=f.options[f.items[b]][f.settings.labelField]||"",d.push('<option value="'+A(f.items[b])+'" selected="selected">'+A(e)+"</option>");d.length||this.$input.attr("multiple")||d.push('<option value="" selected="selected"></option>'),f.$input.html(d.join(""))}else f.$input.val(f.getValue()),f.$input.attr("value",f.$input.val());f.isSetup&&(a.silent||f.trigger("change",f.$input.val()))},updatePlaceholder:function(){if(this.settings.placeholder){var a=this.$control_input;this.items.length?a.removeAttr("placeholder"):a.attr("placeholder",this.settings.placeholder),a.triggerHandler("update",{force:!0})}},open:function(){var a=this;a.isLocked||a.isOpen||"multi"===a.settings.mode&&a.isFull()||(a.focus(),a.isOpen=!0,a.refreshState(),a.$dropdown.css({visibility:"hidden",display:"block"}),a.positionDropdown(),a.$dropdown.css({visibility:"visible"}),a.trigger("dropdown_open",a.$dropdown))},close:function(){var a=this,b=a.isOpen;"single"===a.settings.mode&&a.items.length&&a.hideInput(),a.isOpen=!1,a.$dropdown.hide(),a.setActiveOption(null),a.refreshState(),b&&a.trigger("dropdown_close",a.$dropdown)},positionDropdown:function(){var a=this.$control,b="body"===this.settings.dropdownParent?a.offset():a.position();b.top+=a.outerHeight(!0),this.$dropdown.css({width:a.outerWidth(),top:b.top,left:b.left})},clear:function(a){var b=this;b.items.length&&(b.$control.children(":not(input)").remove(),b.items=[],b.lastQuery=null,b.setCaret(0),b.setActiveItem(null),b.updatePlaceholder(),b.updateOriginalInput({silent:a}),b.refreshState(),b.showInput(),b.trigger("clear"))},insertAtCaret:function(b){var c=Math.min(this.caretPos,this.items.length);0===c?this.$control.prepend(b):a(this.$control[0].childNodes[c]).before(b),this.setCaret(c+1)},deleteSelection:function(b){var c,d,e,f,g,h,i,j,k,l=this;if(e=b&&b.keyCode===p?-1:1,f=H(l.$control_input[0]),l.$activeOption&&!l.settings.hideSelected&&(i=l.getAdjacentOption(l.$activeOption,-1).attr("data-value")),g=[],l.$activeItems.length){for(k=l.$control.children(".active:"+(e>0?"last":"first")),h=l.$control.children(":not(input)").index(k),e>0&&h++,c=0,d=l.$activeItems.length;d>c;c++)g.push(a(l.$activeItems[c]).attr("data-value"));
b&&(b.preventDefault(),b.stopPropagation())}else(l.isFocused||"single"===l.settings.mode)&&l.items.length&&(0>e&&0===f.start&&0===f.length?g.push(l.items[l.caretPos-1]):e>0&&f.start===l.$control_input.val().length&&g.push(l.items[l.caretPos]));if(!g.length||"function"==typeof l.settings.onDelete&&l.settings.onDelete.apply(l,[g])===!1)return!1;for("undefined"!=typeof h&&l.setCaret(h);g.length;)l.removeItem(g.pop());return l.showInput(),l.positionDropdown(),l.refreshOptions(!0),i&&(j=l.getOption(i),j.length&&l.setActiveOption(j)),!0},advanceSelection:function(a,b){var c,d,e,f,g,h,i=this;0!==a&&(i.rtl&&(a*=-1),c=a>0?"last":"first",d=H(i.$control_input[0]),i.isFocused&&!i.isInputHidden?(f=i.$control_input.val().length,g=0>a?0===d.start&&0===d.length:d.start===f,g&&!f&&i.advanceCaret(a,b)):(h=i.$control.children(".active:"+c),h.length&&(e=i.$control.children(":not(input)").index(h),i.setActiveItem(null),i.setCaret(a>0?e+1:e))))},advanceCaret:function(a,b){var c,d,e=this;0!==a&&(c=a>0?"next":"prev",e.isShiftDown?(d=e.$control_input[c](),d.length&&(e.hideInput(),e.setActiveItem(d),b&&b.preventDefault())):e.setCaret(e.caretPos+a))},setCaret:function(b){var c=this;if(b="single"===c.settings.mode?c.items.length:Math.max(0,Math.min(c.items.length,b)),!c.isPending){var d,e,f,g;for(f=c.$control.children(":not(input)"),d=0,e=f.length;e>d;d++)g=a(f[d]).detach(),b>d?c.$control_input.before(g):c.$control.append(g)}c.caretPos=b},lock:function(){this.close(),this.isLocked=!0,this.refreshState()},unlock:function(){this.isLocked=!1,this.refreshState()},disable:function(){var a=this;a.$input.prop("disabled",!0),a.$control_input.prop("disabled",!0).prop("tabindex",-1),a.isDisabled=!0,a.lock()},enable:function(){var a=this;a.$input.prop("disabled",!1),a.$control_input.prop("disabled",!1).prop("tabindex",a.tabIndex),a.isDisabled=!1,a.unlock()},destroy:function(){var b=this,c=b.eventNS,d=b.revertSettings;b.trigger("destroy"),b.off(),b.$wrapper.remove(),b.$dropdown.remove(),b.$input.html("").append(d.$children).removeAttr("tabindex").removeClass("selectized").attr({tabindex:d.tabindex}).show(),b.$control_input.removeData("grow"),b.$input.removeData("selectize"),a(window).off(c),a(document).off(c),a(document.body).off(c),delete b.$input[0].selectize},render:function(a,b){var c,d,e="",f=!1,g=this,h=/^[\t \r\n]*<([a-z][a-z0-9\-_]*(?:\:[a-z][a-z0-9\-_]*)?)/i;return("option"===a||"item"===a)&&(c=z(b[g.settings.valueField]),f=!!c),f&&(y(g.renderCache[a])||(g.renderCache[a]={}),g.renderCache[a].hasOwnProperty(c))?g.renderCache[a][c]:(e=g.settings.render[a].apply(this,[b,A]),("option"===a||"option_create"===a)&&(e=e.replace(h,"<$1 data-selectable")),"optgroup"===a&&(d=b[g.settings.optgroupValueField]||"",e=e.replace(h,'<$1 data-group="'+B(A(d))+'"')),("option"===a||"item"===a)&&(e=e.replace(h,'<$1 data-value="'+B(A(c||""))+'"')),f&&(g.renderCache[a][c]=e),e)},clearCache:function(a){var b=this;"undefined"==typeof a?b.renderCache={}:delete b.renderCache[a]},canCreate:function(a){var b=this;if(!b.settings.create)return!1;var c=b.settings.createFilter;return!(!a.length||"function"==typeof c&&!c.apply(b,[a])||"string"==typeof c&&!new RegExp(c).test(a)||c instanceof RegExp&&!c.test(a))}}),L.count=0,L.defaults={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:!0,diacritics:!0,create:!1,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,maxOptions:1e3,maxItems:null,hideSelected:null,addPrecedence:!1,selectOnTab:!1,preload:!1,allowEmptyOption:!1,closeAfterSelect:!1,scrollDuration:60,loadThrottle:300,loadingClass:"loading",dataAttr:"data-data",optgroupField:"optgroup",valueField:"value",labelField:"text",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:!1,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"selectize-control",inputClass:"selectize-input",dropdownClass:"selectize-dropdown",dropdownContentClass:"selectize-dropdown-content",dropdownParent:null,copyClassesToDropdown:!0,render:{}},a.fn.selectize=function(b){var c=a.fn.selectize.defaults,d=a.extend({},c,b),e=d.dataAttr,f=d.labelField,g=d.valueField,h=d.optgroupField,i=d.optgroupLabelField,j=d.optgroupValueField,k=function(b,c){var h,i,j,k,l=b.attr(e);if(l)for(c.options=JSON.parse(l),h=0,i=c.options.length;i>h;h++)c.items.push(c.options[h][g]);else{var m=a.trim(b.val()||"");if(!d.allowEmptyOption&&!m.length)return;for(j=m.split(d.delimiter),h=0,i=j.length;i>h;h++)k={},k[f]=j[h],k[g]=j[h],c.options.push(k);c.items=j}},l=function(b,c){var k,l,m,n,o=c.options,p={},q=function(a){var b=e&&a.attr(e);return"string"==typeof b&&b.length?JSON.parse(b):null},r=function(b,e){b=a(b);var i=z(b.attr("value"));if(i||d.allowEmptyOption)if(p.hasOwnProperty(i)){if(e){var j=p[i][h];j?a.isArray(j)?j.push(e):p[i][h]=[j,e]:p[i][h]=e}}else{var k=q(b)||{};k[f]=k[f]||b.text(),k[g]=k[g]||i,k[h]=k[h]||e,p[i]=k,o.push(k),b.is(":selected")&&c.items.push(i)}},s=function(b){var d,e,f,g,h;for(b=a(b),f=b.attr("label"),f&&(g=q(b)||{},g[i]=f,g[j]=f,c.optgroups.push(g)),h=a("option",b),d=0,e=h.length;e>d;d++)r(h[d],f)};for(c.maxItems=b.attr("multiple")?null:1,n=b.children(),k=0,l=n.length;l>k;k++)m=n[k].tagName.toLowerCase(),"optgroup"===m?s(n[k]):"option"===m&&r(n[k])};return this.each(function(){if(!this.selectize){var e,f=a(this),g=this.tagName.toLowerCase(),h=f.attr("placeholder")||f.attr("data-placeholder");h||d.allowEmptyOption||(h=f.children('option[value=""]').text());var i={placeholder:h,options:[],optgroups:[],items:[]};"select"===g?l(f,i):k(f,i),e=new L(f,a.extend(!0,{},c,i,b))}})},a.fn.selectize.defaults=L.defaults,a.fn.selectize.support={validity:x},L.define("drag_drop",function(){if(!a.fn.sortable)throw new Error('The "drag_drop" plugin requires jQuery UI "sortable".');if("multi"===this.settings.mode){var b=this;b.lock=function(){var a=b.lock;return function(){var c=b.$control.data("sortable");return c&&c.disable(),a.apply(b,arguments)}}(),b.unlock=function(){var a=b.unlock;return function(){var c=b.$control.data("sortable");return c&&c.enable(),a.apply(b,arguments)}}(),b.setup=function(){var c=b.setup;return function(){c.apply(this,arguments);var d=b.$control.sortable({items:"[data-value]",forcePlaceholderSize:!0,disabled:b.isLocked,start:function(a,b){b.placeholder.css("width",b.helper.css("width")),d.css({overflow:"visible"})},stop:function(){d.css({overflow:"hidden"});var c=b.$activeItems?b.$activeItems.slice():null,e=[];d.children("[data-value]").each(function(){e.push(a(this).attr("data-value"))}),b.setValue(e),b.setActiveItem(c)}})}}()}}),L.define("dropdown_header",function(b){var c=this;b=a.extend({title:"Untitled",headerClass:"selectize-dropdown-header",titleRowClass:"selectize-dropdown-header-title",labelClass:"selectize-dropdown-header-label",closeClass:"selectize-dropdown-header-close",html:function(a){return'<div class="'+a.headerClass+'"><div class="'+a.titleRowClass+'"><span class="'+a.labelClass+'">'+a.title+'</span><a href="javascript:void(0)" class="'+a.closeClass+'">&times;</a></div></div>'}},b),c.setup=function(){var d=c.setup;return function(){d.apply(c,arguments),c.$dropdown_header=a(b.html(b)),c.$dropdown.prepend(c.$dropdown_header)}}()}),L.define("optgroup_columns",function(b){var c=this;b=a.extend({equalizeWidth:!0,equalizeHeight:!0},b),this.getAdjacentOption=function(b,c){var d=b.closest("[data-group]").find("[data-selectable]"),e=d.index(b)+c;return e>=0&&e<d.length?d.eq(e):a()},this.onKeyDown=function(){var a=c.onKeyDown;return function(b){var d,e,f,g;return!this.isOpen||b.keyCode!==j&&b.keyCode!==m?a.apply(this,arguments):(c.ignoreHover=!0,g=this.$activeOption.closest("[data-group]"),d=g.find("[data-selectable]").index(this.$activeOption),g=b.keyCode===j?g.prev("[data-group]"):g.next("[data-group]"),f=g.find("[data-selectable]"),e=f.eq(Math.min(f.length-1,d)),void(e.length&&this.setActiveOption(e)))}}();var d=function(){var a,b=d.width,c=document;return"undefined"==typeof b&&(a=c.createElement("div"),a.innerHTML='<div style="width:50px;height:50px;position:absolute;left:-50px;top:-50px;overflow:auto;"><div style="width:1px;height:100px;"></div></div>',a=a.firstChild,c.body.appendChild(a),b=d.width=a.offsetWidth-a.clientWidth,c.body.removeChild(a)),b},e=function(){var e,f,g,h,i,j,k;if(k=a("[data-group]",c.$dropdown_content),f=k.length,f&&c.$dropdown_content.width()){if(b.equalizeHeight){for(g=0,e=0;f>e;e++)g=Math.max(g,k.eq(e).height());k.css({height:g})}b.equalizeWidth&&(j=c.$dropdown_content.innerWidth()-d(),h=Math.round(j/f),k.css({width:h}),f>1&&(i=j-h*(f-1),k.eq(f-1).css({width:i})))}};(b.equalizeHeight||b.equalizeWidth)&&(C.after(this,"positionDropdown",e),C.after(this,"refreshOptions",e))}),L.define("remove_button",function(b){if("single"!==this.settings.mode){b=a.extend({label:"&times;",title:"Remove",className:"remove",append:!0},b);var c=this,d='<a href="javascript:void(0)" class="'+b.className+'" tabindex="-1" title="'+A(b.title)+'">'+b.label+"</a>",e=function(a,b){var c=a.search(/(<\/[^>]+>\s*)$/);return a.substring(0,c)+b+a.substring(c)};this.setup=function(){var f=c.setup;return function(){if(b.append){var g=c.settings.render.item;c.settings.render.item=function(){return e(g.apply(this,arguments),d)}}f.apply(this,arguments),this.$control.on("click","."+b.className,function(b){if(b.preventDefault(),!c.isLocked){var d=a(b.currentTarget).parent();c.setActiveItem(d),c.deleteSelection()&&c.setCaret(c.items.length)}})}}()}}),L.define("restore_on_backspace",function(a){var b=this;a.text=a.text||function(a){return a[this.settings.labelField]},this.onKeyDown=function(){var c=b.onKeyDown;return function(b){var d,e;return b.keyCode===p&&""===this.$control_input.val()&&!this.$activeItems.length&&(d=this.caretPos-1,d>=0&&d<this.items.length)?(e=this.options[this.items[d]],this.deleteSelection(b)&&(this.setTextboxValue(a.text.apply(this,[e])),this.refreshOptions(!0)),void b.preventDefault()):c.apply(this,arguments)}}()}),L});
/** javascripts/ui-controls/jquery.datetimepicker.full.min.js **/
var DateFormatter;!function(){"use strict";var e,t,a,r,n,o;n=864e5,o=3600,e=function(e,t){return"string"==typeof e&&"string"==typeof t&&e.toLowerCase()===t.toLowerCase()},t=function(e,a,r){var n=r||"0",o=e.toString();return o.length<a?t(n+o,a):o},a=function(e){var t,r;for(e=e||{},t=1;t<arguments.length;t++)if(r=arguments[t])for(var n in r)r.hasOwnProperty(n)&&("object"==typeof r[n]?a(e[n],r[n]):e[n]=r[n]);return e},r={dateSettings:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],meridiem:["AM","PM"],ordinal:function(e){var t=e%10,a={1:"st",2:"nd",3:"rd"};return 1!==Math.floor(e%100/10)&&a[t]?a[t]:"th"}},separators:/[ \-+\/\.T:@]/g,validParts:/[dDjlNSwzWFmMntLoYyaABgGhHisueTIOPZcrU]/g,intParts:/[djwNzmnyYhHgGis]/g,tzParts:/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,tzClip:/[^-+\dA-Z]/g},DateFormatter=function(e){var t=this,n=a(r,e);t.dateSettings=n.dateSettings,t.separators=n.separators,t.validParts=n.validParts,t.intParts=n.intParts,t.tzParts=n.tzParts,t.tzClip=n.tzClip},DateFormatter.prototype={constructor:DateFormatter,parseDate:function(t,a){var r,n,o,i,s,d,u,l,f,c,m=this,h=!1,g=!1,p=m.dateSettings,y={date:null,year:null,month:null,day:null,hour:0,min:0,sec:0};if(!t)return void 0;if(t instanceof Date)return t;if("number"==typeof t)return new Date(t);if("U"===a)return o=parseInt(t),o?new Date(1e3*o):t;if("string"!=typeof t)return"";if(r=a.match(m.validParts),!r||0===r.length)throw new Error("Invalid date format definition.");for(n=t.replace(m.separators,"\x00").split("\x00"),o=0;o<n.length;o++)switch(i=n[o],s=parseInt(i),r[o]){case"y":case"Y":f=i.length,2===f?y.year=parseInt((70>s?"20":"19")+i):4===f&&(y.year=s),h=!0;break;case"m":case"n":case"M":case"F":isNaN(i)?(d=p.monthsShort.indexOf(i),d>-1&&(y.month=d+1),d=p.months.indexOf(i),d>-1&&(y.month=d+1)):s>=1&&12>=s&&(y.month=s),h=!0;break;case"d":case"j":s>=1&&31>=s&&(y.day=s),h=!0;break;case"g":case"h":u=r.indexOf("a")>-1?r.indexOf("a"):r.indexOf("A")>-1?r.indexOf("A"):-1,c=n[u],u>-1?(l=e(c,p.meridiem[0])?0:e(c,p.meridiem[1])?12:-1,s>=1&&12>=s&&l>-1?y.hour=s+l:s>=0&&23>=s&&(y.hour=s)):s>=0&&23>=s&&(y.hour=s),g=!0;break;case"G":case"H":s>=0&&23>=s&&(y.hour=s),g=!0;break;case"i":s>=0&&59>=s&&(y.min=s),g=!0;break;case"s":s>=0&&59>=s&&(y.sec=s),g=!0}if(h===!0&&y.year&&y.month&&y.day)y.date=new Date(y.year,y.month-1,y.day,y.hour,y.min,y.sec,0);else{if(g!==!0)return!1;y.date=new Date(0,0,0,y.hour,y.min,y.sec,0)}return y.date},guessDate:function(e,t){if("string"!=typeof e)return e;var a,r,n,o,i=this,s=e.replace(i.separators,"\x00").split("\x00"),d=/^[djmn]/g,u=t.match(i.validParts),l=new Date,f=0;if(!d.test(u[0]))return e;for(r=0;r<s.length;r++){switch(f=2,n=s[r],o=parseInt(n.substr(0,2)),r){case 0:"m"===u[0]||"n"===u[0]?l.setMonth(o-1):l.setDate(o);break;case 1:"m"===u[0]||"n"===u[0]?l.setDate(o):l.setMonth(o-1);break;case 2:a=l.getFullYear(),n.length<4?(l.setFullYear(parseInt(a.toString().substr(0,4-n.length)+n)),f=n.length):(l.setFullYear=parseInt(n.substr(0,4)),f=4);break;case 3:l.setHours(o);break;case 4:l.setMinutes(o);break;case 5:l.setSeconds(o)}n.substr(f).length>0&&s.splice(r+1,0,n.substr(f))}return l},parseFormat:function(e,a){var r,i=this,s=i.dateSettings,d=/\\?(.?)/gi,u=function(e,t){return r[e]?r[e]():t};return r={d:function(){return t(r.j(),2)},D:function(){return s.daysShort[r.w()]},j:function(){return a.getDate()},l:function(){return s.days[r.w()]},N:function(){return r.w()||7},w:function(){return a.getDay()},z:function(){var e=new Date(r.Y(),r.n()-1,r.j()),t=new Date(r.Y(),0,1);return Math.round((e-t)/n)},W:function(){var e=new Date(r.Y(),r.n()-1,r.j()-r.N()+3),a=new Date(e.getFullYear(),0,4);return t(1+Math.round((e-a)/n/7),2)},F:function(){return s.months[a.getMonth()]},m:function(){return t(r.n(),2)},M:function(){return s.monthsShort[a.getMonth()]},n:function(){return a.getMonth()+1},t:function(){return new Date(r.Y(),r.n(),0).getDate()},L:function(){var e=r.Y();return e%4===0&&e%100!==0||e%400===0?1:0},o:function(){var e=r.n(),t=r.W(),a=r.Y();return a+(12===e&&9>t?1:1===e&&t>9?-1:0)},Y:function(){return a.getFullYear()},y:function(){return r.Y().toString().slice(-2)},a:function(){return r.A().toLowerCase()},A:function(){var e=r.G()<12?0:1;return s.meridiem[e]},B:function(){var e=a.getUTCHours()*o,r=60*a.getUTCMinutes(),n=a.getUTCSeconds();return t(Math.floor((e+r+n+o)/86.4)%1e3,3)},g:function(){return r.G()%12||12},G:function(){return a.getHours()},h:function(){return t(r.g(),2)},H:function(){return t(r.G(),2)},i:function(){return t(a.getMinutes(),2)},s:function(){return t(a.getSeconds(),2)},u:function(){return t(1e3*a.getMilliseconds(),6)},e:function(){var e=/\((.*)\)/.exec(String(a))[1];return e||"Coordinated Universal Time"},T:function(){var e=(String(a).match(i.tzParts)||[""]).pop().replace(i.tzClip,"");return e||"UTC"},I:function(){var e=new Date(r.Y(),0),t=Date.UTC(r.Y(),0),a=new Date(r.Y(),6),n=Date.UTC(r.Y(),6);return e-t!==a-n?1:0},O:function(){var e=a.getTimezoneOffset(),r=Math.abs(e);return(e>0?"-":"+")+t(100*Math.floor(r/60)+r%60,4)},P:function(){var e=r.O();return e.substr(0,3)+":"+e.substr(3,2)},Z:function(){return 60*-a.getTimezoneOffset()},c:function(){return"Y-m-d\\TH:i:sP".replace(d,u)},r:function(){return"D, d M Y H:i:s O".replace(d,u)},U:function(){return a.getTime()/1e3||0}},u(e,e)},formatDate:function(e,t){var a,r,n,o,i,s=this,d="";if("string"==typeof e&&(e=s.parseDate(e,t),e===!1))return!1;if(e instanceof Date){for(n=t.length,a=0;n>a;a++)i=t.charAt(a),"S"!==i&&(o=s.parseFormat(i,e),a!==n-1&&s.intParts.test(i)&&"S"===t.charAt(a+1)&&(r=parseInt(o),o+=s.dateSettings.ordinal(r)),d+=o);return d}return""}}}(),function(e){"function"==typeof define&&define.amd?define(["jquery","jquery-mousewheel"],e):"object"==typeof exports?module.exports=e:e(jQuery)}(function(e){"use strict";function t(e,t,a){this.date=e,this.desc=t,this.style=a}var a={i18n:{ar:{months:["ŸÉÿßŸÜŸàŸÜ ÿßŸÑÿ´ÿßŸÜŸä","ÿ¥ÿ®ÿßÿ∑","ÿ¢ÿ∞ÿßÿ±","ŸÜŸäÿ≥ÿßŸÜ","ŸÖÿßŸäŸà","ÿ≠ÿ≤Ÿäÿ±ÿßŸÜ","ÿ™ŸÖŸàÿ≤","ÿ¢ÿ®","ÿ£ŸäŸÑŸàŸÑ","ÿ™ÿ¥ÿ±ŸäŸÜ ÿßŸÑÿ£ŸàŸÑ","ÿ™ÿ¥ÿ±ŸäŸÜ ÿßŸÑÿ´ÿßŸÜŸä","ŸÉÿßŸÜŸàŸÜ ÿßŸÑÿ£ŸàŸÑ"],dayOfWeekShort:["ŸÜ","ÿ´","ÿπ","ÿÆ","ÿ¨","ÿ≥","ÿ≠"],dayOfWeek:["ÿßŸÑÿ£ÿ≠ÿØ","ÿßŸÑÿßÿ´ŸÜŸäŸÜ","ÿßŸÑÿ´ŸÑÿßÿ´ÿßÿ°","ÿßŸÑÿ£ÿ±ÿ®ÿπÿßÿ°","ÿßŸÑÿÆŸÖŸäÿ≥","ÿßŸÑÿ¨ŸÖÿπÿ©","ÿßŸÑÿ≥ÿ®ÿ™","ÿßŸÑÿ£ÿ≠ÿØ"]},ro:{months:["Ianuarie","Februarie","Martie","Aprilie","Mai","Iunie","Iulie","August","Septembrie","Octombrie","Noiembrie","Decembrie"],dayOfWeekShort:["Du","Lu","Ma","Mi","Jo","Vi","S√¢"],dayOfWeek:["DuminicƒÉ","Luni","Mar≈£i","Miercuri","Joi","Vineri","S√¢mbƒÉtƒÉ"]},id:{months:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],dayOfWeekShort:["Min","Sen","Sel","Rab","Kam","Jum","Sab"],dayOfWeek:["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"]},is:{months:["Jan√∫ar","Febr√∫ar","Mars","Apr√≠l","Ma√≠","J√∫n√≠","J√∫l√≠","√Åg√∫st","September","Okt√≥ber","N√≥vember","Desember"],dayOfWeekShort:["Sun","M√°n","√ûri√∞","Mi√∞","Fim","F√∂s","Lau"],dayOfWeek:["Sunnudagur","M√°nudagur","√ûri√∞judagur","Mi√∞vikudagur","Fimmtudagur","F√∂studagur","Laugardagur"]},bg:{months:["–Ø–Ω—É–∞—Ä–∏","–§–µ–≤—Ä—É–∞—Ä–∏","–ú–∞—Ä—Ç","–ê–ø—Ä–∏–ª","–ú–∞–π","–Æ–Ω–∏","–Æ–ª–∏","–ê–≤–≥—É—Å—Ç","–°–µ–ø—Ç–µ–º–≤—Ä–∏","–û–∫—Ç–æ–º–≤—Ä–∏","–ù–æ–µ–º–≤—Ä–∏","–î–µ–∫–µ–º–≤—Ä–∏"],dayOfWeekShort:["–ù–¥","–ü–Ω","–í—Ç","–°—Ä","–ß—Ç","–ü—Ç","–°–±"],dayOfWeek:["–ù–µ–¥–µ–ª—è","–ü–æ–Ω–µ–¥–µ–ª–Ω–∏–∫","–í—Ç–æ—Ä–Ω–∏–∫","–°—Ä—è–¥–∞","–ß–µ—Ç–≤—ä—Ä—Ç—ä–∫","–ü–µ—Ç—ä–∫","–°—ä–±–æ—Ç–∞"]},fa:{months:["ŸÅÿ±Ÿàÿ±ÿØ€åŸÜ","ÿßÿ±ÿØ€åÿ®Ÿáÿ¥ÿ™","ÿÆÿ±ÿØÿßÿØ","ÿ™€åÿ±","ŸÖÿ±ÿØÿßÿØ","ÿ¥Ÿáÿ±€åŸàÿ±","ŸÖŸáÿ±","ÿ¢ÿ®ÿßŸÜ","ÿ¢ÿ∞ÿ±","ÿØ€å","ÿ®ŸáŸÖŸÜ","ÿßÿ≥ŸÅŸÜÿØ"],dayOfWeekShort:["€å⁄©ÿ¥ŸÜÿ®Ÿá","ÿØŸàÿ¥ŸÜÿ®Ÿá","ÿ≥Ÿá ÿ¥ŸÜÿ®Ÿá","⁄ÜŸáÿßÿ±ÿ¥ŸÜÿ®Ÿá","ŸæŸÜÿ¨ÿ¥ŸÜÿ®Ÿá","ÿ¨ŸÖÿπŸá","ÿ¥ŸÜÿ®Ÿá"],dayOfWeek:["€å⁄©‚Äåÿ¥ŸÜÿ®Ÿá","ÿØŸàÿ¥ŸÜÿ®Ÿá","ÿ≥Ÿá‚Äåÿ¥ŸÜÿ®Ÿá","⁄ÜŸáÿßÿ±ÿ¥ŸÜÿ®Ÿá","ŸæŸÜÿ¨‚Äåÿ¥ŸÜÿ®Ÿá","ÿ¨ŸÖÿπŸá","ÿ¥ŸÜÿ®Ÿá","€å⁄©‚Äåÿ¥ŸÜÿ®Ÿá"]},ru:{months:["–Ø–Ω–≤–∞—Ä—å","–§–µ–≤—Ä–∞–ª—å","–ú–∞—Ä—Ç","–ê–ø—Ä–µ–ª—å","–ú–∞–π","–ò—é–Ω—å","–ò—é–ª—å","–ê–≤–≥—É—Å—Ç","–°–µ–Ω—Ç—è–±—Ä—å","–û–∫—Ç—è–±—Ä—å","–ù–æ—è–±—Ä—å","–î–µ–∫–∞–±—Ä—å"],dayOfWeekShort:["–í—Å","–ü–Ω","–í—Ç","–°—Ä","–ß—Ç","–ü—Ç","–°–±"],dayOfWeek:["–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ","–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫","–í—Ç–æ—Ä–Ω–∏–∫","–°—Ä–µ–¥–∞","–ß–µ—Ç–≤–µ—Ä–≥","–ü—è—Ç–Ω–∏—Ü–∞","–°—É–±–±–æ—Ç–∞"]},uk:{months:["–°—ñ—á–µ–Ω—å","–õ—é—Ç–∏–π","–ë–µ—Ä–µ–∑–µ–Ω—å","–ö–≤—ñ—Ç–µ–Ω—å","–¢—Ä–∞–≤–µ–Ω—å","–ß–µ—Ä–≤–µ–Ω—å","–õ–∏–ø–µ–Ω—å","–°–µ—Ä–ø–µ–Ω—å","–í–µ—Ä–µ—Å–µ–Ω—å","–ñ–æ–≤—Ç–µ–Ω—å","–õ–∏—Å—Ç–æ–ø–∞–¥","–ì—Ä—É–¥–µ–Ω—å"],dayOfWeekShort:["–ù–¥–ª","–ü–Ω–¥","–í—Ç—Ä","–°—Ä–¥","–ß—Ç–≤","–ü—Ç–Ω","–°–±—Ç"],dayOfWeek:["–ù–µ–¥—ñ–ª—è","–ü–æ–Ω–µ–¥—ñ–ª–æ–∫","–í—ñ–≤—Ç–æ—Ä–æ–∫","–°–µ—Ä–µ–¥–∞","–ß–µ—Ç–≤–µ—Ä","–ü'—è—Ç–Ω–∏—Ü—è","–°—É–±–æ—Ç–∞"]},en:{months:["January","February","March","April","May","June","July","August","September","October","November","December"],dayOfWeekShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayOfWeek:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},el:{months:["ŒôŒ±ŒΩŒøœÖŒ¨œÅŒπŒøœÇ","Œ¶ŒµŒ≤œÅŒøœÖŒ¨œÅŒπŒøœÇ","ŒúŒ¨œÅœÑŒπŒøœÇ","ŒëœÄœÅŒØŒªŒπŒøœÇ","ŒúŒ¨ŒπŒøœÇ","ŒôŒøœçŒΩŒπŒøœÇ","ŒôŒøœçŒªŒπŒøœÇ","ŒëœçŒ≥ŒøœÖœÉœÑŒøœÇ","Œ£ŒµœÄœÑŒ≠ŒºŒ≤œÅŒπŒøœÇ","ŒüŒ∫œÑœéŒ≤œÅŒπŒøœÇ","ŒùŒøŒ≠ŒºŒ≤œÅŒπŒøœÇ","ŒîŒµŒ∫Œ≠ŒºŒ≤œÅŒπŒøœÇ"],dayOfWeekShort:["ŒöœÖœÅ","ŒîŒµœÖ","Œ§œÅŒπ","Œ§ŒµœÑ","Œ†ŒµŒº","Œ†Œ±œÅ","Œ£Œ±Œ≤"],dayOfWeek:["ŒöœÖœÅŒπŒ±Œ∫ŒÆ","ŒîŒµœÖœÑŒ≠œÅŒ±","Œ§œÅŒØœÑŒ∑","Œ§ŒµœÑŒ¨œÅœÑŒ∑","Œ†Œ≠ŒºœÄœÑŒ∑","Œ†Œ±œÅŒ±œÉŒ∫ŒµœÖŒÆ","Œ£Œ¨Œ≤Œ≤Œ±œÑŒø"]},de:{months:["Januar","Februar","M√§rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],dayOfWeekShort:["So","Mo","Di","Mi","Do","Fr","Sa"],dayOfWeek:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"]},nl:{months:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],dayOfWeekShort:["zo","ma","di","wo","do","vr","za"],dayOfWeek:["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"]},tr:{months:["Ocak","≈ûubat","Mart","Nisan","Mayƒ±s","Haziran","Temmuz","Aƒüustos","Eyl√ºl","Ekim","Kasƒ±m","Aralƒ±k"],dayOfWeekShort:["Paz","Pts","Sal","√áar","Per","Cum","Cts"],dayOfWeek:["Pazar","Pazartesi","Salƒ±","√áar≈üamba","Per≈üembe","Cuma","Cumartesi"]},fr:{months:["Janvier","F√©vrier","Mars","Avril","Mai","Juin","Juillet","Ao√ªt","Septembre","Octobre","Novembre","D√©cembre"],dayOfWeekShort:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"],dayOfWeek:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]},es:{months:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],dayOfWeekShort:["Dom","Lun","Mar","Mi√©","Jue","Vie","S√°b"],dayOfWeek:["Domingo","Lunes","Martes","Mi√©rcoles","Jueves","Viernes","S√°bado"]},th:{months:["‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°","‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå","‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°","‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô","‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°","‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô","‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°","‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°","‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô","‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°","‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô","‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°"],dayOfWeekShort:["‡∏≠‡∏≤.","‡∏à.","‡∏≠.","‡∏û.","‡∏û‡∏§.","‡∏®.","‡∏™."],dayOfWeek:["‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå","‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå","‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£","‡∏û‡∏∏‡∏ò","‡∏û‡∏§‡∏´‡∏±‡∏™","‡∏®‡∏∏‡∏Å‡∏£‡πå","‡πÄ‡∏™‡∏≤‡∏£‡πå","‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå"]},pl:{months:["stycze≈Ñ","luty","marzec","kwiecie≈Ñ","maj","czerwiec","lipiec","sierpie≈Ñ","wrzesie≈Ñ","pa≈∫dziernik","listopad","grudzie≈Ñ"],dayOfWeekShort:["nd","pn","wt","≈õr","cz","pt","sb"],dayOfWeek:["niedziela","poniedzia≈Çek","wtorek","≈õroda","czwartek","piƒÖtek","sobota"]},pt:{months:["Janeiro","Fevereiro","Mar√ßo","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],dayOfWeekShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sab"],dayOfWeek:["Domingo","Segunda","Ter√ßa","Quarta","Quinta","Sexta","S√°bado"]},ch:{months:["‰∏ÄÊúà","‰∫åÊúà","‰∏âÊúà","ÂõõÊúà","‰∫îÊúà","ÂÖ≠Êúà","‰∏ÉÊúà","ÂÖ´Êúà","‰πùÊúà","ÂçÅÊúà","ÂçÅ‰∏ÄÊúà","ÂçÅ‰∫åÊúà"],dayOfWeekShort:["Êó•","‰∏Ä","‰∫å","‰∏â","Âõõ","‰∫î","ÂÖ≠"]},se:{months:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],dayOfWeekShort:["S√∂n","M√•n","Tis","Ons","Tor","Fre","L√∂r"]},kr:{months:["1Ïõî","2Ïõî","3Ïõî","4Ïõî","5Ïõî","6Ïõî","7Ïõî","8Ïõî","9Ïõî","10Ïõî","11Ïõî","12Ïõî"],dayOfWeekShort:["Ïùº","Ïõî","Ìôî","Ïàò","Î™©","Í∏à","ÌÜ†"],dayOfWeek:["ÏùºÏöîÏùº","ÏõîÏöîÏùº","ÌôîÏöîÏùº","ÏàòÏöîÏùº","Î™©ÏöîÏùº","Í∏àÏöîÏùº","ÌÜ†ÏöîÏùº"]},it:{months:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],dayOfWeekShort:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"],dayOfWeek:["Domenica","Luned√¨","Marted√¨","Mercoled√¨","Gioved√¨","Venerd√¨","Sabato"]},da:{months:["January","Februar","Marts","April","Maj","Juni","July","August","September","Oktober","November","December"],dayOfWeekShort:["S√∏n","Man","Tir","Ons","Tor","Fre","L√∏r"],dayOfWeek:["s√∏ndag","mandag","tirsdag","onsdag","torsdag","fredag","l√∏rdag"]},no:{months:["Januar","Februar","Mars","April","Mai","Juni","Juli","August","September","Oktober","November","Desember"],dayOfWeekShort:["S√∏n","Man","Tir","Ons","Tor","Fre","L√∏r"],dayOfWeek:["S√∏ndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","L√∏rdag"]},ja:{months:["1Êúà","2Êúà","3Êúà","4Êúà","5Êúà","6Êúà","7Êúà","8Êúà","9Êúà","10Êúà","11Êúà","12Êúà"],dayOfWeekShort:["Êó•","Êúà","ÁÅ´","Ê∞¥","Êú®","Èáë","Âúü"],dayOfWeek:["Êó•Êõú","ÊúàÊõú","ÁÅ´Êõú","Ê∞¥Êõú","Êú®Êõú","ÈáëÊõú","ÂúüÊõú"]},vi:{months:["Th√°ng 1","Th√°ng 2","Th√°ng 3","Th√°ng 4","Th√°ng 5","Th√°ng 6","Th√°ng 7","Th√°ng 8","Th√°ng 9","Th√°ng 10","Th√°ng 11","Th√°ng 12"],dayOfWeekShort:["CN","T2","T3","T4","T5","T6","T7"],dayOfWeek:["Ch·ªß nh·∫≠t","Th·ª© hai","Th·ª© ba","Th·ª© t∆∞","Th·ª© nƒÉm","Th·ª© s√°u","Th·ª© b·∫£y"]},sl:{months:["Januar","Februar","Marec","April","Maj","Junij","Julij","Avgust","September","Oktober","November","December"],dayOfWeekShort:["Ned","Pon","Tor","Sre","ƒået","Pet","Sob"],dayOfWeek:["Nedelja","Ponedeljek","Torek","Sreda","ƒåetrtek","Petek","Sobota"]},cs:{months:["Leden","√önor","B≈ôezen","Duben","Kvƒõten","ƒåerven","ƒåervenec","Srpen","Z√°≈ô√≠","≈ò√≠jen","Listopad","Prosinec"],dayOfWeekShort:["Ne","Po","√öt","St","ƒåt","P√°","So"]},hu:{months:["Janu√°r","Febru√°r","M√°rcius","√Åprilis","M√°jus","J√∫nius","J√∫lius","Augusztus","Szeptember","Okt√≥ber","November","December"],dayOfWeekShort:["Va","H√©","Ke","Sze","Cs","P√©","Szo"],dayOfWeek:["vas√°rnap","h√©tf≈ë","kedd","szerda","cs√ºt√∂rt√∂k","p√©ntek","szombat"]},az:{months:["Yanvar","Fevral","Mart","Aprel","May","Iyun","Iyul","Avqust","Sentyabr","Oktyabr","Noyabr","Dekabr"],dayOfWeekShort:["B","Be","√áa","√á","Ca","C","≈û"],dayOfWeek:["Bazar","Bazar ert…ôsi","√á…ôr≈ü…ônb…ô ax≈üamƒ±","√á…ôr≈ü…ônb…ô","C√ºm…ô ax≈üamƒ±","C√ºm…ô","≈û…ônb…ô"]},bs:{months:["Januar","Februar","Mart","April","Maj","Jun","Jul","Avgust","Septembar","Oktobar","Novembar","Decembar"],dayOfWeekShort:["Ned","Pon","Uto","Sri","ƒået","Pet","Sub"],dayOfWeek:["Nedjelja","Ponedjeljak","Utorak","Srijeda","ƒåetvrtak","Petak","Subota"]},ca:{months:["Gener","Febrer","Mar√ß","Abril","Maig","Juny","Juliol","Agost","Setembre","Octubre","Novembre","Desembre"],dayOfWeekShort:["Dg","Dl","Dt","Dc","Dj","Dv","Ds"],dayOfWeek:["Diumenge","Dilluns","Dimarts","Dimecres","Dijous","Divendres","Dissabte"]},"en-GB":{months:["January","February","March","April","May","June","July","August","September","October","November","December"],dayOfWeekShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayOfWeek:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},et:{months:["Jaanuar","Veebruar","M√§rts","Aprill","Mai","Juuni","Juuli","August","September","Oktoober","November","Detsember"],dayOfWeekShort:["P","E","T","K","N","R","L"],dayOfWeek:["P√ºhap√§ev","Esmasp√§ev","Teisip√§ev","Kolmap√§ev","Neljap√§ev","Reede","Laup√§ev"]},eu:{months:["Urtarrila","Otsaila","Martxoa","Apirila","Maiatza","Ekaina","Uztaila","Abuztua","Iraila","Urria","Azaroa","Abendua"],dayOfWeekShort:["Ig.","Al.","Ar.","Az.","Og.","Or.","La."],dayOfWeek:["Igandea","Astelehena","Asteartea","Asteazkena","Osteguna","Ostirala","Larunbata"]},fi:{months:["Tammikuu","Helmikuu","Maaliskuu","Huhtikuu","Toukokuu","Kes√§kuu","Hein√§kuu","Elokuu","Syyskuu","Lokakuu","Marraskuu","Joulukuu"],dayOfWeekShort:["Su","Ma","Ti","Ke","To","Pe","La"],dayOfWeek:["sunnuntai","maanantai","tiistai","keskiviikko","torstai","perjantai","lauantai"]},gl:{months:["Xan","Feb","Maz","Abr","Mai","Xun","Xul","Ago","Set","Out","Nov","Dec"],dayOfWeekShort:["Dom","Lun","Mar","Mer","Xov","Ven","Sab"],dayOfWeek:["Domingo","Luns","Martes","M√©rcores","Xoves","Venres","S√°bado"]},hr:{months:["Sijeƒçanj","Veljaƒça","O≈æujak","Travanj","Svibanj","Lipanj","Srpanj","Kolovoz","Rujan","Listopad","Studeni","Prosinac"],dayOfWeekShort:["Ned","Pon","Uto","Sri","ƒået","Pet","Sub"],dayOfWeek:["Nedjelja","Ponedjeljak","Utorak","Srijeda","ƒåetvrtak","Petak","Subota"]},ko:{months:["1Ïõî","2Ïõî","3Ïõî","4Ïõî","5Ïõî","6Ïõî","7Ïõî","8Ïõî","9Ïõî","10Ïõî","11Ïõî","12Ïõî"],dayOfWeekShort:["Ïùº","Ïõî","Ìôî","Ïàò","Î™©","Í∏à","ÌÜ†"],dayOfWeek:["ÏùºÏöîÏùº","ÏõîÏöîÏùº","ÌôîÏöîÏùº","ÏàòÏöîÏùº","Î™©ÏöîÏùº","Í∏àÏöîÏùº","ÌÜ†ÏöîÏùº"]},lt:{months:["Sausio","Vasario","Kovo","Baland≈æio","Gegu≈æƒós","Bir≈æelio","Liepos","Rugpj≈´ƒçio","Rugsƒójo","Spalio","Lapkriƒçio","Gruod≈æio"],dayOfWeekShort:["Sek","Pir","Ant","Tre","Ket","Pen","≈†e≈°"],dayOfWeek:["Sekmadienis","Pirmadienis","Antradienis","Treƒçiadienis","Ketvirtadienis","Penktadienis","≈†e≈°tadienis"]},lv:{months:["JanvƒÅris","FebruƒÅris","Marts","Aprƒ´lis ","Maijs","J≈´nijs","J≈´lijs","Augusts","Septembris","Oktobris","Novembris","Decembris"],dayOfWeekShort:["Sv","Pr","Ot","Tr","Ct","Pk","St"],dayOfWeek:["Svƒìtdiena","Pirmdiena","Otrdiena","Tre≈°diena","Ceturtdiena","Piektdiena","Sestdiena"]},mk:{months:["—ò–∞–Ω—É–∞—Ä–∏","—Ñ–µ–≤—Ä—É–∞—Ä–∏","–º–∞—Ä—Ç","–∞–ø—Ä–∏–ª","–º–∞—ò","—ò—É–Ω–∏","—ò—É–ª–∏","–∞–≤–≥—É—Å—Ç","—Å–µ–ø—Ç–µ–º–≤—Ä–∏","–æ–∫—Ç–æ–º–≤—Ä–∏","–Ω–æ–µ–º–≤—Ä–∏","–¥–µ–∫–µ–º–≤—Ä–∏"],dayOfWeekShort:["–Ω–µ–¥","–ø–æ–Ω","–≤—Ç–æ","—Å—Ä–µ","—á–µ—Ç","–ø–µ—Ç","—Å–∞–±"],dayOfWeek:["–ù–µ–¥–µ–ª–∞","–ü–æ–Ω–µ–¥–µ–ª–Ω–∏–∫","–í—Ç–æ—Ä–Ω–∏–∫","–°—Ä–µ–¥–∞","–ß–µ—Ç–≤—Ä—Ç–æ–∫","–ü–µ—Ç–æ–∫","–°–∞–±–æ—Ç–∞"]},mn:{months:["1-—Ä —Å–∞—Ä","2-—Ä —Å–∞—Ä","3-—Ä —Å–∞—Ä","4-—Ä —Å–∞—Ä","5-—Ä —Å–∞—Ä","6-—Ä —Å–∞—Ä","7-—Ä —Å–∞—Ä","8-—Ä —Å–∞—Ä","9-—Ä —Å–∞—Ä","10-—Ä —Å–∞—Ä","11-—Ä —Å–∞—Ä","12-—Ä —Å–∞—Ä"],dayOfWeekShort:["–î–∞–≤","–ú—è–≥","–õ—Ö–∞","–ü“Ø—Ä","–ë—Å–Ω","–ë—è–º","–ù—è–º"],dayOfWeek:["–î–∞–≤–∞–∞","–ú—è–≥–º–∞—Ä","–õ—Ö–∞–≥–≤–∞","–ü“Ø—Ä—ç–≤","–ë–∞–∞—Å–∞–Ω","–ë—è–º–±–∞","–ù—è–º"]},"pt-BR":{months:["Janeiro","Fevereiro","Mar√ßo","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],dayOfWeekShort:["Dom","Seg","Ter","Qua","Qui","Sex","S√°b"],dayOfWeek:["Domingo","Segunda","Ter√ßa","Quarta","Quinta","Sexta","S√°bado"]},sk:{months:["Janu√°r","Febru√°r","Marec","Apr√≠l","M√°j","J√∫n","J√∫l","August","September","Okt√≥ber","November","December"],dayOfWeekShort:["Ne","Po","Ut","St","≈†t","Pi","So"],dayOfWeek:["Nedeƒæa","Pondelok","Utorok","Streda","≈†tvrtok","Piatok","Sobota"]},sq:{months:["Janar","Shkurt","Mars","Prill","Maj","Qershor","Korrik","Gusht","Shtator","Tetor","N√´ntor","Dhjetor"],dayOfWeekShort:["Die","H√´n","Mar","M√´r","Enj","Pre","Shtu"],dayOfWeek:["E Diel","E H√´n√´","E Martƒì","E M√´rkur√´","E Enjte","E Premte","E Shtun√´"]},"sr-YU":{months:["Januar","Februar","Mart","April","Maj","Jun","Jul","Avgust","Septembar","Oktobar","Novembar","Decembar"],dayOfWeekShort:["Ned","Pon","Uto","Sre","ƒçet","Pet","Sub"],dayOfWeek:["Nedelja","Ponedeljak","Utorak","Sreda","ƒåetvrtak","Petak","Subota"]},sr:{months:["—ò–∞–Ω—É–∞—Ä","—Ñ–µ–±—Ä—É–∞—Ä","–º–∞—Ä—Ç","–∞–ø—Ä–∏–ª","–º–∞—ò","—ò—É–Ω","—ò—É–ª","–∞–≤–≥—É—Å—Ç","—Å–µ–ø—Ç–µ–º–±–∞—Ä","–æ–∫—Ç–æ–±–∞—Ä","–Ω–æ–≤–µ–º–±–∞—Ä","–¥–µ—Ü–µ–º–±–∞—Ä"],dayOfWeekShort:["–Ω–µ–¥","–ø–æ–Ω","—É—Ç–æ","—Å—Ä–µ","—á–µ—Ç","–ø–µ—Ç","—Å—É–±"],dayOfWeek:["–ù–µ–¥–µ—ô–∞","–ü–æ–Ω–µ–¥–µ—ô–∞–∫","–£—Ç–æ—Ä–∞–∫","–°—Ä–µ–¥–∞","–ß–µ—Ç–≤—Ä—Ç–∞–∫","–ü–µ—Ç–∞–∫","–°—É–±–æ—Ç–∞"]},sv:{months:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],dayOfWeekShort:["S√∂n","M√•n","Tis","Ons","Tor","Fre","L√∂r"],dayOfWeek:["S√∂ndag","M√•ndag","Tisdag","Onsdag","Torsdag","Fredag","L√∂rdag"]},"zh-TW":{months:["‰∏ÄÊúà","‰∫åÊúà","‰∏âÊúà","ÂõõÊúà","‰∫îÊúà","ÂÖ≠Êúà","‰∏ÉÊúà","ÂÖ´Êúà","‰πùÊúà","ÂçÅÊúà","ÂçÅ‰∏ÄÊúà","ÂçÅ‰∫åÊúà"],dayOfWeekShort:["Êó•","‰∏Ä","‰∫å","‰∏â","Âõõ","‰∫î","ÂÖ≠"],dayOfWeek:["ÊòüÊúüÊó•","ÊòüÊúü‰∏Ä","ÊòüÊúü‰∫å","ÊòüÊúü‰∏â","ÊòüÊúüÂõõ","ÊòüÊúü‰∫î","ÊòüÊúüÂÖ≠"]},zh:{months:["‰∏ÄÊúà","‰∫åÊúà","‰∏âÊúà","ÂõõÊúà","‰∫îÊúà","ÂÖ≠Êúà","‰∏ÉÊúà","ÂÖ´Êúà","‰πùÊúà","ÂçÅÊúà","ÂçÅ‰∏ÄÊúà","ÂçÅ‰∫åÊúà"],dayOfWeekShort:["Êó•","‰∏Ä","‰∫å","‰∏â","Âõõ","‰∫î","ÂÖ≠"],dayOfWeek:["ÊòüÊúüÊó•","ÊòüÊúü‰∏Ä","ÊòüÊúü‰∫å","ÊòüÊúü‰∏â","ÊòüÊúüÂõõ","ÊòüÊúü‰∫î","ÊòüÊúüÂÖ≠"]},he:{months:["◊ô◊†◊ï◊ê◊®","◊§◊ë◊®◊ï◊ê◊®","◊û◊®◊•","◊ê◊§◊®◊ô◊ú","◊û◊ê◊ô","◊ô◊ï◊†◊ô","◊ô◊ï◊ú◊ô","◊ê◊ï◊í◊ï◊°◊ò","◊°◊§◊ò◊û◊ë◊®","◊ê◊ï◊ß◊ò◊ï◊ë◊®","◊†◊ï◊ë◊û◊ë◊®","◊ì◊¶◊û◊ë◊®"],dayOfWeekShort:["◊ê'","◊ë'","◊í'","◊ì'","◊î'","◊ï'","◊©◊ë◊™"],dayOfWeek:["◊®◊ê◊©◊ï◊ü","◊©◊†◊ô","◊©◊ú◊ô◊©◊ô","◊®◊ë◊ô◊¢◊ô","◊ó◊û◊ô◊©◊ô","◊©◊ô◊©◊ô","◊©◊ë◊™","◊®◊ê◊©◊ï◊ü"]},hy:{months:["’Ä’∏÷Ç’∂’æ’°÷Ä","’ì’•’ø÷Ä’æ’°÷Ä","’Ñ’°÷Ä’ø","‘±’∫÷Ä’´’¨","’Ñ’°’µ’´’Ω","’Ä’∏÷Ç’∂’´’Ω","’Ä’∏÷Ç’¨’´’Ω","’ï’£’∏’Ω’ø’∏’Ω","’ç’•’∫’ø’•’¥’¢’•÷Ä","’Ä’∏’Ø’ø’•’¥’¢’•÷Ä","’Ü’∏’µ’•’¥’¢’•÷Ä","‘¥’•’Ø’ø’•’¥’¢’•÷Ä"],dayOfWeekShort:["‘ø’´","‘µ÷Ä’Ø","‘µ÷Ä÷Ñ","’â’∏÷Ä","’Ä’∂’£","’à÷Ç÷Ä’¢","’á’¢’©"],dayOfWeek:["‘ø’´÷Ä’°’Ø’´","‘µ÷Ä’Ø’∏÷Ç’∑’°’¢’©’´","‘µ÷Ä’•÷Ñ’∑’°’¢’©’´","’â’∏÷Ä’•÷Ñ’∑’°’¢’©’´","’Ä’´’∂’£’∑’°’¢’©’´","’à÷Ç÷Ä’¢’°’©","’á’°’¢’°’©"]},kg:{months:["“Æ—á—Ç“Ø–Ω –∞–π—ã","–ë–∏—Ä–¥–∏–Ω –∞–π—ã","–ñ–∞–ª–≥–∞–Ω –ö—É—Ä–∞–Ω","–ß—ã–Ω –ö—É—Ä–∞–Ω","–ë—É–≥—É","–ö—É–ª–∂–∞","–¢–µ–∫–µ","–ë–∞—à –û–æ–Ω–∞","–ê—è–∫ –û–æ–Ω–∞","–¢–æ–≥—É–∑–¥—É–Ω –∞–π—ã","–ñ–µ—Ç–∏–Ω–∏–Ω –∞–π—ã","–ë–µ—à—Ç–∏–Ω –∞–π—ã"],dayOfWeekShort:["–ñ–µ–∫","–î“Ø–π","–®–µ–π","–®–∞—Ä","–ë–µ–π","–ñ—É–º","–ò—à–µ"],dayOfWeek:["–ñ–µ–∫—à–µ–º–±","–î“Ø–π—à”©–º–±","–®–µ–π—à–µ–º–±","–®–∞—Ä—à–µ–º–±","–ë–µ–π—à–µ–º–±–∏","–ñ—É–º–∞","–ò—à–µ–Ω–±"]},rm:{months:["Schaner","Favrer","Mars","Avrigl","Matg","Zercladur","Fanadur","Avust","Settember","October","November","December"],dayOfWeekShort:["Du","Gli","Ma","Me","Gie","Ve","So"],dayOfWeek:["Dumengia","Glindesdi","Mardi","Mesemna","Gievgia","Venderdi","Sonda"]},ka:{months:["·Éò·Éê·Éú·Éï·Éê·É†·Éò","·Éó·Éî·Éë·Éî·É†·Éï·Éê·Éö·Éò","·Éõ·Éê·É†·É¢·Éò","·Éê·Éû·É†·Éò·Éö·Éò","·Éõ·Éê·Éò·É°·Éò","·Éò·Éï·Éú·Éò·É°·Éò","·Éò·Éï·Éö·Éò·É°·Éò","·Éê·Éí·Éï·Éò·É°·É¢·Éù","·É°·Éî·É•·É¢·Éî·Éõ·Éë·Éî·É†·Éò","·Éù·É•·É¢·Éù·Éõ·Éë·Éî·É†·Éò","·Éú·Éù·Éî·Éõ·Éë·Éî·É†·Éò","·Éì·Éî·Éô·Éî·Éõ·Éë·Éî·É†·Éò"],dayOfWeekShort:["·Éô·Éï","·Éù·É†·É®","·É°·Éê·Éõ·É®","·Éù·Éó·ÉÆ","·ÉÆ·É£·Éó","·Éû·Éê·É†","·É®·Éê·Éë"],dayOfWeek:["·Éô·Éï·Éò·É†·Éê","·Éù·É†·É®·Éê·Éë·Éê·Éó·Éò","·É°·Éê·Éõ·É®·Éê·Éë·Éê·Éó·Éò","·Éù·Éó·ÉÆ·É®·Éê·Éë·Éê·Éó·Éò","·ÉÆ·É£·Éó·É®·Éê·Éë·Éê·Éó·Éò","·Éû·Éê·É†·Éê·É°·Éô·Éî·Éï·Éò","·É®·Éê·Éë·Éê·Éó·Éò"]}},value:"",rtl:!1,format:"Y/m/d H:i",formatTime:"H:i",formatDate:"Y/m/d",startDate:!1,step:60,monthChangeSpinner:!0,closeOnDateSelect:!1,closeOnTimeSelect:!0,closeOnWithoutClick:!0,closeOnInputClick:!0,timepicker:!0,datepicker:!0,weeks:!1,defaultTime:!1,defaultDate:!1,minDate:!1,maxDate:!1,minTime:!1,maxTime:!1,disabledMinTime:!1,disabledMaxTime:!1,allowTimes:[],opened:!1,initTime:!0,inline:!1,theme:"",onSelectDate:function(){},onSelectTime:function(){},onChangeMonth:function(){},onGetWeekOfYear:function(){},onChangeYear:function(){},onChangeDateTime:function(){},onShow:function(){},onClose:function(){},onGenerate:function(){},withoutCopyright:!0,inverseButton:!1,hours12:!1,next:"xdsoft_next",prev:"xdsoft_prev",dayOfWeekStart:0,parentID:"body",timeHeightInTimePicker:25,timepickerScrollbar:!0,todayButton:!0,prevButton:!0,nextButton:!0,defaultSelect:!0,scrollMonth:!0,scrollTime:!0,scrollInput:!0,lazyInit:!1,mask:!1,validateOnBlur:!0,allowBlank:!0,yearStart:1950,yearEnd:2050,monthStart:0,monthEnd:11,style:"",id:"",fixed:!1,roundTime:"round",className:"",weekends:[],highlightedDates:[],highlightedPeriods:[],allowDates:[],allowDateRe:null,disabledDates:[],disabledWeekDays:[],yearOffset:0,beforeShowDay:null,enterLikeTab:!0,showApplyButton:!1},r=null,n="en",o="en",i={meridiem:["AM","PM"]},s=function(){var t=a.i18n[o],n={days:t.dayOfWeek,daysShort:t.dayOfWeekShort,months:t.months,monthsShort:e.map(t.months,function(e){return e.substring(0,3)})};r=new DateFormatter({dateSettings:e.extend({},i,n)})};e.datetimepicker={setLocale:function(e){var t=a.i18n[e]?e:n;o!=t&&(o=t,s())},setDateFormatter:function(e){r=e},RFC_2822:"D, d M Y H:i:s O",ATOM:"Y-m-dTH:i:sP",ISO_8601:"Y-m-dTH:i:sO",RFC_822:"D, d M y H:i:s O",RFC_850:"l, d-M-y H:i:s T",RFC_1036:"D, d M y H:i:s O",RFC_1123:"D, d M Y H:i:s O",RSS:"D, d M Y H:i:s O",W3C:"Y-m-dTH:i:sP"},s(),window.getComputedStyle||(window.getComputedStyle=function(e){return this.el=e,this.getPropertyValue=function(t){var a=/(\-([a-z]){1})/g;return"float"===t&&(t="styleFloat"),a.test(t)&&(t=t.replace(a,function(e,t,a){return a.toUpperCase()})),e.currentStyle[t]||null},this}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){var a,r;for(a=t||0,r=this.length;r>a;a+=1)if(this[a]===e)return a;return-1}),Date.prototype.countDaysInMonth=function(){return new Date(this.getFullYear(),this.getMonth()+1,0).getDate()},e.fn.xdsoftScroller=function(t){return this.each(function(){var a,r,n,o,i,s=e(this),d=function(e){var t,a={x:0,y:0};return"touchstart"===e.type||"touchmove"===e.type||"touchend"===e.type||"touchcancel"===e.type?(t=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0],a.x=t.clientX,a.y=t.clientY):("mousedown"===e.type||"mouseup"===e.type||"mousemove"===e.type||"mouseover"===e.type||"mouseout"===e.type||"mouseenter"===e.type||"mouseleave"===e.type)&&(a.x=e.clientX,a.y=e.clientY),a},u=100,l=!1,f=0,c=0,m=0,h=!1,g=0,p=function(){};return"hide"===t?void s.find(".xdsoft_scrollbar").hide():(e(this).hasClass("xdsoft_scroller_box")||(a=s.children().eq(0),r=s[0].clientHeight,n=a[0].offsetHeight,o=e('<div class="xdsoft_scrollbar"></div>'),i=e('<div class="xdsoft_scroller"></div>'),o.append(i),s.addClass("xdsoft_scroller_box").append(o),p=function(e){var t=d(e).y-f+g;0>t&&(t=0),t+i[0].offsetHeight>m&&(t=m-i[0].offsetHeight),s.trigger("scroll_element.xdsoft_scroller",[u?t/u:0])},i.on("touchstart.xdsoft_scroller mousedown.xdsoft_scroller",function(a){r||s.trigger("resize_scroll.xdsoft_scroller",[t]),f=d(a).y,g=parseInt(i.css("margin-top"),10),m=o[0].offsetHeight,"mousedown"===a.type||"touchstart"===a.type?(document&&e(document.body).addClass("xdsoft_noselect"),e([document.body,window]).on("touchend mouseup.xdsoft_scroller",function n(){e([document.body,window]).off("touchend mouseup.xdsoft_scroller",n).off("mousemove.xdsoft_scroller",p).removeClass("xdsoft_noselect")}),e(document.body).on("mousemove.xdsoft_scroller",p)):(h=!0,a.stopPropagation(),a.preventDefault())}).on("touchmove",function(e){h&&(e.preventDefault(),p(e))}).on("touchend touchcancel",function(){h=!1,g=0}),s.on("scroll_element.xdsoft_scroller",function(e,t){r||s.trigger("resize_scroll.xdsoft_scroller",[t,!0]),t=t>1?1:0>t||isNaN(t)?0:t,i.css("margin-top",u*t),setTimeout(function(){a.css("marginTop",-parseInt((a[0].offsetHeight-r)*t,10))},10)}).on("resize_scroll.xdsoft_scroller",function(e,t,d){var l,f;r=s[0].clientHeight,n=a[0].offsetHeight,l=r/n,f=l*o[0].offsetHeight,l>1?i.hide():(i.show(),i.css("height",parseInt(f>10?f:10,10)),u=o[0].offsetHeight-i[0].offsetHeight,d!==!0&&s.trigger("scroll_element.xdsoft_scroller",[t||Math.abs(parseInt(a.css("marginTop"),10))/(n-r)]))}),s.on("mousewheel",function(e){var t=Math.abs(parseInt(a.css("marginTop"),10));return t-=20*e.deltaY,0>t&&(t=0),s.trigger("scroll_element.xdsoft_scroller",[t/(n-r)]),e.stopPropagation(),!1}),s.on("touchstart",function(e){l=d(e),c=Math.abs(parseInt(a.css("marginTop"),10))}),s.on("touchmove",function(e){if(l){e.preventDefault();var t=d(e);s.trigger("scroll_element.xdsoft_scroller",[(c-(t.y-l.y))/(n-r)])}}),s.on("touchend touchcancel",function(){l=!1,c=0})),void s.trigger("resize_scroll.xdsoft_scroller",[t]))})},e.fn.datetimepicker=function(n,i){var s,d,u=this,l=48,f=57,c=96,m=105,h=17,g=46,p=13,y=27,v=8,b=37,D=38,k=39,x=40,T=9,S=116,w=65,O=67,M=86,_=90,W=89,F=!1,C=e.isPlainObject(n)||!n?e.extend(!0,{},a,n):e.extend(!0,{},a),P=0,A=function(e){e.on("open.xdsoft focusin.xdsoft mousedown.xdsoft touchstart",function t(){e.is(":disabled")||e.data("xdsoft_datetimepicker")||(clearTimeout(P),P=setTimeout(function(){e.data("xdsoft_datetimepicker")||s(e),e.off("open.xdsoft focusin.xdsoft mousedown.xdsoft touchstart",t).trigger("open.xdsoft")},100))})};return s=function(a){function i(){var e,t=!1;return C.startDate?t=j.strToDate(C.startDate):(t=C.value||(a&&a.val&&a.val()?a.val():""),t?t=j.strToDateTime(t):C.defaultDate&&(t=j.strToDateTime(C.defaultDate),C.defaultTime&&(e=j.strtotime(C.defaultTime),t.setHours(e.getHours()),t.setMinutes(e.getMinutes())))),t&&j.isValidDate(t)?J.data("changed",!0):t="",t||0}function s(t){var r=function(e,t){var a=e.replace(/([\[\]\/\{\}\(\)\-\.\+]{1})/g,"\\$1").replace(/_/g,"{digit+}").replace(/([0-9]{1})/g,"{digit$1}").replace(/\{digit([0-9]{1})\}/g,"[0-$1_]{1}").replace(/\{digit[\+]\}/g,"[0-9_]{1}");return new RegExp(a).test(t)},n=function(e){try{if(document.selection&&document.selection.createRange){var t=document.selection.createRange();return t.getBookmark().charCodeAt(2)-2}if(e.setSelectionRange)return e.selectionStart}catch(a){return 0}},o=function(e,t){if(e="string"==typeof e||e instanceof String?document.getElementById(e):e,!e)return!1;if(e.createTextRange){var a=e.createTextRange();return a.collapse(!0),a.moveEnd("character",t),a.moveStart("character",t),a.select(),!0}return e.setSelectionRange?(e.setSelectionRange(t,t),!0):!1};t.mask&&a.off("keydown.xdsoft"),t.mask===!0&&(t.mask="undefined"!=typeof moment?t.format.replace(/Y{4}/g,"9999").replace(/Y{2}/g,"99").replace(/M{2}/g,"19").replace(/D{2}/g,"39").replace(/H{2}/g,"29").replace(/m{2}/g,"59").replace(/s{2}/g,"59"):t.format.replace(/Y/g,"9999").replace(/F/g,"9999").replace(/m/g,"19").replace(/d/g,"39").replace(/H/g,"29").replace(/i/g,"59").replace(/s/g,"59")),"string"===e.type(t.mask)&&(r(t.mask,a.val())||(a.val(t.mask.replace(/[0-9]/g,"_")),o(a[0],0)),a.on("keydown.xdsoft",function(i){var s,d,u=this.value,C=i.which;if(C>=l&&f>=C||C>=c&&m>=C||C===v||C===g){for(s=n(this),d=C!==v&&C!==g?String.fromCharCode(C>=c&&m>=C?C-l:C):"_",C!==v&&C!==g||!s||(s-=1,d="_");/[^0-9_]/.test(t.mask.substr(s,1))&&s<t.mask.length&&s>0;)s+=C===v||C===g?-1:1;if(u=u.substr(0,s)+d+u.substr(s+1),""===e.trim(u))u=t.mask.replace(/[0-9]/g,"_");else if(s===t.mask.length)return i.preventDefault(),!1;for(s+=C===v||C===g?0:1;/[^0-9_]/.test(t.mask.substr(s,1))&&s<t.mask.length&&s>0;)s+=C===v||C===g?-1:1;r(t.mask,u)?(this.value=u,o(this,s)):""===e.trim(u)?this.value=t.mask.replace(/[0-9]/g,"_"):a.trigger("error_input.xdsoft")}else if(-1!==[w,O,M,_,W].indexOf(C)&&F||-1!==[y,D,x,b,k,S,h,T,p].indexOf(C))return!0;return i.preventDefault(),!1}))}var d,u,P,A,Y,j,H,J=e('<div class="xdsoft_datetimepicker xdsoft_noselect"></div>'),z=e('<div class="xdsoft_copyright"><a target="_blank" href="http://xdsoft.net/jqplugins/datetimepicker/">xdsoft.net</a></div>'),I=e('<div class="xdsoft_datepicker active"></div>'),N=e('<div class="xdsoft_monthpicker"><button type="button" class="xdsoft_prev"></button><button type="button" class="xdsoft_today_button"></button><div class="xdsoft_label xdsoft_month"><span></span><i></i></div><div class="xdsoft_label xdsoft_year"><span></span><i></i></div><button type="button" class="xdsoft_next"></button></div>'),L=e('<div class="xdsoft_calendar"></div>'),E=e('<div class="xdsoft_timepicker active"><button type="button" class="xdsoft_prev"></button><div class="xdsoft_time_box"></div><button type="button" class="xdsoft_next"></button></div>'),R=E.find(".xdsoft_time_box").eq(0),B=e('<div class="xdsoft_time_variant"></div>'),V=e('<button type="button" class="xdsoft_save_selected blue-gradient-button">Save Selected</button>'),G=e('<div class="xdsoft_select xdsoft_monthselect"><div></div></div>'),U=e('<div class="xdsoft_select xdsoft_yearselect"><div></div></div>'),q=!1,X=0;C.id&&J.attr("id",C.id),C.style&&J.attr("style",C.style),C.weeks&&J.addClass("xdsoft_showweeks"),C.rtl&&J.addClass("xdsoft_rtl"),J.addClass("xdsoft_"+C.theme),J.addClass(C.className),N.find(".xdsoft_month span").after(G),N.find(".xdsoft_year span").after(U),N.find(".xdsoft_month,.xdsoft_year").on("touchstart mousedown.xdsoft",function(t){var a,r,n=e(this).find(".xdsoft_select").eq(0),o=0,i=0,s=n.is(":visible");for(N.find(".xdsoft_select").hide(),j.currentTime&&(o=j.currentTime[e(this).hasClass("xdsoft_month")?"getMonth":"getFullYear"]()),n[s?"hide":"show"](),a=n.find("div.xdsoft_option"),r=0;r<a.length&&a.eq(r).data("value")!==o;r+=1)i+=a[0].offsetHeight;return n.xdsoftScroller(i/(n.children()[0].offsetHeight-n[0].clientHeight)),t.stopPropagation(),!1}),N.find(".xdsoft_select").xdsoftScroller().on("touchstart mousedown.xdsoft",function(e){e.stopPropagation(),e.preventDefault()}).on("touchstart mousedown.xdsoft",".xdsoft_option",function(){(void 0===j.currentTime||null===j.currentTime)&&(j.currentTime=j.now());var t=j.currentTime.getFullYear();j&&j.currentTime&&j.currentTime[e(this).parent().parent().hasClass("xdsoft_monthselect")?"setMonth":"setFullYear"](e(this).data("value")),e(this).parent().parent().hide(),J.trigger("xchange.xdsoft"),C.onChangeMonth&&e.isFunction(C.onChangeMonth)&&C.onChangeMonth.call(J,j.currentTime,J.data("input")),t!==j.currentTime.getFullYear()&&e.isFunction(C.onChangeYear)&&C.onChangeYear.call(J,j.currentTime,J.data("input"))}),J.getValue=function(){return j.getCurrentTime()},J.setOptions=function(n){var o={};C=e.extend(!0,{},C,n),n.allowTimes&&e.isArray(n.allowTimes)&&n.allowTimes.length&&(C.allowTimes=e.extend(!0,[],n.allowTimes)),n.weekends&&e.isArray(n.weekends)&&n.weekends.length&&(C.weekends=e.extend(!0,[],n.weekends)),n.allowDates&&e.isArray(n.allowDates)&&n.allowDates.length&&(C.allowDates=e.extend(!0,[],n.allowDates)),n.allowDateRe&&"[object String]"===Object.prototype.toString.call(n.allowDateRe)&&(C.allowDateRe=new RegExp(n.allowDateRe)),n.highlightedDates&&e.isArray(n.highlightedDates)&&n.highlightedDates.length&&(e.each(n.highlightedDates,function(a,n){var i,s=e.map(n.split(","),e.trim),d=new t(r.parseDate(s[0],C.formatDate),s[1],s[2]),u=r.formatDate(d.date,C.formatDate);void 0!==o[u]?(i=o[u].desc,i&&i.length&&d.desc&&d.desc.length&&(o[u].desc=i+"\n"+d.desc)):o[u]=d}),C.highlightedDates=e.extend(!0,[],o)),n.highlightedPeriods&&e.isArray(n.highlightedPeriods)&&n.highlightedPeriods.length&&(o=e.extend(!0,[],C.highlightedDates),
e.each(n.highlightedPeriods,function(a,n){var i,s,d,u,l,f,c;if(e.isArray(n))i=n[0],s=n[1],d=n[2],c=n[3];else{var m=e.map(n.split(","),e.trim);i=r.parseDate(m[0],C.formatDate),s=r.parseDate(m[1],C.formatDate),d=m[2],c=m[3]}for(;s>=i;)u=new t(i,d,c),l=r.formatDate(i,C.formatDate),i.setDate(i.getDate()+1),void 0!==o[l]?(f=o[l].desc,f&&f.length&&u.desc&&u.desc.length&&(o[l].desc=f+"\n"+u.desc)):o[l]=u}),C.highlightedDates=e.extend(!0,[],o)),n.disabledDates&&e.isArray(n.disabledDates)&&n.disabledDates.length&&(C.disabledDates=e.extend(!0,[],n.disabledDates)),n.disabledWeekDays&&e.isArray(n.disabledWeekDays)&&n.disabledWeekDays.length&&(C.disabledWeekDays=e.extend(!0,[],n.disabledWeekDays)),!C.open&&!C.opened||C.inline||a.trigger("open.xdsoft"),C.inline&&(q=!0,J.addClass("xdsoft_inline"),a.after(J).hide()),C.inverseButton&&(C.next="xdsoft_prev",C.prev="xdsoft_next"),C.datepicker?I.addClass("active"):I.removeClass("active"),C.timepicker?E.addClass("active"):E.removeClass("active"),C.value&&(j.setCurrentTime(C.value),a&&a.val&&a.val(j.str)),C.dayOfWeekStart=isNaN(C.dayOfWeekStart)?0:parseInt(C.dayOfWeekStart,10)%7,C.timepickerScrollbar||R.xdsoftScroller("hide"),C.minDate&&/^[\+\-](.*)$/.test(C.minDate)&&(C.minDate=r.formatDate(j.strToDateTime(C.minDate),C.formatDate)),C.maxDate&&/^[\+\-](.*)$/.test(C.maxDate)&&(C.maxDate=r.formatDate(j.strToDateTime(C.maxDate),C.formatDate)),V.toggle(C.showApplyButton),N.find(".xdsoft_today_button").css("visibility",C.todayButton?"visible":"hidden"),N.find("."+C.prev).css("visibility",C.prevButton?"visible":"hidden"),N.find("."+C.next).css("visibility",C.nextButton?"visible":"hidden"),s(C),C.validateOnBlur&&a.off("blur.xdsoft").on("blur.xdsoft",function(){if(C.allowBlank&&(!e.trim(e(this).val()).length||"string"==typeof C.mask&&e.trim(e(this).val())===C.mask.replace(/[0-9]/g,"_")))e(this).val(null),J.data("xdsoft_datetime").empty();else{var t=r.parseDate(e(this).val(),C.format);if(t)e(this).val(r.formatDate(t,C.format));else{var a=+[e(this).val()[0],e(this).val()[1]].join(""),n=+[e(this).val()[2],e(this).val()[3]].join("");e(this).val(!C.datepicker&&C.timepicker&&a>=0&&24>a&&n>=0&&60>n?[a,n].map(function(e){return e>9?e:"0"+e}).join(":"):r.formatDate(j.now(),C.format))}J.data("xdsoft_datetime").setCurrentTime(e(this).val())}J.trigger("changedatetime.xdsoft"),J.trigger("close.xdsoft")}),C.dayOfWeekStartPrev=0===C.dayOfWeekStart?6:C.dayOfWeekStart-1,J.trigger("xchange.xdsoft").trigger("afterOpen.xdsoft")},J.data("options",C).on("touchstart mousedown.xdsoft",function(e){return e.stopPropagation(),e.preventDefault(),U.hide(),G.hide(),!1}),R.append(B),R.xdsoftScroller(),J.on("afterOpen.xdsoft",function(){R.xdsoftScroller()}),J.append(I).append(E),C.withoutCopyright!==!0&&J.append(z),I.append(N).append(L).append(V),e(C.parentID).append(J),d=function(){var t=this;t.now=function(e){var a,r,n=new Date;return!e&&C.defaultDate&&(a=t.strToDateTime(C.defaultDate),n.setFullYear(a.getFullYear()),n.setMonth(a.getMonth()),n.setDate(a.getDate())),C.yearOffset&&n.setFullYear(n.getFullYear()+C.yearOffset),!e&&C.defaultTime&&(r=t.strtotime(C.defaultTime),n.setHours(r.getHours()),n.setMinutes(r.getMinutes())),n},t.isValidDate=function(e){return"[object Date]"!==Object.prototype.toString.call(e)?!1:!isNaN(e.getTime())},t.setCurrentTime=function(e,a){t.currentTime="string"==typeof e?t.strToDateTime(e):t.isValidDate(e)?e:e||a||!C.allowBlank?t.now():null,J.trigger("xchange.xdsoft")},t.empty=function(){t.currentTime=null},t.getCurrentTime=function(){return t.currentTime},t.nextMonth=function(){(void 0===t.currentTime||null===t.currentTime)&&(t.currentTime=t.now());var a,r=t.currentTime.getMonth()+1;return 12===r&&(t.currentTime.setFullYear(t.currentTime.getFullYear()+1),r=0),a=t.currentTime.getFullYear(),t.currentTime.setDate(Math.min(new Date(t.currentTime.getFullYear(),r+1,0).getDate(),t.currentTime.getDate())),t.currentTime.setMonth(r),C.onChangeMonth&&e.isFunction(C.onChangeMonth)&&C.onChangeMonth.call(J,j.currentTime,J.data("input")),a!==t.currentTime.getFullYear()&&e.isFunction(C.onChangeYear)&&C.onChangeYear.call(J,j.currentTime,J.data("input")),J.trigger("xchange.xdsoft"),r},t.prevMonth=function(){(void 0===t.currentTime||null===t.currentTime)&&(t.currentTime=t.now());var a=t.currentTime.getMonth()-1;return-1===a&&(t.currentTime.setFullYear(t.currentTime.getFullYear()-1),a=11),t.currentTime.setDate(Math.min(new Date(t.currentTime.getFullYear(),a+1,0).getDate(),t.currentTime.getDate())),t.currentTime.setMonth(a),C.onChangeMonth&&e.isFunction(C.onChangeMonth)&&C.onChangeMonth.call(J,j.currentTime,J.data("input")),J.trigger("xchange.xdsoft"),a},t.getWeekOfYear=function(t){if(C.onGetWeekOfYear&&e.isFunction(C.onGetWeekOfYear)){var a=C.onGetWeekOfYear.call(J,t);if("undefined"!=typeof a)return a}var r=new Date(t.getFullYear(),0,1);return 4!=r.getDay()&&r.setMonth(0,1+(4-r.getDay()+7)%7),Math.ceil(((t-r)/864e5+r.getDay()+1)/7)},t.strToDateTime=function(e){var a,n,o=[];return e&&e instanceof Date&&t.isValidDate(e)?e:(o=/^(\+|\-)(.*)$/.exec(e),o&&(o[2]=r.parseDate(o[2],C.formatDate)),o&&o[2]?(a=o[2].getTime()-6e4*o[2].getTimezoneOffset(),n=new Date(t.now(!0).getTime()+parseInt(o[1]+"1",10)*a)):n=e?r.parseDate(e,C.format):t.now(),t.isValidDate(n)||(n=t.now()),n)},t.strToDate=function(e){if(e&&e instanceof Date&&t.isValidDate(e))return e;var a=e?r.parseDate(e,C.formatDate):t.now(!0);return t.isValidDate(a)||(a=t.now(!0)),a},t.strtotime=function(e){if(e&&e instanceof Date&&t.isValidDate(e))return e;var a=e?r.parseDate(e,C.formatTime):t.now(!0);return t.isValidDate(a)||(a=t.now(!0)),a},t.str=function(){return r.formatDate(t.currentTime,C.format)},t.currentTime=this.now()},j=new d,V.on("touchend click",function(e){e.preventDefault(),J.data("changed",!0),j.setCurrentTime(i()),a.val(j.str()),J.trigger("close.xdsoft")}),N.find(".xdsoft_today_button").on("touchend mousedown.xdsoft",function(){J.data("changed",!0),j.setCurrentTime(0,!0),J.trigger("afterOpen.xdsoft")}).on("dblclick.xdsoft",function(){var e,t,r=j.getCurrentTime();r=new Date(r.getFullYear(),r.getMonth(),r.getDate()),e=j.strToDate(C.minDate),e=new Date(e.getFullYear(),e.getMonth(),e.getDate()),e>r||(t=j.strToDate(C.maxDate),t=new Date(t.getFullYear(),t.getMonth(),t.getDate()),r>t||(a.val(j.str()),a.trigger("change"),J.trigger("close.xdsoft")))}),N.find(".xdsoft_prev,.xdsoft_next").on("touchend mousedown.xdsoft",function(){var t=e(this),a=0,r=!1;!function n(e){t.hasClass(C.next)?j.nextMonth():t.hasClass(C.prev)&&j.prevMonth(),C.monthChangeSpinner&&(r||(a=setTimeout(n,e||100)))}(500),e([document.body,window]).on("touchend mouseup.xdsoft",function o(){clearTimeout(a),r=!0,e([document.body,window]).off("touchend mouseup.xdsoft",o)})}),E.find(".xdsoft_prev,.xdsoft_next").on("touchend mousedown.xdsoft",function(){var t=e(this),a=0,r=!1,n=110;!function o(e){var i=R[0].clientHeight,s=B[0].offsetHeight,d=Math.abs(parseInt(B.css("marginTop"),10));t.hasClass(C.next)&&s-i-C.timeHeightInTimePicker>=d?B.css("marginTop","-"+(d+C.timeHeightInTimePicker)+"px"):t.hasClass(C.prev)&&d-C.timeHeightInTimePicker>=0&&B.css("marginTop","-"+(d-C.timeHeightInTimePicker)+"px"),R.trigger("scroll_element.xdsoft_scroller",[Math.abs(parseInt(B[0].style.marginTop,10)/(s-i))]),n=n>10?10:n-10,r||(a=setTimeout(o,e||n))}(500),e([document.body,window]).on("touchend mouseup.xdsoft",function i(){clearTimeout(a),r=!0,e([document.body,window]).off("touchend mouseup.xdsoft",i)})}),u=0,J.on("xchange.xdsoft",function(t){clearTimeout(u),u=setTimeout(function(){if(void 0===j.currentTime||null===j.currentTime){if(C.allowBlank)return;j.currentTime=j.now()}for(var t,i,s,d,u,l,f,c,m,h,g="",p=new Date(j.currentTime.getFullYear(),j.currentTime.getMonth(),1,12,0,0),y=0,v=j.now(),b=!1,D=!1,k=[],x=!0,T="",S="";p.getDay()!==C.dayOfWeekStart;)p.setDate(p.getDate()-1);for(g+="<table><thead><tr>",C.weeks&&(g+="<th></th>"),t=0;7>t;t+=1)g+="<th>"+C.i18n[o].dayOfWeekShort[(t+C.dayOfWeekStart)%7]+"</th>";for(g+="</tr></thead>",g+="<tbody>",C.maxDate!==!1&&(b=j.strToDate(C.maxDate),b=new Date(b.getFullYear(),b.getMonth(),b.getDate(),23,59,59,999)),C.minDate!==!1&&(D=j.strToDate(C.minDate),D=new Date(D.getFullYear(),D.getMonth(),D.getDate()));y<j.currentTime.countDaysInMonth()||p.getDay()!==C.dayOfWeekStart||j.currentTime.getMonth()===p.getMonth();)k=[],y+=1,s=p.getDay(),d=p.getDate(),u=p.getFullYear(),l=p.getMonth(),f=j.getWeekOfYear(p),h="",k.push("xdsoft_date"),c=C.beforeShowDay&&e.isFunction(C.beforeShowDay.call)?C.beforeShowDay.call(J,p):null,C.allowDateRe&&"[object RegExp]"===Object.prototype.toString.call(C.allowDateRe)?C.allowDateRe.test(r.formatDate(p,C.formatDate))||k.push("xdsoft_disabled"):C.allowDates&&C.allowDates.length>0?-1===C.allowDates.indexOf(r.formatDate(p,C.formatDate))&&k.push("xdsoft_disabled"):b!==!1&&p>b||D!==!1&&D>p||c&&c[0]===!1?k.push("xdsoft_disabled"):-1!==C.disabledDates.indexOf(r.formatDate(p,C.formatDate))?k.push("xdsoft_disabled"):-1!==C.disabledWeekDays.indexOf(s)?k.push("xdsoft_disabled"):a.is("[readonly]")&&k.push("xdsoft_disabled"),c&&""!==c[1]&&k.push(c[1]),j.currentTime.getMonth()!==l&&k.push("xdsoft_other_month"),(C.defaultSelect||J.data("changed"))&&r.formatDate(j.currentTime,C.formatDate)===r.formatDate(p,C.formatDate)&&k.push("xdsoft_current"),r.formatDate(v,C.formatDate)===r.formatDate(p,C.formatDate)&&k.push("xdsoft_today"),(0===p.getDay()||6===p.getDay()||-1!==C.weekends.indexOf(r.formatDate(p,C.formatDate)))&&k.push("xdsoft_weekend"),void 0!==C.highlightedDates[r.formatDate(p,C.formatDate)]&&(i=C.highlightedDates[r.formatDate(p,C.formatDate)],k.push(void 0===i.style?"xdsoft_highlighted_default":i.style),h=void 0===i.desc?"":i.desc),C.beforeShowDay&&e.isFunction(C.beforeShowDay)&&k.push(C.beforeShowDay(p)),x&&(g+="<tr>",x=!1,C.weeks&&(g+="<th>"+f+"</th>")),g+='<td data-date="'+d+'" data-month="'+l+'" data-year="'+u+'" class="xdsoft_date xdsoft_day_of_week'+p.getDay()+" "+k.join(" ")+'" title="'+h+'"><div>'+d+"</div></td>",p.getDay()===C.dayOfWeekStartPrev&&(g+="</tr>",x=!0),p.setDate(d+1);if(g+="</tbody></table>",L.html(g),N.find(".xdsoft_label span").eq(0).text(C.i18n[o].months[j.currentTime.getMonth()]),N.find(".xdsoft_label span").eq(1).text(j.currentTime.getFullYear()),T="",S="",l="",m=function(t,n){var o,i,s=j.now(),d=C.allowTimes&&e.isArray(C.allowTimes)&&C.allowTimes.length;s.setHours(t),t=parseInt(s.getHours(),10),s.setMinutes(n),n=parseInt(s.getMinutes(),10),o=new Date(j.currentTime),o.setHours(t),o.setMinutes(n),k=[],C.minDateTime!==!1&&C.minDateTime>o||C.maxTime!==!1&&j.strtotime(C.maxTime).getTime()<s.getTime()||C.minTime!==!1&&j.strtotime(C.minTime).getTime()>s.getTime()?k.push("xdsoft_disabled"):C.minDateTime!==!1&&C.minDateTime>o||C.disabledMinTime!==!1&&s.getTime()>j.strtotime(C.disabledMinTime).getTime()&&C.disabledMaxTime!==!1&&s.getTime()<j.strtotime(C.disabledMaxTime).getTime()?k.push("xdsoft_disabled"):a.is("[readonly]")&&k.push("xdsoft_disabled"),i=new Date(j.currentTime),i.setHours(parseInt(j.currentTime.getHours(),10)),d||i.setMinutes(Math[C.roundTime](j.currentTime.getMinutes()/C.step)*C.step),(C.initTime||C.defaultSelect||J.data("changed"))&&i.getHours()===parseInt(t,10)&&(!d&&C.step>59||i.getMinutes()===parseInt(n,10))&&(C.defaultSelect||J.data("changed")?k.push("xdsoft_current"):C.initTime&&k.push("xdsoft_init_time")),parseInt(v.getHours(),10)===parseInt(t,10)&&parseInt(v.getMinutes(),10)===parseInt(n,10)&&k.push("xdsoft_today"),T+='<div class="xdsoft_time '+k.join(" ")+'" data-hour="'+t+'" data-minute="'+n+'">'+r.formatDate(s,C.formatTime)+"</div>"},C.allowTimes&&e.isArray(C.allowTimes)&&C.allowTimes.length)for(y=0;y<C.allowTimes.length;y+=1)S=j.strtotime(C.allowTimes[y]).getHours(),l=j.strtotime(C.allowTimes[y]).getMinutes(),m(S,l);else for(y=0,t=0;y<(C.hours12?12:24);y+=1)for(t=0;60>t;t+=C.step)S=(10>y?"0":"")+y,l=(10>t?"0":"")+t,m(S,l);for(B.html(T),n="",y=0,y=parseInt(C.yearStart,10)+C.yearOffset;y<=parseInt(C.yearEnd,10)+C.yearOffset;y+=1)n+='<div class="xdsoft_option '+(j.currentTime.getFullYear()===y?"xdsoft_current":"")+'" data-value="'+y+'">'+y+"</div>";for(U.children().eq(0).html(n),y=parseInt(C.monthStart,10),n="";y<=parseInt(C.monthEnd,10);y+=1)n+='<div class="xdsoft_option '+(j.currentTime.getMonth()===y?"xdsoft_current":"")+'" data-value="'+y+'">'+C.i18n[o].months[y]+"</div>";G.children().eq(0).html(n),e(J).trigger("generate.xdsoft")},10),t.stopPropagation()}).on("afterOpen.xdsoft",function(){if(C.timepicker){var e,t,a,r;B.find(".xdsoft_current").length?e=".xdsoft_current":B.find(".xdsoft_init_time").length&&(e=".xdsoft_init_time"),e?(t=R[0].clientHeight,a=B[0].offsetHeight,r=B.find(e).index()*C.timeHeightInTimePicker+1,r>a-t&&(r=a-t),R.trigger("scroll_element.xdsoft_scroller",[parseInt(r,10)/(a-t)])):R.trigger("scroll_element.xdsoft_scroller",[0])}}),P=0,L.on("touchend click.xdsoft","td",function(t){t.stopPropagation(),P+=1;var r=e(this),n=j.currentTime;return(void 0===n||null===n)&&(j.currentTime=j.now(),n=j.currentTime),r.hasClass("xdsoft_disabled")?!1:(n.setDate(1),n.setFullYear(r.data("year")),n.setMonth(r.data("month")),n.setDate(r.data("date")),J.trigger("select.xdsoft",[n]),a.val(j.str()),C.onSelectDate&&e.isFunction(C.onSelectDate)&&C.onSelectDate.call(J,j.currentTime,J.data("input"),t),J.data("changed",!0),J.trigger("xchange.xdsoft"),J.trigger("changedatetime.xdsoft"),(P>1||C.closeOnDateSelect===!0||C.closeOnDateSelect===!1&&!C.timepicker)&&!C.inline&&J.trigger("close.xdsoft"),void setTimeout(function(){P=0},200))}),B.on("touchend click.xdsoft","div",function(t){t.stopPropagation();var a=e(this),r=j.currentTime;return(void 0===r||null===r)&&(j.currentTime=j.now(),r=j.currentTime),a.hasClass("xdsoft_disabled")?!1:(r.setHours(a.data("hour")),r.setMinutes(a.data("minute")),J.trigger("select.xdsoft",[r]),J.data("input").val(j.str()),C.onSelectTime&&e.isFunction(C.onSelectTime)&&C.onSelectTime.call(J,j.currentTime,J.data("input"),t),J.data("changed",!0),J.trigger("xchange.xdsoft"),J.trigger("changedatetime.xdsoft"),void(C.inline!==!0&&C.closeOnTimeSelect===!0&&J.trigger("close.xdsoft")))}),I.on("mousewheel.xdsoft",function(e){return C.scrollMonth?(e.deltaY<0?j.nextMonth():j.prevMonth(),!1):!0}),a.on("mousewheel.xdsoft",function(e){return C.scrollInput?!C.datepicker&&C.timepicker?(A=B.find(".xdsoft_current").length?B.find(".xdsoft_current").eq(0).index():0,A+e.deltaY>=0&&A+e.deltaY<B.children().length&&(A+=e.deltaY),B.children().eq(A).length&&B.children().eq(A).trigger("mousedown"),!1):C.datepicker&&!C.timepicker?(I.trigger(e,[e.deltaY,e.deltaX,e.deltaY]),a.val&&a.val(j.str()),J.trigger("changedatetime.xdsoft"),!1):void 0:!0}),J.on("changedatetime.xdsoft",function(t){if(C.onChangeDateTime&&e.isFunction(C.onChangeDateTime)){var a=J.data("input");C.onChangeDateTime.call(J,j.currentTime,a,t),delete C.value,a.trigger("change")}}).on("generate.xdsoft",function(){C.onGenerate&&e.isFunction(C.onGenerate)&&C.onGenerate.call(J,j.currentTime,J.data("input")),q&&(J.trigger("afterOpen.xdsoft"),q=!1)}).on("click.xdsoft",function(e){e.stopPropagation()}),A=0,H=function(e,t){do if(e=e.parentNode,t(e)===!1)break;while("HTML"!==e.nodeName)},Y=function(){var t,a,r,n,o,i,s,d,u,l,f,c,m;if(d=J.data("input"),t=d.offset(),a=d[0],l="top",r=t.top+a.offsetHeight-1,n=t.left,o="absolute",u=e(window).width(),c=e(window).height(),m=e(window).scrollTop(),document.documentElement.clientWidth-t.left<I.parent().outerWidth(!0)){var h=I.parent().outerWidth(!0)-a.offsetWidth;n-=h}"rtl"===d.parent().css("direction")&&(n-=J.outerWidth()-d.outerWidth()),C.fixed?(r-=m,n-=e(window).scrollLeft(),o="fixed"):(s=!1,H(a,function(e){return"fixed"===window.getComputedStyle(e).getPropertyValue("position")?(s=!0,!1):void 0}),s?(o="fixed",r+J.outerHeight()>c+m?(l="bottom",r=c+m-t.top):r-=m):r+a.offsetHeight>c+m&&(r=t.top-a.offsetHeight+1),0>r&&(r=0),n+a.offsetWidth>u&&(n=u-a.offsetWidth)),i=J[0],H(i,function(e){var t;return t=window.getComputedStyle(e).getPropertyValue("position"),"relative"===t&&u>=e.offsetWidth?(n-=(u-e.offsetWidth)/2,!1):void 0}),f={position:o,left:n,top:"",bottom:""},f[l]=r,J.css(f)},J.on("open.xdsoft",function(t){var a=!0;C.onShow&&e.isFunction(C.onShow)&&(a=C.onShow.call(J,j.currentTime,J.data("input"),t)),a!==!1&&(J.show(),Y(),e(window).off("resize.xdsoft",Y).on("resize.xdsoft",Y),C.closeOnWithoutClick&&e([document.body,window]).on("touchstart mousedown.xdsoft",function r(){J.trigger("close.xdsoft"),e([document.body,window]).off("touchstart mousedown.xdsoft",r)}))}).on("close.xdsoft",function(t){var a=!0;N.find(".xdsoft_month,.xdsoft_year").find(".xdsoft_select").hide(),C.onClose&&e.isFunction(C.onClose)&&(a=C.onClose.call(J,j.currentTime,J.data("input"),t)),a===!1||C.opened||C.inline||J.hide(),t.stopPropagation()}).on("toggle.xdsoft",function(){J.trigger(J.is(":visible")?"close.xdsoft":"open.xdsoft")}).data("input",a),X=0,J.data("xdsoft_datetime",j),J.setOptions(C),j.setCurrentTime(i()),a.data("xdsoft_datetimepicker",J).on("open.xdsoft focusin.xdsoft mousedown.xdsoft touchstart",function(){a.is(":disabled")||a.data("xdsoft_datetimepicker").is(":visible")&&C.closeOnInputClick||(clearTimeout(X),X=setTimeout(function(){a.is(":disabled")||(q=!0,j.setCurrentTime(i(),!0),C.mask&&s(C),J.trigger("open.xdsoft"))},100))}).on("keydown.xdsoft",function(t){var a,r=t.which;return-1!==[p].indexOf(r)&&C.enterLikeTab?(a=e("input:visible,textarea:visible,button:visible,a:visible"),J.trigger("close.xdsoft"),a.eq(a.index(this)+1).focus(),!1):-1!==[T].indexOf(r)?(J.trigger("close.xdsoft"),!0):void 0}).on("blur.xdsoft",function(){J.trigger("close.xdsoft")})},d=function(t){var a=t.data("xdsoft_datetimepicker");a&&(a.data("xdsoft_datetime",null),a.remove(),t.data("xdsoft_datetimepicker",null).off(".xdsoft"),e(window).off("resize.xdsoft"),e([window,document.body]).off("mousedown.xdsoft touchstart"),t.unmousewheel&&t.unmousewheel())},e(document).off("keydown.xdsoftctrl keyup.xdsoftctrl").on("keydown.xdsoftctrl",function(e){e.keyCode===h&&(F=!0)}).on("keyup.xdsoftctrl",function(e){e.keyCode===h&&(F=!1)}),this.each(function(){var t,a=e(this).data("xdsoft_datetimepicker");if(a){if("string"===e.type(n))switch(n){case"show":e(this).select().focus(),a.trigger("open.xdsoft");break;case"hide":a.trigger("close.xdsoft");break;case"toggle":a.trigger("toggle.xdsoft");break;case"destroy":d(e(this));break;case"reset":this.value=this.defaultValue,this.value&&a.data("xdsoft_datetime").isValidDate(r.parseDate(this.value,C.format))||a.data("changed",!1),a.data("xdsoft_datetime").setCurrentTime(this.value);break;case"validate":t=a.data("input"),t.trigger("blur.xdsoft");break;default:a[n]&&e.isFunction(a[n])&&(u=a[n](i))}else a.setOptions(n);return 0}"string"!==e.type(n)&&(!C.lazyInit||C.open||C.inline?s(e(this)):A(e(this)))}),u},e.fn.datetimepicker.defaults=a}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}(function(e){function t(t){var i=t||window.event,s=d.call(arguments,1),u=0,f=0,c=0,m=0,h=0,g=0;if(t=e.event.fix(i),t.type="mousewheel","detail"in i&&(c=-1*i.detail),"wheelDelta"in i&&(c=i.wheelDelta),"wheelDeltaY"in i&&(c=i.wheelDeltaY),"wheelDeltaX"in i&&(f=-1*i.wheelDeltaX),"axis"in i&&i.axis===i.HORIZONTAL_AXIS&&(f=-1*c,c=0),u=0===c?f:c,"deltaY"in i&&(c=-1*i.deltaY,u=c),"deltaX"in i&&(f=i.deltaX,0===c&&(u=-1*f)),0!==c||0!==f){if(1===i.deltaMode){var p=e.data(this,"mousewheel-line-height");u*=p,c*=p,f*=p}else if(2===i.deltaMode){var y=e.data(this,"mousewheel-page-height");u*=y,c*=y,f*=y}if(m=Math.max(Math.abs(c),Math.abs(f)),(!o||o>m)&&(o=m,r(i,m)&&(o/=40)),r(i,m)&&(u/=40,f/=40,c/=40),u=Math[u>=1?"floor":"ceil"](u/o),f=Math[f>=1?"floor":"ceil"](f/o),c=Math[c>=1?"floor":"ceil"](c/o),l.settings.normalizeOffset&&this.getBoundingClientRect){var v=this.getBoundingClientRect();h=t.clientX-v.left,g=t.clientY-v.top}return t.deltaX=f,t.deltaY=c,t.deltaFactor=o,t.offsetX=h,t.offsetY=g,t.deltaMode=0,s.unshift(t,u,f,c),n&&clearTimeout(n),n=setTimeout(a,200),(e.event.dispatch||e.event.handle).apply(this,s)}}function a(){o=null}function r(e,t){return l.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120===0}var n,o,i=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],s="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],d=Array.prototype.slice;if(e.event.fixHooks)for(var u=i.length;u;)e.event.fixHooks[i[--u]]=e.event.mouseHooks;var l=e.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var a=s.length;a;)this.addEventListener(s[--a],t,!1);else this.onmousewheel=t;e.data(this,"mousewheel-line-height",l.getLineHeight(this)),e.data(this,"mousewheel-page-height",l.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var a=s.length;a;)this.removeEventListener(s[--a],t,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var a=e(t),r=a["offsetParent"in e.fn?"offsetParent":"parent"]();return r.length||(r=e("body")),parseInt(r.css("fontSize"),10)||parseInt(a.css("fontSize"),10)||16},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})});_application/javascript_Vhttps://hdc-lm-dsi.euro.apple.com:9000/assets/javascripts/generated_default_scripts.js’VWXYObplist00‘klX$versionX$objectsY$archiverT$top Ü†Ø #)*0123MNOPQRSTUVWXYZ[\]^_`aefU$null›	
 !"R$6S$10R$2R$7R$3S$11R$8V$classR$4R$9R$0R$5R$1Ä	ÄÄÄ ÄÄÄÄ”$%'(WNS.base[NS.relativeÄ ÄÄ_fhttps://hdc-lm-dsi.euro.apple.com:9000/assets/javascripts/testrepositoryjs/TestRepositoryManagement.js“+,-.Z$classnameX$classesUNSURL¢-/XNSObject#Aø±Æbå  »”456ALWNS.keysZNS.objects™789:;<=>?@Ä	Ä
ÄÄÄÄÄÄÄÄ™BCDEFGHIJKÄÄÄÄÄÄÄÄÄÄÄTEtag\Content-Type]Last-Modified_Strict-Transport-Security]Accept-RangesTDate_Content-Encoding^Content-Length]Cache-ControlTVary_*"1a677afa441a5db71884d1831980a4086e89d7d4"_%application/javascript; charset=UTF-8_Mon, 10 Jul 2017 11:23:16 GMT_max-age=2592000Ubytes_Tue, 07 Nov 2017 09:00:30 GMTTgzipT9200_public, max-age=3600_Accept-Encoding“+,bc_NSMutableDictionary£bd/\NSDictionary_application/javascript“+,gh_NSHTTPURLResponse£ij/_NSHTTPURLResponse]NSURLResponse_NSKeyedArchiver—mn_WebResourceResponseÄ    # - 2 7 Z ` { ~ Ç Ö à ã è í ô ú ü ¢ • ® ™ ¨ Æ ∞ ≤ ≥ µ ∑ π ª Ω ø ¡ » – ‹ ﬁ ‡ ‚KP[djmvÅÉäíù®™¨Æ∞≤¥∂∏∫º«…ÀÕœ—”’◊Ÿ€›‚Ô˝',?N\aé∂÷ËÓ/AF\`mÜãü£∑≈◊⁄             o              ÚOúÕvar globalTestVersionId = 0;
var globalSetupParametersContainer = {};
var globalVirtualCombinationsContainer = {};
var globalScenariosData = {};
var globalScenarioIdsToDelete = [];
var globalScenarioVirtualCombinationIdsToDelete = [];
var globalScenarioNameColumnWidth = 300;
var globalCategoryColumnWidth = 200;
var globalTestCustomizedAttributeColumnWidth = 300;

function testRepository_initializeButtons() {
	UIUtility_initializeButton('btnSaveTestRepository', 'ui-icon-disk');
	UIUtility_initializeButton('btnSyncTestRepository', 'ui-icon-arrowrefresh-1-w');
	UIUtility_initializeButton('btnNewTest', 'ui-icon-document');
	UIUtility_initializeButton('btnImportTests', 'ui-icon-folder-open');
	UIUtility_initializeButton('btnDeleteTest', 'ui-icon-trash');
	UIUtility_initializeButton('btnShowChangeLog', 'ui-icon-script');
	UIUtility_initializeButton('btnExportTests', 'ui-icon-disk');

	UIUtility_initializeToggleButton('btnShowAdvanced', 'ui-icon-gear');
	$("#btnShowAdvanced").click(testRepository_onShowAdvanced);
}

function testRepository_onShowAdvanced() {
	if ($(this).prop("checked")) {
		$("[data-advanced]").removeClass("inactive-force");
	} else {
		$("[data-advanced]").addClass("inactive-force");
	}
}

function testRepository_initializeDeleteTestsConfirmDialog() {
	$("#deleteTestsConfirmDialog").dialog({
		autoOpen: false,
		height: 300,
		width: 450,
		modal: true,
		buttons: [ 
		          {
		        	  id: "btnConfirmDeleteTests",
		        	  text: "Confirm",
		        	  click: function() {
		        		  testRepository_onDeleteTests_confirm();
		        	  }
		          },
		          {
		        	  text: "Cancel",
		        	  click: function() {
		        		  $(this).dialog("close");
		        	  }
		          }
		          ]
	});
}

function testRepository_showScenariosDiv() {

	// Show the section
	$('#divScenarios, #tdSwitchToEditModeBtn, #tdSwitchToEditModeLbl, #tdNewTest, #tdDeleteTest').removeClass('inactive');
}

function testRepository_sendRequestToLoadTestRepository() {
	// Post 
	var link = '/tasks/LoadTestRepository';
	var async = true;
	var request = {};
	PostJsonWithJsonFeedbackFuncs(link, async, request,
		function (jsonResponse) {
			// Store the scenarios data
			storeConfigurationScenariosData(jsonResponse); // Legacy
			globalTestVersionId = jsonResponse.testVersionId;
			globalSetupParametersContainer = jsonResponse.setupParametersContainer;
			globalVirtualCombinationsContainer = jsonResponse.virtualCombinationsData;
			globalScenariosData = jsonResponse.scenariosData;

			// Render the scenarios
			testRepository_renderRepository();

			// Prepare the table for view
			prepareTableFiltersExt('tblScenarios', false);

			// Show the scenarios
			testRepository_showScenariosDiv();
		},
		function (textResponse) {
			// Hide the loader animation
			pageFinishedLoading();
			UIUtility_showAlert('Failed to load the tests, please try again. Error: ' + textResponse);
		}
	);
}

function testRepository_onExport() {
	exportTableToCsv("tblScenarios", undefined, function (elem) {
		return [ replaceAll(elem.html().trim(), "<br>", "\n") ];
	});
}

function testRepository_onImport() {

	$("body").append('<input style="display: none" type="file" id="loadFile"></input>');
	$("#loadFile").change(testRepository_import);
	$("#loadFile").click();
}

function testRepository_import(event) {
		
	var file = event.target.files[0];
	if (file) {
		var reader = new FileReader();
		reader.onload = function (e) {
		
			try {

				$("#loadFile").remove();

				// Parse file
				var results = Papa.parse(e.target.result.trim(), { header: true });
				if (results.errors.length > 0) {
					UIUtility_showAlert("Invalid CSV file: " + JSON.stringify({ errors: results.errors }), "Error");
					return;
				}

				var headerRow = results.meta.fields;
				console.log("Header: " + headerRow);

				// Add existing test names to set
				var testNames = new Set();
				$("#tblScenarios > tbody > tr").each(function () {
					var testName = $(this).find("#tdScenarioName").text();
					testNames.add(testName);
				});

				// Loop over the rows and prepare an object that contains the tests
				var tests = [];
				for (var rowIndex = 0; rowIndex < results.data.length; rowIndex++) {

					// Get the current row and skip if it's empty
					var columnValues = results.data[rowIndex];

					// Trim the column values
					for (valueIndex = 0; valueIndex < columnValues.length; valueIndex++) {
						columnValues[valueIndex] = columnValues[valueIndex].trim();
					}

					// Get the test name and the category
					var testName = columnValues["Test Name"];
					var category = columnValues["Category"];

					// Validate test name and category
					if (isStringEmpty(testName)) {
						throw 'Test name in row [' + rowIndex + '] cannot be empty';
					} else if (isStringEmpty(category)) {
						throw 'Category in row [' + rowIndex + '] cannot be empty';
					}

					// Validate there is no duplication of test names
					if (testNames.has(testName)) {
						throw 'Test name [' + testName + '] is a duplicate';
					}

					// Add the test name to the set of test names
					testNames.add(testName);

					// Create a test object
					var test = {};
					test.testName = testName;
					test.category = category;

					// Add attributes
					test.attributes = [];
					for (var columnIndex = 2; columnIndex < headerRow.length; columnIndex++) {

						// Get the current column name and column value
						var attributeName = headerRow[columnIndex];
						var attributeValue = columnValues[attributeName];

						if (attributeName == "Virtual Combination" && testRepository_getVCIdByName(attributeValue) == undefined) {
							UIUtility_showAlert("Can't find virtual combination [" + attributeValue + "]", "Error");
							return;
						} else if (attributeName == "Priority" || attributeName == "Repeat") {
							var min = (attributeName == "Priority" ? 0 : 1);
							var max = (attributeName == "Priority" ? 9 : 10);
							var numericValue = parseInt(attributeValue);
							if (numericValue == undefined || numericValue < min || numericValue > max) {
								UIUtility_showAlert("Illegal " + attributeName + " [" + attributeValue + "]", "Error");
								return;
							}
						} else {
							attributeValue = escapeTextToHtml(attributeValue);
						}

						// Add the attribute
						var currentAttribute = {};
						currentAttribute.attributeName = attributeName;
						currentAttribute.attributeValue = attributeValue;
						test.attributes.push(currentAttribute);
					}

					// Add the test to the list of tests
					tests.push(test);
				}

				// Preparation for adding the test attributes - save for each attribute a multiple choice flag
				var multipleChoiceFlags = {
					"Priority": true,
					"Repeat": true,
					"Virtual Combination": true
				};
				$('#tblScenarios thead').find('#trColumnNames th[data-customized-attribute-id]').each(function() {
					var attributeName = $(this).attr('data-customized-attribute-name');
					var multipleChoiceAsString = $(this).attr('data-multiple-choice');
					var multipleChoice = BooleanUtilityFunctions_StringToBoolean(multipleChoiceAsString);
					multipleChoiceFlags[attributeName] = multipleChoice;
				});

				// Add the tests (reverse order so they'll be added in the order in the CSV file)
				for (var testIndex = tests.length - 1; testIndex >= 0; testIndex--) {

					// Get the current test
					var currentTest = tests[testIndex];

					// Add the test
					var addedRow = testRepository_addNewTestRow(currentTest.testName, currentTest.category);

					// Set attribute values
					var attributes = currentTest.attributes;
					for (var attributeIndex = 0; attributeIndex < attributes.length; attributeIndex++) {

						// Get the current attribute
						var currentAttribute = attributes[attributeIndex];
						
						// Get the current attribute name and attribute value
						var attributeName = currentAttribute.attributeName;
						var attributeValue = currentAttribute.attributeValue;

						// Update the attribute
						var attributeCellId = 'td' + replaceAll(attributeName, " ", "");
						$("#" + attributeCellId).html(attributeValue);
					}
				}

			} catch (ex) {

				UIUtility_showAlert("Invalid CSV file: " + ex, "Error");
				console.error(ex);
			}
		}

		reader.readAsText(file);
	} 
}

function testRepository_addNewTestRow(testName, category) {
	
	// Prepare the added test as JSON
	var newTestObj = {};
	newTestObj.id = 0;
	newTestObj.scenarioVirtualCombinationId = 0;
	newTestObj.name = testName;
	newTestObj.categoryName = category;
	newTestObj.virtualCombinationId = 0;
	newTestObj.pririty = 0;
	newTestObj.repeat = 1;
	newTestObj.comment = '';
	
	// Add the new row
	var appendToLast = false;
	var addedRow = testRepository_renderScenario(newTestObj, appendToLast);

	// Indicate that the new row is dirty
	testManagement_markRowAsDirty(addedRow.find("td:first"));

	return addedRow;
}

function testRepository_addTest_confirm(testName, category) {

	// Add the new row
	var addedRow = testRepository_addNewTestRow(testName, category);

	// Refresh filters
	prepareTableFiltersExt('tblScenarios', false);

	// Close the dialog
	$('#addNewTestDialog').dialog('close');
}

function testRepository_deleteTest(selectedTestIdsAsJsonString) {

	// Extract the selected test ids
	var selectedTestIds = selectedTestIdsAsJson.testIdsToDelete;
	
	// Iterate over the selected test ids and remove from the table
	for (var selectedTestIdIndex = 0; selectedTestIdIndex < selectedTestIds.length; selectedTestIdIndex++) {
		// Extract the current test id
		var currentTestId = selectedTestIds[selectedTestIdIndex];
		
		// Remove the row
		var theRow = $('#tblScenarios tbody tr[data-scenario-id^="' + currentTestId + '"]');
		theRow.remove();
	}
	
	// Close the dialog
	$('#deleteTestsConfirmDialog').dialog('close');
}

function testRepository_onNewTest() {

	// Clear previous errors
	$('#addNewTestDialog').find('#lblErrorDescription').html();
	$('#addNewTestDialog').find('#trError').attr('class', 'inactive');
	
	// Show a popup in which the user shall specify the test name & category
	$('#addNewTestDialog').dialog('open');
}

function testRepository_onNewTest_confirm() {

	// Clear previous errors
	$('#addNewTestDialog').find('#trError').attr('class', 'inactive');
	$('#addNewTestDialog').find('#lblErrorDescription').html('');
	
	// Make sure that the test name is not empty
	var testName = $('#addNewTestDialog').find('#txtTestName').val();
	if (isStringEmpty(testName)) {
		$('#addNewTestDialog').find('#lblErrorDescription').html('The Test Name is missing');
		$('#addNewTestDialog').find('#trError').attr('class', '');
		
		return;
	}
	
	// Make sure that the category is not empty
	var category = getValueFromElement($('#addNewTestDialog').find('#txtCategory'));
	if (isStringEmpty(category)) {
		$('#addNewTestDialog').find('#lblErrorDescription').html('The Category is missing');
		$('#addNewTestDialog').find('#trError').attr('class', '');
		
		return;
	}
	
	// Add the new test
	testRepository_addTest_confirm(testName, category);
}

function testRepository_onDeleteTests() {

	// Collect the selected test ID's
	var selectedTestIds = getSelectedAttributeValuesAsArray('tblScenarios', 'data-scenario-virtual-combination-id');
	
	// If the list is empty show an error message
	if (selectedTestIds.length == 0) {
		// Show error dialog
		UIUtility_showAlert("Please select tests to delete", "Error");
	} else {
		// Clear previous errors
		$('#deleteTestsConfirmDialog').find('#lblErrorMessage').html('');
		
		// Populate the message content (how many tests were selected)
		$('#deleteTestsConfirmDialog').find('#lblMessage').html('You are about to delete ' + selectedTestIds.length + ' test(s).<br><br>Please confirm.');
		
		// Show the confirm dialog
		$('#deleteTestsConfirmDialog').dialog('open');
	}
}

function testRepository_onDeleteTests_confirm() {
	
	var selectedRows = getSelectedRows($('#tblScenarios'));	
	
	// Go over the selected rows
	for (var rowIndex = 0; rowIndex < selectedRows.length; rowIndex++) {
	
		var currentRow = selectedRows[rowIndex];
		
		// Get the scenario ID and the scenario virtual combination ID
		var currentScenarioId = $(currentRow).attr('data-scenario-id');
		var currentScenarioVirtualCombinationId = $(currentRow).attr('data-scenario-virtual-combination-id');
	
		// Add the scenario ID and the scenario virtual combination ID to the sets of tests to delete
		globalScenarioIdsToDelete.push(currentScenarioId);
		globalScenarioVirtualCombinationIdsToDelete.push(currentScenarioVirtualCombinationId);
		
		// Remove the row
		currentRow.remove();
	}

	// Refresh row counts
	filter_refreshNumberOfSelectedRows($("#tblScenarios"));

	// Hide the delete tests dialog
	$('#deleteTestsConfirmDialog').dialog('close');

	// Regroup by categories
	testRepository_GroupTestsOfSameCategory();
}

function testRepository_onSetScenariosProperty(callingElement, propertyName, multipleChoice) {

	// Get the row of the calling element
	callingElement = $(callingElement);
	var row = callingElement.parents('tr:eq(0)');

	// Get the value to set
	var propertyValue = '';
	if (multipleChoice) {

		// Get the name value and not the ID attached to the value attribute
		propertyValue = callingElement.find("option:selected").text().trim();

		// Reset the select element
		callingElement.get(0).selectedIndex = 0;
	
	} else {

		var txtElement = row.find('#txt' + propertyName);
		propertyValue = getValueFromElement(txtElement);

		// Reset the text element
		txtElement.val('');
	}

	// Get the selected rows
	var selectedRows = getContainingTableSelectedRows(callingElement);

	// Set the values in all the rows
	for (var rowIndex = 0; rowIndex < selectedRows.length; rowIndex++) {

		var currentRow = $(selectedRows[rowIndex]);

		currentRow.find('#td' + propertyName).html(propertyValue);

		// Mark the row as dirty
		testManagement_markRowAsDirty(currentRow.find("td:first"));
	}
}

function testRepository_setTestCustomizedAttributeText(callingElement) {
	var attributeName = $(callingElement).parent().attr('data-customized-attribute-name');
	UIUtility_showConfirmDialog("Please set value for " + attributeName + "<br/><input type='text' id='txtAttributeValue' style='width: 100%;'></input>",
		"Set Attribute Value", function () {
			testRepository_setTestCustomizedAttribute(callingElement, $("#txtAttributeValue").val());
		});
}

function testRepository_setTestCustomizedAttribute(callingElement, value) {

	// Get the parent cell (where all the information about the customized attribute is)
	var cell = $(callingElement).parents('th:eq(0)');
	
	// Get the customized attribute information
	var customizedAttributeName = $(cell).attr('data-customized-attribute-name');
	var multipleChoiceAsString = $(cell).attr('data-multiple-choice');
	var multipleChoice = BooleanUtilityFunctions_StringToBoolean(multipleChoiceAsString);
	
	// Get the customized attribute value
	var customizedAttributeValue = "";
	if (multipleChoice) {
		// Get the value from the select element
		var slctElementName = 'slct' + customizedAttributeName;
		var slctElement = $(cell).find('#' + slctElementName);
		customizedAttributeValue = getTextFromElement(slctElement).trim();

		$(slctElement).get(0).selectedIndex = 0;
	} else {
		customizedAttributeValue = value;
	}

	// Get the selected rows and from them the selected agent ID's
	var table = $(cell).parents('table:eq(0)');
	var selectedRows = getSelectedRows(table);
	
	// Go over the selected rows and update the cells
	for (var rowIndex = 0; rowIndex < selectedRows.length; rowIndex++) {

		// Get the current row
		var currentRow = $(selectedRows[rowIndex]);

		// Get the relevant cell
		currentRow.find('#td' + customizedAttributeName).html(customizedAttributeValue);

		// Mark row as dirty
		testManagement_markRowAsDirty(currentRow.find("td:first"));
	}
}

function testRepository_save() {

	// Confirm
	UIUtility_showConfirmDialog("You are about to make changes to the test repository. Are you sure?", "Save", testRepository_save_confirm);
}

function testRepository_save_confirm() {

	pageLoading();
	
	// Collect the information from all the dirty rows
	var toSave = {};
	toSave["testVersionId"] = globalTestVersionId;
	toSave['tests'] = [];
	toSave['testCustomizedAttributes'] = [];
	$('#tblScenarios tbody tr').each(function() {

		// If the row is dirty
		if ($(this).is('[data-dirty]')) {
		
			// Add data object for the scenario
			var scenarioData = {};
			toSave['tests'].push(scenarioData);

			// Get the scenario ID
			var scenarioId = $(this).attr('data-scenario-id');
			scenarioData.id = scenarioId;

			// Get the scenario virtual combination ID
			var scenarioVirtualCombinationId = $(this).attr('data-scenario-virtual-combination-id');
			scenarioData.scenarioVirtualCombinationId = scenarioVirtualCombinationId;

			// Get all the scenario data from the row
			var scenarioName = $(this).find('#tdScenarioName').text();
			scenarioData.name = scenarioName;
			var category = $(this).find('#tdCategory').text();
			scenarioData.categoryName = category;
			var priority = $(this).find('#tdPriority').text();
			scenarioData.priority = priority;
			var repeat = $(this).find('#tdRepeat').text();
			scenarioData.repeat = repeat;
			var virtualCombinationId = testRepository_getVCIdByName($(this).find('#tdVirtualCombination').text());
			scenarioData.virtualCombinationId = virtualCombinationId;

			// Legacy
			scenarioData.comment = "";

			// Add test customized attributes 
			$(this).find('[data-customized-attribute-name]').each(function() {

				// The data object
				var testCustomizedAttribute = {};
				toSave['testCustomizedAttributes'].push(testCustomizedAttribute);
				// Use the scenario name and not the scenario virtual combination ID cause new scenarios do not have an ID yet
				testCustomizedAttribute.scenarioName = scenarioName;

				// Get the attribute name
				var currentAttributeName = $(this).attr('data-customized-attribute-name');
				testCustomizedAttribute.customizedAttributeName = currentAttributeName;

				// Get the attribute value
				var currentAttributeValue = replaceAll($(this).html(), "<br>", "\n");
				testCustomizedAttribute.customizedAttributeValue = currentAttributeValue;
			});
		} 
	});

	// Add scenario ID's and scenario virtual combination ID's to delete
	toSave['scenarioIdsToDelete'] = globalScenarioIdsToDelete;
	toSave['scenarioVirtualCombinationIdsToDelete'] = globalScenarioVirtualCombinationIdsToDelete;

	// Post
	var link = '/tasks/saveTestRepository';
	var async = true;
	PostJsonWithJsonFeedbackFuncs(link, async, toSave, testRepository_save_success, testRepository_save_failure);
}

function testRepository_save_success(jsonResponse) {

	// Reset the lists of tests to delete
	globalScenarioIdsToDelete = [];
	globalScenarioVirtualCombinationIdsToDelete = [];
	
	// Update the scenario virtual combination ID of the new scenarios
	var newTests = jsonResponse.newTests;
	$.each(newTests, function(scenarioVirtualCombinationId, currentNewTest) {
		
		// Get the scenario information
		var scenarioId = currentNewTest.id;
		var scenarioName = currentNewTest.name;
		var virtualCombinationId = currentNewTest.virtualCombinationId;
		
		// Search for the new row by the scenario name
		var newTestRow = $('#tblScenarios tbody [data-scenario-name="' + scenarioName + '"]')
		
		// Update the scenario virtual combination ID
		$(newTestRow).attr('id', scenarioVirtualCombinationId);
		$(newTestRow).attr('data-scenario-virtual-combination-id', scenarioVirtualCombinationId);
		$(newTestRow).attr('data-scenario-id', scenarioId);
		$(newTestRow).attr('data-virtual-combination-id', virtualCombinationId);
	});

	// Remove the dirty row indication from all the rows
	$('#tblScenarios tbody tr').each(function() {
		$(this).removeAttr('data-dirty');
		$(this).removeClass('TestManagementDifferentFromDefault');
	});

	pageFinishedLoading();
	
	UIUtility_showAlert('Test repository was saved successfully', 'Save');
}

function testRepository_save_failure(responseText) {

	pageFinishedLoading();

	UIUtility_showAlert('Failed to save changes in the test repository: ' + responseText, 'Save');
}

function testRepository_renderTestCustomizedAttributes() {

	var testCustomizedAttributesJsonArr = globalScenariosData.testCustomizedAttributes;

	if (testCustomizedAttributesJsonArr != undefined) {
	
		// Go over all the rows and test customized attribute cells
		$('#tblScenarios tbody tr').each(function() {

			// Get the scenario virtual combination ID
			var scenarioVirtualCombinationId = $(this).attr('data-scenario-virtual-combination-id');

			// Get the test customized attributes for the scenario virtual combination ID
			var currentTestAttributes = {};
			if (scenarioVirtualCombinationId in testCustomizedAttributesJsonArr) {
				currentTestAttributes = testCustomizedAttributesJsonArr[scenarioVirtualCombinationId];
			}

			// Go over the cells
			$(this).find('[data-customized-attribute-name]').each(function() {

				// Get the test customized attribute name and whether it's multiple choice
				var currentAttributeName = $(this).attr('data-customized-attribute-name');
				var multipleChoiceAsString = $(this).attr('data-multiple-choice');
				var multipleChoice = BooleanUtilityFunctions_StringToBoolean(multipleChoiceAsString);

				// Get the test customized attribute value
				var currentAttributeValue = '';
				if (currentAttributeName in currentTestAttributes) {
					currentAttributeValue = currentTestAttributes[currentAttributeName];
				}

				// Append to the cell
				$(this).append(currentAttributeValue);
			});
		});
	}
}

function testRepository_prepareAttributeTextHtml(attributeName, value) {
	return '<textarea data-attribute="' + attributeName + '" style="width: 99%;">' + (value == undefined ? "" : value) + '</textarea>';
}

function testRepository_prepareAttributeSelectHtml(attributeName, value) {
	var html = '<select data-attribute="' + attributeName + '" style="width: 100%;">';
	for (var valueIndex = 0; valueIndex < globalCustomizedAttributeValues[attributeName].length; valueIndex++) {
		var currentValue = globalCustomizedAttributeValues[attributeName][valueIndex];
		html += '<option value="' + currentValue + '" ';
		if (currentValue == value) {
			html += 'selected="selected" ';
		}
		html += '>' + currentValue + '</option>';
	}
	html += '</select>';
	return html;
}

function testRepository_prepareVCSelectHtml(selectedVCId) {
	var html = '<select id="slctVirtualCombination" style="width: 100%;">';
	var virtualCombinationNames = globalVirtualCombinationsContainer.virtualCombinationNames;
	for (var virtualCombinationIndex = 0; virtualCombinationIndex < virtualCombinationNames.length; virtualCombinationIndex++) {
		// The current virtual combination
		var virtualCombinationName = virtualCombinationNames[virtualCombinationIndex];
		var virtualCombination = globalVirtualCombinationsContainer.virtualCombinations[virtualCombinationName];

		// Add the option
		html += '<option value="' + virtualCombination.virtualCombinationId + '" ';
		if (selectedVCId != undefined && selectedVCId == virtualCombination.virtualCombinationId) {
			html += 'selected="selected" ';
		}
		html += '>' + virtualCombination.virtualCombinationName + '</option>';
	}
	html += '</select>';
	return html;
}

function testRepository_renderRepository() {

	// Add / Update / Remove test customized attribute columns
	var testRepository = true;
	var configurationScenarioTemplateRowAsHtml = '';
	testRepository_renderHeaderRowVirtualCombinations();
	renderTestCustomizedAttributeColumns(testRepository, configurationScenarioTemplateRowAsHtml);

	var scenarioVirtualCombinationIds = globalScenariosData.scenarioVirtualCombinationIds;
	
	// Indicates that all scenarios will be added to the last of the table
	var appendScenarioToLast = true;
	
	// Iterate over the scenario virtual combinations
	for (var scenarioVirtualCombinationIndex = 0; scenarioVirtualCombinationIndex < scenarioVirtualCombinationIds.length; scenarioVirtualCombinationIndex++) {
	
		// The current scenario virtual combination id
		var scenarioVCId = scenarioVirtualCombinationIds[scenarioVirtualCombinationIndex];
		
		var configurationScenarioToRender = globalScenariosData[scenarioVCId];
		
		// Render the configuration scenario
		testRepository_renderScenario(configurationScenarioToRender, appendScenarioToLast);
	}

	testRepository_GroupTestsOfSameCategory();
}

function testRepository_renderHeaderRowVirtualCombinations() {

	// Get the virtual combination names
	var virtualCombinationNames = globalVirtualCombinationsContainer.virtualCombinationNames;

	// Virtual combination
	var vitualCombinationsHtml = '';
	vitualCombinationsHtml += '<option value="">Set Virtual Combination...</option>';
	for (var virtualCombinationIndex = 0; virtualCombinationIndex < virtualCombinationNames.length; virtualCombinationIndex++) {
		// The current virtual combination	
		var virtualCombinationName = virtualCombinationNames[virtualCombinationIndex];
		var virtualCombination = globalVirtualCombinationsContainer.virtualCombinations[virtualCombinationName];
		// Add the option
		vitualCombinationsHtml += ('<option value="' + virtualCombination.virtualCombinationId + '">' + virtualCombination.virtualCombinationName + '</option>');
	}

	// Set the HTML
	$('#tblScenarios').find('#trActionOnSelected').find('#slctVirtualCombination').html(vitualCombinationsHtml);
}

function testRepository_renderScenario(scenarioToRender, appendToLast) {

	// Get the scenario virtual combination ID
	var scenarioVirtualCombinationId = scenarioToRender.scenarioVirtualCombinationId;

	// Build the row ID 
	var rowId = scenarioVirtualCombinationId;

	// The row HTML
	var rowHtml = '';

	// Create the row and its attributes
	rowHtml += '<tr id="' + rowId + '" '; 
	rowHtml += 'data-scenario-virtual-combination-id="' + scenarioToRender.scenarioVirtualCombinationId + '" ';
	rowHtml += 'data-scenario-id="' + scenarioToRender.id + '" ';
	rowHtml += 'data-scenario-name="' + scenarioToRender.name + '" ';
	rowHtml += 'data-virtual-combination-id="' + scenarioToRender.virtualCombinationId + '" ';
	rowHtml += 'onclick="if (!($(event.target).is(\'#tdCategory\'))) { $(this).find(\'#chkSelect\').click(); }" ';
	rowHtml += 'style="cursor: pointer;" ';
	rowHtml += '>';

	// Add category
	rowHtml += '<td id="tdCategory" class="cell-white-no-hover cell-light-right-border" style="word-break: break-all; vertical-align: top; cursor: default;" '
		+ 'onmouseover="testRepository_HoverCategory($(this));" onmouseout="testRepository_UnhoverCategory($(this));">'
		+ scenarioToRender.categoryName + '</td>';

	// Add hidden element with the scenario ID
	rowHtml += '<td id="tdSelect" name="tdSelect" data-csv-exclude style="white-space: nowrap;">';
	rowHtml += '<input type="checkbox" id="chkSelect" name="chkSelect" onclick="event.stopPropagation();" />';
	rowHtml += '<input type="hidden" id="hdnID" value="' + scenarioToRender.id + '" />';
	rowHtml += '&nbsp;<button id="editButton" onclick="testRepository_editTest($(this).closest(\'tr\')); event.stopPropagation();"></button>';
	rowHtml += '</td>';

	// Add scenario name
	rowHtml += ('<td id="tdScenarioName" style="white-space: nowrap;">' + scenarioToRender.name + '</td>');

	// Priority
	var isShowAdvanced = $("#btnShowAdvanced").prop("checked");
	rowHtml += ('<td id="tdPriority" data-advanced ' + (isShowAdvanced ? '' : 'class="inactive-force"') + '>' + scenarioToRender.priority + '</td>');

	// Repeat
	rowHtml += ('<td id="tdRepeat" data-advanced ' + (isShowAdvanced ? '' : 'class="inactive-force"') + '>' + scenarioToRender.repeat + '</td>');

	// Radars
	if (isEnableTestRadarsFeature()) {
		var filter = "";
		var radarsHtml = "";
		if (scenarioToRender.radars != undefined) {
			for (var i = 0; i < scenarioToRender.radars.length; i++) {
				if (i > 0) {
					radarsHtml += ", ";
					filter += ";";
				}
				radarsHtml += "<a href='rdar://problem/" + scenarioToRender.radars[i] + "'>" + scenarioToRender.radars[i] + "</a>";
				filter += scenarioToRender.radars[i];
			}
		}
		rowHtml += '<td id="tdRadars" style="white-space: nowrap" data-filter-values="' + filter + '">' + radarsHtml + '</td>';
	}

	// Get all virtual combination pairs
	var virtualCombinationNames = globalVirtualCombinationsContainer.virtualCombinationNames;

	// Virtual combination
	rowHtml += '<td id="tdVirtualCombination">' + testRepository_getVCNameById(scenarioToRender.virtualCombinationId) + '</td>';

	// Get the test customized attributes data
	var testCustomizedAttributesJsonArr = globalScenariosData.testCustomizedAttributes;
	var currentTestAttributes = {};
	if (undefined != testCustomizedAttributesJsonArr && scenarioVirtualCombinationId in testCustomizedAttributesJsonArr) {
		currentTestAttributes = testCustomizedAttributesJsonArr[scenarioVirtualCombinationId];
	}
	
	// Add columns for the customized attributes
	$('#tblScenarios thead').find('#trColumnNames th[data-customized-attribute-name]').each(function() {

		// Get the test customized attribute name and whether it's multiple choice
		var currentAttributeName = $(this).attr('data-customized-attribute-name');
		var currentMultipleChoiceAsString = $(this).attr('data-multiple-choice');

		// Add the cell
		var cellHtml = '';
		cellHtml += ('<td id="td' + currentAttributeName + '" ');
		cellHtml += ('data-customized-attribute-name="' + currentAttributeName + '" data-multiple-choice="' + currentMultipleChoiceAsString + '" ');

		// Get the test customized attribute value
		var currentAttributeValue = '';
		if (currentAttributeName in currentTestAttributes) {
			currentAttributeValue = currentTestAttributes[currentAttributeName];
		}

		// Add value to HTML
		cellHtml += '>' + escapeTextToHtml(currentAttributeValue) + '</td>';

		// Concatinate to the row HTML
		rowHtml += cellHtml;
	});
	
	// Close the row
	rowHtml += ('</tr>');
	
	// Get the number of rows in the tbody
	var numOfRows = $('#tblScenarios tbody tr').length;
	
	// Add the row
	if (appendToLast || numOfRows == 0) {
		// Add the template row before the last row
		$('#tblScenarios tbody').append(rowHtml);
	} else {
		// Add the template row to the first row
		$('#tblScenarios tbody tr:first').before(rowHtml);
	}

	// Get the row
	var row = $('#' + rowId);

	// Initialize edit button
	var editButton = row.find("#editButton");
	UIUtility_initializeButtonWithSelector(editButton, 'ui-icon-pencil');
	UIUtility_setSmallButtonPadding(editButton);

	if (!appendToLast) {
		testRepository_GroupTestsOfSameCategory();
	}
	
	return row;
}

function testRepository_getVCIdByName(reqVCName) {
	var virtualCombinationNames = globalVirtualCombinationsContainer.virtualCombinationNames;
	for (var virtualCombinationIndex = 0; virtualCombinationIndex < virtualCombinationNames.length; virtualCombinationIndex++) {
		var virtualCombinationName = virtualCombinationNames[virtualCombinationIndex];
		var virtualCombination = globalVirtualCombinationsContainer.virtualCombinations[virtualCombinationName];
		if (reqVCName == virtualCombinationName) {
			return virtualCombination.virtualCombinationId;
		}
	}
	return undefined;
}

function testRepository_getVCNameById(reqVCId) {
	var virtualCombinationNames = globalVirtualCombinationsContainer.virtualCombinationNames;
	for (var virtualCombinationIndex = 0; virtualCombinationIndex < virtualCombinationNames.length; virtualCombinationIndex++) {
		var virtualCombinationName = virtualCombinationNames[virtualCombinationIndex];
		var virtualCombination = globalVirtualCombinationsContainer.virtualCombinations[virtualCombinationName];
		if (reqVCId == virtualCombination.virtualCombinationId) {
			return virtualCombinationName;
		}
	}
	return undefined;
}

function testRepository_showChangeLog() {

	// Get the show change log form
	var showChangeLogForm = $('#frmShowChangeLog');

	// Update the entity ID
	setValueOfElement($(showChangeLogForm).find('#hdnEntityId'), globalTestVersionId);
	
	// Submit
	$(showChangeLogForm).submit();
}

function testRepository_editTest(row) {
	// Extract information if not a new row
	var testName = "";
	var category = "";
	var priority = 0;
	var repeat = 1;
	var vcId = undefined;
	if (row != undefined) {
		testName = row.find("#tdScenarioName").text();
		category = row.find("#tdCategory").text();
		priority = row.find("#tdPriority").text();
		repeat = row.find("#tdRepeat").text();
		vcId = testRepository_getVCIdByName(row.find("#tdVirtualCombination").text());
	}

	// Build current category options HTML
	var categoryOptionsArr = new Array();
	var categoryOptionsObj = new Object();
	$("#tblScenarios > tbody > tr > td[id='tdCategory']").each(function () {
		var curCategory = $(this).text();
		if (categoryOptionsObj[curCategory] == undefined) {
			categoryOptionsObj[curCategory] = true;
			categoryOptionsArr.push(curCategory);
		}
	});

	// Base parameters
	var html = "<table id='editTestTable'>";
	html += "<tr><td>Category:</td><td><input id='txtCategory' value='" + category + "' style='width: 99%;'></input></td></tr>";
	html += "<tr><td>Test Name:</td><td><input type='text' id='txtTestName' value='" + testName + "' style='width: 99%;'></input></td></tr>";
	html += "<tr><td>Priority:</td><td><input type='text' id='txtPriority' value='" + (priority == undefined ? "" : priority) + "' style='width: 50px;'></input></td></tr>";
	html += "<tr><td>Repeat:</td><td><input type='text' id='txtRepeat' value='" + (repeat == undefined ? "" : repeat) + "' style='width: 50px;'></input></td></tr>";
	html += "<tr><td>Virtual Combination:</td><td class='small-selectize'>" + testRepository_prepareVCSelectHtml(vcId) + "</td></tr>";

	// Customized attributes
	$("#tblScenarios > thead > #trColumnNames > th[data-customized-attribute-id]").each(function () {
		var th = $(this);
		var attributeId = th.attr('data-customized-attribute-id');
		var attributeName = th.attr('data-customized-attribute-name');
		var multipleChoice = th.attr('data-multiple-choice');
		var attributeValue = (row == undefined ? "" : row.find("#td" + attributeName).html());
		html += "<tr><td>" + attributeName + ":</td>";
		if (multipleChoice == "true") {
			html += "<td class='small-selectize'>" + testRepository_prepareAttributeSelectHtml(attributeName, attributeValue) + "</td>";
		} else {
			// Replace <br>s with \n
			attributeValue = replaceAll(attributeValue, "<br>", "\n");

			html += "<td>" + testRepository_prepareAttributeTextHtml(attributeName, attributeValue) + "</td>";
		}
		html += "</tr>";
	});

	UIUtility_showConfirmDialog(html, (row == undefined ? "New Test" : "Edit Test"), function () {
		// Extract from dialog
		var editTestTable = $("#editTestTable");
		var testName = escapeTextToHtml(editTestTable.find("#txtTestName").val());
		var category = editTestTable.find("#txtCategory").val();
		var vcId = editTestTable.find("#slctVirtualCombination").val();
		var priority = editTestTable.find("#txtPriority").val();
		var repeat = editTestTable.find("#txtRepeat").val();

		// Validate
		if (isStringEmpty(testName)) {
			UIUtility_showAlert("Please enter a name for the test", "Error");
			return;
		}
		if (isStringEmpty(category)) {
			UIUtility_showAlert("Please enter a category", "Error");
			return;
		}
		if (vcId == 0) {
			UIUtility_showAlert("Please pick a virtual combination", "Error");
			return;
		}
		if (!editTestTable.find("#txtPriority").spinner("isValid")) {
			UIUtility_showAlert("Invalid priority entered", "Error");
			return;
		}
		if (!editTestTable.find("#txtRepeat").spinner("isValid")) {
			UIUtility_showAlert("Invalid repeat entered", "Error");
			return;
		}

		if (row == undefined) {
			// Add new row
			var newTestObj = {};
			newTestObj.id = 0;
			newTestObj.scenarioVirtualCombinationId = 0;
			newTestObj.name = testName;
			newTestObj.categoryName = category;
			newTestObj.virtualCombinationId = vcId;
			newTestObj.priority = priority;
			newTestObj.repeat = repeat;

			// Legacy
			newTestObj.comment = '';

			row = testRepository_renderScenario(newTestObj, false);

			FilterTable_AddRowFilterInfo(row);
		} else {
			// Set common information
			row.find("#tdScenarioName").html(testName);
			row.find("#tdCategory").html(category);
			row.find("#tdVirtualCombination").html(testRepository_getVCNameById(vcId));
			row.find("#tdPriority").html(priority);
			row.find("#tdRepeat").html(repeat);
		}

		// Set attributes in row
		row.find("td[data-customized-attribute-name]").each(function () {
			var td = $(this);
			var attributeValue = editTestTable.find("[data-attribute='" + td.attr('data-customized-attribute-name') + "']").val();
			td.html(escapeTextToHtml(attributeValue));
		});

		// Regroup by category in case we changed the category
		testRepository_GroupTestsOfSameCategory();

		// Mark row as dirty
		testManagement_markRowAsDirty(row.find("td:first"));
	}, 800, 700);

	// Make table big
	var editTestTable = $("#editTestTable");
	editTestTable.css('width', '775px').find("tr").each(function () {
		var tr = $(this);
		tr.css('width', '100%');
		tr.find("td:first").css({ 'white-space': 'nowrap', 'vertical-align': 'top' });
		tr.find("td:last").css('width', '100%');
	});

	// Make table rows with some padding
	editTestTable.find("td").css('padding-bottom', '10px');

	// Make text areas auto size
	autosize(editTestTable.find("textarea"));

	// Make select boxes selectize
	editTestTable.find("select").selectize();

	// Make priority and repeat spinners
	editTestTable.find("#txtPriority").spinner({ min: 0, max: 9, numberFormat: "n" });
	editTestTable.find("#txtRepeat").spinner({ min: 1, max: 10, numberFormat: "n" });

	// Make categories autocomplete with current values
	editTestTable.find("#txtCategory").autocomplete({
		source: categoryOptionsArr,
		minLength: 0
	}).on('focus', function () {
	    $(this).autocomplete('search', '');
	});
}

function testRepository_GroupTestsOfSameCategory() {
	var firstTestTd = undefined;
	var lastCategory = undefined;
	var countOfLastCategory = 0;

	// Go through each visible test row
	$("#tblScenarios > tbody > tr:not(.inactive)").each(function () {
		// Extract some information
		var row = $(this);
		var currentCategory = row.find("#tdCategory").text();
		var isSameCategory = lastCategory == currentCategory;

		// Lets make use of this chance to make sure we have a border in the top row
		// We can't do it in CSS3 since first-child and first-of-type only work on all children
		if (firstTestTd == undefined) {
			row.css('border-top', '1px solid #000000');
		} else {
			row.css('border-top', '');
		}

		if (firstTestTd == undefined || !isSameCategory) {
			// First row of a category, make sure we see it and restart counting
			firstTestTd = row.find("> td:eq(0)");
			firstTestTd.removeClass("inactive-force").attr('rowspan', 1);
			countOfLastCategory = 1;
		} else {
			// We are not in the first row of this category, hide ourselves
			row.find("> td:eq(0)").addClass("inactive-force").attr('rowspan', 1);

			// Increase rowspan of first row for this category
			countOfLastCategory++;
			firstTestTd.attr('rowspan', countOfLastCategory);
		}

		// Update last category encountered
		lastCategory = currentCategory;
	});
}

function testRepository_HoverCategory(categoryTd) {
	var category = categoryTd.text();
	var rows = $("#tblScenarios > tbody > tr").filter(function () { return $(this).find("td:first").text() == category; });
	rows.css('background-color', '#f5f5f5 !important');
	rows.find("#tdCategory").removeClass("cell-white-no-hover").addClass("cell-gray-hover");
}

function testRepository_UnhoverCategory(categoryTd) {
	var category = categoryTd.text();
	var rows = $("#tblScenarios > tbody > tr").filter(function () { return $(this).find("td:first").text() == category; });
	rows.css('background-color', '');
	rows.find("#tdCategory").removeClass("cell-gray-hover").addClass("cell-white-no-hover");
}

function testRepository_syncToGit() {
	PostJsonWithJsonFeedbackFuncs('/tests/repository/sync', true, {},
		function () {
			reloadPage();
		},
		function (err) {
			UIUtility_showAlert(err, "Error");
		});
}
_application/javascript_fhttps://hdc-lm-dsi.euro.apple.com:9000/assets/javascripts/testrepositoryjs/TestRepositoryManagement.js’[\]^O€bplist00‘klX$versionX$objectsY$archiverT$top Ü†Ø #)*0123MNOPQRSTUVWXYZ[\]^_`aefU$null›	
 !"R$6S$10R$2R$7R$3S$11R$8V$classR$4R$9R$0R$5R$1Ä	ÄÄÄ ÄÄÄÄ”$%'(WNS.base[NS.relativeÄ ÄÄ_Qhttps://hdc-lm-dsi.euro.apple.com:9000/assets/javascripts/ui-controls/autosize.js“+,-.Z$classnameX$classesUNSURL¢-/XNSObject#Aø±ÆbåÍ »”456ALWNS.keysZNS.objects™789:;<=>?@Ä	Ä
ÄÄÄÄÄÄÄÄ™BCDEFGHIJKÄÄÄÄÄÄÄÄÄÄÄTEtag\Content-Type]Last-Modified_Strict-Transport-Security]Accept-RangesTDate_Content-Encoding^Content-Length]Cache-ControlTVary_*"7ec45ee02d86d74f2564f1ac10d48d05b2db0fe9"_%application/javascript; charset=UTF-8_Wed, 09 Mar 2016 05:53:50 GMT_max-age=2592000Ubytes_Tue, 07 Nov 2017 09:00:29 GMTTgzipT1590_public, max-age=3600_Accept-Encoding“+,bc_NSMutableDictionary£bd/\NSDictionary_application/javascript“+,gh_NSHTTPURLResponse£ij/_NSHTTPURLResponse]NSURLResponse_NSKeyedArchiver—mn_WebResourceResponseÄ    # - 2 7 Z ` { ~ Ç Ö à ã è í ô ú ü ¢ • ® ™ ¨ Æ ∞ ≤ ≥ µ ∑ π ª Ω ø ¡ » – ‹ ﬁ ‡ ‚6;FOUXajlnu}àìïóôõùü°£•ß≤¥∂∏∫ºæ¿¬ƒ∆»Õ⁄Ë*9GLy°¡”Ÿ˘˛,1GKXqväé¢∞¬≈€             o              ›OB/*!
	Autosize 2.0.0
	license: MIT
	http://www.jacklmoore.com/autosize
*/
(function (root, factory) {
	'use strict';

	if (typeof define === 'function' && define.amd) {
		// AMD. Register as an anonymous module.
		define([], factory);
	} else if (typeof exports === 'object') {
		// Node. Does not work with strict CommonJS, but
		// only CommonJS-like environments that support module.exports,
		// like Node.
		module.exports = factory();
	} else {
		// Browser globals (root is window)
		root.autosize = factory();
  }
}(this, function () {
	function main(ta) {
		if (!ta || !ta.nodeName || ta.nodeName !== 'TEXTAREA' || ta.hasAttribute('data-autosize-on')) { return; }

		var maxHeight;
		var heightOffset;

		function init() {
			var style = window.getComputedStyle(ta, null);

			if (style.resize === 'vertical') {
				ta.style.resize = 'none';
			} else if (style.resize === 'both') {
				ta.style.resize = 'horizontal';
			}

			// horizontal overflow is hidden, so break-word is necessary for handling words longer than the textarea width
			ta.style.wordWrap = 'break-word';

			// Chrome/Safari-specific fix:
			// When the textarea y-overflow is hidden, Chrome/Safari doesn't reflow the text to account for the space
			// made available by removing the scrollbar. This workaround will cause the text to reflow.
			var width = ta.style.width;
			ta.style.width = '0px';
			// Force reflow:
			/* jshint ignore:start */
			ta.offsetWidth;
			/* jshint ignore:end */
			ta.style.width = width;

			maxHeight = style.maxHeight !== 'none' ? parseFloat(style.maxHeight) : false;
			
			if (style.boxSizing === 'content-box') {
				heightOffset = -(parseFloat(style.paddingTop)+parseFloat(style.paddingBottom));
			} else {
				heightOffset = parseFloat(style.borderTopWidth)+parseFloat(style.borderBottomWidth);
			}

			adjust();
		}

		function adjust() {
			var startHeight = ta.style.height;
			var htmlTop = document.documentElement.scrollTop;
			var bodyTop = document.body.scrollTop;
			
			ta.style.height = 'auto';

			var endHeight = ta.scrollHeight+heightOffset;

			if (maxHeight !== false && maxHeight < endHeight) {
				endHeight = maxHeight;
				if (ta.style.overflowY !== 'scroll') {
					ta.style.overflowY = 'scroll';
				}
			} else if (ta.style.overflowY !== 'hidden') {
				ta.style.overflowY = 'hidden';
			}

			ta.style.height = endHeight+'px';

			// prevents scroll-position jumping
			document.documentElement.scrollTop = htmlTop;
			document.body.scrollTop = bodyTop;

			if (startHeight !== ta.style.height) {
				var evt = document.createEvent('Event');
				evt.initEvent('autosize.resized', true, false);
				ta.dispatchEvent(evt);
			}
		}

		// IE9 does not fire onpropertychange or oninput for deletions,
		// so binding to onkeyup to catch most of those events.
		// There is no way that I know of to detect something like 'cut' in IE9.
		if ('onpropertychange' in ta && 'oninput' in ta) {
			ta.addEventListener('keyup', adjust);
		}

		window.addEventListener('resize', adjust);
		ta.addEventListener('input', adjust);

		ta.addEventListener('autosize.update', adjust);

		ta.addEventListener('autosize.destroy', function(style){
			window.removeEventListener('resize', adjust);
			ta.removeEventListener('input', adjust);
			ta.removeEventListener('keyup', adjust);
			ta.removeEventListener('autosize.destroy');

			Object.keys(style).forEach(function(key){
				ta.style[key] = style[key];
			});

			ta.removeAttribute('data-autosize-on');
		}.bind(ta, {
			height: ta.style.height,
			overflow: ta.style.overflow,
			overflowY: ta.style.overflowY,
			wordWrap: ta.style.wordWrap,
			resize: ta.style.resize
		}));

		ta.setAttribute('data-autosize-on', true);
		ta.style.overflow = 'hidden';
		ta.style.overflowY = 'hidden';

		init();		
	}

	// Do nothing in IE8 or lower
	if (typeof window.getComputedStyle !== 'function') {
		return function(elements) {
			return elements;
		};
	} else {
		return function(elements) {
			if (elements && elements.length) {
				Array.prototype.forEach.call(elements, main);
			} else if (elements && elements.nodeName) {
				main(elements);
			}
			return elements;
		};
	}
}));
_application/javascript_Qhttps://hdc-lm-dsi.euro.apple.com:9000/assets/javascripts/ui-controls/autosize.js’`abcOﬁbplist00‘klX$versionX$objectsY$archiverT$top Ü†Ø #)*0123MNOPQRSTUVWXYZ[\]^_`aefU$null›	
 !"R$6S$10R$2R$7R$3S$11R$8V$classR$4R$9R$0R$5R$1Ä	ÄÄÄ ÄÄÄÄ”$%'(WNS.base[NS.relativeÄ ÄÄ_Thttps://hdc-lm-dsi.euro.apple.com:9000/assets/javascripts/utilities/papaparse.min.js“+,-.Z$classnameX$classesUNSURL¢-/XNSObject#Aø±Æbå” »”456ALWNS.keysZNS.objects™789:;<=>?@Ä	Ä
ÄÄÄÄÄÄÄÄ™BCDEFGHIJKÄÄÄÄÄÄÄÄÄÄÄTEtag\Content-Type]Last-Modified_Strict-Transport-Security]Accept-RangesTDate_Content-Encoding^Content-Length]Cache-ControlTVary_*"ef22fdf95050356c13075403d15c6d9f4411ab56"_%application/javascript; charset=UTF-8_Wed, 06 Apr 2016 11:18:28 GMT_max-age=2592000Ubytes_Tue, 07 Nov 2017 09:00:30 GMTTgzipT5360_public, max-age=3600_Accept-Encoding“+,bc_NSMutableDictionary£bd/\NSDictionary_application/javascript“+,gh_NSHTTPURLResponse£ij/_NSHTTPURLResponse]NSURLResponse_NSKeyedArchiver—mn_WebResourceResponseÄ    # - 2 7 Z ` { ~ Ç Ö à ã è í ô ú ü ¢ • ® ™ ¨ Æ ∞ ≤ ≥ µ ∑ π ª Ω ø ¡ » – ‹ ﬁ ‡ ‚9>IRX[dmoqxÄãñòöúû†¢§¶®™µ∑πªΩø¡√≈«…À–›Î-<JO|§ƒ÷‹¸/4JN[tyçë•≥≈»ﬁ             o              ‡O8Ë/*!
	Papa Parse
	v4.1.2
	https://github.com/mholt/PapaParse
*/
!function(e){"use strict";function t(t,r){if(r=r||{},r.worker&&S.WORKERS_SUPPORTED){var n=f();return n.userStep=r.step,n.userChunk=r.chunk,n.userComplete=r.complete,n.userError=r.error,r.step=m(r.step),r.chunk=m(r.chunk),r.complete=m(r.complete),r.error=m(r.error),delete r.worker,void n.postMessage({input:t,config:r,workerId:n.id})}var o=null;return"string"==typeof t?o=r.download?new i(r):new a(r):(e.File&&t instanceof File||t instanceof Object)&&(o=new s(r)),o.stream(t)}function r(e,t){function r(){"object"==typeof t&&("string"==typeof t.delimiter&&1==t.delimiter.length&&-1==S.BAD_DELIMITERS.indexOf(t.delimiter)&&(u=t.delimiter),("boolean"==typeof t.quotes||t.quotes instanceof Array)&&(o=t.quotes),"string"==typeof t.newline&&(h=t.newline))}function n(e){if("object"!=typeof e)return[];var t=[];for(var r in e)t.push(r);return t}function i(e,t){var r="";"string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t));var n=e instanceof Array&&e.length>0,i=!(t[0]instanceof Array);if(n){for(var a=0;a<e.length;a++)a>0&&(r+=u),r+=s(e[a],a);t.length>0&&(r+=h)}for(var o=0;o<t.length;o++){for(var f=n?e.length:t[o].length,c=0;f>c;c++){c>0&&(r+=u);var d=n&&i?e[c]:c;r+=s(t[o][d],c)}o<t.length-1&&(r+=h)}return r}function s(e,t){if("undefined"==typeof e||null===e)return"";e=e.toString().replace(/"/g,'""');var r="boolean"==typeof o&&o||o instanceof Array&&o[t]||a(e,S.BAD_DELIMITERS)||e.indexOf(u)>-1||" "==e.charAt(0)||" "==e.charAt(e.length-1);return r?'"'+e+'"':e}function a(e,t){for(var r=0;r<t.length;r++)if(e.indexOf(t[r])>-1)return!0;return!1}var o=!1,u=",",h="\r\n";if(r(),"string"==typeof e&&(e=JSON.parse(e)),e instanceof Array){if(!e.length||e[0]instanceof Array)return i(null,e);if("object"==typeof e[0])return i(n(e[0]),e)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),e.data instanceof Array&&(e.fields||(e.fields=e.data[0]instanceof Array?e.fields:n(e.data[0])),e.data[0]instanceof Array||"object"==typeof e.data[0]||(e.data=[e.data])),i(e.fields||[],e.data||[]);throw"exception: Unable to serialize unrecognized input"}function n(t){function r(e){var t=_(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null),this._handle=new o(t),this._handle.streamer=this,this._config=t}this._handle=null,this._paused=!1,this._finished=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},r.call(this,t),this.parseChunk=function(t){if(this.isFirstChunk&&m(this._config.beforeFirstChunk)){var r=this._config.beforeFirstChunk(t);void 0!==r&&(t=r)}this.isFirstChunk=!1;var n=this._partialLine+t;this._partialLine="";var i=this._handle.parse(n,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var s=i.meta.cursor;this._finished||(this._partialLine=n.substring(s-this._baseIndex),this._baseIndex=s),i&&i.data&&(this._rowCount+=i.data.length);var a=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(y)e.postMessage({results:i,workerId:S.WORKER_ID,finished:a});else if(m(this._config.chunk)){if(this._config.chunk(i,this._handle),this._paused)return;i=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(i.data),this._completeResults.errors=this._completeResults.errors.concat(i.errors),this._completeResults.meta=i.meta),!a||!m(this._config.complete)||i&&i.meta.aborted||this._config.complete(this._completeResults),a||i&&i.meta.paused||this._nextChunk(),i}},this._sendError=function(t){m(this._config.error)?this._config.error(t):y&&this._config.error&&e.postMessage({workerId:S.WORKER_ID,error:t,finished:!1})}}function i(e){function t(e){var t=e.getResponseHeader("Content-Range");return parseInt(t.substr(t.lastIndexOf("/")+1))}e=e||{},e.chunkSize||(e.chunkSize=S.RemoteChunkSize),n.call(this,e);var r;this._nextChunk=k?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)return void this._chunkLoaded();if(r=new XMLHttpRequest,k||(r.onload=g(this._chunkLoaded,this),r.onerror=g(this._chunkError,this)),r.open("GET",this._input,!k),this._config.chunkSize){var e=this._start+this._config.chunkSize-1;r.setRequestHeader("Range","bytes="+this._start+"-"+e),r.setRequestHeader("If-None-Match","webkit-no-cache")}try{r.send()}catch(t){this._chunkError(t.message)}k&&0==r.status?this._chunkError():this._start+=this._config.chunkSize},this._chunkLoaded=function(){if(4==r.readyState){if(r.status<200||r.status>=400)return void this._chunkError();this._finished=!this._config.chunkSize||this._start>t(r),this.parseChunk(r.responseText)}},this._chunkError=function(e){var t=r.statusText||e;this._sendError(t)}}function s(e){e=e||{},e.chunkSize||(e.chunkSize=S.LocalChunkSize),n.call(this,e);var t,r,i="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,r=e.slice||e.webkitSlice||e.mozSlice,i?(t=new FileReader,t.onload=g(this._chunkLoaded,this),t.onerror=g(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input;if(this._config.chunkSize){var n=Math.min(this._start+this._config.chunkSize,this._input.size);e=r.call(e,this._start,n)}var s=t.readAsText(e,this._config.encoding);i||this._chunkLoaded({target:{result:s}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(t.error)}}function a(e){e=e||{},n.call(this,e);var t,r;this.stream=function(e){return t=e,r=e,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var e=this._config.chunkSize,t=e?r.substr(0,e):r;return r=e?r.substr(e):"",this._finished=!r,this.parseChunk(t)}}}function o(e){function t(){if(b&&d&&(h("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+S.DefaultDelimiter+"'"),d=!1),e.skipEmptyLines)for(var t=0;t<b.data.length;t++)1==b.data[t].length&&""==b.data[t][0]&&b.data.splice(t--,1);return r()&&n(),i()}function r(){return e.header&&0==y.length}function n(){if(b){for(var e=0;r()&&e<b.data.length;e++)for(var t=0;t<b.data[e].length;t++)y.push(b.data[e][t]);b.data.splice(0,1)}}function i(){if(!b||!e.header&&!e.dynamicTyping)return b;for(var t=0;t<b.data.length;t++){for(var r={},n=0;n<b.data[t].length;n++){if(e.dynamicTyping){var i=b.data[t][n];b.data[t][n]="true"==i||"TRUE"==i?!0:"false"==i||"FALSE"==i?!1:o(i)}e.header&&(n>=y.length?(r.__parsed_extra||(r.__parsed_extra=[]),r.__parsed_extra.push(b.data[t][n])):r[y[n]]=b.data[t][n])}e.header&&(b.data[t]=r,n>y.length?h("FieldMismatch","TooManyFields","Too many fields: expected "+y.length+" fields but parsed "+n,t):n<y.length&&h("FieldMismatch","TooFewFields","Too few fields: expected "+y.length+" fields but parsed "+n,t))}return e.header&&b.meta&&(b.meta.fields=y),b}function s(t){for(var r,n,i,s=[",","	","|",";",S.RECORD_SEP,S.UNIT_SEP],a=0;a<s.length;a++){var o=s[a],h=0,f=0;i=void 0;for(var c=new u({delimiter:o,preview:10}).parse(t),d=0;d<c.data.length;d++){var l=c.data[d].length;f+=l,"undefined"!=typeof i?l>1&&(h+=Math.abs(l-i),i=l):i=l}c.data.length>0&&(f/=c.data.length),("undefined"==typeof n||n>h)&&f>1.99&&(n=h,r=o)}return e.delimiter=r,{successful:!!r,bestDelimiter:r}}function a(e){e=e.substr(0,1048576);var t=e.split("\r");if(1==t.length)return"\n";for(var r=0,n=0;n<t.length;n++)"\n"==t[n][0]&&r++;return r>=t.length/2?"\r\n":"\r"}function o(e){var t=l.test(e);return t?parseFloat(e):e}function h(e,t,r,n){b.errors.push({type:e,code:t,message:r,row:n})}var f,c,d,l=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,p=this,g=0,v=!1,k=!1,y=[],b={data:[],errors:[],meta:{}};if(m(e.step)){var R=e.step;e.step=function(n){if(b=n,r())t();else{if(t(),0==b.data.length)return;g+=n.data.length,e.preview&&g>e.preview?c.abort():R(b,p)}}}this.parse=function(r,n,i){if(e.newline||(e.newline=a(r)),d=!1,!e.delimiter){var o=s(r);o.successful?e.delimiter=o.bestDelimiter:(d=!0,e.delimiter=S.DefaultDelimiter),b.meta.delimiter=e.delimiter}var h=_(e);return e.preview&&e.header&&h.preview++,f=r,c=new u(h),b=c.parse(f,n,i),t(),v?{meta:{paused:!0}}:b||{meta:{paused:!1}}},this.paused=function(){return v},this.pause=function(){v=!0,c.abort(),f=f.substr(c.getCharIndex())},this.resume=function(){v=!1,p.streamer.parseChunk(f)},this.aborted=function(){return k},this.abort=function(){k=!0,c.abort(),b.meta.aborted=!0,m(e.complete)&&e.complete(b),f=""}}function u(e){e=e||{};var t=e.delimiter,r=e.newline,n=e.comments,i=e.step,s=e.preview,a=e.fastMode;if(("string"!=typeof t||S.BAD_DELIMITERS.indexOf(t)>-1)&&(t=","),n===t)throw"Comment character same as delimiter";n===!0?n="#":("string"!=typeof n||S.BAD_DELIMITERS.indexOf(n)>-1)&&(n=!1),"\n"!=r&&"\r"!=r&&"\r\n"!=r&&(r="\n");var o=0,u=!1;this.parse=function(e,h,f){function c(e){b.push(e),S=o}function d(t){return f?p():("undefined"==typeof t&&(t=e.substr(o)),w.push(t),o=g,c(w),y&&_(),p())}function l(t){o=t,c(w),w=[],O=e.indexOf(r,o)}function p(e){return{data:b,errors:R,meta:{delimiter:t,linebreak:r,aborted:u,truncated:!!e,cursor:S+(h||0)}}}function _(){i(p()),b=[],R=[]}if("string"!=typeof e)throw"Input must be a string";var g=e.length,m=t.length,v=r.length,k=n.length,y="function"==typeof i;o=0;var b=[],R=[],w=[],S=0;if(!e)return p();if(a||a!==!1&&-1===e.indexOf('"')){for(var C=e.split(r),E=0;E<C.length;E++){var w=C[E];if(o+=w.length,E!==C.length-1)o+=r.length;else if(f)return p();if(!n||w.substr(0,k)!=n){if(y){if(b=[],c(w.split(t)),_(),u)return p()}else c(w.split(t));if(s&&E>=s)return b=b.slice(0,s),p(!0)}}return p()}for(var x=e.indexOf(t,o),O=e.indexOf(r,o);;)if('"'!=e[o])if(n&&0===w.length&&e.substr(o,k)===n){if(-1==O)return p();o=O+v,O=e.indexOf(r,o),x=e.indexOf(t,o)}else if(-1!==x&&(O>x||-1===O))w.push(e.substring(o,x)),o=x+m,x=e.indexOf(t,o);else{if(-1===O)break;if(w.push(e.substring(o,O)),l(O+v),y&&(_(),u))return p();if(s&&b.length>=s)return p(!0)}else{var I=o;for(o++;;){var I=e.indexOf('"',I+1);if(-1===I)return f||R.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:b.length,index:o}),d();if(I===g-1){var D=e.substring(o,I).replace(/""/g,'"');return d(D)}if('"'!=e[I+1]){if(e[I+1]==t){w.push(e.substring(o,I).replace(/""/g,'"')),o=I+1+m,x=e.indexOf(t,o),O=e.indexOf(r,o);break}if(e.substr(I+1,v)===r){if(w.push(e.substring(o,I).replace(/""/g,'"')),l(I+1+v),x=e.indexOf(t,o),y&&(_(),u))return p();if(s&&b.length>=s)return p(!0);break}}else I++}}return d()},this.abort=function(){u=!0},this.getCharIndex=function(){return o}}function h(){var e=document.getElementsByTagName("script");return e.length?e[e.length-1].src:""}function f(){if(!S.WORKERS_SUPPORTED)return!1;if(!b&&null===S.SCRIPT_PATH)throw new Error("Script path cannot be determined automatically when Papa Parse is loaded asynchronously. You need to set Papa.SCRIPT_PATH manually.");var t=S.SCRIPT_PATH||v;t+=(-1!==t.indexOf("?")?"&":"?")+"papaworker";var r=new e.Worker(t);return r.onmessage=c,r.id=w++,R[r.id]=r,r}function c(e){var t=e.data,r=R[t.workerId],n=!1;if(t.error)r.userError(t.error,t.file);else if(t.results&&t.results.data){var i=function(){n=!0,d(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},s={abort:i,pause:l,resume:l};if(m(r.userStep)){for(var a=0;a<t.results.data.length&&(r.userStep({data:[t.results.data[a]],errors:t.results.errors,meta:t.results.meta},s),!n);a++);delete t.results}else m(r.userChunk)&&(r.userChunk(t.results,s,t.file),delete t.results)}t.finished&&!n&&d(t.workerId,t.results)}function d(e,t){var r=R[e];m(r.userComplete)&&r.userComplete(t),r.terminate(),delete R[e]}function l(){throw"Not implemented."}function p(t){var r=t.data;if("undefined"==typeof S.WORKER_ID&&r&&(S.WORKER_ID=r.workerId),"string"==typeof r.input)e.postMessage({workerId:S.WORKER_ID,results:S.parse(r.input,r.config),finished:!0});else if(e.File&&r.input instanceof File||r.input instanceof Object){var n=S.parse(r.input,r.config);n&&e.postMessage({workerId:S.WORKER_ID,results:n,finished:!0})}}function _(e){if("object"!=typeof e)return e;var t=e instanceof Array?[]:{};for(var r in e)t[r]=_(e[r]);return t}function g(e,t){return function(){e.apply(t,arguments)}}function m(e){return"function"==typeof e}var v,k=!e.document&&!!e.postMessage,y=k&&/(\?|&)papaworker(=|&|$)/.test(e.location.search),b=!1,R={},w=0,S={};if(S.parse=t,S.unparse=r,S.RECORD_SEP=String.fromCharCode(30),S.UNIT_SEP=String.fromCharCode(31),S.BYTE_ORDER_MARK="Ôªø",S.BAD_DELIMITERS=["\r","\n",'"',S.BYTE_ORDER_MARK],S.WORKERS_SUPPORTED=!k&&!!e.Worker,S.SCRIPT_PATH=null,S.LocalChunkSize=10485760,S.RemoteChunkSize=5242880,S.DefaultDelimiter=",",S.Parser=u,S.ParserHandle=o,S.NetworkStreamer=i,S.FileStreamer=s,S.StringStreamer=a,"undefined"!=typeof module&&module.exports?module.exports=S:m(e.define)&&e.define.amd?define(function(){return S}):e.Papa=S,e.jQuery){var C=e.jQuery;C.fn.parse=function(t){function r(){if(0==a.length)return void(m(t.complete)&&t.complete());var e=a[0];if(m(t.before)){var r=t.before(e.file,e.inputElem);if("object"==typeof r){if("abort"==r.action)return void n("AbortError",e.file,e.inputElem,r.reason);if("skip"==r.action)return void i();"object"==typeof r.config&&(e.instanceConfig=C.extend(e.instanceConfig,r.config))}else if("skip"==r)return void i()}var s=e.instanceConfig.complete;e.instanceConfig.complete=function(t){m(s)&&s(t,e.file,e.inputElem),i()},S.parse(e.file,e.instanceConfig)}function n(e,r,n,i){m(t.error)&&t.error({name:e},r,n,i)}function i(){a.splice(0,1),r()}var s=t.config||{},a=[];return this.each(function(){var t="INPUT"==C(this).prop("tagName").toUpperCase()&&"file"==C(this).attr("type").toLowerCase()&&e.FileReader;if(!t||!this.files||0==this.files.length)return!0;for(var r=0;r<this.files.length;r++)a.push({file:this.files[r],inputElem:this,instanceConfig:C.extend({},s)})}),r(),this}}y?e.onmessage=p:S.WORKERS_SUPPORTED&&(v=h(),document.body?document.addEventListener("DOMContentLoaded",function(){b=!0},!0):b=!0),i.prototype=Object.create(n.prototype),i.prototype.constructor=i,s.prototype=Object.create(n.prototype),s.prototype.constructor=s,a.prototype=Object.create(a.prototype),a.prototype.constructor=a}("undefined"!=typeof window?window:this);_application/javascript_Thttps://hdc-lm-dsi.euro.apple.com:9000/assets/javascripts/utilities/papaparse.min.js‘ef2gOñbplist00‘jkX$versionX$objectsY$archiverT$top Ü†Ø#)*0123MNOPQRSTUVWXYZ[\]^_`aeU$null›	
 !"R$6S$10R$2R$7R$3S$11R$8V$classR$4R$9R$0R$5R$1Ä	ÄÄÄ ÄÄÄÄ”$%'(WNS.base[NS.relativeÄ ÄÄ_Ghttps://hdc-lm-dsi.euro.apple.com:9000/assets/images/loader-spinner.gif“+,-.Z$classnameX$classesUNSURL¢-/XNSObject#Aø±Æbå¨ »”456ALWNS.keysZNS.objects™789:;<=>?@Ä	Ä
ÄÄÄÄÄÄÄÄ™BDEFGHIJKÄÄÄÄÄÄÄÄÄÄÄTEtag\Content-Type]Last-Modified_Strict-Transport-Security]Accept-RangesTDate_Content-Encoding^Content-Length]Cache-ControlTVary_*"ebbd324df0ddc601bafa9ce4893aa06b53e3159b"Yimage/gif_Wed, 09 Mar 2016 05:53:46 GMT_max-age=2592000Ubytes_Tue, 07 Nov 2017 09:00:30 GMTTgzipS734_public, max-age=3600_Accept-Encoding“+,bc_NSMutableDictionary£bd/\NSDictionary“+,fg_NSHTTPURLResponse£hi/_NSHTTPURLResponse]NSURLResponse_NSKeyedArchiver—lm_WebResourceResponseÄ    # - 2 7 Y _ z } Å Ñ á ä é ë ò õ û ° § ß © ´ ≠ Ø ± ≤ ¥ ∂ ∏ ∫ º æ ¿ « œ € › ﬂ ·+0;DJMV_acjr}àäåéêíîñòöúß©´≠Ø±≥µ∑πªΩ¬œ›˘.<Anxò™∞–’Ÿ!.3GK_mÇò             n              öOOGIF89a  Ù  ˇˇˇîﬂ¯˚˝J´ÂèÀÔñﬂ:£„ŸÌ˘∞⁄Û+ù·Ç≈ÌtæÎÊÛ˙°”ÒÀÊ˜Y≤Áe∑È                                             !ˇNETSCAPE2.0   !˛Created with ajaxload.info !˘	
   ,       P  édiû•0l!*Ñ`™≠ò∆ë5ÄŸàÄ[ç<iÖPëÖâÖ¢é¨),ÄIZ¯¢$b∫Híê8Ñ®5&xâ5k <Úy≈ÔèB !˘	
   ,       h  äG“åh*≈‡®®@$E}¿¿¡÷≈åîÄeh¡¿ @
L¿ÄcQGÉB¥Â∂P5ò <™5UdQ∂+Ë"æ£gî0®Æ¢°èAkœ#A <P70<	Ä0Y8*	á#! !˘	
   ,       `  é#Ûê(⁄H*
ƒP	-§á1Ô3Å
:CÀ1K¥HÑÇ·H.ò$Ÿ±y æ—Ãÿj.ÅWD@‹Y ¢0H	Ö,0éB‘
ékJÊÌU?5w|$k\)ã! !˘	
   ,       R  édiûÄ î1≈@®ÉC¨∆kãÇú!B‰`? Å∑æê#EÇ8zBQXÄcªm¢v"° È¬£`Å`ÜUF¶r‹•pÎ)ÛfˇÄ! !˘	
   ,       `  édiû®@E1¬…m]«πHå–Üÿ(ä4 Á(,¶F!aH XSòÅm5§µbDH¥ ™πab,
é%Äp3cƒ#∞'¯Ï"467P&*X/Ä(åç$! !˘	
   ,       _  édiû®H≈@¶@4 ¬≤∆A"Ië∞ö°`>nÖI0$àçK7≤H,¡â-tÉ*ÇÉE§√-—`®à`¿˘1â∞ó@èC7h/1f\)ãå&! ;         _Ghttps://hdc-lm-dsi.euro.apple.com:9000/assets/images/loader-spinner.gif            1   <   N   d   Ç   ë   ®  ú(  ú2  ú8  úÖ  úà  úü  ú™  ú¿  °è bW b` bf bø b» gx Ä Ä! ÄÄ Äâ çæ ñ% °o °x ™Ì ∞Ö ∏ ∏ æ ¡ ≈/ ≈8 »’  	 Àª Àƒ œ –	 —k —t ‘˝ ÷" ÷, ◊  ◊” ﬂd „ë È7 È@  ÛÆ ¯î ¯ù ˚› ¸À ˛! ˛*  e  í  „  Ï  œ ˘   ≤ < <e <n A \n \Õ \ÿ a≈ *ä *£ *¸ + /˚ ÃÃ ÃÂ ÕN ÕY “8 ‚~ ‚ó ‚Î ‚ˆ Áÿ  ƒ  › !4 != %◊ )*             h             )t